window.__require=function t(e,o,i){function a(s,r){if(!o[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+s+"'")}}var h=o[s]={exports:{}};e[s][0].call(h.exports,function(t){return a(e[s][1][t]||t)},h,h.exports,t,e,o,i)}return o[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<i.length;s++)a(i[s]);return a}({AchievementData:[function(t,e,o){"use strict";cc._RF.push(e,"6a835W88Z5L36Zxiky/P1I6","AchievementData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(){this.index=0,this.monsters={},this.playerLifes=0}}();o.default=i,cc._RF.pop()},{}],Achievement:[function(t,e,o){"use strict";cc._RF.push(e,"5607byYvNBEQ4yBaPsgf0sF","Achievement");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Data/AchievementData"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MONSTER_SIZE=25,e.BOSS_SIZE=9,e.content=null,e.contentBottom=null,e.prefab=null,e.lifesLabel=null,e.spriteFrames=null,e.bossSpriteFrames=null,e.iconList=new Array,e.isMonsterLoaded=!1,e.isBossLoaded=!1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.content.removeAllChildren(),this.contentBottom.removeAllChildren();for(var t=0;t<this.MONSTER_SIZE+this.BOSS_SIZE;t++){var e=cc.instantiate(this.prefab);t>this.MONSTER_SIZE-1?this.contentBottom.addChild(e):this.content.addChild(e);var i=e.getChildByName("sprite");i.color=cc.color(0,0,0),this.iconList.push(i.getComponent(cc.Sprite))}this.loadSpriteFrames(),this.loadBossSpriteFrames();var a=o.getAchievementData();this.lifesLabel&&a.playerLifes&&(this.lifesLabel.string=""+a.playerLifes)},e.prototype.loadSpriteFrames=function(){var t=this;this.spriteFrames?this.isMonsterLoaded=!0:cc.loader.loadResDir("Texture/Monster",cc.SpriteFrame,function(e,o){t.spriteFrames={};for(var i=0,a=o;i<a.length;i++){var n=a[i];t.spriteFrames[n.name]=n}t.isMonsterLoaded=!0,cc.log("monster texture loaded")})},e.prototype.loadBossSpriteFrames=function(){var t=this;this.bossSpriteFrames?this.isBossLoaded=!0:cc.loader.loadResDir("OtherTexture/Boss",cc.SpriteFrame,function(e,o){t.bossSpriteFrames={};for(var i=0,a=o;i<a.length;i++){var n=a[i];t.bossSpriteFrames[n.name]=n}t.isBossLoaded=!0,cc.log("boss texture loaded")})},e.prototype.show=function(){if(this.iconList)for(var t=["#ffffff","#00ff00","#0000ff","#800080","#ffa500"],e=o.getAchievementData(),i=0;i<this.iconList.length;i++){var a="monster"+(i<10?"00"+i:"0"+i),n=this.spriteFrames[a];if(i>this.MONSTER_SIZE-1&&(a="iconboss00"+(i-this.MONSTER_SIZE),n=this.bossSpriteFrames[a]),n){this.iconList[i].node.width=96,this.iconList[i].node.height=96,this.iconList[i].spriteFrame=this.spriteFrames[a],i>this.MONSTER_SIZE-1&&(this.iconList[i].spriteFrame=this.bossSpriteFrames[a]);var s=this.iconList[i].node.parent.getComponentInChildren(cc.Label);if(s.string="",e&&e.monsters&&e.monsters[a]&&e.monsters[a]>0){this.iconList[i].node.color=cc.color(255,255,255),s.node.color=cc.color(255,255,255),s.string=""+e.monsters[a];var r=0;if(e.monsters[a]&&e.monsters[a]>0&&(r=e.monsters[a]),s.string="",r>0){var c=r%20;r>100&&(c=20);for(var l="",h=0;h<c;h+=4)l+="\u2605";s.string=l;var u=Math.floor(r/20);u>t.length-1&&(u=t.length-1),s.node.color=cc.Color.WHITE.fromHEX(t[u])}}else this.iconList[i].node.color=cc.color(0,0,0)}}},e.prototype.start=function(){},e.prototype.backToHome=function(){cc.director.loadScene("start")},e.getAchievementData=function(){var t=cc.sys.localStorage.getItem("achievement");t||(t="{}");var e=JSON.parse(t);return e&&e.monsters||(e=new n.default),e},e.saveAchievementData=function(t){cc.sys.localStorage.setItem("achievement",JSON.stringify(t))},e.addMonsterKillAchievement=function(t){var e=o.getAchievementData();e.monsters[t]?e.monsters[t]=e.monsters[t]+1:e.monsters[t]=1,o.saveAchievementData(e)},e.addPlayerDiedLifesAchievement=function(){var t=o.getAchievementData();t.playerLifes?t.playerLifes=t.playerLifes+1:t.playerLifes=1,o.saveAchievementData(t)},e.prototype.update=function(t){this.isBossLoaded&&this.isMonsterLoaded&&(this.isBossLoaded=!0,this.isMonsterLoaded=!0,this.show())},a([c(cc.Node)],e.prototype,"content",void 0),a([c(cc.Node)],e.prototype,"contentBottom",void 0),a([c(cc.Prefab)],e.prototype,"prefab",void 0),a([c(cc.Label)],e.prototype,"lifesLabel",void 0),e=o=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Data/AchievementData":"AchievementData"}],Actor:[function(t,e,o){"use strict";cc._RF.push(e,"d1527FzjXVGUp0qJt0LJYgx","Actor");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],AmmoCount:[function(t,e,o){"use strict";cc._RF.push(e,"6a3014RzCdLroOkSBlm8HS/","AmmoCount");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(t){this.label&&(this.label.string=""+n.default.ammo)},a([c(cc.Label)],e.prototype,"label",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Logic":"Logic"}],AreaAttack:[function(t,e,o){"use strict";cc._RF.push(e,"08dc9BOH7FDYpKdHhvOcRnQ","AreaAttack");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getNearPlayerDistance=function(t){return this.node?n.default.getDistance(this.node.position,t.position):9999},e.prototype.damagePlayer=function(t,e,o,i){var a=this;this.node&&e&&this.getNearPlayerDistance(e.node)<64*this.node.scale&&(e.takeDamage(o,i),t.length>0&&e.addStatus(t,i)),this.node&&this.scheduleOnce(function(){a.node&&a.node.destroy()},2)},e.prototype.start=function(){},e=a([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{"../Logic":"Logic"}],AudioPlayer:[function(t,e,o){"use strict";cc._RF.push(e,"76c8da4ThVB/L/QkXaZyrPc","AudioPlayer");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("./Random"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monsterHit=null,e.pickUp=null,e.playerHit=null,e.remoteLaser=null,e.shoot=null,e.coin=null,e.boom=null,e.dash=null,e.die=null,e.exit=null,e.pickItem=null,e.melee=null,e.walk=null,e.blink=null,e.select=null,e.bg01=null,e.bg02=null,e.bg03=null,e.bg04=null,e.bg05=null,e.bg06=null,e.bg07=null,e.bg08=null,e.bg09=null,e.bg10=null,e.bg11=null,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(n.EventConstant.PLAY_AUDIO,function(e){t.play(e.detail.name)})},e.prototype.playbg=function(){var t=[this.bg01,this.bg02,this.bg03,this.bg04,this.bg05,this.bg06,this.bg07,this.bg08,this.bg09,this.bg10,this.bg11],e=t[s.default.getRandomNum(0,t.length-1)];e&&cc.audioEngine.playMusic(e,!0)},e.prototype.play=function(t){switch(t){case o.MONSTER_HIT:cc.audioEngine.playEffect(this.monsterHit,!1);break;case o.PICK_UP:cc.audioEngine.playEffect(this.pickUp,!1);break;case o.PLAYER_HIT:cc.audioEngine.playEffect(this.playerHit,!1);break;case o.REMOTE_LASER:cc.audioEngine.playEffect(this.remoteLaser,!1);break;case o.SHOOT:cc.audioEngine.playEffect(this.shoot,!1);break;case o.BOOM:cc.audioEngine.playEffect(this.boom,!1);break;case o.COIN:cc.audioEngine.playEffect(this.coin,!1);break;case o.MELEE:cc.audioEngine.playEffect(this.melee,!1);break;case o.WALK:cc.audioEngine.playEffect(this.walk,!1);break;case o.EXIT:cc.audioEngine.playEffect(this.exit,!1);break;case o.DASH:cc.audioEngine.playEffect(this.dash,!1);break;case o.DIE:cc.audioEngine.playEffect(this.die,!1);break;case o.PICK_ITEM:cc.audioEngine.playEffect(this.pickItem,!1);break;case o.SELECT:cc.audioEngine.playEffect(this.select,!1);break;case o.BLINK:cc.audioEngine.playEffect(this.blink,!1);break;case o.STOP_BG:cc.audioEngine.stopMusic();break;case o.PLAY_BG:this.playbg()}},e.prototype.start=function(){},e.MONSTER_HIT="MONSTER_HIT",e.PICK_UP="PICK_UP",e.PLAYER_HIT="PLAYER_HIT",e.REMOTE_LASER="REMOTE_LASER",e.SHOOT="SHOOT",e.BOOM="BOOM",e.COIN="COIN",e.MELEE="MELEE",e.WALK="WALK",e.DASH="DASH",e.DIE="DIE",e.PICK_ITEM="PICK_ITEM",e.EXIT="EXIT",e.STOP_BG="STOP_BG",e.PLAY_BG="PLAY_BG",e.SELECT="SELECT",e.BLINK="BLINK",a([l({type:cc.AudioClip})],e.prototype,"monsterHit",void 0),a([l({type:cc.AudioClip})],e.prototype,"pickUp",void 0),a([l({type:cc.AudioClip})],e.prototype,"playerHit",void 0),a([l({type:cc.AudioClip})],e.prototype,"remoteLaser",void 0),a([l({type:cc.AudioClip})],e.prototype,"shoot",void 0),a([l({type:cc.AudioClip})],e.prototype,"coin",void 0),a([l({type:cc.AudioClip})],e.prototype,"boom",void 0),a([l({type:cc.AudioClip})],e.prototype,"dash",void 0),a([l({type:cc.AudioClip})],e.prototype,"die",void 0),a([l({type:cc.AudioClip})],e.prototype,"exit",void 0),a([l({type:cc.AudioClip})],e.prototype,"pickItem",void 0),a([l({type:cc.AudioClip})],e.prototype,"melee",void 0),a([l({type:cc.AudioClip})],e.prototype,"walk",void 0),a([l({type:cc.AudioClip})],e.prototype,"blink",void 0),a([l({type:cc.AudioClip})],e.prototype,"select",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg01",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg02",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg03",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg04",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg05",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg06",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg07",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg08",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg09",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg10",void 0),a([l({type:cc.AudioClip})],e.prototype,"bg11",void 0),e=o=a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../EventConstant":"EventConstant","./Random":"Random"}],BaseData:[function(t,e,o){"use strict";cc._RF.push(e,"104f7mgC6BFIYLmzL4FKFUV","BaseData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Utils/Random"),a=function(){function t(){}return t.prototype.genNonDuplicateID=function(){return Number(i.default.rand().toString().substr(3,16)+Date.now()).toString(36)},t}();o.default=a,cc._RF.pop()},{"../Utils/Random":"Random"}],Boom:[function(t,e,o){"use strict";cc._RF.push(e,"d213dKARTpOJaVCOXgf0gmT","Boom");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../Monster"),r=t("../Boss/Boss"),c=t("../Data/DamageData"),l=t("../Data/FromData"),h=cc._decorator,u=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFromPlayer=!1,e}return i(e,t),e.prototype.start=function(){var t=this;this.scheduleOnce(function(){t.node&&t.node.destroy()},.5)},e.prototype.onCollisionEnter=function(t,e){var o=!0,i=t.node.getComponent(n.default),a=t.node.getComponent(s.default),c=t.node.getComponent(r.default);this.isFromPlayer||!a&&!c||(o=!1),this.isFromPlayer&&i&&(o=!1),o&&this.attacking(t.node)},e.prototype.attacking=function(t){if(t){var e=new c.default;e.physicalDamage=3;var o=t.getComponent(s.default);o&&!o.isDied&&o.takeDamage(e);var i=t.getComponent(n.default);i&&!i.isDied&&i.takeDamage(e,l.default.getClone("\u7206\u70b8","boom000anim001"));var a=t.getComponent(r.default);a&&!a.isDied&&a.takeDamage(e)}},e=a([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Monster":"Monster","../Player":"Player"}],BossAttackCollider:[function(t,e,o){"use strict";cc._RF.push(e,"955f3FE6OVI9rSVX2x0s/2h","BossAttackCollider");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("../Player"),r=t("../Data/DamageData"),c=t("../Data/FromData"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=2,e.from=new c.default,e.isShow=!1,e}return i(e,t),e.prototype.start=function(){this.isShow=!1},e.prototype.showCollider=function(t,e){var o=this,i=e||0;this.scheduleOnce(function(){o.isShow=!0},i),this.scheduleOnce(function(){o.isShow=!1},t)},e.prototype.onCollisionEnter=function(t,e){if(t.node.getComponent(s.default)&&this.isShow&&this.node.active){this.isShow=!1;var o=new r.default;o.physicalDamage=this.damage,cc.director.emit(n.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:o,from:this.from}})}},a([u],e.prototype,"damage",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Player":"Player"}],Boss:[function(t,e,o){"use strict";cc._RF.push(e,"27ef0INO8BDnrQF5OkIl5aV","Boss");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../Data/MonsterData"),r=t("../Dungeon"),c=t("../Manager/StatusManager"),l=t("../EventConstant"),h=t("../Base/Actor"),u=t("../Item/Item"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statusManager=null,e.healthBar=null,e.pos=cc.v2(0,0),e.data=new s.default,e.isDied=!1,e.isShow=!1,e}return i(e,t),e.prototype.addStatus=function(t,e){this.statusManager&&this.statusManager.addStatus(t,e)},e.prototype.getNearPlayerDistance=function(t,e){var o=this.node.position.clone();return e&&o.addSelf(e),n.default.getDistance(this.node.position,t.position)},e.prototype.getCenterPosition=function(){return this.node.position.clone().addSelf(cc.v2(0,32*this.node.scaleY))},e.prototype.playHit=function(t){t&&(t.stopAllActions(),t.position=cc.v2(0,0),t.runAction(cc.sequence(cc.moveTo(.1,2,0),cc.moveTo(.1,-2,0),cc.moveTo(.1,2,0),cc.moveTo(.1,-2,0),cc.moveTo(.1,0,2),cc.moveTo(.1,0,-2),cc.moveTo(.1,0,2),cc.moveTo(.1,0,0))))},e.prototype.updatePlayerPos=function(){this.node.position=r.default.getPosInMap(this.pos)},e.prototype.transportBoss=function(t,e){this.pos.x=t,this.pos.y=e,this.changeZIndex(),this.updatePlayerPos()},e.prototype.changeZIndex=function(){this.node.zIndex=3e3+10*(r.default.HEIGHT_SIZE-this.pos.y-1)+2},e.prototype.start=function(){var t=this;this.changeZIndex(),this.scheduleOnce(function(){t.healthBar&&t.healthBar.refreshHealth(t.data.currentHealth,t.data.Common.maxHealth)},.1)},e.prototype.getLoot=function(){this.dungeon&&(cc.director.emit(l.EventConstant.DUNGEON_ADD_COIN,{detail:{pos:this.node.position,count:19}}),cc.director.emit(l.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:u.default.HEART}}),cc.director.emit(l.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:u.default.AMMO}}),this.dungeon.addEquipment(n.default.getRandomEquipType(),this.pos,null,3))},e.prototype.showBoss=function(){},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a)},a([f(c.default)],e.prototype,"statusManager",void 0),e=a([d],e)}(h.default);o.default=m,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/MonsterData":"MonsterData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Item/Item":"Item","../Logic":"Logic","../Manager/StatusManager":"StatusManager"}],BoxData:[function(t,e,o){"use strict";cc._RF.push(e,"9dffcnB2sFH8Y3GL3+iALBZ","BoxData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.onelife=!1}return t.prototype.valueCopy=function(t){this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.defaultPos=t.defaultPos?cc.v2(t.defaultPos.x,t.defaultPos.y):cc.v2(0,0),this.position=t.position?cc.v2(t.position.x,t.position.y):cc.v2(0,0),this.onelife=!!t.onelife&&t.onelife},t}();o.default=i,cc._RF.pop()},{}],Box:[function(t,e,o){"use strict";cc._RF.push(e,"84b7dB47rlIALRzq2ZvOGc3","Box");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Data/BoxData"),r=t("../Logic"),c=t("./Building"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isBreaking=!1,e.boxType=0,e.data=new s.default,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.anim.play("BoxShow")},e.prototype.start=function(){var t="box";switch(this.boxType){case o.BOX:t="box";break;case o.PLANT:t="plant";break;case o.BOXBREAKABLE:t="box"}switch(r.default.chapterName){case r.default.CHAPTER00:this.changeRes(t+"000");break;case r.default.CHAPTER01:this.changeRes(t+"001");break;case r.default.CHAPTER02:this.changeRes(t+"002");break;case r.default.CHAPTER03:this.changeRes(t+"003");break;case r.default.CHAPTER04:this.changeRes(t+"004")}},e.prototype.changeRes=function(t){var e=this.node.getChildByName("sprite").getComponent(cc.Sprite),o=r.default.spriteFrames[t];e.spriteFrame=o},e.prototype.setPos=function(t){this.data.pos=t,this.node.position=n.default.getPosInMap(this.data.pos),this.node.zIndex=3e3+100*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.BreakingFinish=function(){this.reset()},e.prototype.breakBox=function(){this.isBreaking||(this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("BoxBroken"),this.isBreaking=!0)},e.prototype.reset=function(){this.node.position=n.default.getPosInMap(this.data.defaultPos),this.isBreaking=!1},e.prototype.update=function(t){if(this.timeDelay+=t,this.timeDelay>.2){this.data.pos=n.default.getIndexInMap(this.node.position),this.data.position=this.node.position,this.data.onelife=!1;var e=r.default.mapManager.getCurrentMapBoxes();if(e)for(var o=0,i=e;o<i.length;o++){var a=i[o];a.defaultPos.equals(this.data.defaultPos)&&(a.pos=this.data.pos,a.position=this.data.position)}this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-this.data.pos.y)+1}},e.BOX=0,e.PLANT=1,e.BOXBREAKABLE=2,e=o=a([h],e)}(c.default));o.default=u,cc._RF.pop()},{"../Data/BoxData":"BoxData","../Dungeon":"Dungeon","../Logic":"Logic","./Building":"Building"}],Building:[function(t,e,o){"use strict";cc._RF.push(e,"255a9MnBFxLp4C3tatPRINn","Building");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Base/Actor"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.takeDamage=function(t){return!1},e.prototype.actorName=function(){return""},e=a([r],e)}(n.default));o.default=c,cc._RF.pop()},{"../Base/Actor":"Actor"}],BulletData:[function(t,e,o){"use strict";cc._RF.push(e,"081a6xA9tZAiZxbsh2+6iXp","BulletData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./DamageData"),a=t("./FromData"),n=function(){function t(){this.speed=0,this.isRect=0,this.isRotate=0,this.rotateAngle=0,this.isLaser=0,this.isDecelerate=0,this.decelerateDelta=0,this.delayDecelerate=0,this.isBoom=0,this.isPhysical=0,this.delaytrack=0,this.isTracking=0,this.lifeTime=0,this.size=1,this.resName="",this.lightName="",this.resNameLaser="",this.lightColor="#ffffff",this.fixedRotation=0,this.statusType="",this.statusRate=0,this.damage=new i.default,this.from=new a.default}return t.prototype.valueCopy=function(t){this.speed=t.speed?t.speed:0,this.isRect=t.isRect?t.isRect:0,this.isRotate=t.isRotate?t.isRotate:0,this.rotateAngle=t.rotateAngle?t.rotateAngle:0,this.isDecelerate=t.isDecelerate?t.isDecelerate:0,this.decelerateDelta=t.decelerateDelta?t.decelerateDelta:0,this.delayDecelerate=t.delayDecelerate?t.delayDecelerate:0,this.isLaser=t.isLaser?t.isLaser:0,this.isBoom=t.isBoom?t.isBoom:0,this.isTracking=t.isTracking?t.isTracking:0,this.isPhysical=t.isPhysical?t.isPhysical:0,this.delaytrack=t.delaytrack?t.delaytrack:0,this.fixedRotation=t.fixedRotation?t.fixedRotation:0,this.size=t.size?t.size:1,this.lifeTime=t.lifeTime?t.lifeTime:0,this.resName=t.resName?t.resName:"",this.resNameLaser=t.resNameLaser?t.resNameLaser:"",this.lightName=t.lightName?t.lightName:"",this.statusType=t.statusType?t.statusType:"",this.statusRate=t.statusRate?t.statusRate:0,this.lightColor=t.lightColor?t.lightColor:"#ffffff",this.damage.valueCopy(t.damage),this.from.valueCopy(t.from)},t.prototype.clone=function(){var e=new t;return e.speed=this.speed,e.isRect=this.isRect,e.isRotate=this.isRotate,e.rotateAngle=this.rotateAngle,e.decelerateDelta=this.decelerateDelta,e.isDecelerate=this.isDecelerate,e.delayDecelerate=this.delayDecelerate,e.size=this.size,e.isLaser=this.isLaser,e.isBoom=this.isBoom,e.isTracking=this.isTracking,e.resName=this.resName,e.resNameLaser=this.resNameLaser,e.lightName=this.lightName,e.lightColor=this.lightColor,e.lifeTime=this.lifeTime,e.isPhysical=this.isPhysical,e.delaytrack=this.delaytrack,e.fixedRotation=this.fixedRotation,e.statusType=this.statusType,e.statusRate=this.statusRate,e.damage=this.damage.clone(),e.from=this.from.clone(),e},t}();o.default=n,cc._RF.pop()},{"./DamageData":"DamageData","./FromData":"FromData"}],Bullet:[function(t,e,o){"use strict";cc._RF.push(e,"d243aeNu+tEJJbz1ng6i61f","Bullet");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("../Monster"),r=t("../Player"),c=t("../MeleeWeapon"),l=t("../Data/DamageData"),h=t("../Logic"),u=t("../Boss/Boss"),p=t("../Data/BulletData"),d=t("../Manager/StatusManager"),f=t("./Boom"),m=t("../Talent/TalentShield"),g=t("./FlyWheel"),y=t("../Utils/AudioPlayer"),v=t("../Data/FromData"),D=cc._decorator,C=D.ccclass,_=D.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boom=null,e.data=new p.default,e.dir=0,e.tagetPos=cc.v2(0,0),e.hv=cc.v2(0,0),e.isFromPlayer=!1,e.startPos=cc.v2(0,0),e.isTrackDelay=!1,e.isDecelerateDelay=!1,e.isHit=!1,e.isReserved=!1,e.skipTopwall=!1,e.timeDelay=0,e.checkTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.rigidBody=this.getComponent(cc.RigidBody),this.circleCollider=this.getComponent(cc.CircleCollider),this.boxCollider=this.getComponent(cc.BoxCollider),this.circlePCollider=this.getComponent(cc.PhysicsCircleCollider),this.boxPCollider=this.getComponent(cc.PhysicsBoxCollider),this.sprite=this.node.getChildByName("sprite"),this.sprite.opacity=255,this.sprite.angle=0,this.light=this.node.getChildByName("light"),this.light.opacity=0,this.laserNode=this.node.getChildByName("laser"),this.laserSpriteNode=this.laserNode.getChildByName("sprite"),this.laserLightSprite=this.laserNode.getChildByName("light").getComponent(cc.Sprite),this.laserHeadSprite=this.laserNode.getChildByName("head").getComponent(cc.Sprite)},e.prototype.onEnable=function(){this.tagetPos=cc.v2(0,0),this.rigidBody.linearVelocity=cc.v2(0,0),this.sprite=this.node.getChildByName("sprite"),this.sprite.opacity=255,this.sprite.angle=0,this.light=this.node.getChildByName("light"),this.light.opacity=0,this.laserNode=this.node.getChildByName("laser"),this.laserSpriteNode=this.laserNode.getChildByName("sprite"),this.laserLightSprite=this.laserNode.getChildByName("light").getComponent(cc.Sprite),this.laserHeadSprite=this.laserNode.getChildByName("head").getComponent(cc.Sprite),this.isTrackDelay=!1,this.isDecelerateDelay=!1,this.isHit=!1,this.isReserved=!1},e.prototype.update=function(t){if(this.checkTimeDelay+=t,this.checkTimeDelay>.5&&(this.checkTraking(),this.checkTimeDelay=0),1==this.data.fixedRotation&&(this.node.angle=0),1==this.data.isDecelerate&&this.isDecelerateDelay&&(this.timeDelay+=t,this.timeDelay>.016)){this.timeDelay=0;var e=this.data.decelerateDelta>0?this.data.decelerateDelta:1;this.rigidBody.linearVelocity=this.rigidBody.linearVelocity.lerp(cc.v2(0,0),e*t)}},e.prototype.checkTraking=function(){if(1==this.data.isTracking&&1!=this.data.isLaser&&this.isTrackDelay&&!this.isHit){var t=this.hasNearEnemy();t.equals(cc.Vec2.ZERO)||(this.rotateColliderManager(cc.v2(this.node.position.x+t.x,this.node.position.y+t.y)),this.hv=t,this.rigidBody.linearVelocity=cc.v2(this.data.speed*this.hv.x,this.data.speed*this.hv.y))}},e.prototype.changeBullet=function(t){this.data=t,this.changeRes(t.resName,t.lightName,t.lightColor),this.circleCollider.enabled=1!=t.isRect,this.boxCollider.enabled=1==t.isRect,this.circlePCollider.enabled=1!=t.isRect,this.boxPCollider.enabled=1==t.isRect,this.light.position=1==t.isRect?cc.v2(8,0):cc.v2(0,0),this.node.scale=t.size>0?t.size:1,this.circlePCollider.enabled&&(this.circlePCollider.sensor=0==t.isPhysical,this.circlePCollider.apply()),this.boxPCollider.enabled&&(this.boxPCollider.sensor=0==t.isPhysical,this.boxPCollider.apply()),this.initLaser()},e.prototype.initLaser=function(){var t=this;if(this.laserNode.active=1==this.data.isLaser,1==this.data.isLaser){this.laserNode||(this.laserNode=this.node.getChildByName("laser")),this.sprite.opacity=0,this.sprite.getComponent(cc.Sprite).spriteFrame=null,this.sprite.angle=0,this.laserNode.opacity=0,this.laserSpriteNode.getComponent(cc.Sprite).spriteFrame=this.getSpriteFrameByName(this.data.resNameLaser),this.laserHeadSprite.spriteFrame=this.getSpriteFrameByName(this.data.resNameLaser,"head"),this.laserNode.stopAllActions();var e=cc.repeatForever(cc.sequence(cc.moveBy(.05,0,0),cc.callFunc(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light001")}),cc.moveBy(.05,0,0),cc.callFunc(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light002")}),cc.moveBy(.05,0,0),cc.callFunc(function(){t.laserLightSprite.spriteFrame=t.getSpriteFrameByName(t.data.resNameLaser,"light003")})));this.laserLightSprite.node.runAction(e)}},e.prototype.showLaser=function(){var t=this;if(1==this.data.isLaser){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0)),o=h.default.getDistance(this.startPos,e)-32;this.laserSpriteNode.width=o/this.node.scaleY,this.laserSpriteNode.setPosition(cc.v2(-o/this.node.scaleY,0)),this.laserHeadSprite.node.setPosition(cc.v2(-o/this.node.scaleY,0)),this.laserNode.opacity=255,this.sprite.opacity=0,this.laserNode.scaleX=1,this.laserNode.scaleY=1,this.laserLightSprite.node.setPosition(-16*this.node.scaleY,0);var i=cc.sequence(cc.scaleTo(.1,1,1),cc.scaleTo(.1,1,0));this.laserNode.runAction(i),this.scheduleOnce(function(){cc.director.emit("destorybullet",{detail:{bulletNode:t.node}})},.2),cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:y.default.REMOTE_LASER}})}},e.prototype.changeRes=function(t,e,o,i){if(this.sprite||(this.sprite=this.node.getChildByName("sprite")),this.sprite&&!(t.length<1)){var a=this.getSpriteFrameByName(t,i),n=this.getSpriteFrameByName(e,i);if(a&&(this.sprite.getComponent(cc.Sprite).spriteFrame=a),n){this.light.getComponent(cc.Sprite).spriteFrame=n;var s=cc.color(255,255,255).fromHEX(o);this.light.color=s}}},e.prototype.getSpriteFrameByName=function(t,e){var o=h.default.spriteFrames[t+e];return o||(o=h.default.spriteFrames[t]),o},e.prototype.MeleeFinish=function(){cc.director.emit("destorybullet",{detail:{bulletNode:this.node}})},e.prototype.showBullet=function(t){this.hv=t,this.rotateColliderManager(cc.v2(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y)),this.fire(this.hv.clone())},e.prototype.BulletDestory=function(){cc.director.emit("destorybullet",{detail:{bulletNode:this.node}})},e.prototype.fire=function(t){var e=this;this.rigidBody||(this.rigidBody=this.getComponent(cc.RigidBody)),this.rigidBody.linearVelocity=cc.v2(this.data.speed*t.x,this.data.speed*t.y),this.startPos=this.node.convertToWorldSpaceAR(cc.v2(0,0)),this.sprite.stopAllActions(),this.node.stopAllActions();var o=this.sprite.getComponent(cc.Sprite),i=cc.sequence(cc.moveBy(.1,0,0),cc.callFunc(function(){o.spriteFrame=e.getSpriteFrameByName(e.data.resName)}),cc.moveBy(.1,0,0),cc.callFunc(function(){o.spriteFrame=e.getSpriteFrameByName(e.data.resName,"anim001")}),cc.moveBy(.1,0,0),cc.callFunc(function(){o.spriteFrame=e.getSpriteFrameByName(e.data.resName,"anim002")})),a=cc.spawn(i,cc.rotateBy(.3,this.data.rotateAngle>0?this.data.rotateAngle:15));1==this.data.isRotate?this.sprite.runAction(cc.repeatForever(a)):this.sprite.runAction(cc.repeatForever(i)),this.data.lifeTime>0&&this.scheduleOnce(function(){e.bulletHit()},this.data.lifeTime),this.isTrackDelay=!1,1==this.data.isTracking&&this.scheduleOnce(function(){e.isTrackDelay=!0},this.data.delaytrack),this.isDecelerateDelay=!1,1==this.data.isDecelerate&&this.scheduleOnce(function(){e.isDecelerateDelay=!0},this.data.delayDecelerate)},e.prototype.start=function(){},e.prototype.onBeginContact=function(t,e,i){var a=!0,n=i.node.getComponent(r.default),c=i.node.getComponent(s.default),l=i.node.getComponent(u.default),h=i.node.getComponent(o);(n||c||l||h)&&(a=!1),i.sensor&&(a=!1),2==i.tag&&(a=!1),this.skipTopwall&&6==i.tag&&(a=!1),i.node.getComponent(g.default)&&(a=!0),a&&this.bulletHit()},e.prototype.onCollisionEnter=function(t,e){var i=!0,a=t.node.getComponent(o),n=t.node.getComponent(r.default),c=t.node.getComponent(s.default),l=t.node.getComponent(u.default);this.isFromPlayer||!c&&!l||(i=!1),this.isFromPlayer&&n&&(i=!1),a&&(i=!1),i&&this.attacking(t.node)},e.prototype.attacking=function(t){if(t&&!this.isHit){var e=new l.default;e.valueCopy(this.data.damage);var o=!1,i=t.getComponent(s.default);i&&!i.isDied&&(i.takeDamage(e)&&this.addMonsterAllStatus(i),o=!0);var a=t.getComponent(r.default);if(a&&!a.isDied){var n=!1;a.talentShield.IsExcuting&&a.talentShield.hashTalent(m.default.SHIELD_03)&&(n=this.revserseBullet()),n||(a.takeDamage(e,this.data.from)&&this.addPlayerAllStatus(a,this.data.from),o=!0)}var h=t.getComponent(u.default);h&&!h.isDied&&(h.takeDamage(e)&&this.addBossAllStatus(h),o=!0);var p=t.getComponent(c.default);if(p&&p.isAttacking&&!this.isFromPlayer){n=!1;p.isReflect&&(n=this.revserseBullet()),n||(o=!0)}o&&this.bulletHit()}},e.prototype.revserseBullet=function(){return this.isReserved?(this.isReserved=!0,!1):1!=this.data.isLaser&&(this.node.angle+=-180,this.rigidBody.linearVelocity=this.rigidBody.linearVelocity.mul(-1),this.isFromPlayer=!0,this.data.isTracking=0,!0)},e.prototype.bulletHit=function(){if(this.isHit=!0,this.anim&&!this.anim.getAnimationState("Bullet001Hit").isPlaying&&(this.rigidBody.linearVelocity=cc.v2(0,0),1==this.data.isLaser?this.showLaser():this.anim.play("Bullet001Hit")),1==this.data.isBoom){var t=cc.instantiate(this.boom);t.getComponent(f.default).isFromPlayer=this.isFromPlayer,t.parent=this.node.parent,t.setPosition(this.node.position),t.zIndex=4100,cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:y.default.BOOM}})}},e.prototype.hasNearEnemy=function(){if(1!=this.data.isTracking||1==this.data.isLaser||!this.dungeon)return cc.Vec2.ZERO;var t=1e3,e=cc.v2(0,0);if(this.isFromPlayer){for(var o=0,i=this.dungeon.monsters;o<i.length;o++){var a=i[o];if((c=h.default.getDistance(this.node.position,a.node.position))<500&&c<t&&!a.isDied&&!a.isDisguising)t=c,(l=this.node.position.clone()).x=this.node.scaleX>0?l.x:-l.x,e=a.node.position.sub(l)}if(e.equals(cc.Vec2.ZERO))for(var n=0,s=this.dungeon.bosses;n<s.length;n++){var r=s[n];if((c=h.default.getDistance(this.node.position,r.node.position))<500&&c<t&&!r.isDied)t=c,(l=this.node.position.clone()).x=this.node.scaleX>0?l.x:-l.x,e=r.node.position.sub(l)}}else{var c,l;if((c=h.default.getDistance(this.node.position,this.dungeon.player.node.position))<500&&c<t&&!this.dungeon.player.isDied&&!this.dungeon.player.isFall)t=c,(l=this.node.position.clone()).x=this.node.scaleX>0?l.x:-l.x,e=this.dungeon.player.node.position.sub(l)}return 1e3!=t&&(e=e.normalizeSelf()),e},e.prototype.rotateColliderManager=function(t){if(1!=this.data.fixedRotation){var e=t.sub(this.node.position),o=360/(2*Math.PI),i=360-Math.atan2(e.x,e.y)*o;i+=90,this.node.angle=this.node.scaleX<0?-i:i}},e.prototype.addMonsterAllStatus=function(t){this.addMonsterStatus(this.data.damage.iceRate,t,d.default.FROZEN),this.addMonsterStatus(this.data.damage.fireRate,t,d.default.BURNING),this.addMonsterStatus(this.data.damage.lighteningRate,t,d.default.DIZZ),this.addMonsterStatus(this.data.damage.toxicRate,t,d.default.TOXICOSIS),this.addMonsterStatus(this.data.damage.curseRate,t,d.default.CURSING),this.addMonsterStatus(this.data.damage.realRate,t,d.default.BLEEDING),this.addMonsterStatus(this.data.statusRate,t,this.data.statusType)},e.prototype.addBossAllStatus=function(t){this.addBossStatus(this.data.damage.iceRate,t,d.default.FROZEN),this.addBossStatus(this.data.damage.fireRate,t,d.default.BURNING),this.addBossStatus(this.data.damage.lighteningRate,t,d.default.DIZZ),this.addBossStatus(this.data.damage.toxicRate,t,d.default.TOXICOSIS),this.addBossStatus(this.data.damage.curseRate,t,d.default.CURSING),this.addBossStatus(this.data.damage.realRate,t,d.default.BLEEDING),this.addBossStatus(this.data.statusRate,t,this.data.statusType)},e.prototype.addPlayerAllStatus=function(t,e){this.addPlayerStatus(this.data.damage.iceRate,t,d.default.FROZEN,e),this.addPlayerStatus(this.data.damage.fireRate,t,d.default.BURNING,e),this.addPlayerStatus(this.data.damage.lighteningRate,t,d.default.DIZZ,e),this.addPlayerStatus(this.data.damage.toxicRate,t,d.default.TOXICOSIS,e),this.addPlayerStatus(this.data.damage.curseRate,t,d.default.CURSING,e),this.addPlayerStatus(this.data.damage.realRate,t,d.default.BLEEDING,e),this.addPlayerStatus(this.data.damage.stoneRate,t,d.default.STONE,e),this.addPlayerStatus(this.data.statusRate,t,this.data.statusType,e)},e.prototype.addMonsterStatus=function(t,e,o){h.default.getRandomNum(0,100)<t&&e.addStatus(o,new v.default)},e.prototype.addBossStatus=function(t,e,o){h.default.getRandomNum(0,100)<t&&e.addStatus(o,new v.default)},e.prototype.addPlayerStatus=function(t,e,o,i){h.default.getRandomNum(0,100)<t&&e.addStatus(o,i)},a([_(cc.Prefab)],e.prototype,"boom",void 0),e=o=a([C],e)}(cc.Component);o.default=E,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/BulletData":"BulletData","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../MeleeWeapon":"MeleeWeapon","../Monster":"Monster","../Player":"Player","../Talent/TalentShield":"TalentShield","../Utils/AudioPlayer":"AudioPlayer","./Boom":"Boom","./FlyWheel":"FlyWheel"}],CameraControl:[function(t,e,o){"use strict";cc._RF.push(e,"aaca098lw9M94SueX+ajVM7","CameraControl");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Dungeon"),s=t("./EventConstant"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dungeon=null,e.isShaking=!1,e.isHeavyShaking=!1,e.offsetIndex=0,e.offsetArr=[cc.v2(0,2),cc.v2(0,2),cc.v2(0,-3),cc.v2(0,-3),cc.v2(1,2),cc.v2(1,2),cc.v2(-1,-1),cc.v2(-1,-1)],e.offsetArr1=[cc.v2(0,3),cc.v2(0,3),cc.v2(0,-6),cc.v2(0,-6),cc.v2(3,6),cc.v2(3,6),cc.v2(-3,-3),cc.v2(-3,-3)],e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.camera=this.getComponent(cc.Camera),cc.director.on(s.EventConstant.CAMERA_SHAKE,function(e){t.shakeCamera(e.detail.isHeavyShaking)})},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.start=function(){},e.prototype.lateUpdate=function(){var t=this.dungeon.player.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.node.position=this.lerp(this.node.position,this.node.parent.convertToNodeSpaceAR(t),.1),this.isShaking&&(this.offsetIndex>this.offsetArr.length-1&&(this.offsetIndex=0),this.node.position=this.node.position.addSelf(this.isHeavyShaking?this.offsetArr1[this.offsetIndex]:this.offsetArr[this.offsetIndex]),this.offsetIndex++),this.camera.zoomRatio=this.lerpNumber(this.camera.zoomRatio,this.dungeon.isZoomCamera?.7:1,.05)},e.prototype.shakeCamera=function(t){var e=this;this.node&&(this.isHeavyShaking=t,this.isShaking=!0,this.scheduleOnce(function(){e.isShaking=!1},.2))},e.prototype.lerpNumber=function(t,e,o){return t+(e-t)*o},e.prototype.lerp=function(t,e,o){var i=cc.v2(0,0),a=t.x,n=t.y;return i.x=a+(e.x-a)*o,i.y=n+(e.y-n)*o,i},a([l(n.default)],e.prototype,"dungeon",void 0),e=a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./Dungeon":"Dungeon","./EventConstant":"EventConstant"}],CaptainSword:[function(t,e,o){"use strict";cc._RF.push(e,"e541b/KaoRBdL9VgXHoN6dM","CaptainSword");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("../Player"),r=t("../Data/DamageData"),c=t("../Data/FromData"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=2,e.isShow=!1,e}return i(e,t),e.prototype.start=function(){this.isShow=!1},e.prototype.onCollisionEnter=function(t,e){if(t.node.getComponent(s.default)&&this.isShow&&this.node.active){this.isShow=!1;var o=new r.default;o.physicalDamage=this.damage,cc.director.emit(n.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:o,from:c.default.getClone(this.actorName(),"captain_head")}})}},e.prototype.actorName=function(){return"\u90aa\u6076\u8239\u957f"},a([u],e.prototype,"damage",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Player":"Player"}],Captain:[function(t,e,o){"use strict";cc._RF.push(e,"6d826iFR+pBDJHGFIoYZ400","Captain");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./CaptainSword"),s=t("../Dungeon"),r=t("../Player"),c=t("../EventConstant"),l=t("../Shooter"),h=t("../Data/DamageData"),u=t("./Boss"),p=t("../Utils/Skill"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=t("../Achievement"),g=cc._decorator,y=g.ccclass,v=g.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sword=null,e.healthBar=null,e.isFaceRight=!0,e.isMoving=!1,e.timeDelay=0,e.isFall=!1,e.shooter=null,e.exshooter=null,e.attackSkill=new p.default,e.fireSkill=new p.default,e.jumpSkill=new p.default,e}return i(e,t),e.prototype.onLoad=function(){this.attackSkill.IsExcuting=!1,this.isDied=!1,this.anim=this.getComponent(cc.Animation),this.rigidbody=this.getComponent(cc.RigidBody),this.shooter=this.node.getChildByName("Shooter").getComponent(l.default),this.exshooter=this.node.getChildByName("ExShooter").getComponent(l.default),this.shooter.from.valueCopy(f.default.getClone(this.actorName(),"captain_head")),this.exshooter.from.valueCopy(f.default.getClone(this.actorName(),"captain_head")),this.updatePlayerPos()},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.AttackDamageStart=function(){this.sword.isShow=!0},e.prototype.AttackDamageFinish=function(){this.sword.isShow=!1},e.prototype.AttackStart=function(){this.attackSkill.IsExcuting=!0,cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}})},e.prototype.AttackFinish=function(){this.attackSkill.IsExcuting=!1},e.prototype.JumpStart=function(){this.jumpSkill.IsExcuting=!0,this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.getComponent(cc.PhysicsBoxCollider).apply()},e.prototype.JumpFinish=function(){var t=this;if(this.jumpSkill.IsExcuting=!1,this.isFall=!0,this.scheduleOnce(function(){t.isFall=!1},.1),this.getComponent(cc.PhysicsBoxCollider).sensor=!1,this.getComponent(cc.PhysicsBoxCollider).apply(),this.dungeon&&this.exshooter){var e=this.dungeon.player.getCenterPosition().sub(this.node.position);e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf(),this.exshooter.setHv(e),this.exshooter.dungeon=this.dungeon,this.exshooter.data.bulletType="bullet033",this.exshooter.data.bulletArcExNum=99,this.exshooter.data.bulletLineInterval=1,this.data.currentHealth<this.data.Common.maxHealth/2&&(this.exshooter.data.bulletLineExNum=1),this.exshooter.fireBullet(0,cc.v2(0,0)))}},e.prototype.fireWithAngles=function(t){if(this.dungeon&&this.shooter){var e=this.dungeon.player.getCenterPosition().sub(this.node.position);if(!e.equals(cc.Vec2.ZERO)){e=e.normalizeSelf(),this.shooter.setHv(e),this.shooter.dungeon=this.dungeon,this.shooter.data.bulletType="bullet002";for(var o=0,i=t;o<i.length;o++){var a=i[o];this.shooter.fireBullet(a)}}}},e.prototype.OpenFire=function(){var t=this;if(this.dungeon&&this.shooter){var e=[5,10,-10],o=[-5,10,20,-10,-20,-30,-40,30,40];this.shooter.data.bulletArcExNum=0,this.fireWithAngles([0,10,15,-30,-40,-10,-15,30,40]),this.data.currentHealth<this.data.Common.maxHealth/2&&(this.scheduleOnce(function(){t.fireWithAngles(e)},.3),this.scheduleOnce(function(){t.fireWithAngles(o)},.5))}},e.prototype.onCollisionStay=function(t,e){if(t.getComponent(r.default)&&1==e.tag&&this.isFall&&!this.isDied){this.isFall=!1;var o=new h.default;o.physicalDamage=2,cc.director.emit(c.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:o,from:f.default.getClone(this.actorName(),"captain_head")}})}},e.prototype.update=function(t){(this.healthBar.node.active=!this.isDied,this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,this.bossAction(),this.JumpMove()),this.dungeon)&&(this.getNearPlayerDistance(this.dungeon.player.node)<64&&(this.rigidbody.linearVelocity=cc.v2(0,0)));this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.healthBar.node.active=!this.isDied,this.data.currentHealth<1&&this.killed(),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.takeDamage=function(t){var e=this.anim.getAnimationState("CaptainJump").isPlaying;return!this.isDied&&!e&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(m.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.anim.play("CaptainDie"),this.getComponent("cc.PhysicsCollider").sensor=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){var t=this;if(!this.isDied&&this.dungeon){this.node.position=s.default.fixOuterMap(this.node.position),this.pos=s.default.getIndexInMap(this.node.position),this.changeZIndex();var e=this.dungeon.player.pos.clone(),o=s.default.getPosInMap(e).sub(this.node.position),i=this.getNearPlayerDistance(this.dungeon.player.node),a=this.anim.getAnimationState("CaptainJump").isPlaying,n=this.anim.getAnimationState("CaptainFire").isPlaying,r=o.x,c=o.y;Math.abs(r),Math.abs(c);if(this.isFaceRight=r>0,!a&&!n){var l=200;a||this.fireSkill.next(function(){l=50,t.anim.play("CaptainFire")},5),i<140&&!this.dungeon.player.isDied?this.attackSkill.next(function(){t.attackSkill.IsExcuting=!0,t.anim.play("CaptainAttack")},1):(i>300&&this.jumpSkill.next(function(){t.anim.play("CaptainJump"),a=!0},5),o.equals(cc.Vec2.ZERO)||a||this.attackSkill.IsExcuting||(o=o.normalizeSelf(),this.move(o,l)))}}},e.prototype.JumpMove=function(){if(this.dungeon&&this.jumpSkill.IsExcuting){var t=this.dungeon.player.pos.clone(),e=s.default.getPosInMap(t).sub(this.node.position);e.equals(cc.Vec2.ZERO)||(this.pos=s.default.getIndexInMap(this.node.position),e=e.normalizeSelf());var o=e.x,i=e.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i)),n=200;this.data.currentHealth<this.data.Common.maxHealth/2&&(n=240),a=a.mul(n),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i}},e.prototype.move=function(t,e){if(!this.isDied){this.attackSkill.IsExcuting&&!t.equals(cc.Vec2.ZERO)&&(t=t.mul(.5)),t.equals(cc.Vec2.ZERO)||(this.pos=s.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.isMoving&&(this.isFaceRight=o>0),this.isMoving?this.anim.getAnimationState("CaptainMove").isPlaying||this.anim.playAdditive("CaptainMove"):this.anim.getAnimationState("CaptainMove").isPlaying&&this.anim.play("CaptainIdle"),this.changeZIndex()}},e.prototype.actorName=function(){return"\u90aa\u6076\u8239\u957f"},a([v(n.default)],e.prototype,"sword",void 0),e=a([y],e)}(u.default);o.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss","./CaptainSword":"CaptainSword"}],Chapter:[function(t,e,o){"use strict";cc._RF.push(e,"e966c6tQ3FASbN1WCJi24PI","Chapter");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chapter00=null,e.chapter01=null,e.chapter02=null,e.chapter03=null,e.chapter04=null,e.timeDelay=0,e}return i(e,t),e.prototype.start=function(){cc.view.enableAntiAlias(!1)},e.prototype.clickChapter=function(t,e){e&&(n.default.profileManager.clearData(),n.default.resetData(parseInt(e)),cc.director.loadScene("loading"))},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)},a([c(cc.Button)],e.prototype,"chapter00",void 0),a([c(cc.Button)],e.prototype,"chapter01",void 0),a([c(cc.Button)],e.prototype,"chapter02",void 0),a([c(cc.Button)],e.prototype,"chapter03",void 0),a([c(cc.Button)],e.prototype,"chapter04",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Logic":"Logic"}],ChestData:[function(t,e,o){"use strict";cc._RF.push(e,"a377bf5/5RO+ZrS57AzIKxN","ChestData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.pos=cc.v2(0,0),this.isOpen=!1,this.quality=1}return t.prototype.valueCopy=function(t){this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.isOpen=t.isOpen,this.quality=t.quality},t}();o.default=i,cc._RF.pop()},{}],Chest:[function(t,e,o){"use strict";cc._RF.push(e,"a259fOC11hFpJCy2hycs7kH","Chest");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../EventConstant"),r=t("../Logic"),c=t("../Data/ChestData"),l=t("./Building"),h=t("../Rect/RectDungeon"),u=t("../Utils/AudioPlayer"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e.timeDelay=0,e.data=new c.default,e}return i(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite")},e.prototype.start=function(){},e.prototype.setQuality=function(t,e){this.data.quality=t,this.data.isOpen=e,this.sprite||(this.sprite=this.node.getChildByName("sprite"));var o="chest001",i="chestopen001";switch(t){case 1:o="chest001",i="chestopen001";break;case 2:o="chest003",i="chestopen003";break;case 3:o="chest002",i="chestopen002"}var a=r.default.spriteFrames[o],n=r.default.spriteFrames[i];this.openSpriteFrame=a,this.closeSpriteFrame=n,this.sprite.getComponent(cc.Sprite).spriteFrame=this.openSpriteFrame,e&&(this.sprite.getComponent(cc.Sprite).spriteFrame=this.closeSpriteFrame)},e.prototype.setPos=function(t){this.data.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.openChest=function(){var t=this;if(!this.data.isOpen){this.data.isOpen=!0,cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:u.default.MONSTER_HIT}});var e=cc.sequence(cc.moveTo(.1,5,16),cc.moveTo(.1,-5,0),cc.moveTo(.1,5,0),cc.moveTo(.1,-5,0),cc.moveTo(.1,0,0),cc.callFunc(function(){if(t.sprite.getComponent(cc.Sprite).spriteFrame=t.closeSpriteFrame,t.node.parent){var e=t.node.parent.getComponent(n.default);e&&(r.default.level<1&&(r.default.mapManager.getCurrentRoomType(),h.default.TEST_ROOM),e.addEquipment(r.default.getRandomEquipType(),t.data.pos,null,t.data.quality))}}));this.sprite.runAction(e);var o=r.default.mapManager.getCurrentMapChests(),i=new Array,a=!0;if(o)for(var c=0,l=o;c<l.length;c++){var p=l[c];p.pos.equals(this.data.pos)&&(p.isOpen=this.data.isOpen,p.quality=this.data.quality,a=!1)}a&&(i.push(this.data),r.default.mapManager.setCurrentChestsArr(i))}},e.prototype.onCollisionStay=function(t,e){3==t.tag&&(this.data.isOpen||this.openChest())},e.prototype.update=function(t){},a([f(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),a([f(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),e=a([d],e)}(l.default);o.default=m,cc._RF.pop()},{"../Data/ChestData":"ChestData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Rect/RectDungeon":"RectDungeon","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],CoinCount:[function(t,e,o){"use strict";cc._RF.push(e,"91131vqXzhODZpby3U0hjQL","CoinCount");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./EventConstant"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),cc.director.on(s.EventConstant.HUD_ADD_COIN,function(e){t.addCount(e.detail.count)})},e.prototype.start=function(){},e.prototype.addCount=function(t){this.anim&&(n.default.coins+=parseInt(t))},e.prototype.update=function(t){this.label&&(this.label.string=""+n.default.coins)},a([l(cc.Label)],e.prototype,"label",void 0),e=a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic"}],CoinManager:[function(t,e,o){"use strict";cc._RF.push(e,"9211357HjhKqavyVFqZ4zof","CoinManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Item/Coin"),s=t("../Dungeon"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.coinPool=new cc.NodePool,cc.director.on("destorycoin",function(e){t.destroyCoin(e.detail.coinNode)})},e.prototype.getValueCoin=function(t,e,o){for(var i=n.default.FACE_VALUE,a=t%i,s=0;s<a;s++)this.getCoin(1,e,o);var r=(t-a)/i;for(s=0;s<r;s++)this.getCoin(i,e,o)},e.prototype.getCoin=function(t,e,o){var i,a=o.getComponent(s.default);a&&(i=a.player);var r=null;this.coinPool.size()>0&&(r=this.coinPool.get()),r&&!r.active||(r=cc.instantiate(this.coin)),r.parent=o,r.position=e;var c=r.getComponent(n.default);c.player=i,c.changeValue(t),c.node.zIndex=4e3,r.active=!0},e.prototype.destroyCoin=function(t){t.active=!1;t.getComponent(n.default);this.coinPool&&this.coinPool.put(t)},e.prototype.start=function(){},a([l(cc.Prefab)],e.prototype,"coin",void 0),e=a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Dungeon":"Dungeon","../Item/Coin":"Coin"}],Coin:[function(t,e,o){"use strict";cc._RF.push(e,"586a7ZPuVJNUIhnMRyd39J4","Coin");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../EventConstant"),r=t("../Utils/Random"),c=t("../Utils/AudioPlayer"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=0,e.valueRes=["gem01","gem02","gem03","gem04"],e.isReady=!1,e.checkTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.onEnable=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.rigidBody=this.getComponent(cc.RigidBody);var e=r.default.rand()*(n.default.getHalfChance()?1:-1)*800,o=r.default.rand()*(n.default.getHalfChance()?1:-1)*800;this.rigidBody.linearVelocity=cc.v2(e,o),this.rigidBody.linearDamping=30,this.isReady=!1,this.scheduleOnce(function(){t.isReady=!0},.5)},e.prototype.changeValue=function(t){this.value=t;var e=1;this.value==o.FACE_VALUE?(e=3,this.node.scale=1.2):(e=1,this.node.scale=1),this.node.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=n.default.spriteFrames[this.valueRes[e]]},e.prototype.start=function(){},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.getNearPlayerDistance=function(t){return n.default.getDistance(this.node.position,t.position.clone().addSelf(cc.v2(0,32)))},e.prototype.update=function(t){if(this.isCheckTimeDelay(t)&&this.player&&this.getNearPlayerDistance(this.player.node)<400&&this.node.active&&this.isReady){var e=this.player.node.position.clone();e.y+=10;var o=e.sub(this.node.position);o.equals(cc.Vec2.ZERO)||(o=(o=o.normalizeSelf()).mul(800),this.rigidBody.linearVelocity=o,this.rigidBody.linearDamping=1)}this.player&&this.getNearPlayerDistance(this.player.node)<64&&this.node.active&&this.isReady&&(this.isReady=!1,cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:c.default.COIN}}),cc.director.emit(s.EventConstant.HUD_ADD_COIN,{detail:{count:this.value}}),cc.director.emit("destorycoin",{detail:{coinNode:this.node}}))},e.FACE_VALUE=10,e=o=a([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../EventConstant":"EventConstant","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/Random":"Random"}],CommonData:[function(t,e,o){"use strict";cc._RF.push(e,"b86e6PjawlOxqFoYPp0y0Jk","CommonData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.maxHealth=0,this.damageMin=0,this.damageMax=0,this.criticalStrikeRate=0,this.defence=0,this.lifeDrain=0,this.lifeRecovery=0,this.moveSpeed=0,this.attackSpeed=0,this.dodge=0,this.remoteSpeed=0,this.remoteDamage=0,this.remoteCritRate=0,this.realDamage=0,this.realRate=0,this.iceDamage=0,this.iceDefence=0,this.iceRate=0,this.fireDamage=0,this.fireDefence=0,this.fireRate=0,this.lighteningDamage=0,this.lighteningDefence=0,this.lighteningRate=0,this.toxicDamage=0,this.toxicDefence=0,this.toxicRate=0,this.curseDamage=0,this.curseDefence=0,this.curseRate=0}return t.prototype.valueCopy=function(t){this.maxHealth=t.maxHealth?t.maxHealth:0,this.damageMin=t.damageMin?t.damageMin:0,this.damageMax=t.damageMax?t.damageMax:0,this.remoteDamage=t.remoteDamage?t.remoteDamage:0,this.criticalStrikeRate=t.criticalStrikeRate?t.criticalStrikeRate:0,this.remoteCritRate=t.remoteCritRate?t.remoteCritRate:0,this.defence=t.defence?t.defence:0,this.lifeDrain=t.lifeDrain?t.lifeDrain:0,this.lifeRecovery=t.lifeRecovery?t.lifeRecovery:0,this.moveSpeed=t.moveSpeed?t.moveSpeed:0,this.attackSpeed=t.attackSpeed?t.attackSpeed:0,this.remoteSpeed=t.remoteSpeed?t.remoteSpeed:0,this.dodge=t.dodge?t.dodge:0,this.realDamage=t.realDamage?t.realDamage:0,this.realRate=t.realRate?t.realRate:0,this.iceDamage=t.iceDamage?t.iceDamage:0,this.iceDefence=t.iceDefence?t.iceDefence:0,this.iceRate=t.iceRate?t.iceRate:0,this.fireDamage=t.fireDamage?t.fireDamage:0,this.fireDefence=t.fireDefence?t.fireDefence:0,this.fireRate=t.fireRate?t.fireRate:0,this.lighteningDamage=t.lighteningDamage?t.lighteningDamage:0,this.lighteningDefence=t.lighteningDefence?t.lighteningDefence:0,this.lighteningRate=t.lighteningRate?t.lighteningRate:0,this.toxicDamage=t.toxicDamage?t.toxicDamage:0,this.toxicDefence=t.toxicDefence?t.toxicDefence:0,this.toxicRate=t.toxicRate?t.toxicRate:0,this.curseDamage=t.curseDamage?t.curseDamage:0,this.curseDefence=t.curseDefence?t.curseDefence:0,this.curseRate=t.curseRate?t.curseRate:0},t.prototype.clone=function(){var e=new t;return e.maxHealth=this.maxHealth,e.damageMin=this.damageMin,e.damageMax=this.damageMax,e.criticalStrikeRate=this.criticalStrikeRate,e.defence=this.defence,e.lifeDrain=this.lifeDrain,e.lifeRecovery=this.lifeRecovery,e.moveSpeed=this.moveSpeed,e.attackSpeed=this.attackSpeed,e.remoteSpeed=this.remoteSpeed,e.dodge=this.dodge,e.realDamage=this.realDamage,e.realRate=this.realRate,e.iceDamage=this.iceDamage,e.iceDefence=this.iceDefence,e.iceRate=this.iceRate,e.fireDamage=this.fireDamage,e.fireDefence=this.fireDefence,e.fireRate=this.fireRate,e.lighteningDamage=this.lighteningDamage,e.lighteningDefence=this.lighteningDefence,e.lighteningRate=this.lighteningRate,e.toxicDamage=this.toxicDamage,e.toxicDefence=this.toxicDefence,e.toxicRate=this.toxicRate,e.curseDamage=this.curseDamage,e.curseDefence=this.curseDefence,e.curseRate=this.curseRate,e.remoteDamage=this.remoteDamage,e.remoteCritRate=this.remoteCritRate,e},t}();o.default=i,cc._RF.pop()},{}],Controller:[function(t,e,o){"use strict";cc._RF.push(e,"12f66EVamVPmoXVKYdoGHk5","Controller");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=t("./EventConstant"),l=t("./Logic"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackAction=null,e.attackActionTouched=!1,e.shootAction=null,e.shootActionTouched=!1,e.interactAction=null,e.interactActionTouched=!1,e.skillAction=null,e.coolDown=null,e.skillActionTouched=!1,e.graphics=null,e.timeDelay=0,e.interactTimeDelay=0,e.skillTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.graphics=this.getComponent(cc.Graphics),this.attackAction.on(cc.Node.EventType.TOUCH_START,function(e){t.attackActionTouched=!0},this),this.attackAction.on(cc.Node.EventType.TOUCH_END,function(e){t.attackActionTouched=!1},this),this.attackAction.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.attackActionTouched=!1},this),this.shootAction.on(cc.Node.EventType.TOUCH_START,function(e){t.shootActionTouched=!0},this),this.shootAction.on(cc.Node.EventType.TOUCH_END,function(e){t.shootActionTouched=!1},this),this.shootAction.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.shootActionTouched=!1},this),this.interactAction.on(cc.Node.EventType.TOUCH_START,function(e){t.interactActionTouched=!0},this),this.interactAction.on(cc.Node.EventType.TOUCH_END,function(e){t.interactActionTouched=!1},this),this.interactAction.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.interactActionTouched=!1},this),this.skillAction.on(cc.Node.EventType.TOUCH_START,function(e){t.skillActionTouched=!0},this),this.skillAction.on(cc.Node.EventType.TOUCH_END,function(e){t.skillActionTouched=!1},this),this.skillAction.on(cc.Node.EventType.TOUCH_CANCEL,function(e){t.skillActionTouched=!1},this),cc.director.on(c.EventConstant.HUD_DARK_CONTROLLER,function(e){t.changeRes(e.detail.index,!1)}),cc.director.on(c.EventConstant.HUD_DARK_CONTROLLER,function(e){t.changeRes(e.detail.index,!0)}),cc.director.on(c.EventConstant.HUD_CONTROLLER_COOLDOWN,function(e){t.drawSkillCoolDown(e.detail.cooldown,e.detail.talentType)})},e.prototype.changeRes=function(t,e){var o="";switch(t){case 0:o=e?"uimeleelight":"uimelee";break;case 1:o=e?"uiremotelight":"uiremote";break;case 2:o=e?"uiswitchlight":"uiswitch"}this.attackAction.getComponent(cc.Button).normalSprite=l.default.spriteFrames[o]},e.prototype.drawSkillCoolDown=function(t,e){var o=this;if(!(t<=0)&&this.coolDown){var i=this.coolDown.getChildByName("talentdash01"),a=this.coolDown.getChildByName("talentshield01"),n=this.coolDown.getChildByName("talentmagic01"),s=this.coolDown.convertToWorldSpaceAR(cc.Vec2.ZERO);s=this.node.convertToNodeSpaceAR(s);var r=64,c=64/t*.1,l=function(){r-=c,o.graphics&&o.graphics.clear(),o.drawRect(r,s),1==e?(i.opacity=255,a.opacity=0,n.opacity=0):2==e?(i.opacity=0,a.opacity=255,n.opacity=0):3==e&&(i.opacity=0,a.opacity=0,n.opacity=255),r<0&&(i.opacity=0,a.opacity=0,n.opacity=0,o.graphics&&o.graphics.clear(),o.unschedule(l))};this.schedule(l,.1,cc.macro.REPEAT_FOREVER)}},e.prototype.drawRect=function(t,e){this.graphics.fillColor=cc.color(0,255,0,200),this.graphics.rect(e.x-32,e.y-32,64,t),this.graphics.fill()},e.prototype.drawArc=function(t,e){if(this.graphics&&(this.graphics.clear(),!(t<0))){var o=2*t*Math.PI/360;this.graphics.arc(e.x,e.y,48,2*Math.PI,2*Math.PI-o),this.graphics.stroke()}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isInteractTimeDelay=function(t){return this.interactTimeDelay+=t,this.interactTimeDelay>.1&&(this.interactTimeDelay=0,this.interactActionTouched=!1,!0)},e.prototype.isSkillTimeDelay=function(t){return this.skillTimeDelay+=t,this.skillTimeDelay>.1&&(this.skillTimeDelay=0,!0)},e.prototype.update=function(t){this.isInteractTimeDelay(t),this.isSkillTimeDelay(t),this.isTimeDelay(t)&&(this.attackActionTouched&&cc.director.emit(c.EventConstant.PLAYER_ATTACK),this.shootActionTouched&&cc.director.emit(c.EventConstant.PLAYER_REMOTEATTACK),this.interactActionTouched&&cc.director.emit(c.EventConstant.PLAYER_TRIGGER),this.skillActionTouched&&cc.director.emit(c.EventConstant.PLAYER_SKILL))},a([r(cc.Node)],e.prototype,"attackAction",void 0),a([r(cc.Node)],e.prototype,"shootAction",void 0),a([r(cc.Node)],e.prototype,"interactAction",void 0),a([r(cc.Node)],e.prototype,"skillAction",void 0),a([r(cc.Node)],e.prototype,"coolDown",void 0),e=a([s],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic"}],CutScene:[function(t,e,o){"use strict";cc._RF.push(e,"cb0c7YcdndBfpVkO+dBgo79","CutScene");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSkip=!1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.skipNode=this.node.getChildByName("skip"),this.cut001=this.node.getChildByName("sprite").getChildByName("cut001"),this.cut002=this.node.getChildByName("sprite").getChildByName("cut002"),this.cut003=this.node.getChildByName("sprite").getChildByName("cut003"),this.cut004=this.node.getChildByName("sprite").getChildByName("cut004"),this.cut006=this.node.getChildByName("sprite").getChildByName("cut006"),this.cut007=this.node.getChildByName("sprite").getChildByName("cut007"),this.cut008=this.node.getChildByName("sprite").getChildByName("cut008"),this.cut009=this.node.getChildByName("sprite").getChildByName("cut009"),this.cutList=new Array,this.cutList.push(this.cut001),this.cutList.push(this.cut002),this.cutList.push(this.cut003),this.cutList.push(this.cut004),this.cutList.push(this.cut006),this.cutList.push(this.cut007),this.cutList.push(this.cut008),this.cutList.push(this.cut009),this.skipNode.opacity=0,this.node.opacity=0,this.hideAllCuts(),this.node.on(cc.Node.EventType.TOUCH_START,function(e){255==t.skipNode.opacity&&(t.isSkip=!0),t.skipNode.opacity=255},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){},this)},e.prototype.playShow=function(){var t=this;this.node.opacity=255,this.getComponent(cc.Animation).play(),this.scheduleOnce(function(){t.isSkip=!0},12)},e.prototype.unregisterClick=function(){this.node.off(cc.Node.EventType.TOUCH_START),this.node.off(cc.Node.EventType.TOUCH_CANCEL),this.node.off(cc.Node.EventType.TOUCH_END)},e.prototype.hideAllCuts=function(){for(var t=0,e=this.cutList;t<e.length;t++){e[t].opacity=0}},e.prototype.start=function(){},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],DamageData:[function(t,e,o){"use strict";cc._RF.push(e,"140ebm8pJ5CBb4RE4tI9c22","DamageData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t){this.realDamage=0,this.physicalDamage=0,this.iceDamage=0,this.fireDamage=0,this.lighteningDamage=0,this.toxicDamage=0,this.curseDamage=0,this.realRate=0,this.iceRate=0,this.fireRate=0,this.lighteningRate=0,this.toxicRate=0,this.curseRate=0,this.stoneRate=0,this.isCriticalStrike=!1,this.realDamage=t||0}return t.prototype.valueCopy=function(t){this.realDamage=t.realDamage?t.realDamage:0,this.physicalDamage=t.physicalDamage?t.physicalDamage:0,this.iceDamage=t.iceDamage?t.iceDamage:0,this.fireDamage=t.fireDamage?t.fireDamage:0,this.lighteningDamage=t.lighteningDamage?t.lighteningDamage:0,this.toxicDamage=t.toxicDamage?t.toxicDamage:0,this.curseDamage=t.curseDamage?t.curseDamage:0,this.realRate=t.realRate?t.realRate:0,this.iceRate=t.iceRate?t.iceRate:0,this.fireRate=t.fireRate?t.fireRate:0,this.lighteningRate=t.lighteningRate?t.lighteningRate:0,this.toxicRate=t.toxicRate?t.toxicRate:0,this.curseRate=t.curseRate?t.curseRate:0,this.stoneRate=t.stoneRate?t.stoneRate:0,this.isCriticalStrike=!!t.isCriticalStrike},t.prototype.clone=function(){var e=new t;return e.realDamage=this.realDamage,e.physicalDamage=this.physicalDamage,e.iceDamage=this.iceDamage,e.fireDamage=this.fireDamage,e.lighteningDamage=this.lighteningDamage,e.toxicDamage=this.toxicDamage,e.curseDamage=this.curseDamage,e.realRate=this.realRate,e.iceRate=this.iceRate,e.fireRate=this.fireRate,e.lighteningRate=this.lighteningRate,e.toxicRate=this.toxicRate,e.curseRate=this.curseRate,e.stoneRate=this.stoneRate,e.isCriticalStrike=this.isCriticalStrike,e},t.prototype.getTotalDamage=function(){var t=this.physicalDamage+this.iceDamage+this.fireDamage+this.lighteningDamage+this.toxicDamage+this.curseDamage+this.realDamage;return NaN==t&&console.log(t),t},t}();o.default=i,cc._RF.pop()},{}],DashShadow:[function(t,e,o){"use strict";cc._RF.push(e,"909e64n9VxBGoAX7rWiFEbf","DashShadow");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../Dungeon"),r=t("../Talent/TalentShield"),c=t("../Talent/Talent"),l=t("../Shooter"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hv=cc.v2(1,0),e.shooter=null,e}return i(e,t),e.prototype.onLoad=function(){this.rigidBody=this.getComponent(cc.RigidBody),this.motionStreak=this.getComponent(cc.MotionStreak),this.sprite=this.node.getChildByName("sprite")},e.prototype.init=function(t){this.talentDash=t,this.shooter.dungeon=this.talentDash.player.node.parent.getComponent(s.default)},e.prototype.changeDashPerformance=function(t){this.motionStreak.color=cc.Color.BLACK;for(var e=0,o=t;e<o.length;e++)o[e]},e.prototype.onEnable=function(){},e.prototype.start=function(){},e.prototype.getPlayerPosition=function(){return this.talentDash.player.node.position.clone().addSelf(cc.v2(8,8))},e.prototype.getNearPlayerDistance=function(t){return n.default.getDistance(this.node.position,this.getPlayerPosition())},e.prototype.show=function(){var t=this;this.node.active=!0,this.node.parent=this.talentDash.player.node.parent;var e=this.talentDash.player.isFaceRight;this.sprite.scaleX=e?1:-1,this.node.setPosition(this.getPlayerPosition());var o=1200;this.rigidBody.linearDamping=1,this.talentDash.player.talentShield.hashTalent(r.default.DASH_14)&&(o=2e3,this.rigidBody.linearDamping=1),this.rigidBody.linearVelocity=this.hv.mul(o),this.node.zIndex=4e3,this.fire(this.shooter),this.scheduleOnce(function(){t.hide()},.45)},e.prototype.hide=function(){this.talentDash.player.node.setPosition(s.default.fixOuterMap(this.node.position.clone())),this.node.active=!1,this.rigidBody.linearVelocity=cc.Vec2.ZERO},e.prototype.onBeginContact=function(t,e,o){this.talentDash&&this.talentDash.hashTalent(c.default.DASH_02)&&this.talentDash.attacking(o,this.node)},e.prototype.fire=function(t){t.data.bulletLineExNum=5,t.data.bulletLineInterval=.05,this.talentDash.hashTalent(c.default.DASH_11)&&(t.data.bulletLineExNum=10,t.data.bulletLineInterval=.03);var e=!1;this.talentDash.hashTalent(c.default.DASH_09)?(e=!0,t.data.bulletType="bullet025"):this.talentDash.hashTalent(c.default.DASH_10)&&(e=!0,t.data.bulletType="bullet026"),e&&t.fireBullet(0,cc.v2(0,0))},e.prototype.setHv=function(t){t.equals(cc.Vec2.ZERO)?this.hv=cc.v2(1,0):this.hv=t},a([p(l.default)],e.prototype,"shooter",void 0),e=a([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic","../Shooter":"Shooter","../Talent/Talent":"Talent","../Talent/TalentShield":"TalentShield"}],DecorateRoom:[function(t,e,o){"use strict";cc._RF.push(e,"7ff045au5pJh7yakGo9+aoy","DecorateRoom");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.floor=null,e.walltop=null,e.wallbottom=null,e.wallleft=null,e.wallright=null,e.width=15,e.height=15,e}return i(e,t),e.prototype.start=function(){},a([r(cc.Node)],e.prototype,"floor",void 0),a([r(cc.Node)],e.prototype,"walltop",void 0),a([r(cc.Node)],e.prototype,"wallbottom",void 0),a([r(cc.Node)],e.prototype,"wallleft",void 0),a([r(cc.Node)],e.prototype,"wallright",void 0),e=a([s],e)}(cc.Component);o.default=c,cc._RF.pop()},{}],Decorate:[function(t,e,o){"use strict";cc._RF.push(e,"7b8abAQqgxLbKCSpiTgLOQk","Decorate");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Data/BoxData"),r=t("../Logic"),c=t("./Building"),l=t("../EventConstant"),h=t("../Utils/Random"),u=t("../Utils/AudioPlayer"),p=t("../Item/Item"),d=cc._decorator,f=d.ccclass,m=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isBreaking=!1,e.decorateType=0,e.data=new s.default,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){switch(r.default.chapterName){case r.default.CHAPTER00:this.changeRes("decorate000"+this.decorateType);break;case r.default.CHAPTER01:this.changeRes("decorate010"+this.decorateType);break;case r.default.CHAPTER02:this.changeRes("decorate020"+this.decorateType);break;case r.default.CHAPTER03:this.changeRes("decorate030"+this.decorateType);break;case r.default.CHAPTER04:this.changeRes("decorate040"+this.decorateType)}},e.prototype.changeRes=function(t){var e=this.node.getChildByName("sprite").getComponent(cc.Sprite),o=r.default.spriteFrames[t];e.node.opacity=255,e.spriteFrame=o},e.prototype.setPos=function(t){this.data.pos=t,this.node.position=n.default.getPosInMap(this.data.pos),this.node.zIndex=3e3+100*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.BreakingFinish=function(){this.reset()},e.prototype.breakBox=function(){if(!this.isBreaking){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play(),this.isBreaking=!0,cc.director.emit(l.EventConstant.PLAY_AUDIO,{detail:{name:u.default.MONSTER_HIT}});var t=h.default.rand();t>.7&&t<.8?cc.director.emit(l.EventConstant.DUNGEON_ADD_COIN,{detail:{pos:this.node.position,count:r.default.getRandomNum(1,3)}}):t>=.8&&t<.825?cc.director.emit(l.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:p.default.HEART}}):t>=.825&&t<.85&&cc.director.emit(l.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:p.default.AMMO}})}},e.prototype.reset=function(){this.node.position=n.default.getPosInMap(cc.v2(-10,-10)),this.isBreaking=!1},e.prototype.update=function(t){if(this.timeDelay+=t,this.timeDelay>.2){this.data.pos=n.default.getIndexInMap(this.node.position),this.data.position=this.node.position,this.data.onelife=!0;var e=r.default.mapManager.getCurrentMapBoxes();if(e)for(var o=0,i=e;o<i.length;o++){var a=i[o];a.defaultPos.equals(this.data.defaultPos)&&(a.pos=this.data.pos,a.position=this.data.position)}this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-this.data.pos.y)+1}},e.BOX=0,e.PLANT=1,e.BOXBREAKABLE=2,e=a([f],e)}(c.default));o.default=m,cc._RF.pop()},{"../Data/BoxData":"BoxData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Item/Item":"Item","../Logic":"Logic","../Utils/AudioPlayer":"AudioPlayer","../Utils/Random":"Random","./Building":"Building"}],DecorationFloor:[function(t,e,o){"use strict";cc._RF.push(e,"c0e43WuUrFGu7HrB9h8NrBh","DecorationFloor");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Logic"),r=t("./Building"),c=cc._decorator,l=c.ccclass,h=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.changeRes=function(t){var e=this.getComponent(cc.Sprite);e.spriteFrame=s.default.spriteFrames[t],this.node.width=e.spriteFrame.getRect().width,this.node.height=e.spriteFrame.getRect().height},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t)},e=a([l],e)}(r.default));o.default=h,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic","./Building":"Building"}],Door:[function(t,e,o){"use strict";cc._RF.push(e,"f14f52tIg1Ivb0Rnl80O8tL","Door");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../EventConstant"),r=t("../Logic"),c=t("./Building"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.isDoor=!0,e.dir=0,e.wall=null,e.bg=null,e.sprite=null,e}return i(e,t),e.prototype.onLoad=function(){this.bg=this.node.getChildByName("bg"),this.bg.zIndex=1e3,this.sprite=this.node.getChildByName("sprite"),this.sprite.zIndex=2e3,this.anim=this.getComponent(cc.Animation)},e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.setOpen=function(t){if(!this.isDoor)return this.wall.zIndex=3e3,this.wall.getComponent(cc.PhysicsBoxCollider).sensor=!1,void this.wall.getComponent(cc.PhysicsBoxCollider).apply();this.wall.zIndex=500,this.wall.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.wall.getComponent(cc.PhysicsBoxCollider).apply(),t?this.openGate():this.closeGate()},e.prototype.openGate=function(){this.isOpen||(this.isOpen=!0,this.anim||(this.anim=this.getComponent(cc.Animation)),this.getComponent("cc.PhysicsBoxCollider").enabled=!1,this.anim.play("DoorOpen"))},e.prototype.closeGate=function(){this.isOpen&&(this.isOpen=!1,this.anim||(this.anim=this.getComponent(cc.Animation)),this.getComponent("cc.PhysicsBoxCollider").enabled=!0,this.anim.play("DoorClose"))},e.prototype.onCollisionEnter=function(t,e){t.node.getComponent(n.default)&&this.isOpen&&(r.default.saveData(),cc.director.emit(s.EventConstant.LOADINGROOM,{detail:{dir:this.dir}}))},e=a([h],e)}(c.default));o.default=u,cc._RF.pop()},{"../EventConstant":"EventConstant","../Logic":"Logic","../Player":"Player","./Building":"Building"}],Dragon:[function(t,e,o){"use strict";cc._RF.push(e,"a38f40rLRxEErH92pL9pLeC","Dragon");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Data/DamageData"),r=t("../Shooter"),c=t("../Dungeon"),l=t("../Player"),h=t("../Manager/StatusManager"),u=t("../Utils/Skill"),p=t("../Utils/Random"),d=t("../EventConstant"),f=t("../Utils/AudioPlayer"),m=t("../Data/FromData"),g=t("../Achievement"),y=cc._decorator,v=y.ccclass,D=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.fireSkill=new u.default,e.rainSkill=new u.default,e.isRainReady=!1,e.actionCount=0,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(r.default),this.shooter01.from.valueCopy(m.default.getClone(this.actorName(),"dragonhead")),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default),this.physicBox=this.getComponent(cc.PhysicsBoxCollider)},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow||this.rainSkill.IsExcuting)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:f.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(g.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.fireFire=function(){var t=this;this.fireSkill.next(function(){t.fireSkill.IsExcuting=!0,t.anim.play("DragonFire"),t.scheduleOnce(function(){t.shooter01.setHv(cc.v2(0,-1)),t.shooter01.data.bulletLineInterval=.5,t.fireShooter(t.shooter01,"bullet200",2,5)},1.1),t.scheduleOnce(function(){t.fireSkill.IsExcuting=!1,t.anim.play("DragonIdle")},2)},5,!0)},e.prototype.fireRain=function(){var t=this;this.isRainReady&&this.rainSkill.next(function(){t.rainSkill.IsExcuting=!0,t.physicBox.sensor=!0,t.physicBox.apply(),t.rigidbody.linearVelocity=cc.v2(0,0),t.anim.stop(),t.anim.play("DragonFlyHigh"),t.scheduleOnce(function(){t.anim.play("DragonFlyLow"),t.physicBox.sensor=!1,t.physicBox.apply()},13),t.scheduleOnce(function(){t.rainSkill.IsExcuting=!1},15),t.schedule(function(){t.dungeon.addFallStone(t.dungeon.player.node.position,!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v2(p.default.getRandomNum(0,c.default.WIDTH_SIZE-1),p.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v2(p.default.getRandomNum(0,c.default.WIDTH_SIZE-1),p.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0),t.dungeon.addFallStone(c.default.getPosInMap(cc.v2(p.default.getRandomNum(0,c.default.WIDTH_SIZE-1),p.default.getRandomNum(0,c.default.HEIGHT_SIZE-1))),!0,!0)},.5,20,2)},20)},e.prototype.bossAction=function(){if(!this.isDied&&this.isShow&&this.dungeon){if(this.changeZIndex(),this.fireRain(),this.rainSkill.IsExcuting||this.fireFire(),!this.rainSkill.IsExcuting){this.actionCount++;var t=cc.v2(1,0);this.actionCount>10&&(t=cc.v2(-1,0)),this.actionCount>20&&(this.actionCount=0),t.equals(cc.Vec2.ZERO)||(t=t.normalizeSelf(),this.move(t,800))}}else this.actionCount=0},e.prototype.changeZIndex=function(){this.node.zIndex=4e3+10*(c.default.HEIGHT_SIZE-this.pos.y-1)+2},e.prototype.move=function(t,e){if(!this.isDied){t.equals(cc.Vec2.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=cc.v2(o,i);a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.changeZIndex()}},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.setHv(cc.v2(0,-1)),t.fireBullet(a,cc.Vec2.ZERO)},e.prototype.showBoss=function(){var t=this;this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied),this.scheduleOnce(function(){t.isRainReady=!0},10)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(l.default);if(o&&!this.isDied&&!this.physicBox.sensor){var i=new s.default;i.physicalDamage=3,o.takeDamage(i,m.default.getClone(this.actorName(),"dragonhead"))}},e.prototype.actorName=function(){return"\u672b\u65e5\u9ed1\u9f99"},e=a([v],e)}(n.default));o.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Manager/StatusManager":"StatusManager","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Random":"Random","../Utils/Skill":"Skill","./Boss":"Boss"}],DryadGrass:[function(t,e,o){"use strict";cc._RF.push(e,"d7d90DMrjlILYsaGuEm//pn","DryadGrass");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../Data/DamageData"),r=t("../Base/Actor"),c=t("../Manager/StatusManager"),l=t("../Data/FromData"),h=cc._decorator,u=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUp=!1,e.isAuto=!0,e.isUping=!1,e}return i(e,t),e.prototype.onLoad=function(){this.isUp=!1},e.prototype.takeDamage=function(){return!1},e.prototype.fall=function(){this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isUping=!0},e.prototype.TwineUp=function(){var t=this;this.isUp=!0,this.scheduleOnce(function(){t.isUp=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},6)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t,e){!t.getComponent(n.default)||this.isAuto||this.isUping||this.fall()},e.prototype.onCollisionStay=function(t,e){var o=t.getComponent(n.default);if(o&&this.isUp&&this.isValid){this.isUp=!1;var i=l.default.getClone(this.actorName(),"dryadtwine03");o.takeDamage(new s.default(2),i),o.addStatus(c.default.TWINE,i)}},e.prototype.actorName=function(){return"\u6811\u6839\u7f20\u7ed5"},e=a([u],e)}(r.default));o.default=p,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Player":"Player"}],Dryad:[function(t,e,o){"use strict";cc._RF.push(e,"d1a62Oo+gRDI5+v2dxAMRw+","Dryad");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Shooter"),r=t("../Dungeon"),c=t("../Logic"),l=t("../Manager/StatusManager"),h=t("../Utils/Skill"),u=t("./BossAttackCollider"),p=t("../EventConstant"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=t("../Achievement"),g=cc._decorator,y=g.ccclass,v=g.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hand01=null,e.hand02=null,e.timeDelay=0,e.isMoving=!1,e.flower01=null,e.flower02=null,e.twoFlowerSkill=new h.default,e.twineGrassSkill=new h.default,e.meleeSkill=new h.default,e.stoneSkill=new h.default,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(s.default),this.shooter02=this.node.getChildByName("Shooter02").getComponent(s.default),this.shooter03=this.node.getChildByName("Shooter03").getComponent(s.default);var t=f.default.getClone(this.actorName(),"dryadflower04");this.shooter01.from.valueCopy(t),this.shooter02.from.valueCopy(t),this.shooter03.from.valueCopy(t),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(l.default),this.hand01.from.valueCopy(t),this.hand02.from.valueCopy(t)},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.playHit(this.node.getChildByName("sprite")),cc.director.emit(p.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(m.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){!this.isDied&&this.isShow&&this.dungeon&&(this.changeZIndex(),this.twoFlowerSkill.IsExcuting||this.stoneSkill.IsExcuting||this.attack(),this.meleeSkill.IsExcuting||this.stoneSkill.IsExcuting||this.twoFlowers(),this.meleeSkill.IsExcuting||this.twoFlowerSkill.IsExcuting||this.fireStone(),this.twineGrass())},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){cc.director.emit(p.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),t.meleeSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation));c.default.getHalfChance()?(t.anim.play("DryadAttack01"),t.hand01.showCollider(2,1)):(t.anim.play("DryadAttack02"),t.hand02.showCollider(2,1)),t.scheduleOnce(function(){t.anim.play("DryadIdle"),t.meleeSkill.IsExcuting=!1},1)},2,!0)},e.prototype.twineGrass=function(){var t=this;this.twineGrassSkill.next(function(){t.schedule(function(){t.dungeon.addTwineGrass(r.default.getPosInMap(t.dungeon.player.pos.clone()),!0)},1,2)},8,!0)},e.prototype.twoFlowers=function(){var t=this;this.twoFlowerSkill.next(function(){t.twoFlowerSkill.IsExcuting=!0,t.shooter02.setHv(cc.v2(0,-1)),t.shooter03.setHv(cc.v2(0,-1)),t.anim.play("DryadOpen"),t.flower01.getComponent(cc.Animation).play(),t.flower02.getComponent(cc.Animation).play(),t.scheduleOnce(function(){t.shooter02.data.bulletLineInterval=.5,t.shooter03.data.bulletLineInterval=.5,t.fireShooter(t.shooter02,"bullet021",99,2),t.fireShooter(t.shooter03,"bullet021",99,2)},2),t.scheduleOnce(function(){t.anim.play("DryadIdle"),t.twoFlowerSkill.IsExcuting=!1},4)},6,!0)},e.prototype.fireStone=function(){var t=this;this.stoneSkill.next(function(){t.stoneSkill.IsExcuting=!0,t.anim.play("DryadStone"),t.scheduleOnce(function(){var e=t.node.position.clone().add(t.shooter01.node.position),o=t.dungeon.player.getCenterPosition().sub(e);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),t.shooter01.setHv(o),t.fireShooter(t.shooter01,"bullet022",0,0))},.55),t.scheduleOnce(function(){t.stoneSkill.IsExcuting=!1,t.anim.play("DryadIdle")},1)},4,!0)},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a,cc.Vec2.ZERO)},e.prototype.showBoss=function(){this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied,this.rigidbody.linearVelocity=cc.Vec2.ZERO},e.prototype.actorName=function(){return"\u8fdc\u53e4\u4e4b\u6811"},a([v(u.default)],e.prototype,"hand01",void 0),a([v(u.default)],e.prototype,"hand02",void 0),a([v(cc.Node)],e.prototype,"flower01",void 0),a([v(cc.Node)],e.prototype,"flower02",void 0),e=a([y],e)}(n.default);o.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss","./BossAttackCollider":"BossAttackCollider"}],DungeonStyleData:[function(t,e,o){"use strict";cc._RF.push(e,"6e0bc4Ume5FZZHLhQzz4NXv","DungeonStyleData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(t,e,o,i,a,n,s){this.background=t,this.topwall=e,this.doorframe=a,this.sidewall=o,this.door=i,this.bg02color=n,this.d2=s}}();o.default=i,cc._RF.pop()},{}],DungeonStyleManager:[function(t,e,o){"use strict";cc._RF.push(e,"96118QtbixO743MdRQKBctE","DungeonStyleManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../Building/Door"),r=t("../Dungeon"),c=t("../Data/DungeonStyleData"),l=t("../Rect/RectDungeon"),h=t("../Building/ExitDoor"),u=t("../UI/ParallaxBackground"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background01=null,e.wallTopDecoration=null,e.wallBottomDecoration=null,e.wallLeftDecoration=null,e.doorDecoration=null,e.exitdoorPrefab=null,e.parallaxBackground=null,e.exitdoor=null,e.doorRes=null,e.doors=new Array,e.walltops=new Array,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.changeTopWalls=function(t){for(var e=0,o=this.walltops;e<o.length;e++){o[e].opacity=t?255:0}this.doors[0].opacity=t?255:0},e.prototype.runBackgroundAnim=function(t){if(this.background01){var e=n.default.spriteFrames[t],o=n.default.spriteFrames[t+"1"];if(o||(o=n.default.spriteFrames[t]),e){this.background01.stopAllActions();var i=this.background01.getComponent(cc.Sprite),a=cc.repeatForever(cc.sequence(cc.moveBy(.4,0,0),cc.callFunc(function(){i.spriteFrame=e}),cc.moveBy(.4,0,0),cc.callFunc(function(){i.spriteFrame=o})));this.background01.runAction(a)}}},e.prototype.addDecorations=function(){switch(n.default.chapterName){case n.default.CHAPTER00:this.styleData=new c.default("pipeline","restwall","restsides","restdoor","restdoorframe","#323c39",null);break;case n.default.CHAPTER01:this.styleData=new c.default("sea","shipwall","shipsides","shipdoor","shipdoorframe","#12222e","null");break;case n.default.CHAPTER02:this.styleData=new c.default("grass","junglewall","junglesides","jungledoor","jungledoorframe","#1b300d",null);break;case n.default.CHAPTER03:this.styleData=new c.default("sandsea","pyramidwall","pyramidsides","pyramiddoor","pyramiddoorframe","#c8bc69",null);break;case n.default.CHAPTER04:this.styleData=new c.default("magmasea","dungeonwall","dungeonsides","dungeondoor","dungeondoorframe","#1f1e1e",null)}if(this.styleData){this.doors=new Array(4);for(var t=0;t<r.default.WIDTH_SIZE;t++){var e=this.getWallTop(t);this.walltops.push(e);var o=this.getWallBottom(t);if(t==Math.floor(r.default.WIDTH_SIZE/2)){this.doors[0]=cc.instantiate(this.doorDecoration),this.doors[0].parent=this.node;var i=r.default.getPosInMap(cc.v2(t,r.default.HEIGHT_SIZE));this.doors[0].setPosition(cc.v2(i.x,i.y+32)),this.doors[0].zIndex=2e3,this.doors[0].getComponent(s.default).wall=e,this.doors[0].getComponent(s.default).dir=0,this.doors[1]=cc.instantiate(this.doorDecoration),this.doors[1].parent=this.node;var a=r.default.getPosInMap(cc.v2(t,-1));this.doors[1].setPosition(cc.v2(a.x,a.y)),this.doors[1].setScale(4,2),this.doors[1].zIndex=2e3,this.doors[1].getComponent(s.default).wall=o,this.doors[1].getComponent(s.default).dir=1}this.addExitDoor(t,e)}for(var l=-1;l<r.default.HEIGHT_SIZE+4;l++){var h=this.getWallLeft(l),u=this.getWallRight(l);if(l>r.default.HEIGHT_SIZE-1&&(this.walltops.push(h),this.walltops.push(u)),l==Math.floor(r.default.HEIGHT_SIZE/2)){this.doors[2]=cc.instantiate(this.doorDecoration),this.doors[2].parent=this.node;var p=r.default.getPosInMap(cc.v2(-1,l));this.doors[2].setPosition(cc.v2(p.x,p.y)),this.doors[2].zIndex=2e3,this.doors[2].angle=90,this.doors[2].setScale(4,2),this.doors[2].getComponent(s.default).wall=h,this.doors[2].getComponent(s.default).dir=2,this.doors[3]=cc.instantiate(this.doorDecoration),this.doors[3].parent=this.node;var d=r.default.getPosInMap(cc.v2(r.default.WIDTH_SIZE,l));this.doors[3].setPosition(cc.v2(d.x,d.y)),this.doors[3].zIndex=2e3,this.doors[3].setScale(4,2),this.doors[3].angle=-90,this.doors[3].getComponent(s.default).wall=u,this.doors[3].getComponent(s.default).dir=3}}this.background01.getComponent(cc.Sprite).spriteFrame=this.styleData.background?n.default.spriteFrames[this.styleData.background]:null,this.runBackgroundAnim(this.styleData.background),this.addDecorateBg()}},e.prototype.addExitDoor=function(t,e){var o=r.default.WIDTH_SIZE-3,i=r.default.WIDTH_SIZE-2,a=n.default.mapManager.getCurrentRoomType()==l.default.START_ROOM,s=n.default.mapManager.getCurrentRoomType()==l.default.END_ROOM&&3!=n.default.level&&5!=n.default.level,c=n.default.mapManager.getCurrentRoomType()==l.default.PUZZLE_ROOM,u=n.default.mapManager.getCurrentRoomType()==l.default.BOSS_ROOM,p=n.default.mapManager.getCurrentRoomType()==l.default.TAROT_ROOM,d=n.default.mapManager.getCurrentRoomType()==l.default.FINAL_ROOM;if((a&&(o=1,i=2),t==o)&&(s||a||c||u||p||d)){var f=r.default.getPosInMap(cc.v2(o,r.default.HEIGHT_SIZE)),m=cc.instantiate(this.exitdoorPrefab);m.parent=this.node,m.setPosition(cc.v2(f.x+32,f.y+32)),m.zIndex=2e3,this.exitdoor=m.getComponent(h.default),this.exitdoor.wall1=e,this.exitdoor.hideWall(),this.walltops.push(m)}t==i&&this.exitdoor&&(this.exitdoor.wall2=e,this.exitdoor.hideWall())},e.prototype.getWallTop=function(t){var e=cc.instantiate(this.wallTopDecoration);e.parent=this.node;var o=r.default.getPosInMap(cc.v2(t,r.default.HEIGHT_SIZE));return e.setPosition(cc.v2(o.x,o.y+32)),e.zIndex=2500,e.getComponent(cc.Sprite).spriteFrame=this.styleData.topwall?n.default.spriteFrames[this.styleData.topwall]:null,e},e.prototype.getWallBottom=function(t){var e=cc.instantiate(this.wallBottomDecoration);e.parent=this.node,e.angle=90;var o=r.default.getPosInMap(cc.v2(t,-1));return e.setPosition(cc.v2(o.x,o.y)),e.zIndex=2500,e.getComponent("cc.PhysicsBoxCollider").tag=0,e.getComponent(cc.Sprite).spriteFrame=this.styleData.sidewall?n.default.spriteFrames[this.styleData.sidewall]:null,e},e.prototype.getWallLeft=function(t){var e=cc.instantiate(this.wallLeftDecoration);e.parent=this.node;var o=r.default.getPosInMap(cc.v2(-1,t));return e.setPosition(cc.v2(o.x,o.y)),e.zIndex=2500,e.getComponent(cc.Sprite).spriteFrame=this.styleData.sidewall?n.default.spriteFrames[this.styleData.sidewall]:null,e},e.prototype.getWallRight=function(t){var e=cc.instantiate(this.wallLeftDecoration);e.parent=this.node;var o=r.default.getPosInMap(cc.v2(r.default.WIDTH_SIZE,t));return e.setPosition(cc.v2(o.x,o.y)),e.zIndex=2500,e.setScale(-4,4),e.getComponent(cc.Sprite).spriteFrame=this.styleData.sidewall?n.default.spriteFrames[this.styleData.sidewall]:null,e},e.prototype.addDecorateBg=function(){var t=cc.instantiate(this.parallaxBackground);t.parent=this.node;var e=r.default.getPosInMap(cc.v2(r.default.WIDTH_SIZE/2,r.default.HEIGHT_SIZE/2));t.setPosition(e),t.zIndex=100;var o=t.getComponent(u.default);o.background.width=32*r.default.WIDTH_SIZE,o.background.height=32*(r.default.HEIGHT_SIZE+4),o.background.color=cc.Color.WHITE.fromHEX(this.styleData.bg02color),o.init()},e.prototype.setDoor=function(t,e,o){var i=this.styleData.door,a=this.styleData.doorframe;this.doors[t].getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=i?n.default.spriteFrames[i]:null,this.doors[t].getChildByName("bg").getChildByName("frame").getComponent(cc.Sprite).spriteFrame=a?n.default.spriteFrames[a]:null;var r=this.doors[t].getComponent(s.default);r&&(r.isDoor=e,r.setOpen(o))},a([f(cc.Node)],e.prototype,"background01",void 0),a([f(cc.Prefab)],e.prototype,"wallTopDecoration",void 0),a([f(cc.Prefab)],e.prototype,"wallBottomDecoration",void 0),a([f(cc.Prefab)],e.prototype,"wallLeftDecoration",void 0),a([f(cc.Prefab)],e.prototype,"doorDecoration",void 0),a([f(cc.Prefab)],e.prototype,"exitdoorPrefab",void 0),a([f(cc.Prefab)],e.prototype,"parallaxBackground",void 0),e=a([d],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../Building/Door":"Door","../Building/ExitDoor":"ExitDoor","../Data/DungeonStyleData":"DungeonStyleData","../Dungeon":"Dungeon","../Logic":"Logic","../Rect/RectDungeon":"RectDungeon","../UI/ParallaxBackground":"ParallaxBackground"}],Dungeon:[function(t,e,o){"use strict";cc._RF.push(e,"6dd52klzMJJgafrk2kw2YVi","Dungeon");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Player"),s=t("./Tile"),r=t("./Logic"),c=t("./EventConstant"),l=t("./Manager/MonsterManager"),h=(t("./Building/Portal"),t("./Building/Wall")),u=t("./Building/Trap"),p=t("./Item/Item"),d=t("./Manager/EquipmentManager"),f=t("./Manager/DungeonStyleManager"),m=t("./Rect/RectRoom"),g=t("./Rect/RectDungeon"),y=t("./Building/Chest"),v=t("./Building/ShopTable"),D=t("./Manager/CoinManager"),C=t("./Building/Box"),_=t("./Building/FootBoard"),E=t("./HealthBar"),R=t("./Building/FallStone"),S=t("./Building/Emplacement"),T=t("./Boss/SlimeVenom"),O=t("./Utils/Random"),A=t("./Boss/IceDemonThron"),b=t("./Boss/DryadGrass"),M=t("./Building/DecorationFloor"),P=t("./Building/Saw"),L=t("./Building/TileWaterPool"),I=t("./Utils/AudioPlayer"),x=t("./Building/Decorate"),N=cc._decorator,B=N.ccclass,H=N.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tile=null,e.wall=null,e.trap=null,e.fallStone=null,e.emplacement=null,e.footboard=null,e.chest=null,e.box=null,e.decorate=null,e.item=null,e.shop=null,e.shoptable=null,e.floorDecoration=null,e.playerPrefab=null,e.portalPrefab=null,e.portal=null,e.bed=null,e.campFire=null,e.tarotTable=null,e.venom=null,e.iceThron=null,e.dryadGrass=null,e.saw=null,e.waterPool=null,e.fog=null,e.bossHealthBar=null,e.map=new Array,e.wallmap=new Array,e.trapmap=new Array,e.footboards=new Array,e.floorIndexmap=new Array,e.waterlist=new Array,e.timeDelay=0,e.checkTimeDelay=0,e.player=null,e.monsterManager=null,e.equipmentManager=null,e.dungeonStyleManager=null,e.coinManager=null,e.isZoomCamera=!1,e.bosses=[],e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:I.default.PLAY_BG}}),this.anim=this.getComponent(cc.Animation),cc.director.on(c.EventConstant.PLAYER_MOVE,function(e){t.playerAction(e.detail.dir,e.detail.pos,e.detail.dt)}),cc.director.on(c.EventConstant.DUNGEON_SETEQUIPMENT,function(e){t.addEquipment(e.detail.equipmentData.img,e.detail.pos,e.detail.equipmentData)}),cc.director.on(c.EventConstant.DUNGEON_ADD_COIN,function(e){t.addCoin(e.detail.pos,e.detail.count)}),cc.director.on(c.EventConstant.DUNGEON_ADD_ITEM,function(e){t.addItem(e.detail.pos,e.detail.res)}),cc.director.on(c.EventConstant.DUNGEON_ADD_FALLSTONE,function(e){t.addFallStone(e.detail.pos,e.detail.isAuto)}),cc.director.on(c.EventConstant.DUNGEON_SHAKEONCE,function(e){t.anim&&t.anim.play("DungeonShakeOnce")}),cc.director.on(c.EventConstant.BOSS_ADDSLIME,function(e){t.addBossSlime(e.detail.slimeType,e.detail.posIndex)}),this.fog.zIndex=9e3,this.fog.scale=1.5,r.default.changeDungeonSize();var e=r.default.mapManager.getCurrentMapData().map;this.monsterManager=this.getComponent(l.default),this.equipmentManager=this.getComponent(d.default),this.coinManager=this.getComponent(D.default),this.dungeonStyleManager=this.getComponent(f.default),this.dungeonStyleManager.addDecorations(),this.player=cc.instantiate(this.playerPrefab).getComponent(n.default),this.player.node.parent=this.node,this.bosses=new Array,this.monsters=new Array,this.map=new Array,this.wallmap=new Array,this.trapmap=new Array,this.footboards=new Array,this.waterlist=new Array,this.floorIndexmap=new Array;var i=new Array,a=new Array,m=new Array;this.addItemListOnGround(),this.addEquipmentListOnGround();for(var E=0;E<o.WIDTH_SIZE;E++){this.map[E]=new Array(E),this.wallmap[E]=new Array(E),this.trapmap[E]=new Array(E);for(var R=0;R<o.HEIGHT_SIZE;R++){var T=cc.instantiate(this.tile);if(T.parent=this.node,T.position=o.getPosInMap(cc.v2(E,R)),T.zIndex=1e3+10*(o.HEIGHT_SIZE-R),this.map[E][R]=T.getComponent(s.default),this.map[E][R].isAutoShow=!1,"--"==e[E][R]&&(this.map[E][R].isAutoShow=!0,this.floorIndexmap.push(cc.v2(E,R))),this.isThe(e[E][R],"*")&&(this.map[E][R].tileType=e[E][R],this.floorIndexmap.push(cc.v2(E,R))),this.isThe(e[E][R],"#"))(b=cc.instantiate(this.wall)).parent=this.node,b.position=o.getPosInMap(cc.v2(E,R)),b.zIndex=3e3+10*(o.HEIGHT_SIZE-R),b.opacity=255,this.wallmap[E][R]=b.getComponent(h.default),this.wallmap[E][R].mapStr=e[E][R];if("T0"==e[E][R]){var A=cc.instantiate(this.trap);A.parent=this.node,A.position=o.getPosInMap(cc.v2(E,R)),A.zIndex=3e3+10*(o.HEIGHT_SIZE-R),this.trapmap[E][R]=A.getComponent(u.default)}if("~~"==e[E][R]){var b,N=cc.instantiate(this.waterPool);N.parent=this.node,N.position=o.getPosInMap(cc.v2(E,R)),N.zIndex=2e3,(b=N.getComponent(L.default)).setTiles(E,R,e),this.waterlist.push(b)}if("X0"==e[E][R]){var B=cc.instantiate(this.saw);B.parent=this.node,B.getComponent(P.default).setPos(cc.v2(E,R))}if(this.isThe(e[E][R],"E")){var H=cc.instantiate(this.emplacement);H.parent=this.node,H.position=o.getPosInMap(cc.v2(E,R)),H.zIndex=3e3+10*(o.HEIGHT_SIZE-R);var w=H.getComponent(S.default);w.setDirType(e[E][R]),w.dungeon=this}if("F0"==e[E][R]&&this.addFallStone(o.getPosInMap(cc.v2(E,R)),!1),this.isThe(e[E][R],"+"))if(this.isThe(e[E][R],"+0")){var k=cc.instantiate(this.campFire);k.parent=this.node,k.position=o.getPosInMap(cc.v2(E,R)),k.zIndex=3e3+10*(o.HEIGHT_SIZE-R)-2;var F=k.getChildByName("sprite").getChildByName("shadow");F.position=o.getPosInMap(cc.v2(E,R)),F.position=cc.v2(F.position.x,F.position.y+40),F.parent=this.node,F.zIndex=3e3}else if(this.isThe(e[E][R],"+1")){if(0==r.default.level){var j=cc.instantiate(this.bed);j.parent=this.node,j.scale=6,j.position=o.getPosInMap(cc.v2(E,R)),j.zIndex=5e3+10*(o.HEIGHT_SIZE-R)}}else if(this.isThe(e[E][R],"+2")){if(0==r.default.level){var G=cc.instantiate(this.floorDecoration);G.parent=this.node,G.position=o.getPosInMap(cc.v2(E,R)),G.zIndex=2e3+10*(o.HEIGHT_SIZE-R),G.getComponent(M.default).changeRes("exitarrow")}}else{var U=cc.instantiate(this.floorDecoration);U.parent=this.node,U.position=o.getPosInMap(cc.v2(E,R)),U.zIndex=2e3+10*(o.HEIGHT_SIZE-R);var q=U.getComponent(M.default);this.isThe(e[E][R],"++")?q.changeRes("exitarrow"):q.changeRes("dev")}if("@@"==e[E][R]){var Z=cc.instantiate(this.footboard);Z.parent=this.node,Z.position=o.getPosInMap(cc.v2(E,R)),Z.zIndex=3e3+10*(o.HEIGHT_SIZE-R),this.footboards.push(Z.getComponent(_.default))}if("V0"==e[E][R]&&this.addVenom(o.getPosInMap(cc.v2(E,R))),"Q0"==e[E][R]){var W=cc.instantiate(this.tarotTable);W.parent=this.node,W.position=o.getPosInMap(cc.v2(E,R)),W.zIndex=3e3+10*(o.HEIGHT_SIZE-R)}if("C0"==e[E][R]){var V=cc.instantiate(this.chest);V.parent=this.node;var Y=V.getComponent(y.default);Y.setPos(cc.v2(E,R)),Y.setQuality(r.default.getRandomNum(1,3),!1);var z=r.default.mapManager.getCurrentMapChests();if(z)for(var K=0,X=z;K<X.length;K++){var Q=X[K];Q.pos.equals(Y.data.pos)&&Y.setQuality(Q.quality,Q.isOpen)}else m.push(Y.data)}if(this.isThe(e[E][R],"B")){var J=cc.instantiate(this.box);J.parent=this.node;var $=J.getComponent(C.default);if($.data.defaultPos=cc.v2(E,R),$.setPos(cc.v2(E,R)),this.isThe(e[E][R],"B1")&&($.boxType=C.default.PLANT),it=r.default.mapManager.getCurrentMapBoxes())for(var tt=0,et=it;tt<et.length;tt++){(rt=et[tt]).defaultPos.equals($.data.defaultPos)&&($.setPos(rt.pos),$.node.position=rt.position.clone())}else i.push($.data)}if(this.isThe(e[E][R],"D")){var ot=cc.instantiate(this.decorate);ot.parent=this.node;var it,at=ot.getComponent(x.default);if(at.data.defaultPos=cc.v2(E,R),at.data.onelife=!0,at.setPos(cc.v2(E,R)),at.decorateType=parseInt(e[E][R][1]),it=r.default.mapManager.getCurrentMapBoxes())for(var nt=0,st=it;nt<st.length;nt++){var rt;(rt=st[nt]).defaultPos.equals(at.data.defaultPos)&&(at.setPos(rt.pos),at.node.position=rt.position.clone())}else i.push(at.data)}if(r.default.mapManager.isCurrentRoomStateClear()&&r.default.mapManager.getCurrentRoomType()!=g.default.TEST_ROOM||("A2"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.HEART),"A0"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.AMMO),"A3"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.REDCAPSULE),"A1"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.BLUECAPSULE),"A4"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.SHIELD),"A5"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.GOLDAPPLE),"Aa"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.BOTTLE_HEALING),"Ab"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.BOTTLE_MOVESPEED),"Ac"==e[E][R]&&this.addItem(o.getPosInMap(cc.v2(E,R)),p.default.BOTTLE_ATTACKSPEED)),"S0"==e[E][R]){var ct=cc.instantiate(this.shoptable);ct.parent=this.node;var lt=ct.getComponent(v.default);lt.setPos(cc.v2(E,R)),lt.data.shopType=O.default.rand()>.3?v.default.EQUIPMENT:v.default.ITEM;var ht=r.default.mapManager.getCurrentMapShopTables();if(ht){for(var ut=0,pt=ht;ut<pt.length;ut++){var dt=pt[ut];dt.pos.equals(lt.data.pos)&&(dt.equipdata&&(lt.data.equipdata=dt.equipdata.clone()),dt.itemdata&&(lt.data.itemdata=dt.itemdata.clone()),lt.data.isSaled=dt.isSaled,lt.data.shopType=dt.shopType,lt.data.price=dt.price)}lt.showItem()}else lt.showItem(),a.push(lt.data)}if("P0"==e[E][R]);if("S1"==e[E][R]){var ft=cc.instantiate(this.shop);ft.parent=this.node,ft.position=o.getPosInMap(cc.v2(E,R)),ft.zIndex=3e3+10*(o.HEIGHT_SIZE-R)+1}r.default.mapManager.isCurrentRoomStateClear()&&r.default.mapManager.getCurrentRoomType()!=g.default.TEST_ROOM||("a0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_ZEBRA,E,R),"a1"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_TERRORDRONE,E,R),"a2"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_KILLER,E,R),"a3"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_ZOOMBIE,E,R),"a4"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_ELECTRICEYE,E,R),"a5"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_GIRAFFE,E,R),"b0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_PIRATE,E,R),"b1"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_SAILOR,E,R),"b2"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_OCTOPUS,E,R),"b3"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_FISH,E,R),"b4"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_BOOMER,E,R),"b5"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_STRONGSAILOR,E,R),"c0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_SLIME,E,R),"c1"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_GOBLIN,E,R),"c2"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_GOBLIN_ARCHER,E,R),"c3"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_SNAKE,E,R),"c4"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_WEREWOLF,E,R),"c5"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_CHICKEN,E,R),"c6"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_HIPPO,E,R),"d0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_MUMMY,E,R),"d1"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_ANUBIS,E,R),"d2"==e[E][R]&&(this.addMonsterFromData(l.default.MONSTER_SCARAB,E,R),this.addMonsterFromData(l.default.MONSTER_SCARAB,E,R),this.addMonsterFromData(l.default.MONSTER_SCARAB,E,R),this.addMonsterFromData(l.default.MONSTER_SCARAB,E,R),this.addMonsterFromData(l.default.MONSTER_SCARAB,E,R)),"d3"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_CROCODILE,E,R),"d4"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_SANDSTATUE,E,R),"e0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_ELECTRICEYE,E,R),"e1"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_DEMON,E,R),"e2"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_WARLOCK,E,R),"e3"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_SPIDER,E,R),"e4"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_GARGOYLE,E,R),"f0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_CHEST,E,R),"g0"==e[E][R]&&this.addMonsterFromData(l.default.MONSTER_DUMMY,E,R),"z0"==e[E][R]&&this.addBossIceDemon(cc.v2(E,R)),"z1"==e[E][R]&&this.addBossWarMachine(cc.v2(E,R)),"z2"==e[E][R]&&this.addBossCaptain(cc.v2(E,R)),"z3"==e[E][R]&&this.addBossKraken(cc.v2(E,R)),"z4"==e[E][R]&&this.addBossSlime(0,cc.v2(E,R)),"z5"==e[E][R]&&this.addBossDryad(cc.v2(E,R)),"z6"==e[E][R]&&this.addBossRah(cc.v2(E,R)),"z7"==e[E][R]&&this.addBossSphinx(cc.v2(E,R)),"z8"==e[E][R]&&this.addBossEvilEye(cc.v2(E,R)),"z9"==e[E][R]&&this.addBossDragon(cc.v2(E,R)))}}r.default.mapManager.isCurrentRoomStateClear()||r.default.mapManager.getCurrentRoomType()!=g.default.DANGER_ROOM&&r.default.mapManager.getCurrentRoomType()!=g.default.LOOT_ROOM&&r.default.mapManager.getCurrentRoomType()!=g.default.END_ROOM&&r.default.mapManager.getCurrentRoomType()!=g.default.TRAP_ROOM&&r.default.mapManager.getCurrentRoomType()!=g.default.PRIMARY_ROOM||this.monsterManager.addRandomMonsters(this),!r.default.mapManager.getCurrentMapBoxes()&&i.length>0&&r.default.mapManager.setCurrentBoxesArr(i),!r.default.mapManager.getCurrentMapShopTables()&&a.length>0&&r.default.mapManager.setCurrentShopTableArr(a),!r.default.mapManager.getCurrentMapChests()&&m.length>0&&r.default.mapManager.setCurrentChestsArr(m),cc.log("load finished")},e.prototype.isThe=function(t,e){return-1!=t.indexOf(e)},e.prototype.addItem=function(t,e,i){if(this.item){var a=cc.instantiate(this.item);a.parent=this.node,a.position=t;var n=o.getIndexInMap(t);a.zIndex=3e3+10*(o.HEIGHT_SIZE-n.y)+3,a.getComponent(p.default).init(e,n.clone(),i);var s=a.getComponent(p.default).data,c=r.default.mapManager.getCurrentMapItems();c?c.push(s):((c=new Array).push(s),r.default.mapManager.setCurrentItemsArr(c))}},e.prototype.addFallStone=function(t,e,i){if(this.fallStone){var a=cc.instantiate(this.fallStone),n=a.getComponent(R.default);n.isAuto=e,a.parent=this.node,a.position=t;var s=o.getIndexInMap(t);a.zIndex=2e3+10*(o.HEIGHT_SIZE-s.y)+3,n.isAuto&&n.fall(i)}},e.prototype.addVenom=function(t){var e=cc.instantiate(this.venom);e.getComponent(T.default).player=this.player,e.getComponent(T.default).isForever=!0,e.parent=this.node,e.position=t;var i=o.getIndexInMap(t);e.zIndex=3e3+10*(o.HEIGHT_SIZE-i.y)},e.prototype.addIceThron=function(t,e){if(this.iceThron){var i=cc.instantiate(this.iceThron),a=i.getComponent(A.default);a.isAuto=e,i.parent=this.node,i.position=t;var n=o.getIndexInMap(t);i.zIndex=3e3+10*(o.HEIGHT_SIZE-n.y)+3,a.isAuto&&a.fall()}},e.prototype.addTwineGrass=function(t,e){if(this.dryadGrass){var i=cc.instantiate(this.dryadGrass),a=i.getComponent(b.default);a.isAuto=e,i.parent=this.node,i.position=t;var n=o.getIndexInMap(t);i.zIndex=3e3+10*(o.HEIGHT_SIZE-n.y)+3,a.isAuto&&a.fall()}},e.prototype.addCoin=function(t,e){this.coinManager&&this.coinManager.getValueCoin(e,t,this.node)},e.prototype.addEquipmentListOnGround=function(){var t=r.default.mapManager.getCurrentMapEquipments();if(t)for(var e=0,o=t;e<o.length;e++){var i=o[e];this.equipmentManager&&this.equipmentManager.getEquipment(i.img,i.pos,this.node,i,null,null).data}},e.prototype.addItemListOnGround=function(){var t=r.default.mapManager.getCurrentMapItems();if(r.default.mapManager.setCurrentItemsArr(new Array),t)for(var e=0,i=t;e<i.length;e++){var a=i[e];a.isTaken||this.addItem(o.getPosInMap(a.pos),a.resName)}},e.prototype.addEquipment=function(t,e,o,i,a){if(this.equipmentManager){var n=this.equipmentManager.getEquipment(t,e,this.node,o,i,a).data,s=r.default.mapManager.getCurrentMapEquipments();s?s.push(n):((s=new Array).push(n),r.default.mapManager.setCurrentEquipmentsArr(s))}},e.prototype.addMonsterFromData=function(t,e,o){this.addMonster(this.monsterManager.getMonster(t,this),cc.v2(e,o))},e.prototype.breakHalfTiles=function(){for(var t=this,e=function(e){for(var a=function(o){i.map[e][o].isAutoShow=!1,i.breakTile(cc.v2(e,o)),i.scheduleOnce(function(){t.breakTile(cc.v2(e,o))},.1*O.default.rand())},n=6;n<o.HEIGHT_SIZE-1;n++)a(n)},i=this,a=1;a<o.WIDTH_SIZE-1;a++)e(a)},e.prototype.addBossSlime=function(t,e){this.bosses&&this.bosses.push(this.monsterManager.getSlime(this,e.clone(),t))},e.prototype.addBossCaptain=function(t){this.bosses&&this.bosses.push(this.monsterManager.getCaptain(this,t.clone()))},e.prototype.addBossWarMachine=function(t){if(this.bosses){var e=this.monsterManager.getWarMachine(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},3.5)}},e.prototype.addBossDryad=function(t){if(this.bosses){var e=this.monsterManager.getDryad(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossDragon=function(t){if(this.bosses){var e=this.monsterManager.getDragon(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossSphinx=function(t){if(this.bosses){var e=this.monsterManager.getSphinx(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossRah=function(t){if(this.bosses){var e=this.monsterManager.getRah(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossIceDemon=function(t){if(this.bosses){var e=this.monsterManager.getIceDemon(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossEvilEye=function(t){if(this.bosses){var e=this.monsterManager.getEvilEye(this,t.clone());this.bosses.push(e),this.scheduleOnce(function(){e.showBoss()},2)}},e.prototype.addBossKraken=function(t){var e=this;if(this.bosses){this.dungeonStyleManager.changeTopWalls(!1),this.isZoomCamera=!0;var o=this.monsterManager.getKraken(this,t.clone());this.bosses.push(o),this.anim.playAdditive("DungeonShakeOnce"),this.scheduleOnce(function(){e.anim.playAdditive("DungeonShakeOnce")},1),this.scheduleOnce(function(){e.anim.playAdditive("DungeonShakeOnce")},2),this.scheduleOnce(function(){o.showBoss()},3.5)}},e.prototype.addMonster=function(t,e){t.node.active=!0,t.pos=e,t.node.position=o.getPosInMap(e),this.monsters.push(t)},e.getPosInMap=function(t){var e=o.MAPX+t.x*o.TILE_SIZE,i=o.MAPY+t.y*o.TILE_SIZE;return cc.v2(e,i)},e.getIndexInMap=function(t,e){var i=(t.x-o.MAPX)/o.TILE_SIZE,a=(t.y-o.MAPY)/o.TILE_SIZE;return i=Math.round(i),a=Math.round(a),e||(i<0&&(i=0),i>=o.WIDTH_SIZE&&(i=o.WIDTH_SIZE-1),a<0&&(a=0),a>=o.HEIGHT_SIZE&&(a=o.HEIGHT_SIZE-1)),cc.v2(i,a)},e.fixOuterMap=function(t){var e=(t.x-o.MAPX)/o.TILE_SIZE,i=(t.y-o.MAPY)/o.TILE_SIZE;e=Math.round(e),i=Math.round(i);var a=!1;return e<0&&(e=0,a=!0),e>=o.WIDTH_SIZE&&(e=o.WIDTH_SIZE-1,a=!0),i<0&&(i=0,a=!0),i>=o.HEIGHT_SIZE&&(i=o.HEIGHT_SIZE-1,a=!0),a?o.getPosInMap(cc.v2(e,i)):t},e.prototype.start=function(){this.scheduleOnce(function(){cc.director.emit(c.EventConstant.CHANGE_MINIMAP,{detail:{x:r.default.mapManager.currentPos.x,y:r.default.mapManager.currentPos.y}})},.1);for(var t=0,e=r.default.mapManager.getCurrentRoom().doors;t<e.length;t++){var o=e[t];this.dungeonStyleManager.setDoor(o.dir,o.isDoor,!1)}},e.prototype.breakTile=function(t){var e=this.map[t.x][t.y];e.isBroken||e.breakTile()},e.prototype.playerAction=function(t,e,o){this.player&&this.player.playerAction(t,e,o,this)},e.prototype.getMonsterAliveNum=function(){for(var t=0,e=0,o=this.monsters;e<o.length;e++){o[e].isDied&&t++}return this.monsters.length-t},e.prototype.checkRoomClear=function(){var t=!1,e=this.getMonsterAliveNum();if(t=e<=0,this.bosses.length>0){e=0;for(var o=0,i=this.bosses;o<i.length;o++){i[o].isDied&&e++}t=e>=this.bosses.length}for(var a=0,n=this.footboards;a<n.length;a++){n[a].isOpen||(t=!1)}r.default.mapManager.getCurrentRoomType()==g.default.TEST_ROOM&&(t=!0),t&&(this.portal&&this.portal.openGate(),this.dungeonStyleManager&&this.dungeonStyleManager.exitdoor&&this.dungeonStyleManager.exitdoor&&!g.default.isRoomEqual(r.default.mapManager.getCurrentRoom(),r.default.mapManager.rectDungeon.startRoom)&&(this.dungeonStyleManager.changeTopWalls(!0),this.dungeonStyleManager.exitdoor.openGate()),this.openDoors())},e.prototype.openDoors=function(){for(var t=0,e=r.default.mapManager.getCurrentRoom().doors;t<e.length;t++){var o=e[t];r.default.mapManager.setRoomClear(r.default.mapManager.currentPos.x,r.default.mapManager.currentPos.y);var i=!1;if(g.default.isRoomEqual(r.default.mapManager.getCurrentRoom(),r.default.mapManager.rectDungeon.startRoom)&&r.default.mapManager.rectDungeon.endRoom.state!=m.default.STATE_CLEAR){var a=r.default.mapManager.rectDungeon.getNeighborRoomType(r.default.mapManager.currentPos.x,r.default.mapManager.currentPos.y,o.dir);a&&a.roomType==g.default.END_ROOM&&r.default.level!=g.default.LEVEL_5&&r.default.level!=g.default.LEVEL_3&&(i=!0)}r.default.level<=1&&(i=!1),i||this.dungeonStyleManager.setDoor(o.dir,o.isDoor,!0)}},e.prototype.checkPlayerPos=function(t){if(this.map&&this.player&&this.node){this.fog.setPosition(this.lerp(this.fog.position,this.player.node.position,3*t));var e=o.getIndexInMap(this.player.node.position);if(this.map[e.x]&&this.map[e.x][e.y]){var i=this.map[e.x][e.y];i&&i.isBroken&&this.player.fall(),i&&i.isAutoShow&&this.breakTile(e)}}},e.prototype.lerp=function(t,e,o){var i=cc.v2(0,0),a=t.x,n=t.y;return i.x=a+(e.x-a)*o,i.y=n+(e.y-n)*o,i},e.prototype.checkMonstersPos=function(){for(var t=0,e=this.monsters;t<e.length;t++){if(e[t].isDied)return}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){if(this.isTimeDelay(t)&&this.checkPlayerPos(t),this.isCheckTimeDelay(t)){this.checkRoomClear();for(var e=0,o=this.waterlist;e<o.length;e++){o[e].changeWaterLight()}}},e.WIDTH_SIZE=15,e.HEIGHT_SIZE=9,e.MAPX=32,e.MAPY=32,e.TILE_SIZE=64,a([H(cc.Prefab)],e.prototype,"tile",void 0),a([H(cc.Prefab)],e.prototype,"wall",void 0),a([H(cc.Prefab)],e.prototype,"trap",void 0),a([H(cc.Prefab)],e.prototype,"fallStone",void 0),a([H(cc.Prefab)],e.prototype,"emplacement",void 0),a([H(cc.Prefab)],e.prototype,"footboard",void 0),a([H(cc.Prefab)],e.prototype,"chest",void 0),a([H(cc.Prefab)],e.prototype,"box",void 0),a([H(cc.Prefab)],e.prototype,"decorate",void 0),a([H(cc.Prefab)],e.prototype,"item",void 0),a([H(cc.Prefab)],e.prototype,"shop",void 0),a([H(cc.Prefab)],e.prototype,"shoptable",void 0),a([H(cc.Prefab)],e.prototype,"floorDecoration",void 0),a([H(cc.Prefab)],e.prototype,"playerPrefab",void 0),a([H(cc.Prefab)],e.prototype,"portalPrefab",void 0),a([H(cc.Prefab)],e.prototype,"bed",void 0),a([H(cc.Prefab)],e.prototype,"campFire",void 0),a([H(cc.Prefab)],e.prototype,"tarotTable",void 0),a([H(cc.Prefab)],e.prototype,"venom",void 0),a([H(cc.Prefab)],e.prototype,"iceThron",void 0),a([H(cc.Prefab)],e.prototype,"dryadGrass",void 0),a([H(cc.Prefab)],e.prototype,"saw",void 0),a([H(cc.Prefab)],e.prototype,"waterPool",void 0),a([H(cc.Node)],e.prototype,"fog",void 0),a([H(E.default)],e.prototype,"bossHealthBar",void 0),e=o=a([B],e)}(cc.Component);o.default=w,cc._RF.pop()},{"./Boss/DryadGrass":"DryadGrass","./Boss/IceDemonThron":"IceDemonThron","./Boss/SlimeVenom":"SlimeVenom","./Building/Box":"Box","./Building/Chest":"Chest","./Building/Decorate":"Decorate","./Building/DecorationFloor":"DecorationFloor","./Building/Emplacement":"Emplacement","./Building/FallStone":"FallStone","./Building/FootBoard":"FootBoard","./Building/Portal":"Portal","./Building/Saw":"Saw","./Building/ShopTable":"ShopTable","./Building/TileWaterPool":"TileWaterPool","./Building/Trap":"Trap","./Building/Wall":"Wall","./EventConstant":"EventConstant","./HealthBar":"HealthBar","./Item/Item":"Item","./Logic":"Logic","./Manager/CoinManager":"CoinManager","./Manager/DungeonStyleManager":"DungeonStyleManager","./Manager/EquipmentManager":"EquipmentManager","./Manager/MonsterManager":"MonsterManager","./Player":"Player","./Rect/RectDungeon":"RectDungeon","./Rect/RectRoom":"RectRoom","./Tile":"Tile","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random"}],Emplacement:[function(t,e,o){"use strict";cc._RF.push(e,"78b9bpQ7+BAGrpzYzxR/1mq","Emplacement");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Shooter"),r=t("../Logic"),c=t("./Building"),l=t("../Data/FromData"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shooterTop=null,e.shooterBottom=null,e.shooterLeft=null,e.shooterRight=null,e.isOpen=!1,e.pos=cc.v2(0,0),e.timeDelay=0,e.dirType=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.setShooterHv(this.shooterTop,cc.v2(0,1)),this.setShooterHv(this.shooterBottom,cc.v2(0,-1)),this.setShooterHv(this.shooterLeft,cc.v2(-1,0)),this.setShooterHv(this.shooterRight,cc.v2(1,0));var t=l.default.getClone("\u70ae\u53f0","emplacement");this.shooterTop.from.valueCopy(t),this.shooterBottom.from.valueCopy(t),this.shooterLeft.from.valueCopy(t),this.shooterRight.from.valueCopy(t)},e.prototype.setDirType=function(t){switch(t){case"E0":this.dirType=o.ALL;break;case"E1":this.dirType=o.TOP;break;case"E2":this.dirType=o.BOTTOM;break;case"E3":this.dirType=o.LEFT;break;case"E4":this.dirType=o.RIGHT;break;case"E5":this.dirType=o.TOPBOTTOM;break;case"E6":this.dirType=o.TOPLEFT;break;case"E7":this.dirType=o.TOPRIGHT;break;case"E8":this.dirType=o.BOTTOMLEFT;break;case"E9":this.dirType=o.BOTTOMRIGHT;break;case"EE":this.dirType=o.LEFTRIGHT}},e.prototype.start=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.scheduleOnce(function(){t.fire()},1)},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.OpenFire=function(){if(this.dungeon)switch(this.dirType){case o.ALL:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight);break;case o.TOP:this.fireShooter(this.shooterTop);break;case o.BOTTOM:this.fireShooter(this.shooterBottom);break;case o.LEFT:this.fireShooter(this.shooterLeft);break;case o.RIGHT:this.fireShooter(this.shooterRight);break;case o.TOPBOTTOM:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom);break;case o.TOPLEFT:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterLeft);break;case o.TOPRIGHT:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterRight);break;case o.BOTTOMLEFT:this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft);break;case o.BOTTOMRIGHT:this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterRight);break;case o.LEFTRIGHT:this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight);break;default:this.fireShooter(this.shooterTop),this.fireShooter(this.shooterBottom),this.fireShooter(this.shooterLeft),this.fireShooter(this.shooterRight)}},e.prototype.fire=function(){this.anim&&this.anim.play()},e.prototype.fireShooter=function(t){if(!t.dungeon)switch(t.dungeon=this.dungeon,t.data.bulletType="bullet010",t.data.bulletLineExNum=0,r.default.chapterName){case r.default.CHAPTER00:t.data.bulletLineExNum=3,t.data.bulletType="laser001";break;case r.default.CHAPTER01:t.data.bulletType="bullet010";break;case r.default.CHAPTER02:t.data.bulletType="bullet013";break;case r.default.CHAPTER03:t.data.bulletType="bullet006",t.data.bulletLineExNum=1;break;case r.default.CHAPTER04:t.data.bulletType="bullet024",t.data.bulletLineExNum=1}t.fireBullet()},e.prototype.setShooterHv=function(t,e){t.setHv(e)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>3&&(this.timeDelay=0,this.fire())},e.ALL=0,e.TOP=1,e.BOTTOM=2,e.LEFT=3,e.RIGHT=4,e.TOPBOTTOM=5,e.TOPLEFT=6,e.TOPRIGHT=7,e.BOTTOMLEFT=8,e.BOTTOMRIGHT=9,e.LEFTRIGHT=10,a([p(s.default)],e.prototype,"shooterTop",void 0),a([p(s.default)],e.prototype,"shooterBottom",void 0),a([p(s.default)],e.prototype,"shooterLeft",void 0),a([p(s.default)],e.prototype,"shooterRight",void 0),e=o=a([u],e)}(c.default);o.default=d,cc._RF.pop()},{"../Data/FromData":"FromData","../Dungeon":"Dungeon","../Logic":"Logic","../Shooter":"Shooter","./Building":"Building"}],EquipmentData:[function(t,e,o){"use strict";cc._RF.push(e,"a5970exQi1ISK2QZd4VAwv9","EquipmentData");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(o,"__esModule",{value:!0});var a=t("./CommonData"),n=function(t){function e(){var e=t.call(this)||this;return e.uuid="",e.pos=cc.v2(0,0),e.nameCn="",e.nameEn="",e.equipmetType="empty",e.equipmetTypeCn="",e.prefix="",e.desc="",e.color="#ffffff",e.lightcolor="#ffffff",e.titlecolor="#ffffff",e.img="emptyequipment",e.level=0,e.stab=0,e.far=0,e.isLocked=0,e.isReflect=0,e.trouserslong=0,e.bulletType="",e.bulletSize=0,e.bulletArcExNum=0,e.bulletLineExNum=0,e.bulletLineInterval=0,e.bulletNets=0,e.showShooter=0,e.isHeavy=0,e.isArcAim=0,e.isLineAim=0,e.hideHair=0,e.bulletExSpeed=0,e.statusName="",e.statusInterval=0,e.exBulletTypeAttack="",e.exBulletTypeHurt="",e.exBulletRate=0,e.exBulletCombo1=0,e.exBulletCombo2=0,e.exBulletCombo3=0,e.exBulletOffsetX=0,e.info1="",e.info2="",e.info3="",e.extraInfo="",e.suit1="",e.suit2="",e.suit3="",e.infobase="",e.infocolor1="#ffffff",e.infocolor2="#ffffff",e.infocolor3="#ffffff",e.suitcolor1="#ffffff",e.suitcolor2="#ffffff",e.suitcolor3="#ffffff",e.infobasecolor="#ffffff",e.common=new a.default,e}return i(e,t),Object.defineProperty(e.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),e.prototype.valueCopy=function(t){this.uuid=t.uuid?t.uuid:"",this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:"",this.nameEn=t.nameEn?t.nameEn:"",this.equipmetType=t.equipmetType?t.equipmetType:"",this.equipmetTypeCn=t.equipmetTypeCn?t.equipmetTypeCn:"",this.prefix=t.prefix?t.prefix:"",this.desc=t.desc?t.desc:"",this.color=t.color?t.color:"#ffffff",this.titlecolor=t.titlecolor?t.titlecolor:"#ffffff",this.lightcolor=t.lightcolor?t.lightcolor:"#ffffff",this.img=t.img?t.img:"emptyequipment",this.stab=t.stab?t.stab:0,this.far=t.far?t.far:0,this.isLocked=t.isLocked?t.isLocked:0,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.bulletNets=t.bulletNets?t.bulletNets:0,this.level=t.level?t.level:0,this.trouserslong=t.trouserslong?t.trouserslong:0,this.showShooter=t.showShooter?t.showShooter:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.bulletType=t.bulletType?t.bulletType:"",this.exBulletTypeAttack=t.exBulletTypeAttack?t.exBulletTypeAttack:"",this.exBulletTypeHurt=t.exBulletTypeHurt?t.exBulletTypeHurt:"",this.isArcAim=t.isArcAim?t.isArcAim:0,this.isLineAim=t.isLineAim?t.isLineAim:0,this.hideHair=t.hideHair?t.hideHair:0,this.bulletSize=t.bulletSize?t.bulletSize:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0,this.statusName=t.statusName?t.statusName:"",this.statusInterval=t.statusInterval?t.statusInterval:0,this.isReflect=t.isReflect?t.isReflect:0,this.exBulletRate=t.exBulletRate?t.exBulletRate:0,this.exBulletCombo1=t.exBulletCombo1?t.exBulletCombo1:0,this.exBulletCombo2=t.exBulletCombo2?t.exBulletCombo2:0,this.exBulletCombo3=t.exBulletCombo3?t.exBulletCombo3:0,this.exBulletOffsetX=t.exBulletOffsetX?t.exBulletOffsetX:0,this.info1=t.info1?t.info1:"",this.info2=t.info2?t.info2:"",this.info3=t.info3?t.info3:"",this.extraInfo=t.extraInfo?t.extraInfo:"",this.suit1=t.suit1?t.suit1:"",this.suit2=t.suit2?t.suit2:"",this.suit3=t.suit3?t.suit3:"",this.infobase=t.infobase?t.infobase:"",this.infocolor1=t.infocolor1?t.infocolor1:"#ffffff",this.infocolor2=t.infocolor2?t.infocolor2:"#ffffff",this.infocolor3=t.infocolor3?t.infocolor3:"#ffffff",this.suitcolor1=t.suitcolor1?t.suitcolor1:"#ffffff",this.suitcolor2=t.suitcolor2?t.suitcolor2:"#ffffff",this.suitcolor3=t.suitcolor3?t.suitcolor3:"#ffffff",this.infobasecolor=t.infobasecolor?t.infobasecolor:"#ffffff"},e.prototype.clone=function(){var t=new e;return t.uuid=this.uuid,t.pos=this.pos,t.common=this.common.clone(),t.nameCn=this.nameCn,t.nameEn=this.nameEn,t.equipmetType=this.equipmetType,t.equipmetTypeCn=this.equipmetTypeCn,t.prefix=this.prefix,t.desc=this.desc,t.color=this.color,t.titlecolor=this.titlecolor,t.lightcolor=this.lightcolor,t.img=this.img,t.stab=this.stab,t.far=this.far,t.isLocked=this.isLocked,t.level=this.level,t.trouserslong=this.trouserslong,t.showShooter=this.showShooter,t.bulletType=this.bulletType,t.exBulletTypeAttack=this.exBulletTypeAttack,t.exBulletTypeHurt=this.exBulletTypeHurt,t.isHeavy=this.isHeavy,t.isArcAim=this.isArcAim,t.isLineAim=this.isLineAim,t.bulletArcExNum=this.bulletArcExNum,t.bulletLineExNum=this.bulletLineExNum,t.bulletLineInterval=this.bulletLineInterval,t.bulletNets=this.bulletNets,t.hideHair=this.hideHair,t.bulletSize=this.bulletSize,t.bulletExSpeed=this.bulletExSpeed,t.isReflect=this.isReflect,t.exBulletRate=this.exBulletRate,t.exBulletCombo1=this.exBulletCombo1,t.exBulletCombo2=this.exBulletCombo2,t.exBulletCombo3=this.exBulletCombo3,t.exBulletOffsetX=this.exBulletOffsetX,t.info1=this.info1,t.info2=this.info2,t.info3=this.info3,t.extraInfo=this.extraInfo,t.suit1=this.suit1,t.suit2=this.suit2,t.suit3=this.suit3,t.infobase=this.infobase,t.infocolor1=this.infocolor1,t.infocolor2=this.infocolor2,t.infocolor3=this.infocolor3,t.suitcolor1=this.suitcolor1,t.suitcolor2=this.suitcolor2,t.suitcolor3=this.suitcolor3,t.infobasecolor=this.infobasecolor,t},e}(t("./BaseData").default);o.default=n,cc._RF.pop()},{"./BaseData":"BaseData","./CommonData":"CommonData"}],EquipmentDescData:[function(t,e,o){"use strict";cc._RF.push(e,"d7742jFusdGiIE+18obcC2k","EquipmentDescData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(){this.nameCn="",this.nameEn="",this.damageMin=0,this.damageMax=0,this.criticalStrikeRate=0,this.defence=0,this.lifeDrain=0,this.lifeRecovery=0,this.moveSpeed=0,this.attackSpeed=0,this.dodge=0,this.health=0,this.titlecolor="#ffffff",this.color="#ffffff",this.prefix="",this.level=0,this.remoteDamage=0,this.remoteCritRate=0,this.remoteSpeed=0,this.realDamage=0,this.realRate=0,this.iceDamage=0,this.iceDefence=0,this.iceRate=0,this.fireDamage=0,this.fireDefence=0,this.fireRate=0,this.lighteningDamage=0,this.lighteningDefence=0,this.lighteningRate=0,this.toxicDamage=0,this.toxicDefence=0,this.toxicRate=0,this.curseDamage=0,this.curseDefence=0,this.curseRate=0,this.info1="",this.info2="",this.info3="",this.suit1="",this.suit2="",this.suit3="",this.infobase="",this.infocolor1="#ffffff",this.infocolor2="#ffffff",this.infocolor3="#ffffff",this.suitcolor1="#ffffff",this.suitcolor2="#ffffff",this.suitcolor3="#ffffff",this.infobasecolor="#ffffff"}}();o.default=i,cc._RF.pop()},{}],EquipmentDialog:[function(t,e,o){"use strict";cc._RF.push(e,"9bf82hBG9BGv4V/KYPwSFw+","EquipmentDialog");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTile=null,e.infoBase=null,e.info1=null,e.info2=null,e.info3=null,e.extraInfo=null,e.infoSuit1=null,e.infoSuit2=null,e.infoSuit3=null,e.infoDesc=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.opacity=0},e.prototype.refreshDialog=function(t){this.labelTile.string=t.prefix+t.nameCn,this.labelTile.node.color=this.labelTile.node.color.fromHEX(t.titlecolor),this.infoBase.string=t.infobase,this.infoBase.node.color=this.infoBase.node.color.fromHEX(t.infobasecolor),this.info1.string=t.info1,this.info1.node.color=this.info1.node.color.fromHEX(t.infocolor1),this.info2.string=t.info2,this.info2.node.color=this.info2.node.color.fromHEX(t.infocolor2),this.info3.string=t.info3,this.info3.node.color=this.info3.node.color.fromHEX(t.infocolor3),this.extraInfo.string=t.extraInfo,this.infoSuit1.string=t.suit1,this.infoSuit1.node.color=this.infoSuit1.node.color.fromHEX(t.suitcolor1),this.infoSuit2.string=t.suit2,this.infoSuit2.node.color=this.infoSuit2.node.color.fromHEX(t.suitcolor2),this.infoSuit3.string=t.suit3,this.infoSuit3.node.color=this.infoSuit3.node.color.fromHEX(t.suitcolor3),this.infoDesc.string=t.desc,this.infoBase.node.active=this.infoBase.string.length>0,this.info1.node.active=this.info1.string.length>0,this.info2.node.active=this.info2.string.length>0,this.info3.node.active=this.info3.string.length>0,this.extraInfo.node.active=this.extraInfo.string.length>0,this.infoSuit1.node.active=this.infoSuit1.string.length>0,this.infoSuit2.node.active=this.infoSuit2.string.length>0,this.infoSuit3.node.active=this.infoSuit3.string.length>0},e.prototype.showDialog=function(){this.node.opacity=255},e.prototype.hideDialog=function(){this.node.opacity=0},e.prototype.update=function(t){},e.prototype.lerp=function(t,e,o){return t+(e-t)*o},a([r(cc.Label)],e.prototype,"labelTile",void 0),a([r(cc.Label)],e.prototype,"infoBase",void 0),a([r(cc.Label)],e.prototype,"info1",void 0),a([r(cc.Label)],e.prototype,"info2",void 0),a([r(cc.Label)],e.prototype,"info3",void 0),a([r(cc.Label)],e.prototype,"extraInfo",void 0),a([r(cc.Label)],e.prototype,"infoSuit1",void 0),a([r(cc.Label)],e.prototype,"infoSuit2",void 0),a([r(cc.Label)],e.prototype,"infoSuit3",void 0),a([r(cc.Label)],e.prototype,"infoDesc",void 0),e=a([s],e)}(cc.Component);o.default=c,cc._RF.pop()},{}],EquipmentManager:[function(t,e,o){"use strict";cc._RF.push(e,"29c053rRnlLqrw1VkMXkISC","EquipmentManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Logic"),r=t("../Data/EquipmentData"),c=t("../Data/EquipmentDescData"),l=t("../Equipment/Equipment"),h=t("../Utils/Random"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipment=null,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.getRandomDesc=function(t,e){var i=new c.default,a=0,n=cc.v2(0,0);if(this.isTheEquipType(t.equipmetType,[o.TYPE_WEAPON,o.TYPE_HELMET,o.TYPE_GLOVES,o.TYPE_CLOAK,o.TYPE_REMOTE])&&t.Common.criticalStrikeRate>0){var s=50-t.Common.criticalStrikeRate;s<5&&(s=5),a=(n=this.getRandomQuality(0,s,e)).y>a?n.y:a,i.prefix+=n.y>2?"\u66b4\u51fb":"",i.color=this.getMixColor("#000000",n.y>2?o.COLOR_CRITICALSTRIKE:"#000000")}var r=cc.v2(0,0);this.isTheEquipType(t.equipmetType,[o.TYPE_WEAPON,o.TYPE_GLOVES,o.TYPE_CLOTHES,o.TYPE_REMOTE])&&t.Common.damageMin>0&&(a=(r=this.getRandomQuality(0,5,e)).y>a?r.y:a);var l=cc.v2(0,0);this.isTheEquipType(t.equipmetType,[o.TYPE_WEAPON,o.TYPE_GLOVES,o.TYPE_CLOTHES,o.TYPE_REMOTE])&&t.Common.damageMax>0&&(a=(l=this.getRandomQuality(r.x,r.x+5,e)).y>a?l.y:a,i.prefix+=l.y>2?"\u5f3a\u529b":"",i.color=this.getMixColor(i.color,l.y>2?o.COLOR_POWERFUL:"#000000"));var u=cc.v2(0,0);this.isTheEquipType(t.equipmetType,[o.TYPE_HELMET,o.TYPE_GLOVES,o.TYPE_CLOAK,o.TYPE_TROUSERS,o.TYPE_SHOES,o.TYPE_CLOTHES])&&t.Common.defence>0&&(a=(u=this.getRandomQuality(0,5,e)).y>a?u.y:a,i.prefix+=u.y>2?"\u575a\u56fa":"",i.color=this.getMixColor(i.color,u.y>2?o.COLOR_STABLE:"#000000"));var p=cc.v2(0,0);if(this.isTheEquipType(t.equipmetType,[o.TYPE_WEAPON,o.TYPE_HELMET,o.TYPE_GLOVES,o.TYPE_REMOTE])&&t.Common.lifeDrain>0){var d=50-t.Common.lifeDrain;d<5&&(d=5),a=(p=this.getRandomQuality(0,d,e)).y>a?p.y:a,i.prefix+=p.y>2?"\u90aa\u6076":"",i.color=this.getMixColor(i.color,p.y>2?o.COLOR_LIFEDRAIN:"#000000")}var f=cc.v2(0,0);this.isTheEquipType(t.equipmetType,[o.TYPE_HELMET,o.TYPE_GLOVES,o.TYPE_CLOAK,o.TYPE_TROUSERS,o.TYPE_SHOES,o.TYPE_CLOTHES])&&t.Common.lifeRecovery>0&&(a=(f=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0)).y>a?f.y:a,i.prefix+=f.y>2?"\u6e29\u6696":"",i.color=this.getMixColor(i.color,f.y>2?o.COLOR_RECOVERY:"#000000"));var m=cc.v2(0,0);if(this.isTheEquipType(t.equipmetType,[o.TYPE_CLOAK,o.TYPE_TROUSERS,o.TYPE_SHOES,o.TYPE_CLOTHES])&&t.Common.moveSpeed>0){var g=80-t.Common.moveSpeed;g<10&&(g=10),a=(m=this.getRandomQuality(0,g,e)).y>a?m.y:a,i.prefix+=m.y>2?"\u7075\u52a8":"",i.color=this.getMixColor(i.color,m.y>2?o.COLOR_MOVESPEED:"#000000")}var y=cc.v2(0,0);if(this.isTheEquipType(t.equipmetType,[o.TYPE_WEAPON,o.TYPE_GLOVES,o.TYPE_CLOTHES,o.TYPE_REMOTE])&&t.Common.attackSpeed>0){var v=30-t.Common.attackSpeed;v<5&&(v=5),a=(y=this.getRandomQuality(0,v,e)).y>a?y.y:a,i.prefix+=y.y>2?"\u8fc5\u6377":"",i.color=this.getMixColor(i.color,y.y>2?o.COLOR_ATTACKSPPED:"#000000")}var D=cc.v2(0,0);if(this.isTheEquipType(t.equipmetType,[o.TYPE_HELMET,o.TYPE_CLOAK,o.TYPE_TROUSERS,o.TYPE_SHOES,o.TYPE_CLOTHES])&&t.Common.dodge>0){var C=30-t.Common.dodge;C<10&&(C=10),a=(D=this.getRandomQuality(0,C,e)).y>a?D.y:a,i.prefix+=D.y>2?"\u98d8\u9038":"",i.color=this.getMixColor(i.color,D.y>2?o.COLOR_DODGE:"#000000")}var _=cc.v2(0,0);this.isTheEquipType(t.equipmetType,[o.TYPE_HELMET,o.TYPE_GLOVES,o.TYPE_CLOAK,o.TYPE_TROUSERS,o.TYPE_SHOES,o.TYPE_CLOTHES])&&t.Common.maxHealth>0&&(a=(_=this.getRandomQuality(0,5,e)).y>a?_.y:a,i.prefix+=_.y>2?"\u5065\u5eb7":"",i.color=this.getMixColor(i.color,_.y>2?o.COLOR_HEALTHY:"#000000"));var E=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=E.y>a?E.y:a,i.prefix+=E.y>2?"\u950b\u5229":"";var R=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=R.y>a?R.y:a,i.prefix+=R.y>2?"\u5bd2\u51b7":"";var S=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=S.y>a?S.y:a,i.prefix+=S.y>2?"\u708e\u70ed":"";var T=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=T.y>a?T.y:a,i.prefix+=T.y>2?"\u95ea\u7535":"";var O=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=O.y>a?O.y:a,i.prefix+=O.y>2?"\u6bd2\u7d20":"";var A=h.default.rand()<.1?this.getRandomQuality(0,5,e):cc.v2(0,0);a=A.y>a?A.y:a,i.prefix+=A.y>2?"\u8bc5\u5492":"";var b=h.default.rand()<.1?this.getRandomQuality(30,60,e):cc.v2(0,0);a=b.y>a?b.y:a;var M=h.default.rand()<.1?this.getRandomQuality(30,60,e):cc.v2(0,0);a=M.y>a?M.y:a;var P=h.default.rand()<.1?this.getRandomQuality(30,60,e):cc.v2(0,0);a=P.y>a?P.y:a;var L=h.default.rand()<.1?this.getRandomQuality(30,60,e):cc.v2(0,0);a=L.y>a?L.y:a;var I=h.default.rand()<.1?this.getRandomQuality(30,60,e):cc.v2(0,0);a=I.y>a?I.y:a;var x=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);a=x.y>a?x.y:a;var N=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);a=N.y>a?N.y:a;var B=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);a=B.y>a?B.y:a;var H=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);a=H.y>a?H.y:a;var w=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);a=w.y>a?w.y:a;var k=h.default.rand()<.05?this.getRandomQuality(10,60,e):cc.v2(0,0);return a=k.y>a?k.y:a,i.prefix=["","\u666e\u901a\u7684","\u7cbe\u826f\u7684","\u4f18\u79c0\u7684","\u53f2\u8bd7\u7684","\u4f20\u8bf4\u7684"][a]+i.prefix,i.titlecolor=["#dcdcdc","#ffffff","#00ff00","#0000ff","#800080","#ffa500"][a],i.level=a,i.color="#000000"==i.color?"#ffffff":i.color,i.criticalStrikeRate=n.x,i.damageMin=r.x,i.damageMax=l.x,i.defence=u.x,i.lifeDrain=p.x,i.lifeRecovery=f.x,i.moveSpeed=m.x,i.attackSpeed=y.x,i.dodge=D.x,i.health=_.x,i.realDamage=E.x,i.iceDamage=R.x,i.fireDamage=S.x,i.lighteningDamage=T.x,i.toxicDamage=O.x,i.curseDamage=A.x,i.iceDefence=b.x,i.fireDefence=M.x,i.lighteningDefence=P.x,i.toxicDefence=L.x,i.curseDefence=I.x,i.realRate=x.x,i.iceRate=N.x,i.fireRate=B.x,i.lighteningRate=H.x,i.toxicRate=w.x,i.curseRate=k.x,i},e.prototype.isTheEquipType=function(t,e){for(var o=!1,i=0,a=e;i<a.length;i++){a[i]==t&&(o=!0)}return o},e.prototype.getRandomQuality=function(t,e,o){var i=(e-t)/5,a=h.default.rand();if(o&&a>.9)switch(o){case 1:a=h.default.rand()>.2?.04:.5;break;case 2:a=h.default.rand()>.2?.06:.08;break;case 3:a=h.default.rand()>.2?.086:.09}var n=cc.v2(0,0);return a<.05?(n.x=s.default.getRandomNum(0,i),n.y=1):a>=.05&&a<.075?(n.x=s.default.getRandomNum(i,2*i),n.y=2):a>=.075&&a<.085?(n.x=s.default.getRandomNum(2*i,3*i),n.y=3):a>=.085&&a<.09?(n.x=s.default.getRandomNum(3*i,4*i),n.y=4):a>=.09&&a<.091&&(n.x=s.default.getRandomNum(4*i,5*i),n.y=5),n.x=parseFloat(n.x.toFixed(0)),n},e.prototype.getEquipment=function(t,e,o,i,a,c){var h=cc.instantiate(this.equipment);h.parent=o,h.position=n.default.getPosInMap(e),h.zIndex=3e3+10*(n.default.HEIGHT_SIZE-e.y)+3;var u=h.getComponent(l.default);if(u.pos=e,i)c&&(u.shopTable=c,c.data.equipdata=i.clone(),c.data.price=15*(i.level+1)),u.refresh(i);else{var p=new r.default;p.valueCopy(s.default.equipments[t]),p.uuid=p.genNonDuplicateID();var d=this.getRandomDesc(p,a);p.infobase=this.getEquipmentInfoBase(d,p),p.info1=this.getEquipmentInfo1(d,p),p.info2=this.getEquipmentInfo2(d,p),p.info3=this.getEquipmentInfo3(d,p),p.infobasecolor="#fffff0",p.infocolor1="#98FB98",p.infocolor2="#87CEFA",p.infocolor3="#9370DB",p.Common.criticalStrikeRate+=d.criticalStrikeRate,p.Common.damageMin+=d.damageMin,p.Common.damageMax+=d.damageMax,p.Common.defence+=d.defence,p.Common.lifeDrain+=d.lifeDrain,p.Common.lifeRecovery+=d.lifeRecovery,p.Common.moveSpeed+=d.moveSpeed,p.Common.attackSpeed+=d.attackSpeed,p.Common.dodge+=d.dodge,p.Common.maxHealth+=d.health,p.Common.realDamage+=d.realDamage,p.Common.iceDamage+=d.iceDamage,p.Common.fireDamage+=d.fireDamage,p.Common.lighteningDamage+=d.lighteningDamage,p.Common.toxicDamage+=d.toxicDamage,p.Common.curseDamage+=d.curseDamage,p.Common.iceDefence+=d.iceDefence,p.Common.fireDefence+=d.fireDefence,p.Common.lighteningDefence+=d.lighteningDefence,p.Common.toxicDefence+=d.toxicDefence,p.Common.curseDefence+=d.curseDefence,p.Common.realRate+=d.realRate,p.Common.iceRate+=d.iceRate,p.Common.fireRate+=d.fireRate,p.Common.lighteningRate+=d.lighteningRate,p.Common.toxicRate+=d.toxicRate,p.Common.curseRate+=d.curseRate,p.prefix=d.prefix,p.titlecolor=d.titlecolor,"#ffffff"!=d.color&&(p.color=d.color,"#ffffff"!=p.lightcolor?p.lightcolor=this.getMixColor(d.color,p.lightcolor):p.lightcolor=d.color),p.level=d.level,c&&(u.shopTable=c,c.data.equipdata=p.clone(),c.data.price=15*(d.level+1)),u.refresh(p)}return u},e.prototype.getEquipmentInfoBase=function(t,e){var o="";return o+=e.Common.remoteDamage+t.remoteDamage==0?"":"\u8fdc\u7a0b\u4f24\u5bb3"+e.Common.remoteDamage+(0==t.remoteDamage?"":"+"+t.remoteDamage)+"\n",o+=e.Common.remoteCritRate+t.remoteCritRate==0?"":"\u8fdc\u7a0b\u66b4\u51fb\u7387"+e.Common.remoteCritRate+(0==t.remoteCritRate?"":"+"+t.remoteCritRate)+"\n",o+=e.Common.remoteSpeed+t.remoteSpeed==0?"":"\u8fdc\u7a0b\u653b\u901f"+e.Common.remoteSpeed+(0==t.remoteSpeed?"":"+"+t.remoteSpeed)+"\n",o+=e.Common.damageMin+t.damageMin==0?"":"\u653b\u51fb"+e.Common.damageMin+(0==t.damageMin?"":"+"+t.damageMin)+" \u6700\u5927\u653b\u51fb\u529b"+e.Common.damageMax+(0==t.damageMax?"":"+"+t.damageMax)+"\n",o+=e.Common.damageMin+t.damageMin==0&&0!=e.Common.damageMax?"\u6700\u5927\u653b\u51fb\u529b"+e.Common.damageMax+(0==t.damageMax?"":"+"+t.damageMax)+"\n":"",o+=e.Common.defence+t.defence==0?"":"\u9632\u5fa1"+e.Common.defence+(0==t.defence?"":"+"+t.defence)+"\n",(o+=e.Common.maxHealth+t.health==0?"":"\u751f\u547d"+e.Common.maxHealth+(0==t.health?"":"+"+t.health)+"\n").length>0&&-1!=o.lastIndexOf("\n")&&(o=o.substring(0,o.lastIndexOf("\n"))),o=o.replace("+-","-")},e.prototype.getEquipmentInfo1=function(t,e){var o="";return o+=e.Common.criticalStrikeRate+t.criticalStrikeRate==0?"":"\u66b4\u51fb"+e.Common.criticalStrikeRate+(0==t.criticalStrikeRate?"":"+"+t.criticalStrikeRate)+"%\n",o+=e.Common.lifeDrain+t.lifeDrain==0?"":"\u5438\u8840"+e.Common.lifeDrain+(0==t.lifeDrain?"":"+"+t.lifeDrain)+"%\n",o+=e.Common.lifeRecovery+t.lifeRecovery==0?"":"\u56de\u590d"+e.Common.lifeRecovery+(0==t.lifeRecovery?"":"+"+t.lifeRecovery)+"\n",o+=e.Common.moveSpeed+t.moveSpeed==0?"":"\u79fb\u901f"+e.Common.moveSpeed+(0==t.moveSpeed?"":"+"+t.moveSpeed)+"\n",o+=e.Common.attackSpeed+t.attackSpeed==0?"":"\u653b\u901f"+e.Common.attackSpeed+(0==t.attackSpeed?"":"+"+t.attackSpeed)+"\n",(o+=e.Common.dodge+t.dodge==0?"":"\u95ea\u907f"+e.Common.dodge+(0==t.dodge?"":"+"+t.dodge)+"%\n").length>0&&-1!=o.lastIndexOf("\n")&&(o=o.substring(0,o.lastIndexOf("\n"))),o=o.replace("+-","-")},e.prototype.getEquipmentInfo2=function(t,e){var o="";return o+=0==e.isReflect?"":"\u53cd\u5f39\u5b50\u5f39\n",o+=e.Common.realDamage+t.realDamage==0?"":"\u653b\u51fb\u9644\u52a0"+e.Common.realDamage+(0==t.realDamage?"":"+"+t.realDamage)+"\u70b9\u6d41\u8840\u4f24\u5bb3\n",o+=e.Common.realRate+t.realRate==0?"":"\u653b\u51fb\u6709"+e.Common.realRate+(0==t.realRate?"":"+"+t.realRate)+"%\u51e0\u7387\u91ca\u653e\u6d41\u8840\n",o+=e.Common.iceDamage+t.iceDamage==0?"":"\u653b\u51fb\u9644\u52a0"+e.Common.iceDamage+(0==t.iceDamage?"":"+"+t.iceDamage)+"\u70b9\u51b0\u4f24\u5bb3\n",o+=e.Common.iceRate+t.iceRate==0?"":"\u653b\u51fb\u6709"+e.Common.iceRate+(0==t.iceRate?"":"+"+t.iceRate)+"%\u51e0\u7387\u91ca\u653e\u51b0\u51bb\n",o+=e.Common.fireDamage+t.fireDamage==0?"":"\u653b\u51fb\u9644\u52a0"+e.Common.fireDamage+(0==t.fireDamage?"":"+"+t.fireDamage)+"\u70b9\u706b\u4f24\u5bb3\n",o+=e.Common.fireRate+t.fireRate==0?"":"\u653b\u51fb\u6709"+e.Common.fireRate+(0==t.fireRate?"":"+"+t.fireRate)+"%\u51e0\u7387\u91ca\u653e\u71c3\u70e7\n",o+=e.Common.lighteningDamage+t.lighteningDamage==0?"":"\u653b\u51fb\u9644\u52a0"+e.Common.lighteningDamage+(0==t.lighteningDamage?"":"+"+t.lighteningDamage)+"\u70b9\u96f7\u4f24\u5bb3\n",o+=e.Common.lighteningRate+t.lighteningRate==0?"":"\u653b\u51fb\u6709"+e.Common.lighteningRate+(0==t.lighteningRate?"":"+"+t.lighteningRate)+"%\u51e0\u7387\u91ca\u653e\u95ea\u7535\n",o+=e.Common.toxicDamage+t.toxicDamage==0?"":"\u653b\u51fb\u9644\u52a0"+e.Common.toxicDamage+(0==t.toxicDamage?"":"+"+t.toxicDamage)+"\u70b9\u6bd2\u4f24\u5bb3\n",o+=e.Common.toxicRate+t.toxicRate==0?"":"\u6bd2\u653b\u51fb\u6709"+e.Common.toxicRate+(0==t.toxicRate?"":"+"+t.toxicRate)+"%\u51e0\u7387\u91ca\u653e\u6bd2\u7d20\n",o+=e.Common.curseDamage+t.curseDamage==0?"":"\u653b\u51fb\u9644\u52a0 "+e.Common.curseDamage+(0==t.curseDamage?"":"+"+t.curseDamage)+"\u70b9\u8bc5\u5492\u4f24\u5bb3\n",(o+=e.Common.curseRate+t.curseRate==0?"":"\u653b\u51fb\u6709"+e.Common.curseRate+(0==t.curseRate?"":"+"+t.curseRate)+"%\u51e0\u7387\u91ca\u653e\u8bc5\u5492\n").length>0&&-1!=o.lastIndexOf("\n")&&(o=o.substring(0,o.lastIndexOf("\n"))),o=o.replace("+-","-")},e.prototype.getEquipmentInfo3=function(t,e){var o="";return o+=e.Common.iceDefence+t.iceDefence==0?"":"\u51b0\u6297\u6027"+e.Common.iceDefence+(0==t.iceDefence?"":"+"+t.iceDefence)+"%\n",o+=e.Common.fireDefence+t.fireDefence==0?"":"\u706b\u6297\u6027"+e.Common.fireDefence+(0==t.fireDefence?"":"+"+t.fireDefence)+"%\n",o+=e.Common.lighteningDefence+t.lighteningDefence==0?"":"\u96f7\u6297\u6027"+e.Common.lighteningDefence+(0==t.lighteningDefence?"":"+"+t.lighteningDefence)+"%\n",o+=e.Common.toxicDefence+t.toxicDefence==0?"":"\u6bd2\u6297\u6027"+e.Common.toxicDefence+(0==t.toxicDefence?"":"+"+t.toxicDefence)+"%\n",(o+=e.Common.curseDefence+t.curseDefence==0?"":"\u8bc5\u5492\u6297\u6027"+e.Common.curseDefence+(0==t.curseDefence?"":"+"+t.curseDefence)+"%\n").length>0&&-1!=o.lastIndexOf("\n")&&(o=o.substring(0,o.lastIndexOf("\n"))),o=o.replace("+-","-")},e.prototype.start=function(){},e.prototype.getMixColor=function(t,e){var o=cc.color().fromHEX(t),i=cc.color().fromHEX(e),a=cc.color(),n=o.getR()+i.getR(),s=o.getG()+i.getG(),r=o.getB()+i.getB();return a.setR(n>255?255:n),a.setG(s>255?255:s),a.setB(r>255?255:r),"#"+a.toHEX("#rrggbb")},e.TYPE_WEAPON="weapon",e.TYPE_REMOTE="remote",e.TYPE_CLOTHES="clothes",e.TYPE_HELMET="helmet",e.TYPE_CLOAK="cloak",e.TYPE_TROUSERS="trousers",e.TYPE_SHOES="shoes",e.TYPE_GLOVES="gloves",e.EMPTY="emptyequipment",e.WEAPON_DINNERFORK="weapon000",e.WEAPON_KNIFE="weapon001",e.WEAPON_CHOPPER="weapon002",e.WEAPON_HUGEBLADE="weapon003",e.WEAPON_PITCHFORK="weapon004",e.WEAPON_HUGEAXE="weapon005",e.WEAPON_CROWBAR="weapon006",e.WEAPON_KATANA="weapon007",e.WEAPON_FRUITKNIFE="weapon008",e.WEAPON_HAPPYFIRE="weapon009",e.WEAPON_SADICE="weapon010",e.WEAPON_EGYPTWAND="weapon011",e.WEAPON_TOXICDAGGER="weapon012",e.WEAPON_OLDROOTDAGGER="weapon013",e.WEAPON_COOKCHOPPER="weapon014",e.WEAPON_LIGHTENINGBLADE="weapon015",e.WEAPON_JUNGLEFORK="weapon016",e.WEAPON_KUNAI="weapon017",e.WEAPON_DEATH="weapon018",e.WEAPON_SHADOW="weapon019",e.WEAPON_BLOOD="weapon020",e.REMOTE_CROSSBOW="remote001",e.REMOTE_LONGBOW="remote002",e.REMOTE_WAND="remote003",e.REMOTE_ALIENGUN="remote004",e.REMOTE_WINCHESTER="remote005",e.REMOTE_RPG="remote006",e.REMOTE_SHURIKEN="remote007",e.REMOTE_CHICKEN="remote008",e.CLOTHES_VEST="clothes001",e.CLOTHES_SHIRT="clothes002",e.CLOTHES_NAVY="clothes003",e.CLOTHES_PIRATE="clothes004",e.CLOTHES_BUCKET="clothes005",e.CLOTHES_REDROBE="clothes006",e.CLOTHES_WHITEROBE="clothes007",e.CLOTHES_GENTLEMAN="clothes008",e.CLOTHES_RADIATION="clothes009",e.CLOTHES_JUNGLE="clothes010",e.CLOTHES_PHARAOH="clothes011",e.CLOTHES_KNIGHT="clothes012",e.CLOTHES_DEATH="clothes013",e.CLOTHES_ENERGY="clothes014",e.HELMET_BUCKETHAT="helmet002",e.HELMET_PIRATEHAT="helmet003",e.HELMET_REDHAT="helmet004",e.HELMET_WHITEHAT="helmet005",e.HELMET_PHARAOH="helmet006",e.HELMET_CAT="helmet007",e.HELMET_CHIEF="helmet008",e.HELMET_HORUS="helmet009",e.HELMET_GENTLEMAN="helmet010",e.HELMET_CHICKEN="helmet011",e.HELMET_DUCK="helmet012",e.HELMET_GOOSE="helmet013",e.HELMET_RADIATION="helmet014",e.HELMET_JUNGLE="helmet015",e.HELMET_ANUBIS="helmet016",e.HELMET_KNIGHT="helmet017",e.HELMET_DEATH="helmet018",e.HELMET_ENERY="helmet019",e.CLOAK_WARRIOR="cloak001",e.TROUSERS_LONG="trousers001",e.TROUSERS_SHORT="trousers002",e.TROUSERS_RADIATION="trousers003",e.TROUSERS_JUNGLE="trousers004",e.TROUSERS_PHARAOH="trousers005",e.TROUSERS_KNIGHT="trousers006",e.TROUSERS_DEATH="trousers007",e.TROUSERS_ENERGY="trousers008",e.GLOVES_WARRIOR="gloves001",e.GLOVES_DEMON="gloves002",e.GLOVES_BLOODCRAW="gloves003",e.GLOVES_RADIATION="gloves004",e.GLOVES_JUNGLE="gloves005",e.GLOVES_PHARAOH="gloves006",e.GLOVES_KNIGHT="gloves007",e.GLOVES_DEATH="gloves008",e.GLOVES_ENERGY="gloves009",e.SHOES_WARRIOR="shoes001",e.SHOES_SKATEBOARD="shoes002",e.SHOES_DEMON="shoes003",e.SHOES_RADIATION="shoes004",e.SHOES_JUNGLE="shoes005",e.SHOES_PHARAOH="shoes006",e.SHOES_KNIGHT="shoes007",e.SHOES_DEATH="shoes008",e.SHOES_ENERGY="shoes009",e.COLOR_CRITICALSTRIKE="#DC143C",e.COLOR_ATTACKSPPED="#5F9EA0",e.COLOR_MOVESPEED="#00BFFF",e.COLOR_DODGE="#FFFF00",e.COLOR_STABLE="#DEB887",e.COLOR_POWERFUL="#9370DB",e.COLOR_HEALTHY="#90EE90",e.COLOR_LIFEDRAIN="#FFC0CB",e.COLOR_RECOVERY="#ADFF2F",a([d(cc.Prefab)],e.prototype,"equipment",void 0),e=o=a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Data/EquipmentDescData":"EquipmentDescData","../Dungeon":"Dungeon","../Equipment/Equipment":"Equipment","../Logic":"Logic","../Utils/Random":"Random"}],EquipmentStringData:[function(t,e,o){"use strict";cc._RF.push(e,"92198gP7T1AvKS5hasHWtsb","EquipmentStringData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.nameCn="",this.nameEn="",this.equipmetType="empty",this.desc="",this.img="emptyequipment",this.maxHealth=0,this.damageMin=0,this.damageMax=0,this.criticalStrikeRate=0,this.defence=0,this.lifeDrain=0,this.lifeRecovery=0,this.moveSpeed=0,this.attackSpeed=0,this.dodge=0,this.remoteSpeed=0,this.realDamage=0,this.realRate=0,this.iceDamage=0,this.iceDefence=0,this.iceRate=0,this.fireDamage=0,this.fireDefence=0,this.fireRate=0,this.lighteningDamage=0,this.lighteningDefence=0,this.lighteningRate=0,this.toxicDamage=0,this.toxicDefence=0,this.toxicRate=0,this.curseDamage=0,this.curseDefence=0,this.curseRate=0,this.stab=0,this.far=0,this.trouserslong=0,this.bulletType="",this.bulletSize=0,this.bulletArcExNum=0,this.bulletLineExNum=0,this.bulletLineInterval=0,this.showShooter=0,this.isHeavy=0,this.isLineAim=0,this.hideHair=0,this.bulletExSpeed=0}return t.prototype.valueCopy=function(t){this.maxHealth=t.Common.maxHealth?t.Common.maxHealth:0,this.damageMin=t.Common.damageMin?t.Common.damageMin:0,this.damageMax=t.Common.damageMax?t.Common.damageMax:0,this.criticalStrikeRate=t.Common.criticalStrikeRate?t.Common.criticalStrikeRate:0,this.defence=t.Common.defence?t.Common.defence:0,this.lifeDrain=t.Common.lifeDrain?t.Common.lifeDrain:0,this.lifeRecovery=t.Common.lifeRecovery?t.Common.lifeRecovery:0,this.moveSpeed=t.Common.moveSpeed?t.Common.moveSpeed:0,this.attackSpeed=t.Common.attackSpeed?t.Common.attackSpeed:0,this.remoteSpeed=t.Common.remoteSpeed?t.Common.remoteSpeed:0,this.dodge=t.Common.dodge?t.Common.dodge:0,this.realDamage=t.Common.realDamage?t.Common.realDamage:0,this.realRate=t.Common.realRate?t.Common.realRate:0,this.iceDamage=t.Common.iceDamage?t.Common.iceDamage:0,this.iceDefence=t.Common.iceDefence?t.Common.iceDefence:0,this.iceRate=t.Common.iceRate?t.Common.iceRate:0,this.fireDamage=t.Common.fireDamage?t.Common.fireDamage:0,this.fireDefence=t.Common.fireDefence?t.Common.fireDefence:0,this.fireRate=t.Common.fireRate?t.Common.fireRate:0,this.lighteningDamage=t.Common.lighteningDamage?t.Common.lighteningDamage:0,this.lighteningDefence=t.Common.lighteningDefence?t.Common.lighteningDefence:0,this.lighteningRate=t.Common.lighteningRate?t.Common.lighteningRate:0,this.toxicDamage=t.Common.toxicDamage?t.Common.toxicDamage:0,this.toxicDefence=t.Common.toxicDefence?t.Common.toxicDefence:0,this.toxicRate=t.Common.toxicRate?t.Common.toxicRate:0,this.curseDamage=t.Common.curseDamage?t.Common.curseDamage:0,this.curseDefence=t.Common.curseDefence?t.Common.curseDefence:0,this.curseRate=t.Common.curseRate?t.Common.curseRate:0,this.nameCn=t.nameCn?t.nameCn:"",this.nameEn=t.nameEn?t.nameEn:"",this.equipmetType=t.equipmetType?t.equipmetType:"",this.desc=t.desc?t.desc:"",this.img=t.img?t.img:"emptyequipment",this.stab=t.stab?t.stab:0,this.far=t.far?t.far:0,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.trouserslong=t.trouserslong?t.trouserslong:0,this.showShooter=t.showShooter?t.showShooter:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.bulletType=t.bulletType?t.bulletType:"",this.isLineAim=t.isLineAim?t.isLineAim:0,this.hideHair=t.hideHair?t.hideHair:0,this.bulletSize=t.bulletSize?t.bulletSize:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0},t.prototype.clone=function(){var e=new t;return e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.equipmetType=this.equipmetType,e.desc=this.desc,e.img=this.img,e.stab=this.stab,e.far=this.far,e.trouserslong=this.trouserslong,e.showShooter=this.showShooter,e.bulletType=this.bulletType,e.isHeavy=this.isHeavy,e.isLineAim=this.isLineAim,e.bulletArcExNum=this.bulletArcExNum,e.bulletLineExNum=this.bulletLineExNum,e.bulletLineInterval=this.bulletLineInterval,e.hideHair=this.hideHair,e.bulletSize=this.bulletSize,e.bulletExSpeed=this.bulletExSpeed,e.maxHealth=this.maxHealth,e.damageMin=this.damageMin,e.damageMax=this.damageMax,e.criticalStrikeRate=this.criticalStrikeRate,e.defence=this.defence,e.lifeDrain=this.lifeDrain,e.lifeRecovery=this.lifeRecovery,e.moveSpeed=this.moveSpeed,e.attackSpeed=this.attackSpeed,e.remoteSpeed=this.remoteSpeed,e.dodge=this.dodge,e.realDamage=this.realDamage,e.realRate=this.realRate,e.iceDamage=this.iceDamage,e.iceDefence=this.iceDefence,e.iceRate=this.iceRate,e.fireDamage=this.fireDamage,e.fireDefence=this.fireDefence,e.fireRate=this.fireRate,e.lighteningDamage=this.lighteningDamage,e.lighteningDefence=this.lighteningDefence,e.lighteningRate=this.lighteningRate,e.toxicDamage=this.toxicDamage,e.toxicDefence=this.toxicDefence,e.toxicRate=this.toxicRate,e.curseDamage=this.curseDamage,e.curseDefence=this.curseDefence,e.curseRate=this.curseRate,e},t}();o.default=i,cc._RF.pop()},{}],Equipment:[function(t,e,o){"use strict";cc._RF.push(e,"46d3aM6X2VOCJtzuWiGZaWE","Equipment");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("./EquipmentDialog"),r=t("../Data/EquipmentData"),c=t("../EventConstant"),l=t("../Player"),h=t("../Dungeon"),u=t("../Utils/AudioPlayer"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new r.default,e.equipmentDialog=null,e.pos=cc.v2(0,0),e.isTaken=!1,e}return i(e,t),e.prototype.onLoad=function(){this.isTaken=!1,this.sprite=this.node.getChildByName("sprite")},e.prototype.refresh=function(t){this.data.valueCopy(t),this.equipmentDialog.refreshDialog(this.data);var e=n.default.spriteFrames[this.data.img];"trousers"==t.equipmetType&&(e=1==t.trouserslong?n.default.spriteFrames.trousers000:e),this.sprite.getComponent(cc.Sprite).spriteFrame=e,this.sprite.width=e.getRect().width,this.sprite.height=e.getRect().height;var o=cc.color(255,255,255).fromHEX(this.data.color);this.sprite.color=o,"remote"==t.equipmetType&&(this.sprite.width=this.sprite.width/2,this.sprite.height=this.sprite.height/2),this.data.pos=h.default.getIndexInMap(this.node.position.clone())},e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.onEnable=function(){},e.prototype.taken=function(){var t=this;this.isTaken=!0,this.anim.play("EquipmentTaken"),cc.director.emit(c.EventConstant.PLAYER_CHANGEEQUIPMENT,{detail:{equipData:this.data}}),this.node.getChildByName("shadow").active=!1,this.equipmentDialog.node.active=!1,this.scheduleOnce(function(){t.node&&t.destroy()},1);var e=n.default.mapManager.getCurrentMapEquipments(),o=new Array;if(e)for(var i=0,a=e;i<a.length;i++){var s=a[i];s.uuid&&s.uuid!=this.data.uuid&&o.push(s)}n.default.mapManager.setCurrentEquipmentsArr(o),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:u.default.PICK_UP}})},e.prototype.onCollisionExit=function(t,e){t.node.getComponent(l.default)&&this.equipmentDialog.hideDialog()},e.prototype.onCollisionEnter=function(t,e){t.node.getComponent(l.default)&&this.equipmentDialog.showDialog()},a([f(s.default)],e.prototype,"equipmentDialog",void 0),e=a([d],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./EquipmentDialog":"EquipmentDialog"}],EventConstant:[function(t,e,o){"use strict";cc._RF.push(e,"4128feS00VLAILEQToHDge5","EventConstant");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.PLAYER_MOVE="PLAYER_MOVE",e.PLAYER_ROTATE="PLAYER_ROTATE",e.PLAYER_TRIGGER="PLAYER_TRIGGER",e.PLAYER_USEITEM="PLAYER_USEITEM",e.PLAYER_SKILL="PLAYER_SKILL",e.PLAYER_ATTACK="PLAYER_ATTACK",e.PLAYER_REMOTEATTACK="PLAYER_REMOTEATTACK",e.PLAYER_GETITEM="PLAYER_GETITEM",e.PLAYER_TAPTIPS="PLAYER_TAPTIPS",e.PLAYER_TAKEDAMAGE="PLAYER_TAKEDAMAGE",e.PLAYER_CHANGEITEM="PLAYER_CHANGEITEM",e.PLAYER_CHANGEEQUIPMENT="PLAYER_CHANGEEQUIPMENT",e.PLAYER_STATUSUPDATE="PLAYER_STATUSUPDATE",e.INVENTORY_CHANGEITEM="INVENTORY_CHANGEITEM",e.LOADINGNEXTLEVEL="LOADINGNEXTLEVEL",e.CHANGE_MINIMAP="CHANGE_MINIMAP",e.LOADINGROOM="LOADINGROOM",e.HUD_ADD_COIN="HUD_ADD_COIN",e.HUD_STOP_COUNTTIME="HUD_STOP_COUNTTIME",e.HUD_LIGHT_CONTROLLER="HUD_LIGHT_CONTROLLER",e.HUD_DARK_CONTROLLER="HUD_DARK_CONTROLLER",e.HUD_CONTROLLER_COOLDOWN="HUD_CONTROLLER_COOLDOWN",e.HUD_DAMAGE_CORNER_SHOW="HUD_DAMAGE_CORNER_SHOW",e.HUD_GROUND_EQUIPMENT_INFO_SHOW="HUD_GROUND_EQUIPMENT_INFO_SHOW",e.HUD_GROUND_EQUIPMENT_INFO_HIDE="HUD_GROUND_EQUIPMENT_INFO_HIDE",e.DUNGEON_SETEQUIPMENT="DUNGEON_SETEQUIPMENT",e.DUNGEON_ADD_ITEM="DUNGEON_ADD_ITEM",e.DUNGEON_SHAKEONCE="DUNGEON_SHAKEONCE",e.DUNGEON_ADD_COIN="DUNGEON_ADD_COIN",e.DUNGEON_ADD_FALLSTONE="DUNGEON_ADD_FALLSTONE",e.MONSTER_STATUSUPDATE="MONSTER_STATUSUPDATE",e.BOSS_ADDSLIME="BOSS_ADDSLIME",e.HUD_UPDATE_PLAYER_INFODIALOG="HUD_UPDATE_PLAYER_INFO_DIALOG",e.HUD_UPDATE_PLAYER_HEALTHBAR="HUD_UPDATE_PLAYER_HEALTHBAR",e.TALENT_TREE_UPDATE="TALENT_TREE_UPDATE",e.TALENT_TREE_SELECT="TALENT_TREE_SELECT",e.PLAY_AUDIO="PLAY_AUDIO",e.CAMERA_SHAKE="CAMERA_SHAKE",e.eventHandler=new cc.Node,e=a([s],e)}(cc.Component));o.EventConstant=r,cc._RF.pop()},{}],EvilEye:[function(t,e,o){"use strict";cc._RF.push(e,"4c205mgXoJFWIARHvt3fCFo","EvilEye");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Player"),r=t("../EventConstant"),c=t("../Shooter"),l=t("../Data/DamageData"),h=t("../Manager/StatusManager"),u=t("./Boss"),p=t("../Utils/Skill"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=t("../Achievement"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.viceEyesFireSkill=new p.default,e.mainEyesFireSkill=new p.default,e.dashSkill=new p.default,e.isHalfBlood=!1,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.graphics=this.getComponent(cc.Graphics),this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(c.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default),this.viceEyes=new Array,this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb1").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb2").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb3").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb4").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb5").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceEyes.push(this.node.getChildByName("sprite").getChildByName("limb6").getChildByName("tentacle1").getChildByName("tentacle2").getChildByName("tentacle3").getChildByName("eye")),this.viceShooters=new Array,this.viceShooters.push(this.node.getChildByName("Shooter1").getComponent(c.default)),this.viceShooters.push(this.node.getChildByName("Shooter2").getComponent(c.default)),this.viceShooters.push(this.node.getChildByName("Shooter3").getComponent(c.default)),this.viceShooters.push(this.node.getChildByName("Shooter4").getComponent(c.default)),this.viceShooters.push(this.node.getChildByName("Shooter5").getComponent(c.default)),this.viceShooters.push(this.node.getChildByName("Shooter6").getComponent(c.default));var t=f.default.getClone(this.actorName(),"evileyeeye");this.shooter.from.valueCopy(t);for(var e=0,o=this.viceShooters;e<o.length;e++){o[e].from.valueCopy(t)}},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){var e=this;return!(this.isDied||!this.isShow||this.anim.getAnimationState("EvilEyeHurt").isPlaying)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.data.currentHealth<this.data.Common.maxHealth/2&&!this.isHalfBlood&&(this.isHalfBlood=!0,this.anim.play("EvilEyeHurt"),this.scheduleOnce(function(){e.anim.play("EvilEyeBite")},2.5)),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(m.default.addMonsterKillAchievement(this.data.resName),this.node.runAction(cc.fadeOut(3)),this.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.isDied&&this.isShow&&this.dungeon){this.node.position=n.default.fixOuterMap(this.node.position),this.pos=n.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.getMovePos(),e=this.getNearPlayerDistance(this.dungeon.player.node),o=this.data.currentHealth<this.data.Common.maxHealth/2;e<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.mainEyesFireSkill.IsExcuting||!o||this.anim.getAnimationState("EvilEyeHurt").isPlaying||this.dash(),this.fireWithViceEyes(o),this.dashSkill.IsExcuting||this.fireWithMainEye(),!t.equals(cc.Vec2.ZERO)&&e>100&&!this.shooter.isAiming&&!this.dashSkill.IsExcuting&&(t=t.normalizeSelf(),this.move(t,20))}},e.prototype.getMovePos=function(){var t=this.dungeon.player.pos.clone(),e=n.default.getPosInMap(t);e.y+=32;(e=e.sub(this.node.position)).x;return e},e.prototype.fireWithViceEyes=function(t){var e=this;this.viceEyesFireSkill.next(function(){e.viceEyesFireSkill.IsExcuting=!0,e.scheduleOnce(function(){e.viceEyesFireSkill.IsExcuting=!1},2),t?e.schedule(function(){e.fireViceBullet()},.5,2,0):e.fireViceBullet()},3)},e.prototype.fireViceBullet=function(){for(var t=0;t<this.viceShooters.length;t++){var e=this.viceEyes[t].convertToWorldSpaceAR(cc.v2(0,0));e=this.node.convertToNodeSpaceAR(e),this.viceShooters[t].node.setPosition(e);var o=this.node.position.clone().add(e),i=this.dungeon.player.getCenterPosition().sub(o);i.equals(cc.Vec2.ZERO)||(i=i.normalizeSelf(),this.viceShooters[t].setHv(i),this.fireShooter(this.viceShooters[t],"bullet001",0,0,0,cc.v2(0,0)))}},e.prototype.fireWithMainEye=function(){var t=this;this.mainEyesFireSkill.next(function(){t.mainEyesFireSkill.IsExcuting=!0,t.scheduleOnce(function(){t.mainEyesFireSkill.IsExcuting=!1},3);var e=t.shooter.node.convertToWorldSpaceAR(cc.v2(0,0));e=t.node.convertToNodeSpaceAR(e),t.shooter.node.setPosition(e);var o=t.node.position.clone().add(e),i=t.dungeon.player.getCenterPosition().sub(o);i.equals(cc.Vec2.ZERO)||(i=i.normalizeSelf(),t.shooter.setHv(i),t.shooter.data.isLineAim=1,t.fireShooter(t.shooter,"laser003",0,3,0,cc.v2(0,0)),t.anim.playAdditive("EvilEyeStone"))},7)},e.prototype.dash=function(){var t=this;this.dashSkill.next(function(){cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),t.dashSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("EvilEyeBite");var e=t.getMovePos();e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf());var o=e.x,i=e.y,a=cc.v2(o,i);a=a.mul(800),t.rigidbody.linearVelocity=a,t.scheduleOnce(function(){t.dashSkill.IsExcuting=!1},2)},3,!0)},e.prototype.fireShooter=function(t,e,o,i,a,n){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a,n)},e.prototype.showBoss=function(){this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied,this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO)},e.prototype.move=function(t,e){if(!this.isDied){t.equals(cc.Vec2.ZERO)||(this.pos=n.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(s.default);if(o&&this.dashSkill.IsExcuting){var i=new l.default;i.physicalDamage=5;var a=f.default.getClone(this.actorName(),"evileyeeye");o.takeDamage(i,a),o.addStatus(h.default.BLEEDING,a)}},e.prototype.actorName=function(){return"\u90aa\u773c"},e=a([y],e)}(u.default));o.default=v,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Manager/StatusManager":"StatusManager","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss"}],ExitDoor:[function(t,e,o){"use strict";cc._RF.push(e,"479c1KI84hEjY9sMAyTcSmq","ExitDoor");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../EventConstant"),r=t("../Logic"),c=t("./Building"),l=t("../Utils/AudioPlayer"),h=cc._decorator,u=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.wall1=null,e.wall2=null,e.isDoor=!0,e.bgSprite=null,e.closeSprite=null,e.openSprite=null,e}return i(e,t),e.prototype.onLoad=function(){this.bgSprite=this.node.getChildByName("sprite").getChildByName("exitbg").getComponent(cc.Sprite),this.closeSprite=this.node.getChildByName("sprite").getChildByName("exitopen").getComponent(cc.Sprite),this.openSprite=this.node.getChildByName("sprite").getChildByName("exitclose").getComponent(cc.Sprite),this.openSprite.node.zIndex=2e3,this.closeSprite.node.zIndex=3e3},e.prototype.start=function(){switch(r.default.chapterName){case r.default.CHAPTER00:this.changeRes("exit000");break;case r.default.CHAPTER01:this.changeRes("exit001");break;case r.default.CHAPTER02:this.changeRes("exit002");break;case r.default.CHAPTER03:this.changeRes("exit003");break;case r.default.CHAPTER04:this.changeRes("exit004")}},e.prototype.hideWall=function(){this.wall1&&(this.wall1.zIndex=1e3,this.wall1.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.wall1.getComponent(cc.PhysicsBoxCollider).apply()),this.wall2&&(this.wall2.zIndex=1e3,this.wall2.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.wall2.getComponent(cc.PhysicsBoxCollider).apply())},e.prototype.openGate=function(){this.isOpen||(this.isOpen=!0,this.getComponent(cc.PhysicsBoxCollider).enabled=!1,this.closeSprite.node.runAction(cc.fadeOut(1)))},e.prototype.closeGate=function(){this.isOpen&&(this.isOpen=!1,this.getComponent(cc.PhysicsBoxCollider).enabled=!0,this.closeSprite.node.runAction(cc.fadeIn(1)))},e.prototype.onCollisionEnter=function(t,e){t.node.getComponent(n.default)&&this.isOpen&&(this.isOpen=!1,cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:l.default.EXIT}}),r.default.saveData(),cc.director.emit(s.EventConstant.LOADINGNEXTLEVEL))},e.prototype.changeRes=function(t){this.bgSprite.spriteFrame=r.default.spriteFrames[t+"bg"],this.openSprite.spriteFrame=r.default.spriteFrames[t+"open"],this.closeSprite.spriteFrame=r.default.spriteFrames[t+"close"]},e=a([u],e)}(c.default));o.default=p,cc._RF.pop()},{"../EventConstant":"EventConstant","../Logic":"Logic","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],FallStone:[function(t,e,o){"use strict";cc._RF.push(e,"606fd8guh5COozFgkmej6tZ","FallStone");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../EventConstant"),r=t("../Data/DamageData"),c=t("./Building"),l=t("../Utils/AudioPlayer"),h=t("../Data/FromData"),u=t("../Monster"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFall=!1,e.isAuto=!0,e.isFalling=!1,e}return i(e,t),e.prototype.onLoad=function(){this.isFall=!1},e.prototype.fall=function(t){t&&(this.node.getChildByName("stone").getChildByName("fire").active=!0,this.node.getChildByName("stone").color=cc.color(253,122,37)),this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isFalling=!0},e.prototype.FallFinish=function(){var t=this;cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:l.default.BOOM}}),this.isFall=!0,this.scheduleOnce(function(){t.isFall=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},2)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t,e){!t.getComponent(n.default)||this.isAuto||this.isFalling||this.fall()},e.prototype.onCollisionStay=function(t,e){var o=t.getComponent(n.default);o&&this.isFall&&this.isValid&&(this.isFall=!1,o.takeDamage(new r.default(2),h.default.getClone("\u843d\u77f3","stone")));var i=t.getComponent(u.default);i&&this.isFall&&this.isValid&&(this.isFall=!1,i.takeDamage(new r.default(2)))},e=a([d],e)}(c.default));o.default=f,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Monster":"Monster","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./Building":"Building"}],FireGhost:[function(t,e,o){"use strict";cc._RF.push(e,"63945bTi0VH3q4BT6nw6+98","FireGhost");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Monster"),s=t("../Boss/Boss"),r=t("../Data/DamageData"),c=t("../Manager/StatusManager"),l=t("./Talent"),h=t("../Data/FromData"),u=t("../Logic"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRotating=!1,e.isAttacking=!1,e.angleOffset=0,e.angle=0,e.isDied=!1,e.checkTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.rigidBody=this.getComponent(cc.RigidBody)},e.prototype.start=function(){},e.prototype.init=function(t,e){var o=this;this.player=t,this.node.setPosition(t.node.position.clone()),this.node.zIndex=5e3,this.angleOffset=e,this.scheduleOnce(function(){o.node.setPosition(o.getPlayerFarPosition(o.player,50,o.angle+o.angleOffset)),o.isRotating=!0},.2)},e.prototype.getPlayerFarPosition=function(t,e,o){var i=t.meleeWeapon.getHv().clone(),a=cc.v2(i).rotateSelf(o*Math.PI/180).mul(e);return t.node.position.clone().addSelf(cc.v2(8,48).addSelf(a))},e.prototype.onCollisionEnter=function(t,e){if(e.radius>0&&this.isAttacking&&this.isRotating){var o=t.node.getComponent(n.default),i=t.node.getComponent(s.default);(o||i)&&(this.isAttacking=!1,this.attacking(t.node))}},e.prototype.attacking=function(t){if(t){var e=new r.default,o=c.default.BURNING,i=1;this.player&&this.player.talentMagic.hashTalent(l.default.MAGIC_06)&&(i=2),e.fireDamage=i;var a=t.getComponent(n.default);a&&!a.isDied&&(a.takeDamage(e),a.addStatus(o,new h.default));var u=t.getComponent(s.default);u&&!u.isDied&&(u.takeDamage(e),u.addStatus(o,new h.default)),this.isDied=!0,cc.director.emit("destoryfireghost",{detail:{coinNode:this.node}})}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.2&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){if(this.isCheckTimeDelay(t)){var e=this.hasNearEnemy();e.equals(cc.Vec2.ZERO)?this.isRotating&&this.player&&(this.angle+=5,this.angle>360&&(this.angle=0),e=this.getPlayerFarPosition(this.player,50,this.angle+this.angleOffset),this.rigidBody.linearVelocity=e.sub(this.node.position).normalizeSelf().mulSelf(200)):(this.isAttacking=!0,this.rigidBody.linearVelocity=e.normalizeSelf().mulSelf(400))}},e.prototype.hasNearEnemy=function(){if(!this.player||!this.isRotating)return cc.Vec2.ZERO;for(var t=1e3,e=cc.v2(0,0),o=0,i=this.player.meleeWeapon.dungeon.monsters;o<i.length;o++){var a=i[o];if((r=u.default.getDistance(this.node.position,a.node.position))<400&&r<t&&!a.isDied&&!a.isDisguising)t=r,(c=this.node.position.clone()).x=this.node.scaleX>0?c.x:-c.x,e=a.node.position.sub(c)}if(e.equals(cc.Vec2.ZERO))for(var n=0,s=this.player.meleeWeapon.dungeon.bosses;n<s.length;n++){var r,c,l=s[n];if((r=u.default.getDistance(this.node.position,l.node.position))<400&&r<t&&!l.isDied)t=r,(c=this.node.position.clone()).x=this.node.scaleX>0?c.x:-c.x,e=l.node.position.sub(c)}return 1e3!=t&&(e=e.normalizeSelf()),e},e=a([d],e)}(cc.Component));o.default=f,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Monster":"Monster","./Talent":"Talent"}],FloatingLabelManager:[function(t,e,o){"use strict";cc._RF.push(e,"70be4qc1pdJGpxF0vSkBTb1","FloatingLabelManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../UI/FloatingLabel"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.labelPool=new cc.NodePool,cc.director.on("destorylabel",function(e){t.destroyLabel(e.detail.labelNode)})},e.prototype.getFloaingLabel=function(t){var e=this.node.position.clone();e=this.node.convertToWorldSpaceAR(e),e=t.convertToNodeSpaceAR(e);var o=null;this.labelPool.size()>0&&(o=this.labelPool.get()),o&&!o.active||(o=cc.instantiate(this.label)),o.parent=t,o.position=e.clone();var i=o.getComponent(n.default);return o.zIndex=5e3,o.opacity=255,o.active=!0,i},e.prototype.destroyLabel=function(t){t.active=!1;t.getComponent(cc.Label);this.labelPool&&this.labelPool.put(t)},e.prototype.start=function(){},a([c(cc.Prefab)],e.prototype,"label",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../UI/FloatingLabel":"FloatingLabel"}],FloatingLabel:[function(t,e,o){"use strict";cc._RF.push(e,"cae6fbyiQhHL5VOrhWuq2d6","FloatingLabel");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.label=this.node.getChildByName("label").getComponent(cc.Label)},e.prototype.start=function(){},e.prototype.showLabel=function(t,e,o){o&&(o>3&&(o=3),this.node.scale=o),this.label.node.opacity=255,this.label.node.position=cc.v2(0,0),this.label.string=t,this.label.node.color=e,this.anim.play("FontFloating")},e.prototype.showMiss=function(){this.showLabel("\u4e22\u5931",cc.color(255,255,255),1)},e.prototype.showDoge=function(){this.showLabel("\u95ea\u907f",cc.color(255,255,255),1)},e.prototype.showDamage=function(t,e){var o=t<0?cc.color(255,0,0):cc.color(0,255,0),i=1;e&&(o=cc.color(255,255,0),i=2),this.showLabel((t>0?"+":"")+parseFloat(t.toFixed(1)),o,i+Math.abs(t/50))},e.prototype.hideLabel=function(){this.node.active=!1,cc.director.emit("destorylabel",{detail:{labelNode:this.node}})},e.prototype.FloatingFinish=function(){this.hideLabel()},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],FlyWheel:[function(t,e,o){"use strict";cc._RF.push(e,"9401d43vIxKXLf+lf5WxH6B","FlyWheel");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../Talent/TalentShield"),r=t("../Data/DamageData"),c=t("../Monster"),l=t("../Boss/Boss"),h=t("../Manager/StatusManager"),u=t("../Building/Box"),p=t("../Data/FromData"),d=t("../Building/Decorate"),f=cc._decorator,m=f.ccclass,g=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hv=cc.v2(1,0),e.isFlyOut=!1,e.checkTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.rigidBody=this.getComponent(cc.RigidBody)},e.prototype.init=function(){this.sprites=new Array;for(var t=[2,3,4,5,9,12,13,14],e=0;e<t.length;e++){var o=this.getSpriteChildSprite(["sprite","sprite"+t[e]]);o.node.opacity=0,this.sprites.push(o)}},e.prototype.changeShieldPerformance=function(t){for(var e=0,o=this.sprites;e<o.length;e++){o[e].node.opacity=0}this.node.color=cc.color(255,255,255);for(var i=0,a=t;i<a.length;i++){var n=a[i];n.id==s.default.SHIELD_01||(n.id==s.default.SHIELD_02?this.sprites[0].node.opacity=255:n.id==s.default.SHIELD_03?this.sprites[1].node.opacity=255:n.id==s.default.SHIELD_04?this.sprites[2].node.opacity=255:n.id==s.default.SHIELD_05?this.sprites[3].node.opacity=255:n.id==s.default.SHIELD_06?!0:n.id==s.default.SHIELD_07?this.node.color=cc.color(0,0,0):n.id==s.default.SHIELD_08?this.node.color=cc.color(0,0,0):n.id==s.default.SHIELD_09?this.sprites[4].node.opacity=255:n.id==s.default.SHIELD_10?this.node.color=cc.color(0,0,0):n.id==s.default.SHIELD_11?this.node.color=cc.color(0,0,0):n.id==s.default.SHIELD_12?this.sprites[5].node.opacity=255:n.id==s.default.SHIELD_13?this.sprites[6].node.opacity=255:n.id==s.default.SHIELD_14&&(this.sprites[7].node.opacity=255))}},e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,o=0,i=t;o<i.length;o++){var a=i[o];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.onEnable=function(){},e.prototype.start=function(){},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.016&&(this.checkTimeDelay=0,!0)},e.prototype.getPlayerPosition=function(){return this.dungeon.player.node.position.clone().addSelf(cc.v2(8,48))},e.prototype.getNearPlayerDistance=function(t){return n.default.getDistance(this.node.position,this.getPlayerPosition())},e.prototype.show=function(){var t=this;this.node.active=!0,this.node.parent=this.dungeon.node,this.node.setPosition(this.getPlayerPosition());var e=1500;this.rigidBody.linearDamping=3,this.dungeon.player.talentShield.hashTalent(s.default.SHIELD_11)&&(e=3e3,this.rigidBody.linearDamping=12),this.rigidBody.linearVelocity=this.hv.mul(e),this.isFlyOut=!0,this.node.zIndex=4e3,this.scheduleOnce(function(){t.isFlyOut=!1},.5)},e.prototype.hide=function(){this.node.active=!1,this.rigidBody.linearVelocity=cc.Vec2.ZERO},e.prototype.onBeginContact=function(t,e,o){this.attacking(o)},e.prototype.setHv=function(t){t.equals(cc.Vec2.ZERO)?this.hv=cc.v2(1,0):this.hv=t},e.prototype.attacking=function(t){if(t&&this.node.active){var e=new r.default(1),o=t.node.getComponent(c.default);o&&!o.isDied&&o.takeDamage(e)&&(this.beatBack(o.node),this.addMonsterAllStatus(o));var i=t.node.getComponent(l.default);i&&!i.isDied&&i.takeDamage(e)&&this.addBossAllStatus(i);var a=t.node.getComponent(u.default);a&&a.breakBox();var n=t.node.getComponent(d.default);n&&n.breakBox()}},e.prototype.beatBack=function(t){if(this.dungeon.player.talentShield.hashTalent(s.default.SHIELD_09)&&this.isFlyOut){var e=t.getComponent(cc.RigidBody),o=this.hv.clone();o.equals(cc.Vec2.ZERO)&&(o=cc.v2(1,0));o=o.normalizeSelf().mul(1e3),e.applyLinearImpulse(o,e.getLocalCenter(),!0)}},e.prototype.update=function(t){if(this.isCheckTimeDelay(t)&&this.dungeon.player&&this.node.active&&!this.isFlyOut){var e=this.getPlayerPosition();e.y+=10;var o=e.sub(this.node.position);o.equals(cc.Vec2.ZERO)||(o=(o=o.normalizeSelf()).mul(2e3),this.rigidBody.linearVelocity=o,this.rigidBody.linearDamping=1)}this.dungeon&&this.dungeon.player&&this.getNearPlayerDistance(this.dungeon.player.node)<32&&this.node.active&&!this.isFlyOut&&this.hide()},e.prototype.addMonsterAllStatus=function(t){this.addMonsterStatus(s.default.SHIELD_07,t,h.default.FROZEN),this.addMonsterStatus(s.default.SHIELD_08,t,h.default.DIZZ),this.addMonsterStatus(s.default.SHIELD_10,t,h.default.BLEEDING)},e.prototype.addBossAllStatus=function(t){this.addBossStatus(s.default.SHIELD_07,t,h.default.FROZEN),this.addBossStatus(s.default.SHIELD_08,t,h.default.DIZZ),this.addBossStatus(s.default.SHIELD_10,t,h.default.BLEEDING)},e.prototype.addMonsterStatus=function(t,e,o){this.dungeon.player.talentShield.hashTalent(t)&&e.addStatus(o,new p.default)},e.prototype.addBossStatus=function(t,e,o){this.dungeon.player.talentShield.hashTalent(t)&&e.addStatus(o,new p.default)},e=a([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{"../Boss/Boss":"Boss","../Building/Box":"Box","../Building/Decorate":"Decorate","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Monster":"Monster","../Talent/TalentShield":"TalentShield"}],FootBoard:[function(t,e,o){"use strict";cc._RF.push(e,"a20d6iwPAJLg7AtbBgYX0yS","FootBoard");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Player"),r=t("./Box"),c=t("./Building"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e.isOpen=!1,e.pos=cc.v2(0,0),e.timeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.spriteNode=this.node.getChildByName("sprite"),this.sprite=this.spriteNode.getComponent(cc.Sprite)},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.openTrap=function(){this.isOpen||(this.isOpen=!0,this.sprite.spriteFrame=this.isOpen?this.openSpriteFrame:this.closeSpriteFrame)},e.prototype.onCollisionStay=function(t,e){t.node.getComponent(r.default)&&(this.isOpen=!0),t.node.getComponent(s.default)&&(this.isOpen=!0)},e.prototype.onCollisionEnter=function(t,e){t.node.getComponent(r.default)&&(this.isOpen=!0),t.node.getComponent(s.default)&&(this.isOpen=!0)},e.prototype.onCollisionExit=function(t,e){t.node.getComponent(r.default)&&(this.isOpen=!1),t.node.getComponent(s.default)&&(this.isOpen=!1)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>.16&&(this.sprite.spriteFrame=this.isOpen?this.openSpriteFrame:this.closeSpriteFrame)},a([u(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),a([u(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),e=a([h],e)}(c.default);o.default=p,cc._RF.pop()},{"../Dungeon":"Dungeon","../Player":"Player","./Box":"Box","./Building":"Building"}],FromData:[function(t,e,o){"use strict";cc._RF.push(e,"cf8a1Noa0FD6qIEI4bqHV5c","FromData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.valueCopy=function(t){t&&(this.name=t.name?t.name:"",this.res=t.res?t.res:"")},t.getClone=function(e,o){var i=new t;return i.name=e,i.res=o,i},t.prototype.clone=function(){var e=new t;return e.name=this.name,e.res=this.res,e},t}();o.default=i,cc._RF.pop()},{}],GameFinish:[function(t,e,o){"use strict";cc._RF.push(e,"98577N+o/RGi4cE+Wsz8Pp4","GameFinish");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./WxHelper"),r=t("./EventConstant"),c=t("./Utils/AudioPlayer"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wxhelper=null,e.level=null,e.clock=null,e}return i(e,t),e.prototype.start=function(){this.clock&&(this.clock.string=""+n.default.time),this.level&&(this.level.string="Level "+(n.default.chapterName+1)+"-"+n.default.level)},e.prototype.retry=function(){n.default.resetData(),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("loading")},e.prototype.home=function(){this.wxhelper&&this.wxhelper.CloseDialog(),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("start")},a([u(s.default)],e.prototype,"wxhelper",void 0),a([u(cc.Label)],e.prototype,"level",void 0),a([u(cc.Label)],e.prototype,"clock",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer","./WxHelper":"WxHelper"}],GameHud:[function(t,e,o){"use strict";cc._RF.push(e,"34bc5nmZdpM3J3SaZigF3c3","GameHud");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./PlayerInfoDialog"),s=t("../HealthBar"),r=t("../EventConstant"),c=t("../Data/PlayerData"),l=t("../Logic"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.healthBar=null,e.playerInfoDialog=null,e.level=null,e.clock=null,e.damageCorner=null,e.pasueButton=null,e.checkTimeDelay=0,e.startCountTime=!0,e.hour=0,e.minute=0,e.second=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this;cc.director.on(r.EventConstant.HUD_UPDATE_PLAYER_INFODIALOG,function(e){var o=new c.default;o.valueCopy(e.detail.data),t.statusUpdate(o)}),cc.director.on(r.EventConstant.HUD_UPDATE_PLAYER_HEALTHBAR,function(e){t.healthBarUpdate(e.detail.x,e.detail.y)}),cc.director.on(r.EventConstant.HUD_DAMAGE_CORNER_SHOW,function(e){t.showDamageCorner()}),cc.director.on(r.EventConstant.HUD_STOP_COUNTTIME,function(e){t.startCountTime=!1}),this.clock&&(this.clock.string=""+l.default.time),this.level&&(this.level.string="Level "+(l.default.chapterName+1)+"-"+l.default.level),this.damageCorner&&(this.damageCorner.opacity=0),this.pasueButton.on(cc.Node.EventType.TOUCH_START,function(e){t.pauseGame()})},e.prototype.statusUpdate=function(t){this.playerInfoDialog&&this.playerInfoDialog.refreshDialog(t,t.EquipmentTotalData,t.StatusTotalData)},e.prototype.showDamageCorner=function(){this.damageCorner&&(this.damageCorner.stopAllActions(),this.damageCorner.opacity=255,this.damageCorner.scale=1,this.damageCorner.runAction(cc.spawn(cc.scaleTo(.5,1.05),cc.fadeOut(1))))},e.prototype.healthBarUpdate=function(t,e){this.healthBar&&this.healthBar.refreshHealth(t,e)},e.prototype.start=function(){var t=l.default.time.split(":");this.hour=parseInt(t[0]),this.minute=parseInt(t[1]),this.second=parseInt(t[2])},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.clock&&this.startCountTime&&(this.changeTime(),this.clock.string=""+l.default.time)},e.prototype.useItem=function(){},e.prototype.changeTime=function(){this.second=this.second+1,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1);var t=""+this.hour;t=t.length>1?t:"0"+t;var e=""+this.minute;e=e.length>1?e:"0"+e;var o=""+this.second;o=o.length>1?o:"0"+o,l.default.time=t+":"+e+":"+o},e.prototype.pauseGame=function(){cc.director.isPaused()?(cc.director.resume(),this.pasueButton.getComponent(cc.Sprite).spriteFrame=l.default.spriteFrames.hud_pause):(this.pasueButton.getComponent(cc.Sprite).spriteFrame=l.default.spriteFrames.hud_pause_pressed,cc.director.pause())},a([p(s.default)],e.prototype,"healthBar",void 0),a([p(n.default)],e.prototype,"playerInfoDialog",void 0),a([p(cc.Label)],e.prototype,"level",void 0),a([p(cc.Label)],e.prototype,"clock",void 0),a([p(cc.Node)],e.prototype,"damageCorner",void 0),a([p(cc.Node)],e.prototype,"pasueButton",void 0),e=a([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Data/PlayerData":"PlayerData","../EventConstant":"EventConstant","../HealthBar":"HealthBar","../Logic":"Logic","./PlayerInfoDialog":"PlayerInfoDialog"}],GameOver:[function(t,e,o){"use strict";cc._RF.push(e,"0e28bkl25dNTqUQmquXpqGi","GameOver");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./EventConstant"),r=t("./Utils/AudioPlayer"),c=t("./Utils/Random"),l=t("./Achievement"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.info=null,e.infoIcon=null,e.level=null,e.clock=null,e.tips=null,e.tipsStr="",e}var o;return i(e,t),o=e,e.prototype.start=function(){var t=this,e=l.default.getAchievementData();this.clock&&(this.clock.string="\u7528\u65f6\uff1a"+n.default.time),this.level&&(this.level.string=n.default.chapterName+1+"-"+n.default.level);var i="\u6b7b\u4e8e\u975e\u547d";if(n.default.dieFrom.name.length>0&&(i="\u7b2c"+e.playerLifes+"\u6b21\u6b7b\u4ea1\uff0c\u5728"+(n.default.chapterName+1)+"-"+n.default.level+"\u88ab "+n.default.dieFrom.name+" \u51fb\u5012"),this.infoIcon&&n.default.dieFrom.res.length>0&&(this.infoIcon.spriteFrame=n.default.spriteFrames[n.default.dieFrom.res]),this.info&&(this.info.string=i),this.tips){var a=0;this.tips.string="";var s=o.TIPS[c.default.getRandomNum(0,o.TIPS.length-1)];this.schedule(function(){++a>s.length&&(a=s.length),t.tips.string=s.substr(0,a)},.05,s.length,.2)}},e.prototype.retry=function(){n.default.resetData(),cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:r.default.SELECT}}),cc.director.loadScene("loading")},e.prototype.home=function(){n.default.time="00:00:00",cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:r.default.SELECT}}),cc.director.loadScene("start")},e.TIPS=["\u5f53\u4f60\u51dd\u89c6\u6df1\u6e0a\u7684\u65f6\u5019,\u6df1\u6e0a\u4e5f\u5728\u51dd\u89c6\u7740\u4f60","YOU SHALL NOT PASS","\u72b9\u8c6b\u5c31\u4f1a...","\u6211\u4eec\u8eac\u8015\u4e8e\u6708\u4e0b\uff0c\u5374\u670d\u4f8d\u4e8e\u592a\u9633","\u6cb9\u6e56\u7684\u6c34\u5f88\u51b0\u51b7","DON'T WORRY,BE HAPPY","\u8fd9\u91cc\u9700\u8981\u7684\u4e0d\u662f\u82f1\u96c4\uff0c\u800c\u662f\u4e13\u5bb6","\u7535\u773c\u4f1a\u9ebb\u75f9\u4f60\u7684\u601d\u7ef4","\u4e0a\u5e1d\u6b32\u4f7f\u5176\u706d\u4ea1 \u5fc5\u5148\u4f7f\u5176\u75af\u72c2","\u6fc0\u5149\u6709\u4e00\u4e2a\u77ed\u6682\u7684\u7784\u51c6\u671f\uff0c\u6293\u4f4f\u673a\u4f1a\u518d\u8865\u4e00\u5200","\u51b0\u9b54\u7684\u523a\u4f1a\u963b\u6321\u4f60\u7684\u884c\u52a8","\u6b66\u58eb\u5200\u53ef\u4ee5\u53cd\u51fb\u5b50\u5f39","\u4f60\u7684\u5934\u76d6\u9aa8\u88ab\u54e5\u5e03\u6797\u505a\u6210\u4e86\u7897","\u4e0e\u5176\u611f\u6168\u8def\u96be\u884c\uff0c\u4e0d\u5982\u9a6c\u4e0a\u51fa\u53d1"],a([p(cc.Label)],e.prototype,"info",void 0),a([p(cc.Sprite)],e.prototype,"infoIcon",void 0),a([p(cc.Label)],e.prototype,"level",void 0),a([p(cc.Label)],e.prototype,"clock",void 0),a([p(cc.Label)],e.prototype,"tips",void 0),e=o=a([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./Achievement":"Achievement","./EventConstant":"EventConstant","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random"}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"c30ffLX6hVIjoNslRhRCM7w","Game"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,n=(i.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e=__decorate([a],e)}(cc.Component));o.default=n,cc._RF.pop()},{}],HealthBar:[function(t,e,o){"use strict";cc._RF.push(e,"4298eVZsIJFhKykTJYXRBP0","HealthBar"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,n=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backbar=null,e.label=null,e.timeDelay=0,e}return __extends(e,t),e.prototype.onLoad=function(){this.progressBar=this.getComponent(cc.ProgressBar),this.progressBar.progress=1},e.prototype.start=function(){},e.prototype.refreshHealth=function(t,e){this.progressBar&&(this.progressBar.progress=t/e,this.label&&(this.label.string=parseFloat(t.toFixed(1))+"/"+e))},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0),this.backbar.width=this.lerp(this.backbar.width,this.progressBar.barSprite.node.width,5*t)},e.prototype.lerp=function(t,e,o){return t+(e-t)*o},__decorate([n(cc.Node)],e.prototype,"backbar",void 0),__decorate([n(cc.Label)],e.prototype,"label",void 0),e=__decorate([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],IceDemonThron:[function(t,e,o){"use strict";cc._RF.push(e,"24e5dr3bslGlZZLL6MjYCjj","IceDemonThron");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../Data/DamageData"),r=t("../Manager/StatusManager"),c=t("../Data/FromData"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUp=!1,e.isAuto=!0,e.isUping=!1,e}return i(e,t),e.prototype.onLoad=function(){this.isUp=!1},e.prototype.fall=function(){this.anim=this.getComponent(cc.Animation),this.anim.play(),this.isUping=!0},e.prototype.ThronUp=function(){var t=this;this.isUp=!0,this.scheduleOnce(function(){t.isUp=!1},.1),this.scheduleOnce(function(){t.node&&t.node.destroy()},2)},e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t,e){!t.getComponent(n.default)||this.isAuto||this.isUping||this.fall()},e.prototype.onCollisionStay=function(t,e){var o=t.getComponent(n.default);if(o&&this.isUp&&this.isValid){this.isUp=!1;var i=c.default.getClone("\u51b0\u523a","bossicethron02");o.takeDamage(new s.default(2),i),o.addStatus(r.default.FROZEN,i)}},e=a([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Player":"Player"}],IceDemon:[function(t,e,o){"use strict";cc._RF.push(e,"4043fv41gFB1o18Orugu9B9","IceDemon");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Player"),r=t("../EventConstant"),c=t("../Shooter"),l=t("../Data/DamageData"),h=t("../Manager/StatusManager"),u=t("./Boss"),p=t("../Utils/Skill"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=t("../Achievement"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isFaceRight=!0,e.isMoving=!1,e.dashSkill=new p.default,e.thronSkill=new p.default,e.defenceSkill=new p.default,e.meleeSkill=new p.default,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(c.default),this.shooter.from.valueCopy(f.default.getClone(this.actorName(),"bossicepart01")),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(h.default)},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.defence(),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(m.default.addMonsterKillAchievement(this.data.resName),this.node.runAction(cc.fadeOut(3)),this.isDied=!0,this.anim.play("IceDemonDefence"),this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.isDied&&this.isShow&&this.dungeon){this.node.position=n.default.fixOuterMap(this.node.position),this.pos=n.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.getMovePos(),e=this.getNearPlayerDistance(this.dungeon.player.node),o=this.data.currentHealth<this.data.Common.maxHealth/2;e<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),!(e<200)||this.defenceSkill.IsExcuting||this.meleeSkill.IsExcuting||this.thronSkill.IsExcuting||this.dashSkill.IsExcuting||this.attack(),this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.thronSkill.IsExcuting||this.dash(),this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.dashSkill.IsExcuting||this.thron(o),t.equals(cc.Vec2.ZERO)||this.meleeSkill.IsExcuting||this.defenceSkill.IsExcuting||this.thronSkill.IsExcuting||this.dashSkill.IsExcuting||!(e>60)||(t=t.normalizeSelf(),this.move(t,500))}},e.prototype.getMovePos=function(){var t=this.dungeon.player.pos.clone();t=this.dungeon.player.pos.x>this.pos.x?t.addSelf(cc.v2(1,-1)):t.addSelf(cc.v2(-1,-1));var e=n.default.getPosInMap(t);e.y+=32;var o=(e=e.sub(this.node.position)).x;return this.isFaceRight=o>0,e},e.prototype.thron=function(t){var e=this;this.thronSkill.next(function(){e.thronSkill.IsExcuting=!0,e.anim||(e.anim=e.getComponent(cc.Animation)),e.anim.play("IceDemonThron");var o=1;e.schedule(function(){for(var t=e.pos.clone(),i=[cc.v2(t.x,t.y+o),cc.v2(t.x,t.y-o),cc.v2(t.x+o,t.y+o),cc.v2(t.x+o,t.y-o),cc.v2(t.x+o,t.y),cc.v2(t.x-o,t.y),cc.v2(t.x-o,t.y+o),cc.v2(t.x-o,t.y-o)],a=0;a<i.length;a++)e.dungeon.addIceThron(n.default.getPosInMap(i[a]),!0);o++},.2,t?7:5,1),t&&e.scheduleOnce(function(){for(var t=e.pos.clone(),o=[cc.v2(t.x+2,t.y+1),cc.v2(t.x+2,t.y-1),cc.v2(t.x-2,t.y+1),cc.v2(t.x-2,t.y-1),cc.v2(t.x+4,t.y+2),cc.v2(t.x+4,t.y-2),cc.v2(t.x-4,t.y+2),cc.v2(t.x-4,t.y-2),cc.v2(t.x+5,t.y+3),cc.v2(t.x+5,t.y-3),cc.v2(t.x-5,t.y+3),cc.v2(t.x-5,t.y-3),cc.v2(t.x+6,t.y+2),cc.v2(t.x+6,t.y-2),cc.v2(t.x-6,t.y+2),cc.v2(t.x-6,t.y-2),cc.v2(t.x+6,t.y+4),cc.v2(t.x+6,t.y-4),cc.v2(t.x-6,t.y+4),cc.v2(t.x-6,t.y-4),cc.v2(t.x+1,t.y+2),cc.v2(t.x+1,t.y-2),cc.v2(t.x-1,t.y+2),cc.v2(t.x-1,t.y-2),cc.v2(t.x+2,t.y+4),cc.v2(t.x+2,t.y-4),cc.v2(t.x-2,t.y+4),cc.v2(t.x-2,t.y-4),cc.v2(t.x+3,t.y+5),cc.v2(t.x+3,t.y-5),cc.v2(t.x-3,t.y+5),cc.v2(t.x-3,t.y-5),cc.v2(t.x+2,t.y+6),cc.v2(t.x+2,t.y-6),cc.v2(t.x-2,t.y+6),cc.v2(t.x-2,t.y-6),cc.v2(t.x+4,t.y+6),cc.v2(t.x+4,t.y-6),cc.v2(t.x-4,t.y+6),cc.v2(t.x-4,t.y-6)],i=0;i<o.length;i++)e.dungeon.addIceThron(n.default.getPosInMap(o[i]),!0)},1.5),e.scheduleOnce(function(){e.thronSkill.IsExcuting=!1},4)},15,!0)},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){t.meleeSkill.IsExcuting=!0,cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("IceDemonAttack001"),t.scheduleOnce(function(){cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}});var e=t.getMovePos();e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf());var o=e.x,i=e.y,a=cc.v2(o,i);a=a.mul(1500),t.rigidbody.linearVelocity=a},1),t.scheduleOnce(function(){t.meleeSkill.IsExcuting=!1},2)},3,!0)},e.prototype.dash=function(){var t=this;this.dashSkill.next(function(){t.dashSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("IceDemonDash"),t.scheduleOnce(function(){var e=t.getMovePos();e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf());var o=e.x,i=e.y,a=cc.v2(o,i);a=a.mul(2500),t.rigidbody.linearVelocity=a},2.4),t.scheduleOnce(function(){t.dashSkill.IsExcuting=!1},3)},8,!0)},e.prototype.defence=function(){var t=this;this.defenceSkill.next(function(){t.defenceSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.play("IceDemonDefence"),t.data.Common.defence=9999,t.data.Common.fireDefence=9999,t.data.Common.iceDefence=9999,t.data.Common.toxicDefence=9999,t.data.Common.lighteningDamage=9999,t.data.Common.curseDefence=9999,t.scheduleOnce(function(){t.defenceSkill.IsExcuting=!1,t.data.Common.defence=0,t.data.Common.fireDefence=0,t.data.Common.iceDefence=0,t.data.Common.toxicDefence=0,t.data.Common.lighteningDamage=0,t.data.Common.curseDefence=0},3)},6,!0)},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a)},e.prototype.showBoss=function(){this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied,this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.move=function(t,e){if(!this.isDied){t.equals(cc.Vec2.ZERO)||(this.pos=n.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.isMoving?this.anim.getAnimationState("IceDemonWalk").isPlaying||this.anim.playAdditive("IceDemonWalk"):this.anim.getAnimationState("IceDemonWalk").isPlaying&&this.anim.play("IceDemonIdle"),this.changeZIndex()}},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(s.default);if(o&&(this.meleeSkill.IsExcuting||this.dashSkill.IsExcuting)&&!this.isDied){var i=new l.default;i.physicalDamage=3;var a=f.default.getClone(this.actorName(),"bossicepart01");o.takeDamage(i,a),o.addStatus(h.default.FROZEN,a)}},e.prototype.actorName=function(){return"\u51b0\u9b54"},e=a([y],e)}(u.default));o.default=v,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Manager/StatusManager":"StatusManager","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss"}],InventoryManager:[function(t,e,o){"use strict";cc._RF.push(e,"1dc08IgWM1D6q2nqBDxwhzD","InventoryManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Data/EquipmentData"),a=t("../Data/ItemData"),n=function(){function t(){this.weapon=new i.default,this.remote=new i.default,this.helmet=new i.default,this.clothes=new i.default,this.trousers=new i.default,this.gloves=new i.default,this.shoes=new i.default,this.cloak=new i.default,this.buffer=new i.default,this.list=[],this.itemList=[],this.list=[this.weapon,this.helmet,this.clothes,this.trousers,this.gloves,this.shoes,this.cloak,this.buffer,this.remote],this.itemList.push(new a.default),this.itemList.push(new a.default),this.itemList.push(new a.default)}return t.prototype.getMoveSpeed=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.moveSpeed}return t},t.prototype.getAttackSpeed=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.attackSpeed}return t},t.prototype.getRemoteSpeed=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.remoteSpeed}return t},t.prototype.getAttackPoint=function(){for(var t=cc.v2(0,0),e=0,o=this.list;e<o.length;e++){var i=o[e];t.x+=i.Common.damageMin,t.y+=i.Common.damageMax}return t},t.prototype.getRemoteDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.remoteDamage}return t},t.prototype.getRemoteCritRate=function(){for(var t=1,e=0,o=this.list;e<o.length;e++){t*=1-o[e].Common.remoteCritRate/100}return 100*(1-t)},t.prototype.getCriticalStrikeRate=function(){for(var t=1,e=0,o=this.list;e<o.length;e++){t*=1-o[e].Common.criticalStrikeRate/100}return 100*(1-t)},t.prototype.getDodge=function(){for(var t=1,e=0,o=this.list;e<o.length;e++){t*=1-o[e].Common.dodge/100}return 100*(1-t)},t.prototype.getDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.defence}return t},t.prototype.getIceDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.iceDefence}return t},t.prototype.getFireDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.fireDefence}return t},t.prototype.getLighteningDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.lighteningDefence}return t},t.prototype.getToxicDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.toxicDefence}return t},t.prototype.getCurseDefence=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.curseDefence}return t},t.prototype.getRealDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.realDamage}return t},t.prototype.getIceDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.iceDamage}return t},t.prototype.getFireDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.fireDamage}return t},t.prototype.getLighteningDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.lighteningDamage}return t},t.prototype.getToxicDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.toxicDamage}return t},t.prototype.getCurseDamage=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.curseDamage}return t},t.prototype.getRealRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.realRate}return t},t.prototype.getIceRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.iceRate}return t},t.prototype.getFireRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.fireRate}return t},t.prototype.getLighteningRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.lighteningRate}return t},t.prototype.getToxicRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.toxicRate}return t},t.prototype.getCurseRate=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.curseRate}return t},t.prototype.getLifeRecovery=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.lifeRecovery}return t},t.prototype.getLifeDrainRate=function(){for(var t=1,e=0,o=this.list;e<o.length;e++){t*=1-o[e].Common.lifeDrain/100}return 100*(1-t)},t.prototype.getHealth=function(){for(var t=0,e=0,o=this.list;e<o.length;e++){t+=o[e].Common.maxHealth}return t},t.prototype.getTotalEquipmentData=function(){var t=new i.default;return t.Common.damageMin=this.getAttackPoint().x,t.Common.damageMax=this.getAttackPoint().y,t.Common.criticalStrikeRate=this.getCriticalStrikeRate(),t.Common.defence=this.getDefence(),t.Common.lifeDrain=this.getLifeDrainRate(),t.Common.lifeRecovery=this.getLifeRecovery(),t.Common.moveSpeed=this.getMoveSpeed(),t.Common.attackSpeed=this.getAttackSpeed(),t.Common.remoteSpeed=this.getRemoteSpeed(),t.Common.remoteDamage=this.getRemoteDamage(),t.Common.remoteCritRate=this.getRemoteCritRate(),t.Common.dodge=this.getDodge(),t.Common.maxHealth=this.getHealth(),t.Common.realDamage=this.getRealDamage(),t.Common.realRate=this.getRealRate(),t.Common.iceDamage=this.getIceDamage(),t.Common.iceDefence=this.getIceDefence(),t.Common.iceRate=this.getIceRate(),t.Common.fireDamage=this.getFireDamage(),t.Common.fireDefence=this.getFireDefence(),t.Common.fireRate=this.getFireRate(),t.Common.lighteningDamage=this.getLighteningDamage(),t.Common.lighteningDefence=this.getLighteningDefence(),t.Common.lighteningRate=this.getLighteningRate(),t.Common.toxicDamage=this.getToxicDamage(),t.Common.toxicDefence=this.getToxicDefence(),t.Common.toxicRate=this.getToxicRate(),t.Common.curseDamage=this.getCurseDamage(),t.Common.curseDefence=this.getCurseDefence(),t.Common.curseRate=this.getCurseRate(),t},t}();o.default=n,cc._RF.pop()},{"../Data/EquipmentData":"EquipmentData","../Data/ItemData":"ItemData"}],Inventory:[function(t,e,o){"use strict";cc._RF.push(e,"3b411lPIzZAv7ApO4pixeng","Inventory");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=t("./EventConstant"),l=t("./Logic"),h=t("./Data/EquipmentData"),u=t("./Player"),p=t("./Equipment/EquipmentDialog"),d=t("./Dungeon"),f=t("./Data/FromData"),m=t("./Item/Item"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tabselect=null,e.dungeon=null,e.selectIndex=0,e.weapon=null,e.remote=null,e.helmet=null,e.clothes=null,e.trousers=null,e.gloves=null,e.shoes=null,e.cloak=null,e.item1=null,e.item2=null,e.item3=null,e.equipmentDialog=null,e.equipmentGroundDialog=null,e.weaponTimeDelay=0,e.remoteTimeDelay=0,e.helmetTimeDelay=0,e.clothesTimeDelay=0,e.trousersTimeDelay=0,e.glovesTimeDelay=0,e.shoesTimeDelay=0,e.cloakTimeDelay=0,e.secondTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.inventoryManager=l.default.inventoryManager,cc.director.on(c.EventConstant.PLAYER_CHANGEEQUIPMENT,function(e){t.refreshEquipment(e.detail.equipData,!0)}),this.equipmentGroundDialog&&this.equipmentGroundDialog.hideDialog(),cc.director.on(c.EventConstant.PLAYER_CHANGEITEM,function(e){t.refreshItem(e.detail.itemData)}),cc.director.on(c.EventConstant.HUD_GROUND_EQUIPMENT_INFO_SHOW,function(e){t.equipmentGroundDialog&&(t.equipmentGroundDialog.refreshDialog(e.detail.equipData),t.equipmentGroundDialog.showDialog())}),cc.director.on(c.EventConstant.HUD_GROUND_EQUIPMENT_INFO_HIDE,function(e){t.equipmentGroundDialog&&t.equipmentGroundDialog.hideDialog()})},e.prototype.start=function(){this.tabselect.x=0,this.weapon.spriteFrame=null,this.remote.spriteFrame=null,this.helmet.spriteFrame=null,this.clothes.spriteFrame=null,this.trousers.spriteFrame=null,this.gloves.spriteFrame=null,this.shoes.spriteFrame=null,this.cloak.spriteFrame=null,this.addSpriteTouchEvent(this.weapon,"weapon"),this.addSpriteTouchEvent(this.remote,"remote"),this.addSpriteTouchEvent(this.helmet,"helmet"),this.addSpriteTouchEvent(this.clothes,"clothes"),this.addSpriteTouchEvent(this.trousers,"trousers"),this.addSpriteTouchEvent(this.gloves,"gloves"),this.addSpriteTouchEvent(this.shoes,"shoes"),this.addSpriteTouchEvent(this.cloak,"cloak"),this.refreshEquipment(this.inventoryManager.weapon,!1),this.refreshEquipment(this.inventoryManager.remote,!1),this.refreshEquipment(this.inventoryManager.helmet,!1),this.refreshEquipment(this.inventoryManager.clothes,!1),this.refreshEquipment(this.inventoryManager.trousers,!1),this.refreshEquipment(this.inventoryManager.gloves,!1),this.refreshEquipment(this.inventoryManager.shoes,!1),this.refreshEquipment(this.inventoryManager.cloak,!1),this.refreshItemRes()},e.prototype.addSpriteTouchEvent=function(t,e){var o=this;t.node.parent.on(cc.Node.EventType.TOUCH_START,function(){if(null!=t.spriteFrame){var i=new h.default;switch(e){case"weapon":i=o.inventoryManager.weapon.clone();break;case"remote":i=o.inventoryManager.remote.clone();break;case"helmet":i=o.inventoryManager.helmet.clone();break;case"clothes":i=o.inventoryManager.clothes.clone();break;case"trousers":i=o.inventoryManager.trousers.clone();break;case"gloves":i=o.inventoryManager.gloves.clone();break;case"shoes":i=o.inventoryManager.shoes.clone();break;case"cloak":i=o.inventoryManager.cloak.clone()}o.equipmentDialog.refreshDialog(i),o.equipmentDialog.showDialog()}}),t.node.parent.on(cc.Node.EventType.TOUCH_END,function(){o.equipmentDialog.hideDialog()}),t.node.parent.on(cc.Node.EventType.TOUCH_CANCEL,function(){o.equipmentDialog.hideDialog()})},e.prototype.select=function(t,e){var o=parseInt(e);this.tabselect.y=64*o;t.currentTarget},e.prototype.setEquipment=function(t,e,o){if(e.equipmetType==t.equipmetType){var i=this.dungeon.player.getComponent(u.default).pos.clone();i.y<1?i.y+=1:i.y-=1,o&&cc.director.emit(c.EventConstant.DUNGEON_SETEQUIPMENT,{detail:{pos:i,equipmentData:e}})}},e.prototype.refreshEquipment=function(t,e){if(t&&this.weapon){var o=cc.color(255,255,255).fromHEX(t.color),i=l.default.spriteFrames[t.img];switch(t.equipmetType){case"weapon":this.weapon.spriteFrame=i,this.weapon.node.color=o,this.setEquipment(t,this.inventoryManager.weapon,e),this.inventoryManager.weapon.valueCopy(t);break;case"remote":this.remote.spriteFrame=i,this.remote.node.color=o,this.setEquipment(t,this.inventoryManager.remote,e),this.inventoryManager.remote.valueCopy(t);break;case"helmet":this.helmet.spriteFrame=i,this.helmet.node.color=o,this.setEquipment(t,this.inventoryManager.helmet,e),this.inventoryManager.helmet.valueCopy(t);break;case"clothes":this.clothes.spriteFrame=i,this.clothes.node.color=o,this.setEquipment(t,this.inventoryManager.clothes,e),this.inventoryManager.clothes.valueCopy(t);break;case"trousers":this.trousers.spriteFrame=1==t.trouserslong?l.default.spriteFrames.trousers000:i,this.trousers.node.color=o,this.setEquipment(t,this.inventoryManager.trousers,e),this.inventoryManager.trousers.valueCopy(t);break;case"gloves":this.gloves.spriteFrame=i,this.gloves.node.color=o,this.setEquipment(t,this.inventoryManager.gloves,e),this.inventoryManager.gloves.valueCopy(t);break;case"shoes":this.shoes.spriteFrame=i,this.shoes.node.color=o,this.setEquipment(t,this.inventoryManager.shoes,e),this.inventoryManager.shoes.valueCopy(t);break;case"cloak":this.cloak.spriteFrame=i,this.cloak.node.color=o,this.setEquipment(t,this.inventoryManager.cloak,e),this.inventoryManager.cloak.valueCopy(t)}this.dungeon.player&&(this.dungeon.player.getComponent(u.default).inventoryManager=this.inventoryManager,this.dungeon.player.getComponent(u.default).changeEquipment(t,i),t.statusInterval>0&&t.statusName.length>0&&this.dungeon.player.addStatus(t.statusName,f.default.getClone(t.nameCn,t.img)))}},e.prototype.addPlayerStatus=function(t){this.dungeon&&this.dungeon.player&&t.statusInterval>0&&t.statusName.length>0&&this.dungeon.player.addStatus(t.statusName,f.default.getClone(t.nameCn,t.img))},e.prototype.getTimeDelay=function(t,e,o){return(t+=o)>e?t=0:t},e.prototype.isTimeDelay=function(t,e){var o=-1;switch(e.equipmetType){case"weapon":this.weaponTimeDelay=this.getTimeDelay(this.weaponTimeDelay,e.statusInterval,t),o=this.weaponTimeDelay;break;case"remote":this.remoteTimeDelay=this.getTimeDelay(this.remoteTimeDelay,e.statusInterval,t),o=this.remoteTimeDelay;break;case"helmet":this.helmetTimeDelay=this.getTimeDelay(this.helmetTimeDelay,e.statusInterval,t),o=this.helmetTimeDelay;break;case"clothes":this.clothesTimeDelay=this.getTimeDelay(this.clothesTimeDelay,e.statusInterval,t),o=this.clothesTimeDelay;break;case"trousers":this.trousersTimeDelay=this.getTimeDelay(this.trousersTimeDelay,e.statusInterval,t),o=this.trousersTimeDelay;break;case"gloves":this.glovesTimeDelay=this.getTimeDelay(this.glovesTimeDelay,e.statusInterval,t),o=this.glovesTimeDelay;break;case"shoes":this.shoesTimeDelay=this.getTimeDelay(this.shoesTimeDelay,e.statusInterval,t),o=this.shoesTimeDelay;break;case"cloak":this.cloakTimeDelay=this.getTimeDelay(this.cloakTimeDelay,e.statusInterval,t),o=this.cloakTimeDelay}return 0==o},e.prototype.update=function(t){this.isTimeDelay(t,this.inventoryManager.weapon)&&this.addPlayerStatus(this.inventoryManager.weapon),this.isTimeDelay(t,this.inventoryManager.remote)&&this.addPlayerStatus(this.inventoryManager.remote),this.isTimeDelay(t,this.inventoryManager.helmet)&&this.addPlayerStatus(this.inventoryManager.helmet),this.isTimeDelay(t,this.inventoryManager.clothes)&&this.addPlayerStatus(this.inventoryManager.clothes),this.isTimeDelay(t,this.inventoryManager.trousers)&&this.addPlayerStatus(this.inventoryManager.trousers),this.isTimeDelay(t,this.inventoryManager.gloves)&&this.addPlayerStatus(this.inventoryManager.gloves),this.isTimeDelay(t,this.inventoryManager.shoes)&&this.addPlayerStatus(this.inventoryManager.shoes),this.isTimeDelay(t,this.inventoryManager.cloak)&&this.addPlayerStatus(this.inventoryManager.cloak)},e.prototype.userItem=function(t,e){var o=this.inventoryManager.itemList[e].clone();this.inventoryManager.itemList[e].valueCopy(l.default.items[m.default.EMPTY]),this.refreshItemRes(),cc.director.emit(c.EventConstant.PLAYER_USEITEM,{detail:{itemData:o}})},e.prototype.refreshItem=function(t){if(this.node){for(var e=!1,o=0;o<this.inventoryManager.itemList.length;o++){var i=this.inventoryManager.itemList[o];if(i.resName==m.default.EMPTY){i.valueCopy(t),e=!0;break}}if(!e){var a=this.inventoryManager.itemList[0].clone(),n=this.inventoryManager.itemList[1].clone(),s=this.inventoryManager.itemList[2].clone();this.inventoryManager.itemList[0].valueCopy(n),this.inventoryManager.itemList[1].valueCopy(s),this.inventoryManager.itemList[2].valueCopy(t),this.setItem(a)}this.refreshItemRes()}},e.prototype.refreshItemRes=function(){for(var t=[this.item1,this.item2,this.item3],e=0;e<t.length;e++){var o=this.inventoryManager.itemList[e];t[e].spriteFrame=l.default.spriteFrames[o.resName]}},e.prototype.setItem=function(t){var e=this.dungeon.player.pos.clone();e.x<1||(e.x-=1),t.resName!=m.default.EMPTY&&cc.director.emit(c.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:d.default.getPosInMap(e),res:t.resName}})},a([r(cc.Node)],e.prototype,"tabselect",void 0),a([r(d.default)],e.prototype,"dungeon",void 0),a([r(cc.Sprite)],e.prototype,"weapon",void 0),a([r(cc.Sprite)],e.prototype,"remote",void 0),a([r(cc.Sprite)],e.prototype,"helmet",void 0),a([r(cc.Sprite)],e.prototype,"clothes",void 0),a([r(cc.Sprite)],e.prototype,"trousers",void 0),a([r(cc.Sprite)],e.prototype,"gloves",void 0),a([r(cc.Sprite)],e.prototype,"shoes",void 0),a([r(cc.Sprite)],e.prototype,"cloak",void 0),a([r(cc.Sprite)],e.prototype,"item1",void 0),a([r(cc.Sprite)],e.prototype,"item2",void 0),a([r(cc.Sprite)],e.prototype,"item3",void 0),a([r(p.default)],e.prototype,"equipmentDialog",void 0),a([r(p.default)],e.prototype,"equipmentGroundDialog",void 0),e=a([s],e)}(cc.Component);o.default=g,cc._RF.pop()},{"./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./Dungeon":"Dungeon","./Equipment/EquipmentDialog":"EquipmentDialog","./EventConstant":"EventConstant","./Item/Item":"Item","./Logic":"Logic","./Player":"Player"}],ItemData:[function(t,e,o){"use strict";cc._RF.push(e,"371e21tzPlAtY0KmtggGqZV","ItemData");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(o,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uuid="",e.pos=cc.v2(0,0),e.nameCn="",e.nameEn="",e.duration=0,e.desc="",e.info="",e.resName="emptyitem",e.price=0,e.isTaken=!1,e.canSave=0,e}return i(e,t),e.prototype.valueCopy=function(t){this.uuid=t.uuid?t.uuid:"",this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn,this.duration=t.duration,this.resName=t.resName?t.resName:"emptyitem",this.info=t.info?t.info:"",this.desc=t.desc?t.desc:"",this.isTaken=!!t.isTaken&&t.isTaken,this.canSave=t.canSave?t.canSave:0,this.price=t.price?t.price:0},e.prototype.clone=function(){var t=new e;return t.uuid=this.uuid,t.pos=this.pos,t.nameCn=this.nameCn,t.nameEn=this.nameEn,t.duration=this.duration,t.info=this.info,t.desc=this.desc,t.resName=this.resName,t.isTaken=this.isTaken,t.canSave=this.canSave,t.price=this.price,t},e}(t("./BaseData").default);o.default=a,cc._RF.pop()},{"./BaseData":"BaseData"}],ItemDialog:[function(t,e,o){"use strict";cc._RF.push(e,"7261ctkcr1Hb5jd00yv55ME","ItemDialog");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelTitle=null,e.infoBase=null,e.infoDesc=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.node.opacity=0},e.prototype.refreshDialog=function(t){this.labelTitle.string=t.nameCn,this.infoBase.string=t.info,this.infoDesc.string=t.desc},e.prototype.showDialog=function(){this.node.opacity=255},e.prototype.hideDialog=function(){this.node.opacity=0},a([r(cc.Label)],e.prototype,"labelTitle",void 0),a([r(cc.Label)],e.prototype,"infoBase",void 0),a([r(cc.Label)],e.prototype,"infoDesc",void 0),e=a([s],e)}(cc.Component);o.default=c,cc._RF.pop()},{}],Item:[function(t,e,o){"use strict";cc._RF.push(e,"ce4de5SY9BKg5Ay5wKpP9r7","Item");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("../Player"),r=t("../Logic"),c=t("../Data/ItemData"),l=t("../Manager/StatusManager"),h=t("../Utils/AudioPlayer"),u=t("../Data/FromData"),p=t("./ItemDialog"),d=cc._decorator,f=d.ccclass,m=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new c.default,e.itemDialog=null,e}var o;return i(e,t),o=e,e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.init=function(t,e,o){this.data.valueCopy(r.default.items[t]),this.data.uuid=this.data.genNonDuplicateID(),this.data.pos=e,o&&(this.shopTable=o,o.data.itemdata=new c.default,o.data.itemdata.valueCopy(r.default.items[t]),o.data.price=this.data.price);var i=r.default.spriteFrames[this.data.resName];if(i){var a=this.node.getChildByName("sprite").getComponent(cc.Sprite);this.node.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=i,a.node.width=2*i.getRect().width,a.node.height=2*i.getRect().height}this.itemDialog.refreshDialog(this.data)},e.prototype.taken=function(t){var e=this;!this.data.isTaken&&this.anim&&(cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:h.default.PICK_ITEM}}),this.anim.play("ItemTaken"),this.data.isTaken=!0,this.data.canSave<1?o.userIt(this.data,t):cc.director.emit(n.EventConstant.PLAYER_CHANGEITEM,{detail:{itemData:this.data}}),this.scheduleOnce(function(){e.node&&(e.node.active=!1)},3));var i=r.default.mapManager.getCurrentMapItems(),a=new Array;if(i)for(var s=0,c=i;s<c.length;s++){var l=c[s];l.uuid&&l.uuid!=this.data.uuid&&a.push(l)}r.default.mapManager.setCurrentItemsArr(a),this.itemDialog.node.active=!1},e.userIt=function(t,e){var i=u.default.getClone(t.nameCn,t.resName);switch(t.resName){case o.HEART:e.addStatus(l.default.HEALING,i);break;case o.BOTTLE_HEALING:e.addStatus(l.default.BOTTLE_HEALING,i);break;case o.BOTTLE_MOVESPEED:e.addStatus(l.default.FASTMOVE,i);break;case o.BOTTLE_ATTACKSPEED:e.addStatus(l.default.FASTATTACK,i);break;case o.AMMO:r.default.ammo+=30;break;case o.REDCAPSULE:e.addStatus(l.default.FASTATTACK,i);break;case o.BLUECAPSULE:e.addStatus(l.default.FASTMOVE,i);break;case o.SHIELD:e.addStatus(l.default.PERFECTDEFENCE,i);break;case o.GOLDAPPLE:e.addStatus(l.default.GOLDAPPLE,i)}},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(s.default);o&&(this.data.canSave?this.itemDialog.showDialog():this.taken(o))},e.prototype.onCollisionExit=function(t,e){t.node.getComponent(s.default)&&this.itemDialog.hideDialog()},e.EMPTY="emptyitem",e.HEART="heart",e.BOTTLE_HEALING="bottle001",e.BOTTLE_MOVESPEED="bottle002",e.BOTTLE_ATTACKSPEED="bottle003",e.AMMO="ammo",e.REDCAPSULE="redcapsule",e.BLUECAPSULE="bluecapsule",e.SHIELD="shield",e.GOLDAPPLE="goldapple",a([m(p.default)],e.prototype,"itemDialog",void 0),e=o=a([f],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../Data/FromData":"FromData","../Data/ItemData":"ItemData","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./ItemDialog":"ItemDialog"}],JoyController:[function(t,e,o){"use strict";cc._RF.push(e,"246e3R5w7RM/68kAxSEZZAX","JoyController");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anglePreDirQuadrant=23,e.fixedPoint=null,e.movePoint=null,e.movePointMoveRadius=100,e.timeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.touchArea=new cc.Vec2(t.width,t.height),this.fixedPointMoveCenterPos=cc.v2(0,0),this.fixedPointMoveRadius=this.touchArea.x/2-this.movePointMoveRadius,this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(-1==this.touchID){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var i=this.clampPos(o,this.fixedPointMoveCenterPos,this.fixedPointMoveRadius);this.movePointMoveCenterPos=i,this.setFixedPointPos(i),this.touchID=t.getID()}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.touchID==t.getID()){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var i=this.clampPos(o,this.movePointMoveCenterPos,this.movePointMoveRadius);console.log(i),this.setMovePointPos(i)}},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){this.init(),cc.director.emit(n.EventConstant.PLAYER_ATTACK)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){this.init(),cc.director.emit(n.EventConstant.PLAYER_ATTACK)},this),this.init()},e.prototype.init=function(){this.touchID=-1,this.joystickInputDir=new cc.Vec2,this.setFixedPointPos(this.fixedPointMoveCenterPos),this.setMovePointPos(this.fixedPointMoveCenterPos)},e.prototype.setFixedPointPos=function(t){this.fixedPoint.setPosition(cc.v2(0,0))},e.prototype.getFixedPointPos=function(){return this.fixedPoint.getPosition()},e.prototype.setMovePointPos=function(t){this.movePoint.setPosition(t)},e.prototype.getMovePointPos=function(){return this.movePoint.getPosition()},e.prototype.clampPos=function(t,e,o){var i=t.sub(e);return i.mag()>o?i.normalize().mul(o).add(e):t},e.prototype.getInputDir=function(){var t=this.movePoint.getPosition().sub(this.fixedPoint.getPosition());return t.mag()>0&&t.normalizeSelf(),t},e.prototype.getInputQuadrantDir=function(){return this.getVec2ByQuadrant(this.getDirQuadrant(this.getInputDir()))},e.prototype.getDirQuadrant=function(t){var e=null;return t.mag()>0&&(e=Math.floor(this.getAngleByVec2(t)/this.anglePreDirQuadrant)),e},e.prototype.getAngleByVec2=function(t){return 180*-Math.atan2(t.y,t.x)/Math.PI+this.anglePreDirQuadrant/2},e.prototype.getVec2ByAngle=function(t){var e=new cc.Vec2,o=(this.anglePreDirQuadrant/2-t)*(Math.PI/180);return e.x=Math.cos(o),e.y=Math.sin(o),e.normalizeSelf()},e.prototype.getVec2ByQuadrant=function(t){if(null!=t){var e=t*this.anglePreDirQuadrant;return e+=this.anglePreDirQuadrant/2,this.getVec2ByAngle(e)}return cc.Vec2.ZERO},e.prototype.sendMoveMessageToPlayer=function(t){var e=this.getInputQuadrantDir(),o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3));var i=this.getInputDir();cc.director.emit(n.EventConstant.PLAYER_ROTATE,{detail:{dir:o,pos:i,dt:t}})},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},a([c(cc.Integer)],e.prototype,"anglePreDirQuadrant",void 0),a([c(cc.Node)],e.prototype,"fixedPoint",void 0),a([c(cc.Node)],e.prototype,"movePoint",void 0),a([c],e.prototype,"movePointMoveRadius",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant"}],Joystick:[function(t,e,o){"use strict";cc._RF.push(e,"a3868eVgi9Ewpbgxpufia3p","Joystick");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anglePreDirQuadrant=23,e.fixedPoint=null,e.movePoint=null,e.movePointMoveRadius=100,e.stopCount=0,e.timeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.touchArea=new cc.Vec2(t.width,t.height),this.fixedPointMoveCenterPos=this.touchArea.div(0,this.touchArea),this.fixedPointMoveRadius=this.touchArea.x/2-this.movePointMoveRadius,this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(-1==this.touchID){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var i=this.clampPos(o,this.fixedPointMoveCenterPos,this.fixedPointMoveRadius);this.movePointMoveCenterPos=i,this.setFixedPointPos(i),this.setMovePointPos(i),this.touchID=t.getID()}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.touchID==t.getID()){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var i=this.clampPos(o,this.movePointMoveCenterPos,this.movePointMoveRadius);this.setMovePointPos(i)}},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){this.init()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){this.init()},this),this.init()},e.prototype.init=function(){this.touchID=-1,this.joystickInputDir=new cc.Vec2,this.setFixedPointPos(this.fixedPointMoveCenterPos),this.setMovePointPos(this.fixedPointMoveCenterPos)},e.prototype.setFixedPointPos=function(t){this.fixedPoint.setPosition(t)},e.prototype.getFixedPointPos=function(){return this.fixedPoint.getPosition()},e.prototype.setMovePointPos=function(t){this.movePoint.setPosition(t)},e.prototype.getMovePointPos=function(){return this.movePoint.getPosition()},e.prototype.clampPos=function(t,e,o){var i=t.sub(e);return i.mag()>o?i.normalize().mul(o).add(e):t},e.prototype.getInputDir=function(){var t=this.movePoint.getPosition().sub(this.fixedPoint.getPosition());return(isNaN(t.x)||isNaN(t.y))&&(t=cc.v2(0,0)),t.mag()>0&&t.normalizeSelf(),t},e.prototype.getInputQuadrantDir=function(){return this.getVec2ByQuadrant(this.getDirQuadrant(this.getInputDir()))},e.prototype.getDirQuadrant=function(t){var e=null;return t.mag()>0&&(e=Math.floor(this.getAngleByVec2(t)/this.anglePreDirQuadrant)),e},e.prototype.getAngleByVec2=function(t){return 180*-Math.atan2(t.y,t.x)/Math.PI+this.anglePreDirQuadrant/2},e.prototype.getVec2ByAngle=function(t){var e=new cc.Vec2,o=(this.anglePreDirQuadrant/2-t)*(Math.PI/180);return e.x=Math.cos(o),e.y=Math.sin(o),e.normalizeSelf()},e.prototype.getVec2ByQuadrant=function(t){if(null!=t){var e=t*this.anglePreDirQuadrant;return e+=this.anglePreDirQuadrant/2,this.getVec2ByAngle(e)}return cc.Vec2.ZERO},e.prototype.sendMoveMessageToPlayer=function(t){var e=this.getInputQuadrantDir(),o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3));var i=this.getInputDir();i.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(n.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:i,dt:t}})},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},a([c(cc.Integer)],e.prototype,"anglePreDirQuadrant",void 0),a([c(cc.Node)],e.prototype,"fixedPoint",void 0),a([c(cc.Node)],e.prototype,"movePoint",void 0),a([c],e.prototype,"movePointMoveRadius",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant"}],KeyboardController:[function(t,e,o){"use strict";cc._RF.push(e,"b57f7ePcl9JD6/oAh/+vpUg","KeyboardController");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopCount=0,e.isUp=!1,e.isDown=!1,e.isLeft=!1,e.isRight=!1,e.isA=!1,e.isB=!1,e.isC=!1,e.isD=!1,e.timeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!0;break;case cc.macro.KEY.s:this.isDown=!0;break;case cc.macro.KEY.a:this.isLeft=!0;break;case cc.macro.KEY.d:this.isRight=!0;break;case cc.macro.KEY.j:this.isA=!0;break;case cc.macro.KEY.k:this.isB=!0;break;case cc.macro.KEY.i:this.isC=!0;break;case cc.macro.KEY.l:this.isD=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!1;break;case cc.macro.KEY.s:this.isDown=!1;break;case cc.macro.KEY.a:this.isLeft=!1;break;case cc.macro.KEY.d:this.isRight=!1;break;case cc.macro.KEY.j:this.isA=!1;break;case cc.macro.KEY.k:this.isB=!1;break;case cc.macro.KEY.i:this.isC=!1;break;case cc.macro.KEY.l:this.isD=!1}},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},e.prototype.sendMoveMessageToPlayer=function(t){var e=cc.v2(0,0);this.isUp&&e.addSelf(cc.v2(0,.9)),this.isDown&&e.addSelf(cc.v2(0,-.9)),this.isLeft&&e.addSelf(cc.v2(-.9,0)),this.isRight&&e.addSelf(cc.v2(.9,0)),e.mag()>0&&e.normalizeSelf();var o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3)),e.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(n.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:e,dt:t}}),this.isA&&cc.director.emit(n.EventConstant.PLAYER_ATTACK),this.isB&&cc.director.emit(n.EventConstant.PLAYER_REMOTEATTACK),this.isC&&cc.director.emit(n.EventConstant.PLAYER_TRIGGER),this.isD&&cc.director.emit(n.EventConstant.PLAYER_SKILL)},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e=a([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{"./EventConstant":"EventConstant"}],KrakenSwingHand:[function(t,e,o){"use strict";cc._RF.push(e,"15ea4rtPQxD8pcJLX7yPozV","KrakenSwingHand");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("../Player"),r=t("../Data/DamageData"),c=t("../Data/FromData"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=2,e.isShow=!1,e}return i(e,t),e.prototype.onLoad=function(){this.anim=this.node.parent.getComponent(cc.Animation)},e.prototype.swing=function(){this.anim.play()},e.prototype.start=function(){this.isShow=!1},e.prototype.onCollisionEnter=function(t,e){if(t.node.getComponent(s.default)&&this.isShow&&this.node.active){this.node.stopAllActions();var o=new r.default;o.physicalDamage=this.damage,cc.director.emit(n.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:o,from:c.default.getClone(this.actorName(),"boss001")}})}},e.prototype.actorName=function(){return"\u6d77\u5996"},a([u],e.prototype,"damage",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Player":"Player"}],Kraken:[function(t,e,o){"use strict";cc._RF.push(e,"cbbb1U+Yy5Jtb8PV4hyvH/c","Kraken");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Shooter"),s=t("../EventConstant"),r=t("./KrakenSwingHand"),c=t("../Dungeon"),l=t("../Logic"),h=t("./Boss"),u=t("../Utils/Skill"),p=t("../Utils/AudioPlayer"),d=t("../Data/FromData"),f=t("../Achievement"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.swingHand=null,e.timeDelay=0,e.remoteSkill=new u.default,e.handSkill=new u.default,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.shooter=this.getComponentInChildren(n.default),this.shooter.from.valueCopy(d.default.getClone(this.actorName(),"boss001")),this.anim=this.getComponent(cc.Animation)},e.prototype.ShowFinish=function(){this.anim.play("KrakenHeadIdle"),this.isShow=!0;var t=c.default.getPosInMap(cc.v2(c.default.WIDTH_SIZE+4,-10)),e=c.default.getPosInMap(cc.v2(-4,-10));this.hand01=this.addHand(t,!0),this.hand02=this.addHand(e,!1)},e.prototype.addHand=function(t,e){var o=cc.instantiate(this.swingHand);this.dungeon.node.addChild(o),o.setPosition(t),o.scaleX=e?-50:50,o.scaleY=-50,o.zIndex=5e3;var i=o.getComponentInChildren(r.default);return this.scheduleOnce(function(){i.isShow=!0},2),i},e.prototype.updatePlayerPos=function(){var t=c.default.getPosInMap(cc.v2(c.default.WIDTH_SIZE/2,c.default.HEIGHT_SIZE+4));this.node.setPosition(t)},e.prototype.changeZIndex=function(){this.node.zIndex=101},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:p.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;if(!this.isDied){f.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.changeZIndex();for(var e=0,o=this.getComponentsInChildren(r.default);e<o.length;e++){o[e].isShow=!1}this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot()}},e.prototype.showBoss=function(){this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied),this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("KrakenHeadShow")},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.label&&(this.label.string=""+this.node.zIndex),this.healthBar.node.active=!this.isDied},e.prototype.bossAction=function(){var t=this;!this.isDied&&this.isShow&&this.dungeon&&(this.hand01&&(this.hand01.node.parent.y=l.default.lerp(this.hand01.node.y,this.dungeon.player.node.y,.1)),this.hand02&&(this.hand02.node.parent.y=l.default.lerp(this.hand02.node.y,this.dungeon.player.node.y,.1)),this.shooter&&this.remoteSkill.next(function(){t.shooter.skipTopwall=!0;var e=t.node.position.clone().add(t.shooter.node.position),o=t.dungeon.player.getCenterPosition().sub(e);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),t.shooter.setHv(o),t.shooter.dungeon=t.dungeon,t.shooter.data.bulletType="bullet004",t.shooter.fireBullet(),t.shooter.fireBullet(30),t.shooter.fireBullet(-30)),t.data.currentHealth<t.data.Common.maxHealth/2&&(t.dungeon.addFallStone(t.dungeon.player.node.position,!0),t.shooter.fireBullet(30),t.shooter.fireBullet(-30),t.shooter.fireBullet(15),t.shooter.fireBullet(-15))},2),this.handSkill.next(function(){t.dungeon.player.pos.x>c.default.WIDTH_SIZE/2?t.hand01&&t.hand01.swing():t.hand02&&t.hand02.swing()},10))},e.prototype.actorName=function(){return"\u6d77\u5996"},a([y(cc.Label)],e.prototype,"label",void 0),a([y(cc.Prefab)],e.prototype,"swingHand",void 0),e=a([g],e)}(h.default);o.default=v,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss","./KrakenSwingHand":"KrakenSwingHand"}],LevelManager:[function(t,e,o){"use strict";cc._RF.push(e,"3e292AShLdPYabPsUR5SDk6","LevelManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.level=0,this.chapter=t.CHAPTER00}return t.prototype.init=function(){},t.CHAPTER00="chapter00",t.CHAPTER01="chapter01",t.CHAPTER02="chapter02",t.CHAPTER03="chapter03",t.CHAPTER04="chapter04",t}();o.default=i,cc._RF.pop()},{}],Loading:[function(t,e,o){"use strict";cc._RF.push(e,"a2246gAT5JKc4YhD10URG7K","Loading");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./UI/TalentTree"),r=t("./UI/CutScene"),c=t("./EventConstant"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.simpleTree=null,e.shieldTree=null,e.dashTree=null,e.magicTree=null,e.talentInfo=null,e.confirmButton=null,e.cutScene=null,e.timeDelay=0,e.isEquipmentLoaded=!1,e.isMonsterLoaded=!1,e.isLevelLoaded=!1,e.isSpriteFramesLoaded=!1,e.isDebuffsLoaded=!1,e.isBulletsLoaded=!1,e.isItemsLoaded=!1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.simpleTree.node.active=!1,this.shieldTree.node.active=!1,this.dashTree.node.active=!1,this.magicTree.node.active=!1,this.talentInfo.active=!1,this.label.node.setPosition(cc.v2(0,0)),this.confirmButton.interactable=!1,cc.director.on(c.EventConstant.TALENT_TREE_SELECT,function(e){t.node&&(t.confirmButton.interactable=!0)})},e.prototype.confirmTalent=function(){this.simpleTree.node.active?this.simpleTree.talentClick():this.dashTree.node.active?this.dashTree.talentClick():this.shieldTree.node.active?this.shieldTree.talentClick():this.magicTree.node.active&&this.magicTree.talentClick()},e.prototype.showTalentPick=function(){if(n.default.isPickedTalent||!this.isTalentLevel())return this.simpleTree.node.active=!1,this.shieldTree.node.active=!1,this.dashTree.node.active=!1,this.magicTree.node.active=!1,this.talentInfo.active=!1,!0;this.talentInfo.active=!0,n.default.talentList.length<1&&(this.simpleTree.node.active=!0),n.default.talentList.length>=1&&(this.simpleTree.node.active=!1,n.default.talentList[0].id<2000001?this.dashTree.node.active=!0:n.default.talentList[0].id<3000001?this.shieldTree.node.active=!0:n.default.talentList[0].id<4000001&&(this.magicTree.node.active=!0)),this.label.node.setPosition(cc.v2(0,320)),n.default.talentList.length>9&&(this.simpleTree.node.active=!1,this.shieldTree.node.active=!1,this.dashTree.node.active=!1,this.magicTree.node.active=!1)},e.prototype.isTalentLevel=function(){return 1==n.default.level||4==n.default.level},e.prototype.isPickedTalent=function(){if(n.default.isPickedTalent)return!0;if(this.isTalentLevel()){var t=!1;return this.simpleTree.node.active&&this.simpleTree.hasPicked&&(t=!0),this.dashTree.node.active&&this.dashTree.hasPicked&&(t=!0),this.shieldTree.node.active&&this.shieldTree.hasPicked&&(t=!0),this.magicTree.node.active&&this.magicTree.hasPicked&&(t=!0),this.simpleTree.node.active||this.dashTree.node.active||this.shieldTree.node.active||this.magicTree.node.active||(t=!0),t}return!0},e.prototype.start=function(){this.label.string="Level "+(n.default.chapterName+1)+"-"+n.default.level,0==n.default.level&&(this.label.string="\u6df1\u9677\u5730\u7262"),this.isLevelLoaded=!1,this.isEquipmentLoaded=!1,this.isMonsterLoaded=!1,this.isDebuffsLoaded=!1,this.loadMap(),this.loadEquipment(),this.loadSpriteFrames(),this.loadMonsters(),this.loadDebuffs(),this.loadBullets(),this.loadItems(),1==n.default.isFirst&&(this.cutScene.isSkip=!0,this.cutScene.unregisterClick())},e.prototype.loadMap=function(){n.default.mapManager.isloaded=!1,n.default.mapManager.loadMap()},e.prototype.loadEquipment=function(){var t=this;n.default.equipments?this.isEquipmentLoaded=!0:cc.loader.loadRes("Data/equipment",function(e,o){if(e)cc.error(e);else for(var i in n.default.equipments=o.json,t.isEquipmentLoaded=!0,cc.log("equipment loaded"),n.default.equipmentNameList=new Array,o.json)n.default.equipmentNameList.push(i)})},e.prototype.loadDebuffs=function(){var t=this;n.default.debuffs?this.isDebuffsLoaded=!0:cc.loader.loadRes("Data/status",function(e,o){e?cc.error(e):(n.default.debuffs=o.json,t.isDebuffsLoaded=!0,cc.log("debuffs loaded"))})},e.prototype.loadBullets=function(){var t=this;n.default.bullets?this.isBulletsLoaded=!0:cc.loader.loadRes("Data/bullet",function(e,o){e?cc.error(e):(n.default.bullets=o.json,t.isBulletsLoaded=!0,cc.log("bullets loaded"))})},e.prototype.loadMonsters=function(){var t=this;n.default.monsters?this.isMonsterLoaded=!0:cc.loader.loadRes("Data/monsters",function(e,o){e?cc.error(e):(n.default.monsters=o.json,t.isMonsterLoaded=!0,cc.log("monsters loaded"))})},e.prototype.loadItems=function(){var t=this;n.default.items?this.isItemsLoaded=!0:cc.loader.loadRes("Data/item",function(e,o){if(e)cc.error(e);else{for(var i in n.default.items=o.json,n.default.itemNameList=new Array,o.json)n.default.items[i].canSave&&n.default.itemNameList.push(i);t.isItemsLoaded=!0,cc.log("items loaded")}})},e.prototype.loadSpriteFrames=function(){var t=this;if(n.default.spriteFrames)return this.isSpriteFramesLoaded=!0,void this.showTalentPick();cc.loader.loadResDir("Texture",cc.SpriteFrame,function(e,o){n.default.spriteFrames={};for(var i=0,a=o;i<a.length;i++){var s=a[i];n.default.spriteFrames[s.name]=s}t.isSpriteFramesLoaded=!0,t.showTalentPick(),cc.log("texture loaded")})},e.prototype.showCut=function(){this.isSpriteFramesLoaded&&1!=n.default.isFirst&&(n.default.isFirst=1,this.cutScene.playShow())},e.prototype.update=function(t){this.timeDelay+=t,this.isLevelLoaded=n.default.mapManager.isloaded,this.showCut(),this.timeDelay>.16&&this.isLevelLoaded&&this.isEquipmentLoaded&&this.isSpriteFramesLoaded&&this.isMonsterLoaded&&this.isDebuffsLoaded&&this.isBulletsLoaded&&this.isItemsLoaded&&this.isPickedTalent()&&this.cutScene.isSkip&&(this.timeDelay=0,this.cutScene.unregisterClick(),this.isLevelLoaded=!1,this.isEquipmentLoaded=!1,this.isSpriteFramesLoaded=!1,this.isDebuffsLoaded=!1,this.isBulletsLoaded=!1,this.isItemsLoaded=!1,cc.director.loadScene("game"))},a([u(cc.Label)],e.prototype,"label",void 0),a([u(s.default)],e.prototype,"simpleTree",void 0),a([u(s.default)],e.prototype,"shieldTree",void 0),a([u(s.default)],e.prototype,"dashTree",void 0),a([u(s.default)],e.prototype,"magicTree",void 0),a([u(cc.Node)],e.prototype,"talentInfo",void 0),a([u(cc.Button)],e.prototype,"confirmButton",void 0),a([u(r.default)],e.prototype,"cutScene",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./UI/CutScene":"CutScene","./UI/TalentTree":"TalentTree"}],Logic:[function(t,e,o){"use strict";cc._RF.push(e,"2225fYJ0sRMTZjuD7WFmbVi","Logic");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Data/PlayerData"),s=t("./EventConstant"),r=t("./Manager/MapManager"),c=t("./Dungeon"),l=t("./Manager/InventoryManager"),h=t("./Utils/Random"),u=t("./Data/TalentData"),p=t("./Manager/ProfileManager"),d=t("./Utils/AudioPlayer"),f=t("./Data/FromData"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.game.setFrameRate(60),cc.game.addPersistRootNode(this.node),cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0,cc.director.on(s.EventConstant.LOADINGNEXTLEVEL,function(e){t.loadingNextLevel()}),cc.director.on(s.EventConstant.LOADINGROOM,function(e){t.loadingNextRoom(e.detail.dir)})},e.prototype.start=function(){},e.saveData=function(){o.profileManager.data.playerData=o.playerData.clone(),o.profileManager.data.playerEquipList=o.inventoryManager.list,o.profileManager.data.playerItemList=o.inventoryManager.itemList,o.profileManager.saveData(),cc.sys.localStorage.setItem("coin",o.coins)},e.resetData=function(t){o.time="00:00:00",o.profileManager.data.chapterName=t||o.profileManager.data.chapterName,o.chapterName=o.profileManager.data.chapterName,o.level=o.profileManager.data.level,o.playerData=o.profileManager.data.playerData.clone(),o.inventoryManager=new l.default;for(var e=0;e<o.profileManager.data.playerEquipList.length;e++)o.inventoryManager.list[e].valueCopy(o.profileManager.data.playerEquipList[e]);for(e=0;e<o.profileManager.data.playerItemList.length;e++)o.inventoryManager.itemList[e].valueCopy(o.profileManager.data.playerItemList[e]);o.talentList=o.profileManager.data.talentList,o.initTalentMap(),o.ammo=o.profileManager.data.ammo,o.mapManager.reset(o.level),c.default.WIDTH_SIZE=15,c.default.HEIGHT_SIZE=9;var i=cc.sys.localStorage.getItem("coin");o.coins=i?parseInt(i):0,o.isPickedTalent=!1},e.initTalentMap=function(){o.hasTalentMap={};for(var t=0,e=o.talentList;t<e.length;t++){var i=e[t];o.hasTalentMap[i.id]=!0}},e.addTalent=function(t){var e=new u.default;e.id=t;for(var i=!1,a=0,n=o.talentList;a<n.length;a++){t==n[a].id&&(i=!0)}return!i&&(o.talentList.push(e),o.hasTalentMap[e.id]=!0,o.isPickedTalent=!0,!0)},e.hashTalent=function(t){return o.hasTalentMap[t]&&1==o.hasTalentMap[t]},e.changeDungeonSize=function(){var t=o.mapManager.getCurrentMapSize();t&&(c.default.WIDTH_SIZE=t.x,c.default.HEIGHT_SIZE=t.y)},e.prototype.loadingNextRoom=function(t){if(o.mapManager.loadingNextRoom(t)){switch(o.changeDungeonSize(),t){case 0:o.playerData.pos=cc.v2(Math.round(c.default.WIDTH_SIZE/2-1),0);break;case 1:o.playerData.pos=cc.v2(Math.round(c.default.WIDTH_SIZE/2-1),c.default.HEIGHT_SIZE-1);break;case 2:o.playerData.pos=cc.v2(c.default.WIDTH_SIZE-1,Math.round(c.default.HEIGHT_SIZE/2-1));break;case 3:o.playerData.pos=cc.v2(0,Math.round(c.default.HEIGHT_SIZE/2-1))}cc.director.loadScene("loading")}},e.prototype.loadingNextLevel=function(){o.level++,o.level>6&&o.chapterName>=o.CHAPTER04?(o.profileManager.clearData(),cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:d.default.SHOOT}}),cc.director.loadScene("gamefinish")):(o.chapterName<o.CHAPTER04&&o.level>5&&(o.profileManager.data.chapterName++,o.chapterName++,o.level=1),o.mapManager.reset(o.level),o.profileManager.data.currentPos=o.mapManager.currentPos.clone(),o.profileManager.data.rectDungeon=o.mapManager.rectDungeon,o.changeDungeonSize(),o.playerData.pos=cc.v2(Math.round(c.default.WIDTH_SIZE/2-1),Math.round(c.default.HEIGHT_SIZE/2-1)),o.isPickedTalent=!1,cc.director.loadScene("loading"))},e.isBossLevel=function(t){return t==o.BOSS_LEVEL_1},e.getRandomNum=function(t,e){return t+Math.round(h.default.rand()*(e-t))},e.getHalfChance=function(){return h.default.rand()>.5},e.getChance=function(t){return o.getRandomNum(0,100)<t},e.getDistance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)},e.lerp=function(t,e,o){return t+(e-t)*o},e.genNonDuplicateID=function(){return Number(h.default.rand().toString().substr(3,16)+Date.now()).toString(36)},e.getRandomEquipType=function(){return o.equipmentNameList[h.default.getRandomNum(1,o.equipmentNameList.length-1)]},e.getRandomItemType=function(){return o.itemNameList[h.default.getRandomNum(1,o.itemNameList.length-1)]},e.BOSS_LEVEL_1=10,e.CHAPTER00=0,e.CHAPTER01=1,e.CHAPTER02=2,e.CHAPTER03=3,e.CHAPTER04=4,e.equipments=null,e.equipmentNameList=[],e.itemNameList=[],e.monsters=null,e.spriteFrames=null,e.debuffs=null,e.bullets=null,e.items=null,e.level=0,e.chapterName=0,e.playerData=new n.default,e.inventoryManager=new l.default,e.talentList=new Array,e.hasTalentMap={},e.isPickedTalent=!1,e.mapManager=new r.default,e.coins=0,e.ammo=30,e.killCount=0,e.time="00:00:00",e.seed=5,e.isFirst=0,e.isCheatMode=!1,e.isDebug=!1,e.dieFrom=new f.default,e.profileManager=new p.default,e=o=a([g],e)}(cc.Component));o.default=y,cc._RF.pop()},{"./Data/FromData":"FromData","./Data/PlayerData":"PlayerData","./Data/TalentData":"TalentData","./Dungeon":"Dungeon","./EventConstant":"EventConstant","./Manager/InventoryManager":"InventoryManager","./Manager/MapManager":"MapManager","./Manager/ProfileManager":"ProfileManager","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random"}],MagicBall:[function(t,e,o){"use strict";cc._RF.push(e,"d28d1W0XEREC78fFIm7QZgR","MagicBall");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Monster"),s=t("../Boss/Boss"),r=t("../Data/DamageData"),c=t("../Data/FromData"),l=t("./Talent"),h=t("../Manager/StatusManager"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasTargetMap={},e.ballType=0,e.fire=null,e.lightening=null,e.isAttacking=!1,e.checkTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.fire.node.active=!1,this.lightening.node.active=!1,this.rigidBody=this.getComponent(cc.RigidBody)},e.prototype.start=function(){},e.prototype.show=function(t,e,i,a){var n=this;this.ballType=e,this.player=t;var s=3,r=100;this.node.active=!0,this.node.parent=t.node.parent,this.node.setPosition(this.getPlayerPosition(t));var c=500;t.talentMagic.hashTalent(l.default.MAGIC_09)&&(this.node.scale=1.5,s=6),t.talentMagic.hashTalent(l.default.MAGIC_15)&&(this.node.scale=1.5,r=200,s=6),this.ballType==o.LIGHTENING?(this.lightening.node.active=!0,c=0,this.node.setPosition(this.getPlayerFarPosition(t,r,a)),this.node.scale=.1,this.node.runAction(cc.sequence(cc.scaleTo(1,.2),cc.callFunc(function(){n.isAttacking=!0}),cc.scaleTo(1,1)))):(this.fire.node.active=!0,this.isAttacking=!0),this.rigidBody.linearVelocity=this.getPlayerHv(t,a).mul(c),this.node.zIndex=4e3,this.scheduleOnce(function(){n.node&&n.node.destroy()},s)},e.prototype.getPlayerPosition=function(t){return t.node.position.clone().addSelf(cc.v2(8,48))},e.prototype.getPlayerFarPosition=function(t,e,o){var i=t.meleeWeapon.getHv().clone(),a=cc.v2(i).rotateSelf(o*Math.PI/180).mul(e);return t.node.position.clone().addSelf(cc.v2(8,48).addSelf(a))},e.prototype.getPlayerHv=function(t,e){var o=t.meleeWeapon.getHv().clone();return cc.v2(o).rotateSelf(e*Math.PI/180).normalizeSelf()},e.prototype.onCollisionStay=function(t,e){if(e.radius>0&&this.isAttacking)if(this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0)this.hasTargetMap[t.node.uuid]++;else{this.hasTargetMap[t.node.uuid]=1;var o=t.node.getComponent(n.default),i=t.node.getComponent(s.default);(o||i)&&(this.attacking(t.node),this.rigidBody.linearVelocity=cc.Vec2.ZERO,this.fire.node.angle=0)}},e.prototype.attacking=function(t){if(t){var e=new r.default,i=h.default.BURNING,a=1;this.player&&this.player.talentMagic.hashTalent(l.default.MAGIC_06)&&(a=2),this.ballType==o.FIRE?e.fireDamage=a:(e.lighteningDamage=a,i=h.default.DIZZ);var u=t.getComponent(n.default);u&&!u.isDied&&(u.takeDamage(e),u.addStatus(i,new c.default));var p=t.getComponent(s.default);p&&!p.isDied&&(p.takeDamage(e),p.addStatus(i,new c.default))}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.5&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&(this.hasTargetMap={})},e.FIRE=0,e.LIGHTENING=1,a([d(cc.ParticleSystem)],e.prototype,"fire",void 0),a([d(cc.ParticleSystem)],e.prototype,"lightening",void 0),e=o=a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Manager/StatusManager":"StatusManager","../Monster":"Monster","./Talent":"Talent"}],MagicCircle:[function(t,e,o){"use strict";cc._RF.push(e,"4b4e32e5VZL3KOgwsnsl4rh","MagicCircle");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e}return i(e,t),e.prototype.playMagic=function(t){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play(),this.anim.getAnimationState("PlayerMagicShow").speed=t,this.isShow=!0},e.prototype.MagicFinish=function(){this.talentMaigc&&this.talentMaigc.MagicFinish(),this.isShow=!1},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],MagicIce:[function(t,e,o){"use strict";cc._RF.push(e,"593bdTc6U9L8aRhkgXkK2Pf","MagicIce");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShow=!1,e}return i(e,t),e.prototype.showIce=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.node.opacity=128,this.anim.play("PlayerMagicIceIdle"),this.isShow=!0},e.prototype.breakIce=function(){this.anim.play("PlayerMagicIceBreak"),this.isShow=!1},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],MapData:[function(t,e,o){"use strict";cc._RF.push(e,"9d7bcZhUYBIzJR0A6/ryRxj","MapData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t){this.map=new Array,this.init(t)}return t.prototype.init=function(t){if(t){var e=(t=t.substring(2,t.length-2)).split("\r\n");this.map=new Array;for(var o=0;o<e.length;o++)this.map[o]=new Array;for(o=0;o<e.length;o++)for(var i=e[e.length-1-o].split(""),a=0,n=0;n<i.length-1;a++)this.map[o][a]=i[n]+i[n+1],n+=2;var s=new Array;for(o=0;o<this.map[0].length;o++){s[o]=new Array;for(n=0;n<this.map.length;n++)s[o][n]=this.map[n][o]}this.map=s}},t.prototype.clone=function(){var e=new t("");return e.map=this.map.slice(),e},t.prototype.valueCopy=function(t){return this.map=t&&t.map?t.map:null,this},t}();o.default=i,cc._RF.pop()},{}],MapManagerData:[function(t,e,o){"use strict";cc._RF.push(e,"fc23bpSDqZOALYDNPFUGFLx","MapManagerData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(){}}();o.default=i,cc._RF.pop()},{}],MapManager:[function(t,e,o){"use strict";cc._RF.push(e,"3b0b2KGAWdGI6jcP8eIcPHE","MapManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Data/MapData"),a=t("../Rect/RectRoom"),n=t("../Rect/RectDungeon"),s=t("../Logic"),r=t("../Utils/Random4Save"),c=function(){function t(){this.allfileRooms00={},this.allfileRooms01={},this.allfileRooms02={},this.allfileRooms03={},this.allfileRooms04={},this.roomStrs=["startroom","endroom","primaryroom","traproom","lootroom","dangerroom","merchantroom","puzzleroom","bossroom","pokerroom","tarotroom","testroom","finalroom"],this.isloaded=!1,this.isloaded00=!1,this.isloaded01=!1,this.isloaded02=!1,this.isloaded03=!1,this.isloaded04=!1,this.rectDungeon=new n.default(1),this.currentPos=cc.v2(0,0),this.boxes={},this.shopTables={},this.chests={},this.equipments={},this.items={},this.init()}return t.prototype.init=function(){this.isloaded=!1},t.prototype.loadDataFromSave=function(){s.default.profileManager.hasSaveData&&(this.rectDungeon=s.default.profileManager.data.rectDungeon,this.currentPos=s.default.profileManager.data.currentPos.clone(),this.boxes=s.default.profileManager.data.boxes,this.shopTables=s.default.profileManager.data.shopTables,this.chests=s.default.profileManager.data.chests,this.equipments=s.default.profileManager.data.equipments,this.items=s.default.profileManager.data.items,this.changeRoomsIsFound(this.currentPos.x,this.currentPos.y),cc.log("load"),cc.log(this.rectDungeon.getDisPlay()))},t.prototype.reset=function(t){this.rectDungeon=new n.default(t),cc.log(this.rectDungeon.getDisPlay()),this.resetRooms(),this.currentPos=cc.v2(this.rectDungeon.startRoom.x,this.rectDungeon.startRoom.y),this.changeRoomsIsFound(this.currentPos.x,this.currentPos.y),this.boxes={},this.shopTables={},this.chests={},this.equipments={},this.items={}},t.prototype.loadingNextRoom=function(t){var e=this.rectDungeon.getNeighborRoomType(this.currentPos.x,this.currentPos.y,t);return e&&0!=e.roomType&&(this.currentPos=cc.v2(e.x,e.y),s.default.profileManager.data.currentPos=this.currentPos.clone(),this.changeRoomsIsFound(e.x,e.y)),e},t.prototype.changeRoomsIsFound=function(t,e){this.rectDungeon.changeRoomIsFound(t,e),this.rectDungeon.changeRoomIsFound(t+1,e),this.rectDungeon.changeRoomIsFound(t-1,e),this.rectDungeon.changeRoomIsFound(t,e+1),this.rectDungeon.changeRoomIsFound(t,e-1)},t.prototype.getCurrentMapData=function(){var t=this.getCurrentRoom(),e=t.roomType-1,o=this.getAllFileRooms()[this.roomStrs[e]];return this.addGenerateThings(o[t.saveIndex].clone(),t.roomType,t.seed)},t.prototype.getCurrentMapSize=function(){var t=this.getCurrentRoom(),e=t.roomType-1,o=this.getAllFileRooms()[this.roomStrs[e]][t.saveIndex].clone();return cc.v2(o.map.length,o.map[0].length)},t.prototype.getCurrentRoom=function(){return this.rectDungeon.map[this.currentPos.x][this.currentPos.y]},t.prototype.getCurrentMapBoxes=function(){return this.boxes["x="+this.currentPos.x+"y="+this.currentPos.y]},t.prototype.setCurrentBoxesArr=function(t){this.boxes["x="+this.currentPos.x+"y="+this.currentPos.y]=t,s.default.profileManager.data.boxes=this.boxes},t.prototype.getCurrentMapShopTables=function(){return this.shopTables["x="+this.currentPos.x+"y="+this.currentPos.y]},t.prototype.setCurrentShopTableArr=function(t){this.shopTables["x="+this.currentPos.x+"y="+this.currentPos.y]=t,s.default.profileManager.data.shopTables=this.shopTables},t.prototype.getCurrentMapChests=function(){return this.chests["x="+this.currentPos.x+"y="+this.currentPos.y]},t.prototype.setCurrentChestsArr=function(t){this.chests["x="+this.currentPos.x+"y="+this.currentPos.y]=t,s.default.profileManager.data.chests=this.chests},t.prototype.getCurrentMapEquipments=function(){return this.equipments["x="+this.currentPos.x+"y="+this.currentPos.y]},t.prototype.setCurrentEquipmentsArr=function(t){this.equipments["x="+this.currentPos.x+"y="+this.currentPos.y]=t,s.default.profileManager.data.equipments=this.equipments},t.prototype.getCurrentMapItems=function(){return this.items["x="+this.currentPos.x+"y="+this.currentPos.y]},t.prototype.setCurrentItemsArr=function(t){this.items["x="+this.currentPos.x+"y="+this.currentPos.y]=t,s.default.profileManager.data.items=this.items},t.prototype.setRoomClear=function(t,e){this.rectDungeon.map[t][e].state=a.default.STATE_CLEAR},t.prototype.getCurrentRoomState=function(){return this.rectDungeon.map[this.currentPos.x][this.currentPos.y].state},t.prototype.isCurrentRoomStateClear=function(){return this.getCurrentRoomState()==a.default.STATE_CLEAR},t.prototype.getCurrentRoomType=function(){return this.rectDungeon.map[this.currentPos.x][this.currentPos.y].roomType},t.prototype.loadMap=function(){this.allfileRooms00[this.roomStrs[0]]?this.isloaded=!0:(this.loadChapterMap(0,this.allfileRooms00),this.loadChapterMap(1,this.allfileRooms01),this.loadChapterMap(2,this.allfileRooms02),this.loadChapterMap(3,this.allfileRooms03),this.loadChapterMap(4,this.allfileRooms04))},t.prototype.loadChapterMap=function(t,e){var o=this;cc.loader.loadRes("Data/rooms0"+t,function(a,n){if(a)cc.error(a);else{for(var s=n.text.split("room"),r=0,c=0;c<s.length;c++){var l=s[c],h=null;if(l&&(h=(l=l.substring(l.indexOf("=")+1,l.length-3)).split("$")),h){for(var u=new Array,p=0;p<h.length;p++){var d=h[p];u.push(new i.default(d))}e[o.roomStrs[r]]=u,r++}}switch(t){case 0:o.isloaded00=!0;break;case 1:o.isloaded01=!0;break;case 2:o.isloaded02=!0;break;case 3:o.isloaded03=!0;break;case 4:o.isloaded04=!0}o.isloaded00&&o.isloaded01&&o.isloaded02&&o.isloaded03&&o.isloaded04&&(o.resetRooms(),o.loadDataFromSave(),o.isloaded=!0,cc.log("maps loaded"))}})},t.prototype.addGenerateThings=function(t,e,o){var i=new r.default(o);return cc.log("seed:"+o),this.addRandomTile(t,i),n.default.TEST_ROOM!=e&&n.default.TAROT_ROOM!=e&&n.default.START_ROOM!=e&&(i=new r.default(o),this.addDecorate(t,i)),t},t.prototype.addRandomTile=function(t,e){for(var o=[],i=0;i<10;i++){var a=e.getRandomNum(0,t.map.length-1),n=e.getRandomNum(0,t.map[0].length-1);o.push(cc.v2(a,0)),o.push(cc.v2(0,n)),o.push(cc.v2(a,n))}for(var s=0,r=o;s<r.length;s++){var c=r[s];"**"==t.map[c.x][c.y]&&(t.map[c.x][c.y]="*"+e.getRandomNum(0,2))}},t.prototype.addDecorate=function(t,e){for(var o=[],i=0;i<2;i++){var a=e.getRandomNum(0,t.map.length-1),n=e.getRandomNum(0,t.map[0].length-1);o.push(cc.v2(a,0)),o.push(cc.v2(0,n)),o.push(cc.v2(a,n))}for(var s=0,r=o;s<r.length;s++){var c=r[s];-1==t.map[c.x][c.y].indexOf("*")&&-1==t.map[c.x][c.y].indexOf("D")||(t.map[c.x][c.y]="D"+e.getRandomNum(0,2),cc.log("addDecorate:"+c))}},t.prototype.getAllFileRooms=function(){var t=this.allfileRooms00;switch(s.default.chapterName){case s.default.CHAPTER00:t=this.allfileRooms00;break;case s.default.CHAPTER01:t=this.allfileRooms01;break;case s.default.CHAPTER02:t=this.allfileRooms02;break;case s.default.CHAPTER03:t=this.allfileRooms03;break;case s.default.CHAPTER04:t=this.allfileRooms04}return t},t.prototype.resetRooms=function(){var t=this.getAllFileRooms();if(t&&t[this.roomStrs[0]])for(var e=0;e<this.rectDungeon.map.length;e++)for(var o=0;o<this.rectDungeon.map[0].length;o++){var i=this.rectDungeon.map[e][o],a=i.roomType-1;if(a>=0){var r=t[this.roomStrs[a]];i.saveIndex=s.default.getRandomNum(0,r.length-1),i.roomType==n.default.PRIMARY_ROOM&&(this.rectDungeon.isPrimaryHorizontal(e,o)&&(i.saveIndex=0),this.rectDungeon.isPrimaryVertical(e,o)&&(i.saveIndex=1),this.rectDungeon.isPrimaryRoomCorner(e,o)&&(i.saveIndex=r.length-1))}}},t}();o.default=c,cc._RF.pop()},{"../Data/MapData":"MapData","../Logic":"Logic","../Rect/RectDungeon":"RectDungeon","../Rect/RectRoom":"RectRoom","../Utils/Random4Save":"Random4Save"}],MeleeWeaponChild:[function(t,e,o){"use strict";cc._RF.push(e,"81ac4Ib50VMBoiaBfrNyVFU","MeleeWeaponChild");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.meleeWeapon=null,e}return i(e,t),e.prototype.onLoad=function(){this.getComponent(cc.Sprite).spriteFrame},e.prototype.start=function(){},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],MeleeWeapon:[function(t,e,o){"use strict";cc._RF.push(e,"8747dgi/6dFupzO0r46t7Ya","MeleeWeapon");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Player"),s=t("./Monster"),r=t("./EventConstant"),c=t("./Building/Box"),l=t("./Logic"),h=t("./MeleeWeaponChild"),u=t("./Data/DamageData"),p=t("./Manager/StatusManager"),d=t("./Boss/Boss"),f=t("./Utils/Random"),m=t("./Utils/Skill"),g=t("./Data/FromData"),y=t("./Building/Decorate"),v=cc._decorator,D=v.ccclass,C=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerNode=null,e.player=null,e.stabWeapon=null,e.waveWeapon=null,e.iceLight=null,e.fireLight=null,e.lighteningLight=null,e.toxicLight=null,e.curseLight=null,e.handStab=null,e.handWave=null,e.glovesStabSprite=null,e.glovesWaveSprite=null,e.isAttacking=!1,e.hv=cc.v2(1,0),e.isStab=!0,e.isFar=!1,e.isFist=!0,e.isMiss=!1,e.drainSkill=new m.default,e.isReflect=!1,e.comboType=0,e.isComboing=!1,e.hasTargetMap={},e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.player=this.playerNode.getComponent(n.default),this.weaponFirePoint=this.node.getChildByName("firepoint"),this.handStab=this.stabWeapon.node.getChildByName("hand"),this.handWave=this.waveWeapon.node.getChildByName("hand"),this.glovesStabSprite=this.handStab.getChildByName("gloves").getComponent(cc.Sprite),this.glovesWaveSprite=this.handWave.getChildByName("gloves").getComponent(cc.Sprite)},e.prototype.setHands=function(){this.isStab?(this.handStab.opacity=255,this.handWave.opacity=0):(this.handStab.opacity=0,this.handWave.opacity=255)},e.prototype.setHv=function(t){var e=this.hasNearEnemy();e.equals(cc.Vec2.ZERO)?this.hv=t.normalizeSelf():(this.rotateColliderManager(cc.v2(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e)},e.prototype.getHv=function(){return this.hv},e.prototype.updateCombo=function(){this.comboType==o.COMBO1?(this.comboType=o.COMBO2,this.isFist&&(this.comboType=o.COMBO1)):this.comboType==o.COMBO2?this.comboType=o.COMBO3:(this.comboType,o.COMBO3,this.comboType=o.COMBO1),this.isComboing||(this.comboType=o.COMBO1,this.isComboing=!0)},e.prototype.attack=function(t,e){if(this.isAttacking)return!1;this.hasTargetMap={},this.updateCombo(),this.isMiss=e,this.isAttacking=!0;var i=1+t.getAttackSpeed()/1e3;if(i<.2&&(i=.2),i>3&&(i=3),this.anim){var a=this.getAttackAnimName();this.anim.play(a),this.anim.getAnimationState(a).speed=i}for(var n=this.weaponFirePoint.position.clone(),s=l.default.getRandomNum(0,100),r=0,c=[t.getIceDamage()>0&&s<t.getIceRate()?o.ELEMENT_TYPE_ICE:0,t.getFireDamage()>0&&s<t.getFireRate()?o.ELEMENT_TYPE_FIRE:0,t.getLighteningDamage()>0&&s<t.getLighteningRate()?o.ELEMENT_TYPE_LIGHTENING:0,t.getToxicDamage()>0&&s<t.getToxicRate()?o.ELEMENT_TYPE_TOXIC:0,t.getCurseDamage()>0&&s<t.getCurseRate()?o.ELEMENT_TYPE_CURSE:0];r<c.length;r++){var h=c[r];this.getWaveLight(this.dungeon.node,n,h,this.isStab,this.isFar)}return!0},e.prototype.getAttackAnimName=function(){return(!this.isFar&&this.isStab?"MeleeAttackStab":this.isFar&&this.isStab?"MeleeAttackStabFar":this.isFar&&!this.isStab?"MeleeAttackFar":"MeleeAttack")+this.getComboSuffix()},e.prototype.getComboSuffix=function(){return this.comboType==o.COMBO1?"1":this.comboType==o.COMBO2?"2":this.comboType==o.COMBO3?"3":"1"},e.prototype.getWaveLight=function(t,e,o,i,a){var n=[this.iceLight,this.fireLight,this.lighteningLight,this.toxicLight,this.curseLight];if(!(o<1||o>n.length)&&this.dungeon){var s=cc.instantiate(n[o-1]),r=60,c=60;i&&(r=10),a&&(r+=i?20:80,c+=10);var l=[cc.v2(e.x,e.y+c),cc.v2(e.x+.9*r,e.y+c/2),cc.v2(e.x+r,e.y),cc.v2(e.x+.9*r,-e.y-c/2),cc.v2(e.x,-e.y-c)],h=[cc.v2(e.x-2*r,e.y),cc.v2(e.x-.5*r,e.y),cc.v2(e.x,e.y),cc.v2(e.x+.5*r,e.y),cc.v2(e.x+r,e.y)];i||(h=l);for(var u=0;u<h.length;u++){var p=h[u];p=this.node.convertToWorldSpaceAR(p),p=t.convertToNodeSpaceAR(p),h[u]=p.clone()}s.parent=t,s.position=h[0],s.zIndex=4e3,s.opacity=255,s.active=!0;var d=cc.sequence(cc.moveTo(.025,h[1]),cc.moveTo(.05,h[2]),cc.moveTo(.075,h[3]),cc.moveTo(.1,h[4]));s.runAction(d)}},e.prototype.MeleeAttackFinish=function(){var t=this;this.scheduleOnce(function(){t.isAttacking=!1},.05),this.scheduleOnce(function(){t.isAttacking||(t.isComboing=!1)},1)},e.prototype.ExAttackTime=function(){this.player.remoteExAttack(this.comboType)},e.prototype.RefreshTime=function(){this.hasTargetMap={}},e.prototype.start=function(){},e.prototype.getRandomNum=function(t,e){return t+Math.round(f.default.rand()*(e-t))},e.prototype.update=function(t){var e=this.hasNearEnemy();if(e.equals(cc.Vec2.ZERO)){if((0!=this.hv.x||0!=this.hv.y)&&!this.isAttacking){var o=cc.v2(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(o)}}else this.isAttacking||this.rotateColliderManager(cc.v2(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e},e.prototype.hasNearEnemy=function(){var t=1e3,e=cc.v2(0,0);if(this.dungeon){for(var o=0,i=this.dungeon.monsters;o<i.length;o++){var a=i[o];if((r=l.default.getDistance(this.node.parent.position,a.node.position))<200&&r<t&&!a.isDied)t=r,(c=this.node.position.clone()).x=this.node.scaleX>0?c.x:-c.x,e=a.getCenterPosition().sub(this.node.parent.position.add(c))}if(e.equals(cc.Vec2.ZERO))for(var n=0,s=this.dungeon.bosses;n<s.length;n++){var r,c,h=s[n];if((r=l.default.getDistance(this.node.parent.position,h.node.position))<200&&r<t&&!h.isDied)t=r,(c=this.node.position.clone()).x=this.node.scaleX>0?c.x:-c.x,e=h.getCenterPosition().sub(this.node.parent.position.add(c))}1e3!=t&&(e=e.normalizeSelf())}return e},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),o=360/(2*Math.PI),i=360-Math.atan2(e.x,e.y)*o;this.node.scaleX=this.node.parent.scaleX;var a=Math.abs(this.node.scaleY);this.node.scaleY=this.node.scaleX<0?-a:a,(i+=90)>=360&&(i-=360),i<=-360&&(i+=360),this.node.angle=this.node.scaleX<0?-i:i},e.prototype.onCollisionStay=function(t,e){e.radius>0&&(this.hasTargetMap[t.node.uuid]&&this.hasTargetMap[t.node.uuid]>0?this.hasTargetMap[t.node.uuid]++:(this.hasTargetMap[t.node.uuid]=1,this.attacking(t)))},e.prototype.beatBack=function(t){var e=t.getComponent(cc.RigidBody),i=this.getHv().clone();i.equals(cc.Vec2.ZERO)&&(i=cc.v2(1,0));var a=50;a=!this.isFar&&this.isStab?50:this.isFar&&this.isStab?300:this.isFar||this.isStab?50:200,this.comboType==o.COMBO3&&(a+=50),i=i.normalizeSelf().mul(a),e.applyLinearImpulse(i,e.getLocalCenter(),!0)},e.prototype.attacking=function(t){var e=this;if(t&&this.isAttacking){var i=new u.default;this.player&&(i=this.player.data.getFinalAttackPoint());var a=!1,n=!1,l=t.node.getComponent(s.default);!l||l.isDied||this.isMiss||(a=l.takeDamage(i))&&(this.beatBack(l.node),this.addMonsterAllStatus(l));var h=t.node.getComponent(d.default);!h||h.isDied||this.isMiss||(a=h.takeDamage(i))&&this.addBossAllStatus(h);var p=t.node.getComponent(c.default);p&&(n=!0,p.breakBox());var f=t.node.getComponent(y.default);f&&(n=!0,f.breakBox()),a&&this.drainSkill.next(function(){var t=e.player.data.getLifeDrain();t>0&&e.player.takeDamage(new u.default(-t))},1,!0),this.isMiss=!1,(a||n)&&(this.anim.pause(),cc.director.emit(r.EventConstant.CAMERA_SHAKE,{detail:{isHeavyShaking:this.comboType==o.COMBO3}}),this.scheduleOnce(function(){e.anim.resume()},.1))}},e.prototype.addMonsterAllStatus=function(t){this.addMonsterStatus(this.player.data.getIceRate(),t,p.default.FROZEN),this.addMonsterStatus(this.player.data.getFireRate(),t,p.default.BURNING),this.addMonsterStatus(this.player.data.getLighteningRate(),t,p.default.DIZZ),this.addMonsterStatus(this.player.data.getToxicRate(),t,p.default.TOXICOSIS),this.addMonsterStatus(this.player.data.getCurseRate(),t,p.default.CURSING),this.addMonsterStatus(this.player.data.getRealRate(),t,p.default.BLEEDING)},e.prototype.addBossAllStatus=function(t){this.addBossStatus(this.player.data.getIceRate(),t,p.default.FROZEN),this.addBossStatus(this.player.data.getFireRate(),t,p.default.BURNING),this.addBossStatus(this.player.data.getLighteningRate(),t,p.default.DIZZ),this.addBossStatus(this.player.data.getToxicRate(),t,p.default.TOXICOSIS),this.addBossStatus(this.player.data.getCurseRate(),t,p.default.CURSING),this.addBossStatus(this.player.data.getRealRate(),t,p.default.BLEEDING)},e.prototype.addMonsterStatus=function(t,e,o){l.default.getRandomNum(0,100)<t&&e.addStatus(o,new g.default)},e.prototype.addBossStatus=function(t,e,o){l.default.getRandomNum(0,100)<t&&e.addStatus(o,new g.default)},e.ELEMENT_TYPE_ICE=1,e.ELEMENT_TYPE_FIRE=2,e.ELEMENT_TYPE_LIGHTENING=3,e.ELEMENT_TYPE_TOXIC=4,e.ELEMENT_TYPE_CURSE=5,e.COMBO1=1,e.COMBO2=2,e.COMBO3=3,a([C(cc.Node)],e.prototype,"playerNode",void 0),a([C(h.default)],e.prototype,"stabWeapon",void 0),a([C(h.default)],e.prototype,"waveWeapon",void 0),a([C(cc.Prefab)],e.prototype,"iceLight",void 0),a([C(cc.Prefab)],e.prototype,"fireLight",void 0),a([C(cc.Prefab)],e.prototype,"lighteningLight",void 0),a([C(cc.Prefab)],e.prototype,"toxicLight",void 0),a([C(cc.Prefab)],e.prototype,"curseLight",void 0),e=o=a([D],e)}(cc.Component);o.default=_,cc._RF.pop()},{"./Boss/Boss":"Boss","./Building/Box":"Box","./Building/Decorate":"Decorate","./Data/DamageData":"DamageData","./Data/FromData":"FromData","./EventConstant":"EventConstant","./Logic":"Logic","./Manager/StatusManager":"StatusManager","./MeleeWeaponChild":"MeleeWeaponChild","./Monster":"Monster","./Player":"Player","./Utils/Random":"Random","./Utils/Skill":"Skill"}],MiniMap:[function(t,e,o){"use strict";cc._RF.push(e,"b8f7e0qah9Ot5qnGbL59sxK","MiniMap");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./Rect/RectDungeon"),r=t("./Rect/RectRoom"),c=t("./EventConstant"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.miniTile=null,e.size=0,e.level=1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(c.EventConstant.CHANGE_MINIMAP,function(e){t.changeMap(e.detail.x,e.detail.y)}),this.level=n.default.level<1||n.default.level>5?1:n.default.level,this.size=this.level+2,this.size<3&&(this.size=3),this.map=new Array;for(var e=0;e<this.size;e++){this.map[e]=new Array;for(var o=0;o<this.size;o++){var i=cc.instantiate(this.miniTile);i.group="ui",this.map[e][o]=i,this.map[e][o].parent=this.node,this.map[e][o].position=cc.v2(e*i.width,o*i.height),this.map[e][o].color=cc.Color.BLACK,this.map[e][o].opacity=0}}},e.prototype.start=function(){},e.prototype.changeMap=function(t,e){if(this.map)for(var i=0;i<this.size;i++)for(var a=0;a<this.size;a++){var c=n.default.mapManager.rectDungeon.map[a][i].isFound,l=n.default.mapManager.rectDungeon.map[a][i].state,h=n.default.mapManager.rectDungeon.map[a][i].roomType;n.default.mapManager.rectDungeon.map[a][i].isPrimary;if(this.map[a][i].color=this.getColor(o.ColorLevel.HIDE),c){this.map[a][i].color=this.getColor(o.ColorLevel.NORMAL),this.map[a][i].opacity=255;var u=l==r.default.STATE_CLEAR;this.map[a][i].color=this.getColor(u?o.ColorLevel.CLEAR:o.ColorLevel.NORMAL),this.getMapColor(a,i,h,s.default.BOSS_ROOM,u,o.ColorLevel.NORMAL_BOSS,o.ColorLevel.CLEAR_BOSS),this.getMapColor(a,i,h,s.default.LOOT_ROOM,u,o.ColorLevel.NORMAL_LOOT,o.ColorLevel.CLEAR_LOOT),this.getMapColor(a,i,h,s.default.MERCHANT_ROOM,u,o.ColorLevel.NORMAL_MERCHANT,o.ColorLevel.CLEAR_MERCHANT),this.getMapColor(a,i,h,s.default.START_ROOM,u,o.ColorLevel.NORMAL_START,o.ColorLevel.NORMAL_START),n.default.level!=s.default.LEVEL_3&&n.default.level!=s.default.LEVEL_5&&this.getMapColor(a,i,h,s.default.END_ROOM,u,o.ColorLevel.NORMAL_END,o.ColorLevel.CLEAR_END),this.getMapColor(a,i,h,s.default.PUZZLE_ROOM,u,o.ColorLevel.NORMAL_PUZZLE,o.ColorLevel.CLEAR_PUZZLE),this.getMapColor(a,i,h,s.default.POKER_ROOM,u,o.ColorLevel.NORMAL_POKER,o.ColorLevel.NORMAL_POKER),this.getMapColor(a,i,h,s.default.TAROT_ROOM,u,o.ColorLevel.NORMAL_TAROT,o.ColorLevel.NORMAL_TAROT),this.getMapColor(a,i,h,s.default.TEST_ROOM,u,o.ColorLevel.NORMAL_TEST,o.ColorLevel.NORMAL_TEST),h==s.default.START_ROOM&&(this.map[a][i].color=this.getColor(o.ColorLevel.NORMAL_START)),a==t&&i==e&&(this.map[t][e].color=this.getColor(o.ColorLevel.PLAYER))}}},e.prototype.getMapColor=function(t,e,o,i,a,n,s){o==i&&(this.map[t][e].color=this.getColor(a?s:n))},e.prototype.getColor=function(t){var e=new cc.Color(0,0,0);switch(t){case o.ColorLevel.HIDE:e=new cc.Color(0,0,0);break;case o.ColorLevel.NORMAL:e=new cc.Color(128,128,128);break;case o.ColorLevel.CLEAR:e=new cc.Color(255,255,255);break;case o.ColorLevel.PLAYER:e=new cc.Color(0,255,0);break;case o.ColorLevel.NORMAL_START:e=new cc.Color(144,238,144);break;case o.ColorLevel.NORMAL_END:e=new cc.Color(100,149,237);break;case o.ColorLevel.NORMAL_BOSS:e=new cc.Color(128,0,128);break;case o.ColorLevel.NORMAL_LOOT:case o.ColorLevel.NORMAL_MERCHANT:e=new cc.Color(255,215,0);break;case o.ColorLevel.NORMAL_POKER:e=new cc.Color(139,69,19);break;case o.ColorLevel.NORMAL_TAROT:e=new cc.Color(255,165,0);break;case o.ColorLevel.NORMAL_TEST:e=new cc.Color(238,130,238);break;case o.ColorLevel.NORMAL_PUZZLE:e=new cc.Color(128,0,128);break;case o.ColorLevel.CLEAR_LOOT:case o.ColorLevel.CLEAR_MERCHANT:e=new cc.Color(240,230,140);break;case o.ColorLevel.CLEAR_BOSS:e=new cc.Color(75,0,130);break;case o.ColorLevel.CLEAR_END:e=new cc.Color(176,196,222);break;case o.ColorLevel.CLEAR_PUZZLE:e=new cc.Color(75,0,130)}return e},e.prototype.getMixColor=function(t,e){var o=t.clone(),i=e.clone(),a=cc.color(),n=o.getR()+i.getR(),s=o.getG()+i.getG(),r=o.getB()+i.getB();return a.setR(n>255?255:n),a.setG(s>255?255:s),a.setB(r>255?255:r),a},e.ColorLevel={HIDE:0,NORMAL:1,PLAYER:2,CLEAR:3,NORMAL_BOSS:4,CLEAR_PUZZLE:5,CLEAR_END:6,CLEAR_BOSS:7,NORMAL_LOOT:8,CLEAR_LOOT:9,NORMAL_START:10,NORMAL_END:11,NORMAL_POKER:12,NORMAL_TAROT:13,NORMAL_TEST:14,NORMAL_PUZZLE:15,NORMAL_MERCHANT:16,CLEAR_MERCHANT:17},a([u(cc.Prefab)],e.prototype,"miniTile",void 0),e=o=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./Rect/RectDungeon":"RectDungeon","./Rect/RectRoom":"RectRoom"}],MonsterDangerBox:[function(t,e,o){"use strict";cc._RF.push(e,"c5bd3A3tgpJso8uoa83DjVW","MonsterDangerBox");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Data/FromData"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attackType=0,e.isAttacking=!1,e.hv=cc.v2(1,0),e.checkTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.node.opacity=0,this.collider=this.getComponent(cc.BoxCollider)},e.prototype.init=function(t){this.monster=t},e.prototype.start=function(){},e.prototype.show=function(t){if(this.monster){this.attackType=t,this.changeBoxSize(t),this.node.opacity=80;var e=this.node.position.clone(),o=this.monster.dungeon.player.getCenterPosition().sub(this.monster.node.position.add(e));this.setHv(o)}},e.prototype.changeBoxSize=function(t){var e=80,i=cc.v2(40,0);switch(this.node.anchorX=0,this.node.width=e,this.node.height=e,this.node.position=cc.v2(-16,32),this.collider.offset=i,this.collider.size.width=e,this.collider.size.height=e,t){case o.ATTACK_NORMAL:break;case o.ATTACK_STAB:this.node.width=300,this.collider.offset=cc.v2(0,0);break;case o.ATTACK_AREA:this.node.anchorX=.5,e=160,this.node.width=e,this.node.height=e,this.node.position=cc.v2(0,32),this.collider.size.width=e,this.collider.size.height=e,this.collider.offset=cc.v2(0,0)}},e.prototype.hide=function(t){this.isAttacking=!t,this.node.opacity=0},e.prototype.finish=function(){this.node.opacity=0,this.isAttacking=!1},e.prototype.onCollisionStay=function(t,e){if(this.isAttacking&&this.monster&&3==t.tag){this.isAttacking=!1;var o=n.default.getClone(this.monster.data.nameCn,this.monster.data.resName);this.monster.addPlayerStatus(this.monster.dungeon.player,o);var i=this.monster.data.getAttackPoint();this.monster.dungeon.player.takeDamage(i,o,this.monster)}},e.prototype.setHv=function(t){if(this.hv=t.normalizeSelf(),0!=this.hv.x||0!=this.hv.y){var e=cc.v2(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(e)}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>.02&&(this.checkTimeDelay=0,!0)},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),o=360/(2*Math.PI),i=360-Math.atan2(e.x,e.y)*o;this.node.scaleX=this.monster.node.scaleX>0?1:-1,i+=90,this.node.angle=-1==this.node.scaleX?-i:i},e.ATTACK_NORMAL=0,e.ATTACK_STAB=1,e.ATTACK_AREA=2,e=o=a([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{"../Data/FromData":"FromData"}],MonsterData:[function(t,e,o){"use strict";cc._RF.push(e,"1f11a18691HqqKqLoB//q4B","MonsterData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./DamageData"),a=t("./StatusData"),n=t("./CommonData"),s=t("../Utils/Random"),r=function(){function t(){this.nameCn="",this.nameEn="",this.resName="",this.chapter=0,this.stageLevel=0,this.invisible=0,this.remote=0,this.melee=0,this.dash=0,this.disguise=0,this.sizeType=0,this.bulletType="",this.bulletArcExNum=0,this.bulletLineExNum=0,this.bulletLineInterval=0,this.bulletExSpeed=0,this.isArcAim=0,this.isLineAim=0,this.blink=0,this.isBoom=0,this.isHeavy=0,this.shooterOffsetX=0,this.shooterOffsetY=0,this.specialAttack=0,this.specialType="",this.specialDistance=0,this.specialBulletArcExNum=0,this.specialBulletLineExNum=0,this.pos=cc.v2(0,0),this.currentHealth=0,this.boxType=0,this.attackType=0,this.statusTotalData=new a.default,this.common=new n.default}return t.prototype.getCommonList=function(){return[this.common,this.statusTotalData.Common]},Object.defineProperty(t.prototype,"StatusTotalData",{get:function(){return this.statusTotalData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),t.prototype.updateHA=function(t,e,o){this.currentHealth=t,this.common.maxHealth=e,this.common.damageMin=o},t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.nameCn=t.nameCn,this.nameEn=t.nameEn,this.resName=t.resName,this.chapter=t.chapter,this.stageLevel=t.stageLevel,this.currentHealth=t.currentHealth?t.currentHealth:0,this.invisible=t.invisible?t.invisible:0,this.remote=t.remote?t.remote:0,this.melee=t.melee?t.melee:0,this.dash=t.dash?t.dash:0,this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.disguise=t.disguise?t.disguise:0,this.sizeType=t.sizeType?t.sizeType:0,this.bulletType=t.bulletType,this.bulletArcExNum=t.bulletArcExNum?t.bulletArcExNum:0,this.bulletLineExNum=t.bulletLineExNum?t.bulletLineExNum:0,this.bulletLineInterval=t.bulletLineInterval?t.bulletLineInterval:0,this.isArcAim=t.isArcAim?t.isArcAim:0,this.isLineAim=t.isLineAim?t.isLineAim:0,this.blink=t.blink?t.blink:0,this.isBoom=t.isBoom?t.isBoom:0,this.bulletExSpeed=t.bulletExSpeed?t.bulletExSpeed:0,this.isHeavy=t.isHeavy?t.isHeavy:0,this.shooterOffsetX=t.shooterOffsetX?t.shooterOffsetX:0,this.shooterOffsetY=t.shooterOffsetY?t.shooterOffsetY:0,this.specialAttack=t.specialAttack?t.specialAttack:0,this.specialType=t.specialType?t.specialType:"",this.specialDistance=t.specialDistance?t.specialDistance:0,this.specialBulletArcExNum=t.specialBulletArcExNum?t.specialBulletArcExNum:0,this.specialBulletLineExNum=t.specialBulletLineExNum?t.specialBulletLineExNum:0,this.boxType=t.boxType?t.boxType:0,this.attackType=t.attackType?t.attackType:0},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.resName=this.resName,e.chapter=this.chapter,e.stageLevel=this.stageLevel,e.currentHealth=this.currentHealth,e.invisible=this.invisible,e.remote=this.remote,e.melee=this.melee,e.dash=this.dash,e.pos=this.pos,e.disguise=this.disguise,e.sizeType=this.sizeType,e.bulletType=this.bulletType,e.bulletArcExNum=this.bulletArcExNum,e.bulletLineExNum=this.bulletLineExNum,e.bulletLineInterval=this.bulletLineInterval,e.isArcAim=this.isArcAim,e.isLineAim=this.isLineAim,e.blink=this.blink,e.isBoom=this.isBoom,e.bulletExSpeed=this.bulletExSpeed,e.isHeavy=this.isHeavy,e.shooterOffsetX=this.shooterOffsetX,e.shooterOffsetY=this.shooterOffsetY,e.specialAttack=this.specialAttack,e.specialType=this.specialType,e.specialDistance=this.specialDistance,e.specialBulletArcExNum=this.specialBulletArcExNum,e.specialBulletLineExNum=this.specialBulletLineExNum,e.boxType=this.boxType,e.attackType=this.attackType,e},t.prototype.getAttackPoint=function(){var t=new i.default;return t.realDamage=this.common.realDamage,t.physicalDamage=this.common.damageMin,t.iceDamage=this.common.iceDamage,t.fireDamage=this.common.fireDamage,t.lighteningDamage=this.common.lighteningDamage,t.toxicDamage=this.common.toxicDamage,t.curseDamage=this.common.curseDamage,t},t.prototype.getDamage=function(t){var e=t.clone(),o=this.getDefence(),i=this.getIceDefence(),a=this.getFireDefence(),n=this.getLighteningDefence(),s=this.getToxicDefence(),r=this.getCurseDefence();return e.physicalDamage=o>=0?e.physicalDamage*(1-.06*o/(.06*o+1)):e.physicalDamage*(2-Math.pow(.94,-o)),e.iceDamage=e.iceDamage*(1-i/100),e.fireDamage=e.fireDamage*(1-a/100),e.lighteningDamage=e.lighteningDamage*(1-n/100),e.toxicDamage=e.toxicDamage*(1-s/100),e.curseDamage=e.curseDamage*(1-r/100),e},t.prototype.getLifeDrain=function(){var t=this.getCriticalStrikeRate(),e=this.getLifeDrainRate(),o=0;return s.default.rand()<e&&(o=1,s.default.rand()<t&&(o=2)),o},t.prototype.getMoveSpeed=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].moveSpeed}return t},t.prototype.getAttackSpeed=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].attackSpeed}return t},t.prototype.getDamageMin=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].damageMin}return t},t.prototype.getDamageMax=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].damageMax}return t},t.prototype.getCriticalStrikeRate=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].criticalStrikeRate/100}return 1-t},t.prototype.getDodge=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].dodge/100}return 1-t},t.prototype.getDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].defence}return t},t.prototype.getHealth=function(){for(var t=1,e=0,o=0,i=this.getCommonList();o<i.length;o++){e+=i[o].maxHealth}return e>0?(t=this.currentHealth/e,cc.v2(e*t,e)):cc.v2(1,1)},t.prototype.getIceDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceDefence}return t>100&&(t=100),t},t.prototype.getFireDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireDefence}return t>100&&(t=100),t},t.prototype.getLighteningDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningDefence}return t>100&&(t=100),t},t.prototype.getToxicDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicDefence}return t>100&&(t=100),t},t.prototype.getCurseDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseDefence}return t>100&&(t=100),t},t.prototype.getRealDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].realDamage}return t<0&&(t=0),t},t.prototype.getIceDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceDamage}return t<0&&(t=0),t},t.prototype.getFireDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireDamage}return t<0&&(t=0),t},t.prototype.getLighteningDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningDamage}return t<0&&(t=0),t},t.prototype.getToxicDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicDamage}return t<0&&(t=0),t},t.prototype.getCurseDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseDamage}return t<0&&(t=0),t},t.prototype.getRealRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].realRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getIceRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getFireRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getLighteningRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getToxicRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getCurseRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getLifeRecovery=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lifeRecovery}return t>0?t:0},t.prototype.getLifeDrainRate=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].lifeDrain/100}return 1-t},t}();o.default=r,cc._RF.pop()},{"../Utils/Random":"Random","./CommonData":"CommonData","./DamageData":"DamageData","./StatusData":"StatusData"}],MonsterDetector:[function(t,e,o){"use strict";cc._RF.push(e,"77810+lX7JF67u57+eViJLm","MonsterDetector");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Item/Bullet"),s=t("../Monster"),r=t("../Utils/Random"),c=cc._decorator,l=c.ccclass,h=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t,e){var o=t.getComponent(n.default),i=this.node.parent.getComponent(s.default);if(o&&o.isFromPlayer&&i){var a=this.getRoate90Point(o.node.position,i.node.position,r.default.getHalfChance());a=a.sub(i.node.position),i.moveTarget=a.clone(),i.monsterAction(),this.scheduleOnce(function(){i.moveTarget=cc.Vec2.ZERO},.1)}},e.prototype.getRoate90Point=function(t,e,o){return o?cc.v2(e.x+t.y-e.y,e.y-t.x+e.x):cc.v2(e.x-t.y+e.y,e.y+t.x-e.x)},e=a([l],e)}(cc.Component));o.default=h,cc._RF.pop()},{"../Item/Bullet":"Bullet","../Monster":"Monster","../Utils/Random":"Random"}],MonsterManager:[function(t,e,o){"use strict";cc._RF.push(e,"441f6g4iH9M574s+sdv3n8E","MonsterManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Monster"),s=t("../Data/MonsterData"),r=t("../Boss/Kraken"),c=t("../Dungeon"),l=t("../Boss/Captain"),h=t("../Logic"),u=t("../Boss/Slime"),p=t("../Boss/WarMachine"),d=t("../Boss/Rah"),f=t("../Utils/Random"),m=t("../Boss/IceDemon"),g=t("../Boss/EvilEye"),y=t("../Boss/Dryad"),v=t("../Boss/Sphinx"),D=t("../Boss/Dragon"),C=t("./MonsterRandomAttr"),_=cc._decorator,E=_.ccclass,R=_.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monster=null,e.kraken=null,e.captain=null,e.slime=null,e.warmachine=null,e.rah=null,e.iceDemon=null,e.evilEye=null,e.dryad=null,e.sphinx=null,e.dragon=null,e.maxHealth00=200,e.maxHealth01=300,e.maxHealth02=300,e.maxHealth03=400,e.maxHealth04=400,e.maxHealth05=500,e.maxHealth06=500,e.maxHealth07=600,e.maxHealth08=600,e.maxHealth09=800,e.monsterRandomAttr=new C.default,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.getMonster=function(t,e){var o=null;(o=cc.instantiate(this.monster)).active=!1,o.parent=e.node;var i=o.getComponent(n.default),a=new s.default;i.dungeon=e,a.valueCopy(h.default.monsters[t]),f.default.rand()<.1&&(this.monsterRandomAttr.addRandomAttrs(2),a=this.monsterRandomAttr.updateMonsterData(a),i.attrmap=this.monsterRandomAttr.attrmap);var r=5;r=r+5*h.default.chapterName+2*h.default.level,i.isVariation=h.default.getRandomNum(0,100)<r,i.isVariation&&(a.Common.maxHealth=2*a.Common.maxHealth,a.Common.damageMin=2*a.Common.damageMin,a.currentHealth=2*a.currentHealth,a.melee>0&&(a.melee=a.melee>1?a.melee-1:1),a.remote>0&&(a.remote=a.remote>1?a.remote-1:1),a.dash>0&&(a.dash=a.dash>1?a.dash-1:1),a.Common.moveSpeed=a.Common.moveSpeed>0?a.Common.moveSpeed+100:0);var c=f.default.rand(),l=h.default.getRandomNum(80,100),u=h.default.getRandomNum(80,100);return c<.05?(a.Common.iceDamage+=1,a.Common.iceDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.iceRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u):c>=.005&&c<.01?(a.Common.fireDamage+=1,a.Common.fireDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.fireRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u):c>=.01&&c<.015?(a.Common.fireDamage+=1,a.Common.fireDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.fireRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u):c>=.015&&c<.02?(a.Common.lighteningDamage+=1,a.Common.lighteningDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.lighteningRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u):c>=.02&&c<.025?(a.Common.toxicDamage+=1,a.Common.toxicDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.toxicRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u):c>=.025&&c<.03&&(a.Common.curseDamage+=1,a.Common.curseDefence=a.Common.iceDefence+l>100?100:a.Common.iceDefence+l,a.Common.curseRate=a.Common.iceRate+u>100?100:a.Common.iceRate+u),i.data=a,i.isDisguising=a.disguise>0,i.isDisguising?i.changeBodyRes(a.resName,n.default.RES_DISGUISE):i.changeBodyRes(t),i.addAttrIcon(),i},e.prototype.getIceDemon=function(t,e){var o=null;(o=cc.instantiate(this.iceDemon)).active=!1,o.parent=t.node;var i=o.getComponent(m.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss000",a.updateHA(this.maxHealth00,this.maxHealth00,0),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getEvilEye=function(t,e){var o=null;(o=cc.instantiate(this.evilEye)).active=!1,o.parent=t.node;var i=o.getComponent(g.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss008",a.updateHA(this.maxHealth08,this.maxHealth08,0),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getWarMachine=function(t,e){var o=null;(o=cc.instantiate(this.warmachine)).active=!1,o.parent=t.node;var i=o.getComponent(p.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss001",a.updateHA(this.maxHealth01,this.maxHealth01,2),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getDryad=function(t,e){var o=null;(o=cc.instantiate(this.dryad)).active=!1,o.parent=t.node;var i=o.getComponent(y.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss005",a.updateHA(this.maxHealth05,this.maxHealth05,2),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getSphinx=function(t,e){var o=null;(o=cc.instantiate(this.sphinx)).active=!1,o.parent=t.node;var i=o.getComponent(v.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss007",a.updateHA(this.maxHealth07,this.maxHealth07,2),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getDragon=function(t,e){var o=null;(o=cc.instantiate(this.dragon)).active=!1,o.parent=t.node;var i=o.getComponent(D.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss009",a.updateHA(this.maxHealth09,this.maxHealth09,5),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getRah=function(t,e){var o=null;(o=cc.instantiate(this.rah)).active=!1,o.parent=t.node;var i=o.getComponent(d.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss006",a.updateHA(this.maxHealth06,this.maxHealth06,0),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getKraken=function(t,e){var o=null;(o=cc.instantiate(this.kraken)).active=!1,o.parent=t.node;var i=o.getComponent(r.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss003",a.updateHA(this.maxHealth03,this.maxHealth03,2),i.data=a,i.transportBoss(Math.floor(c.default.WIDTH_SIZE/2),c.default.HEIGHT_SIZE+4),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getCaptain=function(t,e){var o=null;(o=cc.instantiate(this.captain)).active=!1,o.parent=t.node;var i=o.getComponent(l.default);i.dungeon=t;var a=new s.default;return a.resName="iconboss002",a.updateHA(this.maxHealth02,this.maxHealth02,2),i.data=a,i.transportBoss(e.x,e.y),i.healthBar=t.bossHealthBar,i.node.active=!0,i},e.prototype.getSlime=function(t,e,o){var i=null;(i=cc.instantiate(this.slime)).active=!1,i.parent=t.node;var a=i.getComponent(u.default);a.dungeon=t;var n=new s.default;switch(n.resName="iconboss004",n.Common.moveSpeed=200,o){case 0:n.updateHA(this.maxHealth04,this.maxHealth04,2),a.scaleSize=2;break;case 1:n.updateHA(200,200,2),a.scaleSize=1.5;break;case 2:n.updateHA(100,100,2),a.scaleSize=1;break;case 3:n.updateHA(50,50,2),a.scaleSize=.5;break;case 4:n.updateHA(25,25,2),a.scaleSize=.3;break;case 5:n.updateHA(10,10,1),a.scaleSize=.2;break;default:n.updateHA(5,5,1),a.scaleSize=.2}return a.slimeType=o,a.node.scaleY=a.scaleSize,a.node.scaleX=a.scaleSize,a.data=n,a.transportBoss(e.x,e.y),a.healthBar=t.bossHealthBar,a.node.active=!0,a},e.prototype.addRandomMonsters=function(t){var e=new Array,i=f.default.getRandomNum(1,3);switch(h.default.chapterName){case h.default.CHAPTER00:e=[o.MONSTER_ZEBRA,o.MONSTER_TERRORDRONE,o.MONSTER_KILLER,o.MONSTER_ZOOMBIE,o.MONSTER_ELECTRICEYE,o.MONSTER_GIRAFFE],i=f.default.getRandomNum(1,3);break;case h.default.CHAPTER01:e=[o.MONSTER_PIRATE,o.MONSTER_SAILOR,o.MONSTER_OCTOPUS,o.MONSTER_STRONGSAILOR,o.MONSTER_FISH,o.MONSTER_BOOMER],i=f.default.getRandomNum(2,3);break;case h.default.CHAPTER02:e=[o.MONSTER_SLIME,o.MONSTER_GOBLIN,o.MONSTER_GOBLIN_ARCHER,o.MONSTER_WEREWOLF,o.MONSTER_SNAKE,o.MONSTER_CHICKEN,o.MONSTER_HIPPO],i=f.default.getRandomNum(2,4);break;case h.default.CHAPTER03:e=[o.MONSTER_MUMMY,o.MONSTER_ANUBIS,o.MONSTER_SCARAB,o.MONSTER_CROCODILE,o.MONSTER_SANDSTATUE],i=f.default.getRandomNum(2,5);break;case h.default.CHAPTER04:e=[o.MONSTER_GARGOYLE,o.MONSTER_WARLOCK,o.MONSTER_DEMON,o.MONSTER_ELECTRICEYE,o.MONSTER_SPIDER],i=f.default.getRandomNum(3,6)}for(var a=0;a<=i;a++){var n=t.floorIndexmap[f.default.getRandomNum(0,t.floorIndexmap.length-1)];t.addMonsterFromData(e[f.default.getRandomNum(0,e.length-1)],n.x,n.y)}},e.BOSS_KRAKEN="BOSS_KRAKEN",e.MONSTER_SLIME="monster000",e.MONSTER_GOBLIN="monster001",e.MONSTER_MUMMY="monster002",e.MONSTER_ANUBIS="monster003",e.MONSTER_PIRATE="monster004",e.MONSTER_SAILOR="monster005",e.MONSTER_OCTOPUS="monster006",e.MONSTER_KILLER="monster007",e.MONSTER_STRONGSAILOR="monster008",e.MONSTER_CHEST="monster009",e.MONSTER_GARGOYLE="monster010",e.MONSTER_CHICKEN="monster011",e.MONSTER_SCARAB="monster012",e.MONSTER_GOBLIN_ARCHER="monster013",e.MONSTER_TERRORDRONE="monster014",e.MONSTER_WEREWOLF="monster015",e.MONSTER_DUMMY="monster016",e.MONSTER_ZEBRA="monster017",e.MONSTER_GIRAFFE="monster018",e.MONSTER_ZOOMBIE="monster019",e.MONSTER_ELECTRICEYE="monster020",e.MONSTER_FISH="monster021",e.MONSTER_CROCODILE="monster022",e.MONSTER_SNAKE="monster023",e.MONSTER_DEMON="monster024",e.MONSTER_WARLOCK="monster025",e.MONSTER_SPIDER="monster026",e.MONSTER_BOOMER="monster027",e.MONSTER_SANDSTATUE="monster028",e.MONSTER_HIPPO="monster029",a([R(cc.Prefab)],e.prototype,"monster",void 0),a([R(cc.Prefab)],e.prototype,"kraken",void 0),a([R(cc.Prefab)],e.prototype,"captain",void 0),a([R(cc.Prefab)],e.prototype,"slime",void 0),a([R(cc.Prefab)],e.prototype,"warmachine",void 0),a([R(cc.Prefab)],e.prototype,"rah",void 0),a([R(cc.Prefab)],e.prototype,"iceDemon",void 0),a([R(cc.Prefab)],e.prototype,"evilEye",void 0),a([R(cc.Prefab)],e.prototype,"dryad",void 0),a([R(cc.Prefab)],e.prototype,"sphinx",void 0),a([R(cc.Prefab)],e.prototype,"dragon",void 0),e=o=a([E],e)}(cc.Component);o.default=S,cc._RF.pop()},{"../Boss/Captain":"Captain","../Boss/Dragon":"Dragon","../Boss/Dryad":"Dryad","../Boss/EvilEye":"EvilEye","../Boss/IceDemon":"IceDemon","../Boss/Kraken":"Kraken","../Boss/Rah":"Rah","../Boss/Slime":"Slime","../Boss/Sphinx":"Sphinx","../Boss/WarMachine":"WarMachine","../Data/MonsterData":"MonsterData","../Dungeon":"Dungeon","../Logic":"Logic","../Monster":"Monster","../Utils/Random":"Random","./MonsterRandomAttr":"MonsterRandomAttr"}],MonsterRandomAttr:[function(t,e,o){"use strict";cc._RF.push(e,"9949f1Fu8NGLLz3ZQCj49YJ","MonsterRandomAttr"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Utils/Random"),a=function(){function t(){this.attrmap={},this.attrmap={}}return t.prototype.hasAttr=function(t){return this.attrmap[t]&&this.attrmap[t]>0},t.prototype.addAttr=function(t){var e=t>9?""+t:"0"+t;this.attrmap["attr_"+e]=1},t.prototype.removeAttr=function(t){var e=t>9?""+t:"0"+t;this.attrmap["attr_"+e]=0},t.prototype.addRandomAttrs=function(t){this.attrmap={};for(var e=0;e<t;e++)this.addAttr(i.default.getRandomNum(1,23))},t.prototype.updateMonsterData=function(e){return this.hasAttr(t.ATTR_01)&&(e.Common.maxHealth=1,e.currentHealth=1),this.hasAttr(t.ATTR_02)&&(e.Common.damageMin+=5),this.hasAttr(t.ATTR_03)&&(e.Common.maxHealth+=5,e.currentHealth+=5),this.hasAttr(t.ATTR_04)&&(e.Common.damageMin=1),this.hasAttr(t.ATTR_05)&&(e.Common.moveSpeed-=100,e.Common.moveSpeed<0&&(e.Common.moveSpeed=50)),this.hasAttr(t.ATTR_06)&&(e.Common.moveSpeed+=100),this.hasAttr(t.ATTR_07)&&e.melee>0&&(e.melee+=2),this.hasAttr(t.ATTR_08)&&e.melee>0&&(e.melee=1),this.hasAttr(t.ATTR_09)&&e.remote>0&&e.isLineAim<=0&&e.isArcAim<=0&&(e.remote=1),this.hasAttr(t.ATTR_10)&&e.remote>0&&(e.remote+=2),this.hasAttr(t.ATTR_11)&&e.remote>0&&(e.bulletLineExNum+=1),this.hasAttr(t.ATTR_12)&&e.remote>0&&(e.bulletExSpeed=-100),this.hasAttr(t.ATTR_13)&&e.remote>0&&(e.bulletExSpeed=100),this.hasAttr(t.ATTR_14)&&(e.Common.dodge+=50,e.Common.dodge>60&&(e.Common.dodge=60)),this.hasAttr(t.ATTR_15)&&(e.Common.lifeRecovery=1),this.hasAttr(t.ATTR_16)&&(e.blink>0?e.blink=2:e.blink=5),this.hasAttr(t.ATTR_17)&&(e.Common.iceDamage+=1,e.Common.iceRate=100),this.hasAttr(t.ATTR_18)&&(e.Common.fireDamage+=1,e.Common.fireRate=100),this.hasAttr(t.ATTR_19)&&(e.Common.lighteningDamage+=1,e.Common.lighteningRate=100),this.hasAttr(t.ATTR_20)&&(e.Common.toxicDamage+=1,e.Common.toxicRate=100),this.hasAttr(t.ATTR_21)&&(e.Common.curseDamage+=1,e.Common.curseRate=100),this.hasAttr(t.ATTR_22)&&(e.Common.realDamage+=1,e.Common.realRate=100),this.hasAttr(t.ATTR_23)&&(e.isBoom=1),e},t.ATTR_01="attr_01",t.ATTR_02="attr_02",t.ATTR_03="attr_03",t.ATTR_04="attr_04",t.ATTR_05="attr_05",t.ATTR_06="attr_06",t.ATTR_07="attr_07",t.ATTR_08="attr_08",t.ATTR_09="attr_09",t.ATTR_10="attr_10",t.ATTR_11="attr_11",t.ATTR_12="attr_12",t.ATTR_13="attr_13",t.ATTR_14="attr_14",t.ATTR_15="attr_15",t.ATTR_16="attr_16",t.ATTR_17="attr_17",t.ATTR_18="attr_18",t.ATTR_19="attr_19",t.ATTR_20="attr_20",t.ATTR_21="attr_21",t.ATTR_22="attr_22",t.ATTR_23="attr_23",t}();o.default=a,cc._RF.pop()},{"../Utils/Random":"Random"}],Monster:[function(t,e,o){"use strict";cc._RF.push(e,"b7513vXKLpHGrSf+utaohLs","Monster");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=t("./EventConstant"),l=t("./HealthBar"),h=t("./Logic"),u=t("./Data/MonsterData"),p=t("./Dungeon"),d=t("./Shooter"),f=t("./Player"),m=t("./Manager/StatusManager"),g=t("./Data/DamageData"),y=t("./Manager/FloatingLabelManager"),v=t("./Utils/Random"),D=t("./Utils/Skill"),C=t("./Item/Item"),_=t("./Base/Actor"),E=t("./Achievement"),R=t("./Utils/AudioPlayer"),S=t("./Manager/SpecialManager"),T=t("./Data/FromData"),O=t("./Actor/MonsterDangerBox"),A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=cc.v2(0,0),e.healthBar=null,e.statusManager=null,e.floatinglabelManager=null,e.specialManager=null,e.boom=null,e.dangerBox=null,e.dangerTips=null,e.attrPrefab=null,e.isFaceRight=!0,e.isMoving=!1,e.isDied=!1,e.isFall=!1,e.isShow=!1,e.isDizz=!1,e.timeDelay=0,e.data=new u.default,e.shooter=null,e.isHurt=!1,e.isDisguising=!1,e.currentlinearVelocitySpeed=cc.Vec2.ZERO,e.isVariation=!1,e.remoteSkill=new D.default,e.meleeSkill=new D.default,e.specialSkill=new D.default,e.dashSkill=new D.default,e.blinkSkill=new D.default,e.isAttackAnimExcuting=!1,e.moveTarget=cc.v2(0,0),e.attrmap={},e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;if(this.graphics=this.getComponent(cc.Graphics),this.meleeSkill.IsExcuting=!1,this.isShow=!1,this.isDied=!1,this.anim=this.getComponent(cc.Animation),this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite),this.boxCollider=this.getComponent(cc.BoxCollider),this.isVariation){var e=this.data.sizeType&&this.data.sizeType>0?this.data.sizeType:1;this.node.scale=o.SCALE_NUM*e}this.dashlight=this.sprite.getChildByName("dashlight"),this.dashlight.opacity=0,this.shadow=this.sprite.getChildByName("shadow"),this.rigidbody=this.getComponent(cc.RigidBody),this.shooter=this.node.getChildByName("Shooter").getComponent(d.default),this.effectNode=this.node.getChildByName("Effect"),this.particleIce=this.node.getChildByName("Effect").getChildByName("ice").getComponent(cc.ParticleSystem),this.particleFire=this.node.getChildByName("Effect").getChildByName("fire").getComponent(cc.ParticleSystem),this.particleLightening=this.node.getChildByName("Effect").getChildByName("lightening").getComponent(cc.ParticleSystem),this.particleToxic=this.node.getChildByName("Effect").getChildByName("toxic").getComponent(cc.ParticleSystem),this.particleCurse=this.node.getChildByName("Effect").getChildByName("curse").getComponent(cc.ParticleSystem),this.particleBlood=this.node.getChildByName("Effect").getChildByName("blood").getComponent(cc.ParticleSystem),this.attrNode=this.node.getChildByName("attr"),this.updatePlayerPos(),this.actionSpriteFrameIdle(),this.scheduleOnce(function(){t.isShow=!0},.5),this.changeBodyColor(),this.data.isHeavy>0&&(this.rigidbody.type=cc.RigidBodyType.Static),this.stopAttackEffect(),this.dangerBox.init(this)},e.prototype.addAttrIcon=function(){for(var t in this.attrNode||(this.attrNode=this.node.getChildByName("attr")),this.attrNode.removeAllChildren(),this.attrmap){var e=cc.instantiate(this.attrPrefab);e.getComponent(cc.Sprite).spriteFrame=h.default.spriteFrames[t],this.attrNode.addChild(e)}},e.prototype.showDangerTips=function(){var t=this;this.dangerTips.opacity=255,this.scheduleOnce(function(){t.dangerTips.opacity=0},1)},e.prototype.showCircle=function(){var t=this,e=0,o=function(){t.graphics.clear(),t.graphics.fillColor=cc.color(255,0,0,80),t.graphics.arc(0,0,e,Math.PI/2,Math.PI+Math.PI/2),e+=2,t.graphics.fill(),e>80*t.node.scaleY&&(e=80*t.node.scaleY),t.isHurt&&(t.unschedule(o),t.graphics.clear())};this.schedule(o,.016,40)},e.prototype.getCurrentBodyRes=function(){return this.sprite||(this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite)),this.bodySprite.spriteFrame.name},e.prototype.changeBodyRes=function(t,e){this.sprite||(this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.sprite.getChildByName("body").getComponent(cc.Sprite)),this.boxCollider||(this.boxCollider=this.getComponent(cc.BoxCollider)),this.shadow||(this.shadow=this.sprite.getChildByName("shadow"));var o=this.getSpriteFrameByName(t,e);this.bodySprite.spriteFrame=o,this.bodySprite.node.width=o.getRect().width,this.bodySprite.node.height=o.getRect().height;var i=48,a=80,n=80;switch(this.data.boxType){case 0:i=32,a=80,n=64;break;case 1:i=48,a=48,n=96;break;case 2:i=48,a=80,n=80;break;case 3:i=64,a=80,n=128;break;case 4:i=32,a=128,n=48;break;case 5:i=48,a=80,n=112;break;default:i=48,a=80,n=80}this.boxCollider.offset=cc.v2(0,i),this.boxCollider.size.width=a,this.boxCollider.size.height=n,this.data.boxType>2?this.shadow.scale=3:this.shadow.scale=2},e.prototype.getSpriteFrameByName=function(t,e){var o=h.default.spriteFrames[t+e];return o||(o=h.default.spriteFrames[t]),o},e.prototype.updatePlayerPos=function(){this.node.position=p.default.getPosInMap(this.pos)},e.prototype.transportPlayer=function(t,e){this.sprite.angle=0,this.sprite.scale=1,this.sprite.opacity=255,this.sprite.x=0,this.sprite.y=0,this.pos.x=t,this.pos.y=e,this.changeZIndex(),this.updatePlayerPos()},e.prototype.changeZIndex=function(){this.node.zIndex=3e3+10*(p.default.HEIGHT_SIZE-this.pos.y)+2},e.prototype.showFloatFont=function(t,e,o,i,a){if(this.floatinglabelManager){var n=this.floatinglabelManager.getFloaingLabel(t);o?n.showDoge():i?n.showMiss():0!=e?n.showDamage(-e,a):n.hideLabel()}},e.prototype.remoteAttack=function(t){this.remoteSkill.IsExcuting=!1;var e=this.shooter.node.position.clone();e.x=this.shooter.node.scaleX>0?e.x+30:-e.x-30;var o=this.dungeon.player.getCenterPosition().sub(this.node.position.add(e));o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),this.shooter.setHv(o),this.shooter.from.valueCopy(T.default.getClone(this.data.nameCn,this.data.resName)),this.isVariation&&(this.shooter.data.bulletSize=.5),this.shooter.dungeon=this.dungeon,this.shooter.data.bulletArcExNum=this.data.bulletArcExNum,this.shooter.data.bulletLineExNum=this.data.bulletLineExNum,this.shooter.data.bulletLineInterval=this.data.bulletLineInterval,t&&(this.shooter.data.bulletLineExNum=this.data.specialBulletLineExNum,this.shooter.data.bulletArcExNum=this.data.specialBulletArcExNum),this.shooter.data.isArcAim=this.data.isArcAim,this.shooter.data.isLineAim=this.data.isLineAim,this.shooter.data.bulletType=this.data.bulletType?this.data.bulletType:"bullet001",this.shooter.data.bulletExSpeed=this.data.bulletExSpeed,this.shooter.fireBullet(h.default.getRandomNum(0,5)-5,cc.v2(this.data.shooterOffsetX,this.data.shooterOffsetY)))},e.prototype.showAttackAnim=function(t,e,i,a){var n=this;if(!this.isAttackAnimExcuting){this.isAttackAnimExcuting=!0;var s=this.dungeon.player.node.position.clone().sub(this.node.position);s.equals(cc.Vec2.ZERO)||(s=s.normalizeSelf()),this.anim.pause(),s.equals(cc.Vec2.ZERO)&&(s=cc.v2(1,0)),s=s.normalizeSelf().mul(this.node.scaleX>0?48:-48),this.sprite.stopAllActions(),this.idleAction=null;var r=0;this.data.attackType==O.default.ATTACK_STAB&&i&&(r=.8);var c=cc.sequence(cc.callFunc(function(){n.changeBodyRes(n.data.resName,o.RES_ATTACK01),i&&n.dangerBox.show(n.data.attackType)}),cc.delayTime(r),cc.moveBy(.5,-s.x/2,-s.y/2),cc.callFunc(function(){n.changeBodyRes(n.data.resName,o.RES_ATTACK02),i&&(n.dangerBox.hide(a),n.data.attackType==O.default.ATTACK_STAB&&(n.moveTarget=n.dangerBox.hv.mul(n.dangerBox.node.width),n.move(n.moveTarget,5e3)))}),cc.delayTime(r),cc.moveBy(.2,s.x,s.y),cc.callFunc(function(){n.dangerBox.finish(),n.moveTarget=cc.Vec2.ZERO})),l=cc.sequence(cc.callFunc(function(){n.changeBodyRes(n.data.resName,o.RES_ATTACK03)}),cc.callFunc(function(){n.specialManager.dungeon=n.dungeon,n.specialManager.addEffect(n.data.specialType,n.data.specialDistance,n.isFaceRight,T.default.getClone(n.data.nameCn,n.data.resName))}),cc.moveBy(.1,5,0),cc.moveBy(.1,-5,0),cc.moveBy(.1,5,0),cc.moveBy(.1,-5,0),cc.moveBy(.1,5,0),cc.moveBy(.1,-5,0),cc.moveBy(.1,5,0),cc.moveBy(.1,-5,0),cc.callFunc(function(){n.changeBodyRes(n.data.resName,o.RES_ATTACK04)}),cc.callFunc(function(){n.specialManager.dungeon=n.dungeon,n.specialManager.addPlacement(n.data.specialType,n.data.specialDistance,n.isFaceRight,T.default.getClone(n.data.nameCn,n.data.resName))}),cc.delayTime(.5)),h=cc.sequence(cc.callFunc(function(){n.anim.resume(),t&&t(e)}),cc.moveTo(.2,0,0),cc.callFunc(function(){n.changeBodyRes(n.data.resName,o.RES_WALK01),n.changeFaceRight(),n.isAttackAnimExcuting=!1})),u=cc.sequence(c,h);e&&(u=cc.sequence(l,h),this.showDangerTips()),this.sprite.runAction(u)}},e.prototype.actionSpriteFrameIdle=function(){var t=this;if(!(!this.sprite||this.meleeSkill.IsExcuting||this.remoteSkill.IsExcuting||this.isDied||this.isFall||this.isHurt||this.isDisguising)){h.default.spriteFrames[this.data.resName+o.RES_WALK01];var e=h.default.spriteFrames[this.data.resName+o.RES_WALK02],i=!e,a=!!e,n=!!h.default.spriteFrames[this.data.resName+o.RES_WALK03];n&&(i=!1,a=!1),this.idleAction||(i?this.idleAction=cc.repeatForever(cc.sequence(cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK01)}))):a?this.idleAction=cc.repeatForever(cc.sequence(cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK01)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK02)}))):n&&(this.idleAction=cc.repeatForever(cc.sequence(cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK01)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK02)}),cc.moveBy(.2,0,0),cc.callFunc(function(){t.changeBodyRes(t.data.resName,o.RES_WALK03)})))),this.sprite.runAction(this.idleAction)),this.idleAction.isDone()&&this.sprite.runAction(this.idleAction)}},e.prototype.getNearPlayerDistance=function(t){return h.default.getDistance(this.node.position,t.position)},e.prototype.move=function(t,e){if(!(this.isDied||this.isFall||this.isHurt||this.dashSkill.IsExcuting||this.isDisguising||t.equals(cc.Vec2.ZERO))){var o=!1;this.moveTarget.equals(cc.Vec2.ZERO)||(t=this.moveTarget.clone(),o=!0),t=t.normalizeSelf(),this.meleeSkill.IsExcuting&&!t.equals(cc.Vec2.ZERO)&&(t=t.mul(.1)),o&&(t=t.mul(2.5)),t.equals(cc.Vec2.ZERO)||(this.pos=p.default.getIndexInMap(this.node.position));var i=t.x,a=t.y,n=Math.abs(i),s=Math.abs(a),r=n>s?n:s;r=0==r?1:r;var c=cc.v2(i,a);e<0&&(e=0),c=c.mul(e),this.rigidbody.linearVelocity=c.clone(),this.currentlinearVelocitySpeed=c.clone(),this.isMoving=0!=i||0!=a,this.isMoving&&!this.isAttackAnimExcuting&&!this.isDisguising&&this.data.isHeavy<1&&(this.isFaceRight=i>=0),this.changeZIndex()}},e.prototype.start=function(){this.changeZIndex(),this.healthBar.refreshHealth(this.data.getHealth().x,this.data.getHealth().y)},e.prototype.fall=function(){this.isDied||(this.isFall=!0,this.bodySprite.node.angle=-75,this.anim.play("MonsterFall"))},e.prototype.FallFinish=function(){this.isFall=!1,this.bodySprite.node.angle=0,this.sprite.y=0,this.sprite.x=0,this.anim.play("MonsterIdle")},e.prototype.takeDamage=function(t){var e=this;if(!this.isShow)return!1;if(this.data.invisible>0&&this.sprite.opacity<200&&h.default.getRandomNum(1,10)>4)return this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike),!1;if(this.blinkSkill.IsExcuting)return this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike),!1;var i=this.data.getDamage(t),a=this.data.getDodge(),n=v.default.rand()<=a&&i.getTotalDamage()>0;return i=n?new g.default:i,n?(this.showFloatFont(this.dungeon.node,0,!0,!1,t.isCriticalStrike),!1):(this.isHurt=i.getTotalDamage()>0,this.isDisguising=!1,this.specialSkill.IsExcuting||(this.meleeSkill.IsExcuting=!1,this.remoteSkill.IsExcuting=!1,this.isAttackAnimExcuting=!1,i.getTotalDamage()>0&&this.changeBodyRes(this.data.resName,o.RES_HIT01),this.sprite.stopAllActions(),t.isCriticalStrike&&this.fall()),this.idleAction=null,i.getTotalDamage()>0&&(this.dangerBox.finish(),this.moveTarget=cc.Vec2.ZERO,this.bodySprite.node.color=cc.color(255,0,0),this.showBloodEffect(),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:R.default.MONSTER_HIT}}),this.scheduleOnce(function(){e.node&&(e.isHurt=!1,e.changeBodyColor())},.2)),this.sprite.opacity=255,this.data.currentHealth-=i.getTotalDamage(),this.data.currentHealth>this.data.getHealth().y&&(this.data.currentHealth=this.data.getHealth().y),this.healthBar.refreshHealth(this.data.currentHealth,this.data.getHealth().y),this.showFloatFont(this.dungeon.node,i.getTotalDamage(),!1,!1,t.isCriticalStrike),this.data.Common.lifeRecovery>0&&this.isHurt&&this.addStatus(m.default.RECOVERY,new T.default),this.isHurt)},e.prototype.changeBodyColor=function(){if(this.data){var t="#000000";t=this.getMixColor(t,this.data.getIceDefence()+this.data.getIceDamage()>0?"#CCFFFF":"#000000"),t=this.getMixColor(t,this.data.getFireDefence()+this.data.getFireDamage()>0?"#FF6633":"#000000"),t=this.getMixColor(t,this.data.getLighteningDefence()+this.data.getLighteningDamage()>0?"#0099FF":"#000000"),t=this.getMixColor(t,this.data.getToxicDefence()+this.data.getToxicDamage()>0?"#66CC00":"#000000"),t="#000000"==(t=this.getMixColor(t,this.data.getCurseDefence()+this.data.getCurseDamage()>0?"#660099":"#000000"))?"#ffffff":t,this.bodySprite.node.color=cc.color(255,255,255).fromHEX(t)}},e.prototype.getMixColor=function(t,e){var o=cc.color().fromHEX(t),i=cc.color().fromHEX(e),a=cc.color(),n=o.getR()+i.getR(),s=o.getG()+i.getG(),r=o.getB()+i.getB();return a.setR(n>255?255:n),a.setG(s>255?255:s),a.setB(r>255?255:r),"#"+a.toHEX("#rrggbb")},e.prototype.addStatus=function(t,e){this.statusManager.addStatus(t,e)},e.prototype.showAttackEffect=function(t){this.particleIce&&(this.effectNode.setPosition(cc.v2(0,16)),t||this.effectNode.runAction(cc.sequence(cc.moveTo(.2,32,32),cc.moveTo(.2,0,16))),this.data.getIceDamage()>0?this.particleIce.resetSystem():this.particleIce.stopSystem(),this.data.getFireDamage()>0?this.particleFire.resetSystem():this.particleFire.stopSystem(),this.data.getLighteningDamage()>0?this.particleLightening.resetSystem():this.particleLightening.stopSystem(),this.data.getToxicDamage()>0?this.particleToxic.resetSystem():this.particleToxic.stopSystem(),this.data.getCurseDamage()>0?this.particleCurse.resetSystem():this.particleCurse.stopSystem())},e.prototype.stopAttackEffect=function(){this.particleIce&&(this.particleIce.stopSystem(),this.particleFire.stopSystem(),this.particleLightening.stopSystem(),this.particleToxic.stopSystem(),this.particleCurse.stopSystem())},e.prototype.showBloodEffect=function(){var t=this;this.particleBlood.resetSystem(),this.scheduleOnce(function(){t.particleBlood.stopSystem()},.5)},e.prototype.addPlayerStatus=function(t,e){h.default.getRandomNum(0,100)<this.data.getIceRate()&&t.addStatus(m.default.FROZEN,e),h.default.getRandomNum(0,100)<this.data.getFireRate()&&t.addStatus(m.default.BURNING,e),h.default.getRandomNum(0,100)<this.data.getLighteningRate()&&t.addStatus(m.default.DIZZ,e),h.default.getRandomNum(0,100)<this.data.getToxicRate()&&t.addStatus(m.default.TOXICOSIS,e),h.default.getRandomNum(0,100)<this.data.getCurseRate()&&t.addStatus(m.default.CURSING,e),h.default.getRandomNum(0,100)<this.data.getRealRate()&&t.addStatus(m.default.BLEEDING,e)},e.prototype.killed=function(){var t=this;if(!this.isDied){this.isDied=!0,this.isDisguising&&this.changeBodyRes(this.data.resName),this.isDisguising=!1,this.dashSkill.IsExcuting=!1,this.anim.play("MonsterDie"),this.idleAction=null,this.sprite.stopAllActions(),this.getComponent("cc.PhysicsCollider").sensor=!0;var e=v.default.rand();this.dungeon&&(e<.8?cc.director.emit(c.EventConstant.DUNGEON_ADD_COIN,{detail:{pos:this.node.position,count:h.default.getRandomNum(1,10)}}):e>=.8&&e<.825?this.dungeon.addItem(this.node.position.clone(),C.default.HEART):e>=.825&&e<.85?this.dungeon.addItem(this.node.position.clone(),C.default.AMMO):e>=.85&&e<.875?this.dungeon.addItem(this.node.position.clone(),C.default.BOTTLE_ATTACKSPEED):e>=.875&&e<.9?this.dungeon.addItem(this.node.position.clone(),C.default.BOTTLE_MOVESPEED):e>=.9&&e<.925?this.dungeon.addItem(this.node.position.clone(),C.default.BOTTLE_HEALING):e>=.925&&e<1&&this.dungeon.addEquipment(h.default.getRandomEquipType(),this.pos,null,1)),E.default.addMonsterKillAchievement(this.data.resName),this.scheduleOnce(function(){if(t.node){if(1==t.data.isBoom){var e=cc.instantiate(t.boom);e.parent=t.node.parent,e.setPosition(t.node.position),e.zIndex=4100,cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:R.default.BOOM}})}t.scheduleOnce(function(){t.node.active=!1},25)}},2)}},e.prototype.getCenterPosition=function(){return this.node.position.clone().addSelf(cc.v2(0,32*this.node.scaleY))},e.prototype.blink=function(){var t=this;this.data.blink>0&&this.blinkSkill.next(function(){cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:R.default.BLINK}}),t.blinkSkill.IsExcuting=!0;var e=t.sprite.getChildByName("body"),o=cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){var e=t.dungeon.player.pos.clone();e=t.dungeon.player.pos.x>t.pos.x?e.addSelf(cc.v2(1,0)):e.addSelf(cc.v2(-1,0));var o=p.default.getPosInMap(e);t.node.setPosition(o)}),cc.fadeIn(.5));e.runAction(o),t.scheduleOnce(function(){t.blinkSkill.IsExcuting=!1},1.5)},this.data.blink,!0)},e.prototype.monsterAction=function(){var t=this;if(!this.isDied&&this.dungeon&&!this.isHurt&&!this.isFall&&this.isShow&&!this.isDizz){this.node.position=p.default.fixOuterMap(this.node.position),this.pos=p.default.getIndexInMap(this.node.position),this.changeZIndex();var e=cc.v2(0,0);e.x+=h.default.getRandomNum(0,200)-100,e.y+=h.default.getRandomNum(0,200)-100;var o=this.getNearPlayerDistance(this.dungeon.player.node),i=e.clone();this.data.specialAttack>0&&this.specialSkill.next(function(){t.specialSkill.IsExcuting=!0},this.data.specialAttack,!0);var a=100;this.specialSkill.IsExcuting&&(a=200),this.data.attackType==O.default.ATTACK_STAB&&(a=300),o<a*this.node.scaleY&&!this.dungeon.player.isDied&&this.data.melee>0&&!this.dashSkill.IsExcuting&&!this.blinkSkill.IsExcuting&&!this.isDisguising&&this.meleeSkill.next(function(){cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:R.default.MELEE}}),t.meleeSkill.IsExcuting=!0,t.showAttackEffect(!1);var e=h.default.getRandomNum(0,100)<t.data.StatusTotalData.missRate;e&&t.showFloatFont(t.dungeon.node,0,!1,!0,!1),t.showAttackAnim(function(e){t.meleeSkill.IsExcuting=!1,t.stopAttackEffect(),t.graphics&&t.graphics.clear(),t.specialSkill.IsExcuting=!1},t.specialSkill.IsExcuting,!0,e),t.sprite.opacity=255},this.data.melee),this.blink(),this.data.melee>0&&(i=this.getMovePosFromPlayer()),o<600&&this.data.remote>0&&this.shooter&&!this.isDisguising&&!this.meleeSkill.IsExcuting&&this.remoteSkill.next(function(){t.remoteSkill.IsExcuting=!0,t.changeFaceRight(),t.showAttackAnim(function(e){t.remoteAttack(e),t.specialSkill.IsExcuting=!1},t.specialSkill.IsExcuting,!1,!1),t.sprite.opacity=255},this.data.remote,!0);var n=this.data.getMoveSpeed();o<600&&o>100&&!this.dungeon.player.isDied&&this.data.dash>0&&!this.dashSkill.IsExcuting&&!this.isDisguising&&this.dashSkill.next(function(){cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:R.default.MELEE}}),i=t.getMovePosFromPlayer(),t.showAttackEffect(!0),t.move(i,1.2*n),t.dashSkill.IsExcuting=!0,t.scheduleOnce(function(){t.node&&(t.dashSkill.IsExcuting=!1,t.stopAttackEffect())},3)},this.data.dash),this.data.disguise>0&&o<this.data.disguise&&!this.dungeon.player.isDied&&this.isDisguising&&(this.changeBodyRes(this.data.resName),this.isDisguising=!1),h.default.getHalfChance()&&!this.shooter.isAiming&&o>64*this.node.scaleY&&!this.isAttackAnimExcuting&&this.move(i,n)}},e.prototype.getMovePosFromPlayer=function(){var t=this.dungeon.player.pos.clone();t=this.dungeon.player.pos.x>this.pos.x?t.addSelf(cc.v2(1,0)):t.addSelf(cc.v2(-1,0));var e=p.default.getPosInMap(t);return e=e.sub(this.node.position),!this.isAttackAnimExcuting&&!this.isAttackAnimExcuting&&!this.isDisguising&&this.data.isHeavy<1&&this.changeFaceRight(),e},e.prototype.changeFaceRight=function(){var t=this.dungeon.player.node.position.clone(),e=(t=t.sub(this.node.position)).x;this.isFaceRight=e>=0},e.prototype.lerp=function(t,e,o){return t+(e-t)*o},e.prototype.onCollisionEnter=function(t,e){if(t.getComponent(f.default)&&this.dashSkill.IsExcuting&&this.dungeon&&!this.isHurt&&!this.isDied){this.dashSkill.IsExcuting=!1,this.rigidbody.linearVelocity=cc.Vec2.ZERO;var o=T.default.getClone(this.data.nameCn,this.data.resName);this.addPlayerStatus(this.dungeon.player,o),this.stopAttackEffect(),this.dungeon.player.takeDamage(this.data.getAttackPoint(),o,this)}},e.prototype.dizzCharacter=function(t){var e=this;t>0&&(this.isDizz=!0,this.scheduleOnce(function(){e.isDizz=!1},t))},e.prototype.getScaleSize=function(){var t=this.data.sizeType&&this.data.sizeType>0?this.data.sizeType:1;return this.isVariation?o.SCALE_NUM*t:t},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>.2&&(this.timeDelay=0,this.monsterAction(),this.actionSpriteFrameIdle()),this.data.invisible>0&&this.sprite.opacity>10&&(this.sprite.opacity=this.lerp(this.sprite.opacity,9,3*t)),this.dashlight.opacity=0,this.dungeon&&this.dashSkill.IsExcuting&&(this.dashlight.opacity=128,this.rigidbody.linearVelocity=this.currentlinearVelocitySpeed.clone()),this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.healthBar.node.opacity=this.isDisguising?0:255,this.shadow&&(this.shadow.opacity=this.isDisguising?0:128),this.isDisguising&&this.anim&&this.anim.pause(),this.data.invisible>0&&(this.healthBar.node.opacity=this.sprite.opacity>20?255:9),this.healthBar.node.active=!this.isDied,this.data.currentHealth<1&&this.killed();var e=this.getScaleSize();this.node.scaleX=this.isFaceRight?e:-e,this.node.scaleY=e,this.healthBar.node.scaleX=this.node.scaleX>0?1:-1,this.healthBar.node.x=-30*this.node.scaleX,this.healthBar.node.y=3==this.data.boxType||5==this.data.boxType?150:120,this.healthBar.progressBar.barSprite.node.color=this.isVariation?cc.color(128,0,128):cc.color(194,0,0),this.dashlight.color=this.isVariation?cc.color(0,0,0):cc.color(255,255,255),this.attrNode&&(this.attrNode.opacity=this.healthBar.node.opacity)},e.prototype.actorName=function(){return this.data.nameCn},e.RES_DISGUISE="disguise",e.RES_WALK01="anim001",e.RES_WALK02="anim002",e.RES_WALK03="anim003",e.RES_HIT01="hit001",e.RES_ATTACK01="anim004",e.RES_ATTACK02="anim005",e.RES_ATTACK03="anim006",e.RES_ATTACK04="anim007",e.SCALE_NUM=1.5,a([r(cc.Vec2)],e.prototype,"pos",void 0),a([r(l.default)],e.prototype,"healthBar",void 0),a([r(m.default)],e.prototype,"statusManager",void 0),a([r(y.default)],e.prototype,"floatinglabelManager",void 0),a([r(S.default)],e.prototype,"specialManager",void 0),a([r(cc.Prefab)],e.prototype,"boom",void 0),a([r(O.default)],e.prototype,"dangerBox",void 0),a([r(cc.Node)],e.prototype,"dangerTips",void 0),a([r(cc.Prefab)],e.prototype,"attrPrefab",void 0),e=o=a([s],e)}(_.default);o.default=A,cc._RF.pop()},{"./Achievement":"Achievement","./Actor/MonsterDangerBox":"MonsterDangerBox","./Base/Actor":"Actor","./Data/DamageData":"DamageData","./Data/FromData":"FromData","./Data/MonsterData":"MonsterData","./Dungeon":"Dungeon","./EventConstant":"EventConstant","./HealthBar":"HealthBar","./Item/Item":"Item","./Logic":"Logic","./Manager/FloatingLabelManager":"FloatingLabelManager","./Manager/SpecialManager":"SpecialManager","./Manager/StatusManager":"StatusManager","./Player":"Player","./Shooter":"Shooter","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random","./Utils/Skill":"Skill"}],OilLake:[function(t,e,o){"use strict";cc._RF.push(e,"8cd153I1qFEbb/uteHyUJpM","OilLake");var i=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./PerlinNoise2D"),n=t("../Utils/Random"),s=cc._decorator,r=s.ccclass,c=(s.property,function(){function t(){this.map=new Array;var t,o,i,s,r=new a.default;r.seed(n.default.rand()),i=20+this.getRandomNum(20),s=20+this.getRandomNum(20),t=this.getRandomNum(9999),o=this.getRandomNum(9999);var c=e.WIDTH,l=e.HEIGHT;this.map=new Array;for(var h=0;h<c;h++){this.map[h]=new Array;for(var u=0;u<l;u++){this.map[h][u]=".";var p=i*h/c+t,d=s*u/l+o,f=r.simplex2(p,d);f>.14?this.map[h][u]="Y":f<-.14&&(this.map[h][u]="~");var m=n.default.rand();m>=0&&m<.2&&"~"!=this.map[h][u]&&(this.map[h][u]="o"),m>=.2&&m<.25&&"~"!=this.map[h][u]&&(this.map[h][u]="w")}}}var e;return e=t,t.prototype.getRandomNum=function(t){return Math.round(n.default.rand()*t)},t.prototype.getDisPlay=function(){for(var t="",o=e.HEIGHT-1;o>=0;o--){for(var i=0;i<e.WIDTH;i++)t+=this.map[i][o];t+="\n"}return t},t.WIDTH=64,t.HEIGHT=64,t=e=i([r],t)}());o.default=c,cc._RF.pop()},{"../Utils/Random":"Random","./PerlinNoise2D":"PerlinNoise2D"}],ParallaxBackground:[function(t,e,o){"use strict";cc._RF.push(e,"509a7aimNhEX5/e74VkypMj","ParallaxBackground");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Logic"),r=cc._decorator,c=r.ccclass,l=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.layer1=null,e.layer2=null,e}return i(e,t),e.prototype.init=function(){this.layer1.getComponent(cc.Sprite).spriteFrame=s.default.spriteFrames["chapter0"+s.default.chapterName+"layer1"],this.layer2.getComponent(cc.Sprite).spriteFrame=s.default.spriteFrames["chapter0"+s.default.chapterName+"layer2"]},e.prototype.getPlayer=function(){return this.player||(this.player=this.node.parent.getComponent(n.default).player),this.player},e.prototype.start=function(){},e.prototype.lateUpdate=function(){var t=this.getPlayer().node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.layer1.position=this.lerp(this.layer1.position,this.node.convertToNodeSpaceAR(t),.005),this.layer2.position=this.lerp(this.layer2.position,this.node.convertToNodeSpaceAR(t),.015)},e.prototype.lerp=function(t,e,o){var i=cc.v2(0,0),a=t.x,n=t.y;return i.x=a+(e.x-a)*o,i.y=n+(e.y-n)*o,i},a([l(cc.Node)],e.prototype,"background",void 0),a([l(cc.Node)],e.prototype,"layer1",void 0),a([l(cc.Node)],e.prototype,"layer2",void 0),e=a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic"}],PerlinNoise2D:[function(t,e,o){"use strict";cc._RF.push(e,"59901zRRqlG9KvoKLDTbxq7","PerlinNoise2D");var i=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,n=a.ccclass,s=(a.property,function(){function t(){this.grad3=[new r(1,1,0),new r(-1,1,0),new r(1,-1,0),new r(-1,-1,0),new r(1,0,1),new r(-1,0,1),new r(1,0,-1),new r(-1,0,-1),new r(0,1,1),new r(0,-1,1),new r(0,1,-1),new r(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.F2=.5*(Math.sqrt(3)-1),this.G2=(3-Math.sqrt(3))/6,this.F3=1/3,this.G3=1/6}return t.prototype.simplex2=function(t,e){var o,i,a=(t+e)*this.F2,n=Math.floor(t+a),s=Math.floor(e+a),r=(n+s)*this.G2,c=t-n+r,l=e-s+r;c>l?(o=1,i=0):(o=0,i=1);var h=c-o+this.G2,u=l-i+this.G2,p=c-1+2*this.G2,d=l-1+2*this.G2;n&=255,s&=255;var f=this.gradP[n+this.perm[s]],m=this.gradP[n+o+this.perm[s+i]],g=this.gradP[n+1+this.perm[s+1]],y=.5-c*c-l*l,v=.5-h*h-u*u,D=.5-p*p-d*d;return 70*((y<0?0:(y*=y)*y*f.dot2(c,l))+(v<0?0:(v*=v)*v*m.dot2(h,u))+(D<0?0:(D*=D)*D*g.dot2(p,d)))},t.prototype.simplex3=function(t,e,o){var i,a,n,s,r,c,l=(t+e+o)*this.F3,h=Math.floor(t+l),u=Math.floor(e+l),p=Math.floor(o+l),d=(h+u+p)*this.G3,f=t-h+d,m=e-u+d,g=o-p+d;f>=m?m>=g?(i=1,a=0,n=0,s=1,r=1,c=0):f>=g?(i=1,a=0,n=0,s=1,r=0,c=1):(i=0,a=0,n=1,s=1,r=0,c=1):m<g?(i=0,a=0,n=1,s=0,r=1,c=1):f<g?(i=0,a=1,n=0,s=0,r=1,c=1):(i=0,a=1,n=0,s=1,r=1,c=0);var y=f-i+this.G3,v=m-a+this.G3,D=g-n+this.G3,C=f-s+2*this.G3,_=m-r+2*this.G3,E=g-c+2*this.G3,R=f-1+3*this.G3,S=m-1+3*this.G3,T=g-1+3*this.G3;h&=255,u&=255,p&=255;var O=this.gradP[h+this.perm[u+this.perm[p]]],A=this.gradP[h+i+this.perm[u+a+this.perm[p+n]]],b=this.gradP[h+s+this.perm[u+r+this.perm[p+c]]],M=this.gradP[h+1+this.perm[u+1+this.perm[p+1]]],P=.6-f*f-m*m-g*g,L=.6-y*y-v*v-D*D,I=.6-C*C-_*_-E*E,x=.6-R*R-S*S-T*T;return 32*((P<0?0:(P*=P)*P*O.dot3(f,m,g))+(L<0?0:(L*=L)*L*A.dot3(y,v,D))+(I<0?0:(I*=I)*I*b.dot3(C,_,E))+(x<0?0:(x*=x)*x*M.dot3(R,S,T)))},t.prototype.perlin2=function(t,e){var o=Math.floor(t),i=Math.floor(e);t-=o,e-=i,o&=255,i&=255;var a=this.gradP[o+this.perm[i]].dot2(t,e),n=this.gradP[o+this.perm[i+1]].dot2(t,e-1),s=this.gradP[o+1+this.perm[i]].dot2(t-1,e),r=this.gradP[o+1+this.perm[i+1]].dot2(t-1,e-1),c=this.fade(t);return this.lerp(this.lerp(a,s,c),this.lerp(n,r,c),this.fade(e))},t.prototype.perlin3=function(t,e,o){var i=Math.floor(t),a=Math.floor(e),n=Math.floor(o);t-=i,e-=a,o-=n,i&=255,a&=255,n&=255;var s=this.gradP[i+this.perm[a+this.perm[n]]].dot3(t,e,o),r=this.gradP[i+this.perm[a+this.perm[n+1]]].dot3(t,e,o-1),c=this.gradP[i+this.perm[a+1+this.perm[n]]].dot3(t,e-1,o),l=this.gradP[i+this.perm[a+1+this.perm[n+1]]].dot3(t,e-1,o-1),h=this.gradP[i+1+this.perm[a+this.perm[n]]].dot3(t-1,e,o),u=this.gradP[i+1+this.perm[a+this.perm[n+1]]].dot3(t-1,e,o-1),p=this.gradP[i+1+this.perm[a+1+this.perm[n]]].dot3(t-1,e-1,o),d=this.gradP[i+1+this.perm[a+1+this.perm[n+1]]].dot3(t-1,e-1,o-1),f=this.fade(t),m=this.fade(e),g=this.fade(o);return this.lerp(this.lerp(this.lerp(s,h,f),this.lerp(r,u,f),g),this.lerp(this.lerp(c,p,f),this.lerp(l,d,f),g),m)},t.prototype.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var o=void 0;o=1&e?this.p[e]^255&t:this.p[e]^t>>8&255,this.perm[e]=this.perm[e+256]=o,this.gradP[e]=this.gradP[e+256]=this.grad3[o%12]}},t.prototype.lerp=function(t,e,o){return(1-o)*t+o*e},t.prototype.fade=function(t){return t*t*t*(t*(6*t-15)+10)},t=i([n],t)}());o.default=s;var r=function(){function t(t,e,o){this.x=t,this.y=e,this.z=o}return t.prototype.dot2=function(t,e){return this.x*t+this.y*e},t.prototype.dot3=function(t,e,o){return this.x*t+this.y*e+this.z*o},t}();cc._RF.pop()},{}],PlayerData:[function(t,e,o){"use strict";cc._RF.push(e,"802a53ZqslNorozVvKYFivM","PlayerData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./EquipmentData"),a=t("./DamageData"),n=t("./StatusData"),s=t("./CommonData"),r=t("../Utils/Random"),c=function(){function t(){this.name="",this.pos=cc.v2(7,4),this.currentHealth=t.DEFAULT_HEALTH,this.equipmentTotalData=new i.default,this.statusTotalData=new n.default,this.common=new s.default,this.common.maxHealth=t.DEFAULT_HEALTH,this.common.moveSpeed=t.DefAULT_SPEED,this.common.damageMin=t.DefAULT_ATTACK}return Object.defineProperty(t.prototype,"EquipmentTotalData",{get:function(){return this.equipmentTotalData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StatusTotalData",{get:function(){return this.statusTotalData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),t.prototype.getCommonList=function(){return[this.common,this.equipmentTotalData.Common,this.statusTotalData.Common]},t.prototype.updateHA=function(t,e){return this.currentHealth=t.x,this.common.maxHealth=t.y,this.common.damageMin=this.common.damageMin,this},t.prototype.valueCopy=function(e){this.common.valueCopy(e.common),this.pos=e.pos?cc.v2(e.pos.x,e.pos.y):cc.v2(4,7),this.name=e.name?e.name:"",this.equipmentTotalData.valueCopy(e.equipmentTotalData),this.statusTotalData.valueCopy(e.statusTotalData),this.currentHealth=e.currentHealth?e.currentHealth:t.DEFAULT_HEALTH,this.common.maxHealth=e.common.maxHealth?e.common.maxHealth:t.DEFAULT_HEALTH,this.common.moveSpeed=e.common.moveSpeed?e.common.moveSpeed:300},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.pos=this.pos,e.name=this.name,e.currentHealth=this.currentHealth,e.equipmentTotalData=this.equipmentTotalData,e.statusTotalData=this.statusTotalData,e},t.prototype.getFinalAttackPoint=function(){var t=new a.default,e=this.getDamageMin(),o=this.getDamageMax(),i=this.getCriticalStrikeRate(),n=r.default.rand()<i,s=n?e+o:e;return s<0&&(s=0),t.isCriticalStrike=n,t.physicalDamage=s,t.realDamage=this.getRealDamage(),t.iceDamage=this.getIceDamage(),t.fireDamage=this.getFireDamage(),t.lighteningDamage=this.getLighteningDamage(),t.toxicDamage=this.getToxicDamage(),t.curseDamage=this.getCurseDamage(),t},t.prototype.getFinalRemoteDamage=function(){var t=new a.default,e=this.getRemoteDamage(),o=this.getRemoteCritRate(),i=r.default.rand()<o,n=i?e+e:e;return n<0&&(n=0),t.physicalDamage=n,t.isCriticalStrike=i,t},t.prototype.getDamage=function(t){var e=t.clone(),o=this.getDefence(),i=this.getIceDefence(),a=this.getFireDefence(),n=this.getLighteningDefence(),s=this.getToxicDefence(),r=this.getCurseDefence();return e.physicalDamage=o>=0?e.physicalDamage*(1-.06*o/(.06*o+1)):e.physicalDamage*(2-Math.pow(.94,-o)),e.iceDamage=e.iceDamage*(1-i/100),e.fireDamage=e.fireDamage*(1-a/100),e.lighteningDamage=e.lighteningDamage*(1-n/100),e.toxicDamage=e.toxicDamage*(1-s/100),e.curseDamage=e.curseDamage*(1-r/100),e},t.prototype.getLifeDrain=function(){var t=this.getCriticalStrikeRate(),e=this.getLifeDrainRate(),o=0;return r.default.rand()<e&&(o=1,r.default.rand()<t&&(o=2)),o},t.prototype.getMoveSpeed=function(){for(var e=0,o=0,i=this.getCommonList();o<i.length;o++){e+=i[o].moveSpeed}return e>2*t.DefAULT_SPEED&&(e=2*t.DefAULT_SPEED),e<2*-t.DefAULT_SPEED&&(e=2*-t.DefAULT_SPEED),e},t.prototype.getAttackSpeed=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].attackSpeed}return t},t.prototype.getRemoteSpeed=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].remoteSpeed}return t},t.prototype.getRemoteDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].remoteDamage}return t},t.prototype.getDamageMin=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].damageMin}return t},t.prototype.getDamageMax=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].damageMax}return t},t.prototype.getCriticalStrikeRate=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].criticalStrikeRate/100}return 1-t},t.prototype.getRemoteCritRate=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].remoteCritRate/100}return 1-t},t.prototype.getDodge=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].dodge/100}return 1-t},t.prototype.getDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].defence}return t},t.prototype.getHealth=function(){for(var t=1,e=0,o=0,i=this.getCommonList();o<i.length;o++){e+=i[o].maxHealth}return e>0?(t=this.currentHealth/e,cc.v2(e*t,e)):cc.v2(1,1)},t.prototype.getIceDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceDefence}return t>100&&(t=100),t},t.prototype.getFireDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireDefence}return t>100&&(t=100),t},t.prototype.getLighteningDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningDefence}return t>100&&(t=100),t},t.prototype.getToxicDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicDefence}return t>100&&(t=100),t},t.prototype.getCurseDefence=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseDefence}return t>100&&(t=100),t},t.prototype.getRealDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].realDamage}return t<0&&(t=0),t},t.prototype.getIceDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceDamage}return t<0&&(t=0),t},t.prototype.getFireDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireDamage}return t<0&&(t=0),t},t.prototype.getLighteningDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningDamage}return t<0&&(t=0),t},t.prototype.getToxicDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicDamage}return t<0&&(t=0),t},t.prototype.getCurseDamage=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseDamage}return t<0&&(t=0),t},t.prototype.getRealRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].realRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getIceRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].iceRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getFireRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].fireRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getLighteningRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lighteningRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getToxicRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].toxicRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getCurseRate=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].curseRate}return t=(t=t<0?0:t)>100?100:t},t.prototype.getLifeRecovery=function(){for(var t=0,e=0,o=this.getCommonList();e<o.length;e++){t+=o[e].lifeRecovery}return t>0?t:0},t.prototype.getLifeDrainRate=function(){for(var t=1,e=0,o=this.getCommonList();e<o.length;e++){t*=1-o[e].lifeDrain/100}return 1-t},t.DEFAULT_HEALTH=5,t.DefAULT_SPEED=300,t.DefAULT_ATTACK=1,t}();o.default=c,cc._RF.pop()},{"../Utils/Random":"Random","./CommonData":"CommonData","./DamageData":"DamageData","./EquipmentData":"EquipmentData","./StatusData":"StatusData"}],PlayerInfoDialog:[function(t,e,o){"use strict";cc._RF.push(e,"15316LuMnlLl6y6PlDqoReo","PlayerInfoDialog");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attack=null,e.criticalStrikeRate=null,e.defence=null,e.lifeDrain=null,e.lifeRecovery=null,e.moveSpeed=null,e.attackSpeed=null,e.dodge=null,e.health=null,e.realDamage=null,e.realRate=null,e.iceDamage=null,e.iceDefence=null,e.iceRate=null,e.fireDamage=null,e.fireDefence=null,e.fireRate=null,e.lighteningDamage=null,e.lighteningDefence=null,e.lighteningRate=null,e.toxicDamage=null,e.toxicDefence=null,e.toxicRate=null,e.curseDamage=null,e.curseDefence=null,e.curseRate=null,e.isShow=!1,e.layout=null,e}return i(e,t),e.prototype.onLoad=function(){this.attack=this.node.getChildByName("layout").getChildByName("attack").getChildByName("label").getComponent(cc.Label),this.criticalStrikeRate=this.node.getChildByName("layout").getChildByName("criticalStrikeRate").getChildByName("label").getComponent(cc.Label),this.defence=this.node.getChildByName("layout").getChildByName("defence").getChildByName("label").getComponent(cc.Label),this.lifeDrain=this.node.getChildByName("layout").getChildByName("lifeDrain").getChildByName("label").getComponent(cc.Label),this.lifeRecovery=this.node.getChildByName("layout").getChildByName("lifeRecovery").getChildByName("label").getComponent(cc.Label),this.moveSpeed=this.node.getChildByName("layout").getChildByName("moveSpeed").getChildByName("label").getComponent(cc.Label),this.attackSpeed=this.node.getChildByName("layout").getChildByName("attackSpeed").getChildByName("label").getComponent(cc.Label),this.dodge=this.node.getChildByName("layout").getChildByName("dodge").getChildByName("label").getComponent(cc.Label),this.health=this.node.getChildByName("layout").getChildByName("health").getChildByName("label").getComponent(cc.Label),this.realDamage=this.node.getChildByName("layout").getChildByName("realDamage").getChildByName("label").getComponent(cc.Label),this.realRate=this.node.getChildByName("layout").getChildByName("realRate").getChildByName("label").getComponent(cc.Label),this.iceDamage=this.node.getChildByName("layout").getChildByName("iceDamage").getChildByName("label").getComponent(cc.Label),this.iceDefence=this.node.getChildByName("layout").getChildByName("iceDefence").getChildByName("label").getComponent(cc.Label),this.iceRate=this.node.getChildByName("layout").getChildByName("iceRate").getChildByName("label").getComponent(cc.Label),this.fireDamage=this.node.getChildByName("layout").getChildByName("fireDamage").getChildByName("label").getComponent(cc.Label),this.fireDefence=this.node.getChildByName("layout").getChildByName("fireDefence").getChildByName("label").getComponent(cc.Label),this.fireRate=this.node.getChildByName("layout").getChildByName("fireRate").getChildByName("label").getComponent(cc.Label),this.lighteningDamage=this.node.getChildByName("layout").getChildByName("lighteningDamage").getChildByName("label").getComponent(cc.Label),this.lighteningDefence=this.node.getChildByName("layout").getChildByName("lighteningDefence").getChildByName("label").getComponent(cc.Label),this.lighteningRate=this.node.getChildByName("layout").getChildByName("lighteningRate").getChildByName("label").getComponent(cc.Label),this.toxicDamage=this.node.getChildByName("layout").getChildByName("toxicDamage").getChildByName("label").getComponent(cc.Label),this.toxicDefence=this.node.getChildByName("layout").getChildByName("toxicDefence").getChildByName("label").getComponent(cc.Label),this.toxicRate=this.node.getChildByName("layout").getChildByName("toxicRate").getChildByName("label").getComponent(cc.Label),this.curseDamage=this.node.getChildByName("layout").getChildByName("curseDamage").getChildByName("label").getComponent(cc.Label),this.curseDefence=this.node.getChildByName("layout").getChildByName("curseDefence").getChildByName("label").getComponent(cc.Label),this.curseRate=this.node.getChildByName("layout").getChildByName("curseRate").getChildByName("label").getComponent(cc.Label),this.layout=this.node.getChildByName("layout"),this.addSpriteTouchEvent()},e.prototype.start=function(){},e.prototype.refreshDialog=function(t,e,o){this.attack&&(this.attack.string=this.getInfo(t.Common.damageMin,e.Common.damageMin,o.Common.damageMin)+"->"+this.getInfo(t.Common.damageMax,e.Common.damageMax,o.Common.damageMax),this.criticalStrikeRate.string=this.getInfo(t.Common.criticalStrikeRate,e.Common.criticalStrikeRate,o.Common.criticalStrikeRate,!0),this.defence.string=this.getInfo(t.Common.defence,e.Common.defence,o.Common.defence),this.lifeDrain.string=this.getInfo(t.Common.lifeDrain,e.Common.lifeDrain,o.Common.lifeDrain,!0),this.lifeRecovery.string=this.getInfo(t.Common.lifeRecovery,e.Common.lifeRecovery,o.Common.lifeRecovery),this.moveSpeed.string=this.getInfo(t.Common.moveSpeed,e.Common.moveSpeed,o.Common.moveSpeed),this.attackSpeed.string=this.getInfo(t.Common.attackSpeed,e.Common.attackSpeed,o.Common.attackSpeed,!0),this.dodge.string=this.getInfo(t.Common.dodge,e.Common.dodge,o.Common.dodge,!0),this.health.string=t.currentHealth.toFixed(1).replace(".0","")+"/"+this.getInfo(t.Common.maxHealth,e.Common.maxHealth,o.Common.maxHealth),this.realDamage.string=this.getInfo(t.Common.realDamage,e.Common.realDamage,o.Common.realDamage),this.realRate.string=this.getInfo(t.Common.realRate,e.Common.realRate,o.Common.realRate,!0),this.iceDamage.string=this.getInfo(t.Common.iceDamage,e.Common.iceDamage,o.Common.iceDamage),this.iceDefence.string=this.getInfo(t.Common.iceDefence,e.Common.iceDefence,o.Common.iceDefence,!0),this.iceRate.string=this.getInfo(t.Common.iceRate,e.Common.iceRate,o.Common.iceRate,!0),this.fireDamage.string=this.getInfo(t.Common.fireDamage,e.Common.fireDamage,o.Common.fireDamage),this.fireDefence.string=this.getInfo(t.Common.fireDefence,e.Common.fireDefence,o.Common.fireDefence,!0),this.fireRate.string=this.getInfo(t.Common.fireRate,e.Common.fireRate,o.Common.fireRate,!0),this.lighteningDamage.string=this.getInfo(t.Common.lighteningDamage,e.Common.lighteningDamage,o.Common.lighteningDamage),this.lighteningDefence.string=this.getInfo(t.Common.lighteningDefence,e.Common.lighteningDefence,o.Common.lighteningDefence,!0),this.lighteningRate.string=this.getInfo(t.Common.lighteningRate,e.Common.lighteningRate,o.Common.lighteningRate,!0),this.toxicDamage.string=this.getInfo(t.Common.toxicDamage,e.Common.toxicDamage,o.Common.toxicDamage),this.toxicDefence.string=this.getInfo(t.Common.toxicDefence,e.Common.toxicDefence,o.Common.toxicDefence,!0),this.toxicRate.string=this.getInfo(t.Common.toxicRate,e.Common.toxicRate,o.Common.toxicRate,!0),this.curseDamage.string=this.getInfo(t.Common.curseDamage,e.Common.curseDamage,o.Common.curseDamage),this.curseDefence.string=this.getInfo(t.Common.curseDefence,e.Common.curseDefence,o.Common.curseDefence,!0),this.curseRate.string=this.getInfo(t.Common.curseRate,e.Common.curseRate,o.Common.curseRate,!0))},e.prototype.getInfo=function(t,e,o,i){var a=""+(t+e+o).toFixed(1).replace(".0","");return i&&(a+="%"),e>0?(a+=" E:+"+e.toFixed(1).replace(".0",""),i&&(a+="%")):e<0&&(a+=" E:"+e.toFixed(1).replace(".0",""),i&&(a+="%")),o>0?(a+=" S:+"+o.toFixed(1).replace(".0",""),i&&(a+="%")):o<0&&(a+=" S:"+o.toFixed(1).replace(".0",""),i&&(a+="%")),a},e.prototype.addSpriteTouchEvent=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){t.isShow=!0}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.isShow=!1}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.isShow=!1})},e.prototype.update=function(t){this.layout.active=this.isShow},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"03570PUzDdNyIu4Asd1jFZT","Player");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=n.property,c=t("./EventConstant"),l=t("./Shooter"),h=t("./Logic"),u=t("./Dungeon"),p=t("./Equipment/Equipment"),d=t("./MeleeWeapon"),f=t("./Rect/RectDungeon"),m=t("./Manager/StatusManager"),g=t("./Data/DamageData"),y=t("./Data/PlayerData"),v=t("./Manager/FloatingLabelManager"),D=t("./UI/Tips"),C=t("./Utils/Random"),_=t("./Talent/TalentShield"),E=t("./Talent/TalentDash"),R=t("./Base/Actor"),S=t("./Talent/Talent"),T=t("./Utils/AudioPlayer"),O=t("./Data/FromData"),A=t("./Achievement"),b=t("./Talent/TalentMagic"),M=t("./Item/Item"),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=cc.v2(0,0),e.floatinglabelManager=null,e.walksmoke=null,e.meleeWeaponNode=null,e.meleeWeapon=null,e.shooter=null,e.shooterEx=null,e.statusManager=null,e.hairSprite=null,e.weaponSprite=null,e.weaponLightSprite=null,e.weaponStabSprite=null,e.weaponStabLightSprite=null,e.helmetSprite=null,e.clothesSprite=null,e.trousersSprite=null,e.pantsSprite=null,e.glovesLeftSprite=null,e.shoesLeftSprite=null,e.shoesRightSprite=null,e.cloakSprite=null,e.bodySprite=null,e.isMoving=!1,e.isAttacking=!1,e.isHeavyRemotoAttacking=!1,e.isDied=!1,e.isFall=!1,e.isStone=!1,e.isDizz=!1,e.baseAttackPoint=1,e.recoveryTimeDelay=0,e.isFaceRight=!0,e.defaultPos=cc.v2(0,0),e.remoteRate=0,e.smokeTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;this.isAttacking=!1,this.inventoryManager=h.default.inventoryManager,this.data=h.default.playerData,this.statusUpdate(),this.pos=cc.v2(0,0),this.isDied=!1,this.isStone=!1,this.anim=this.getComponent(cc.Animation),this.rigidbody=this.getComponent(cc.RigidBody),this.sprite=this.node.getChildByName("sprite"),this.bodySprite=this.getSpriteChildSprite(["sprite","body","body"]),this.hairSprite=this.getSpriteChildSprite(["sprite","body","head","hair"]),this.weaponSprite=this.getSpriteChildSprite(["MeleeWeapon","sprite","weapon"]),this.weaponLightSprite=this.getSpriteChildSprite(["MeleeWeapon","sprite","meleelight"]),this.weaponStabSprite=this.getSpriteChildSprite(["MeleeWeapon","sprite","stabweapon"]),this.weaponStabLightSprite=this.getSpriteChildSprite(["MeleeWeapon","sprite","stablight"]),this.helmetSprite=this.getSpriteChildSprite(["sprite","body","head","helmet"]),this.clothesSprite=this.getSpriteChildSprite(["sprite","body","body","clothes"]),this.trousersSprite=this.getSpriteChildSprite(["sprite","body","legs"]),this.pantsSprite=this.getSpriteChildSprite(["sprite","body","body","pants"]),this.glovesLeftSprite=this.getSpriteChildSprite(["sprite","body","handleft","gloveleft"]),this.shoesLeftSprite=this.getSpriteChildSprite(["sprite","body","legs","footleft","shoes"]),this.shoesRightSprite=this.getSpriteChildSprite(["sprite","body","legs","footright","shoes"]),this.cloakSprite=this.getSpriteChildSprite(["sprite","cloak"]),cc.director.on(c.EventConstant.PLAYER_TRIGGER,function(e){t.triggerThings()}),cc.director.on(c.EventConstant.PLAYER_USEITEM,function(e){t.useItem(e.detail.itemData)}),cc.director.on(c.EventConstant.PLAYER_SKILL,function(e){t.useSkill()}),cc.director.on(c.EventConstant.PLAYER_ATTACK,function(e){t.meleeAttack()}),cc.director.on(c.EventConstant.PLAYER_REMOTEATTACK,function(e){t.remoteAttack()}),cc.director.on(c.EventConstant.PLAYER_STATUSUPDATE,function(e){t.statusUpdate()}),cc.director.on(c.EventConstant.PLAYER_TAKEDAMAGE,function(e){t.takeDamage(e.detail.damage,e.detail.from)}),h.default.mapManager.getCurrentRoomType()==f.default.BOSS_ROOM&&(h.default.playerData.pos=cc.v2(Math.floor(u.default.WIDTH_SIZE/2),2)),this.pos=h.default.playerData.pos.clone(),this.defaultPos=h.default.playerData.pos.clone(),this.baseAttackPoint=h.default.playerData.getDamageMin(),this.updatePlayerPos(),this.meleeWeapon=this.meleeWeaponNode.getComponent(d.default),this.shooter.player=this,this.shooterEx.player=this,this.shooterEx.isEx=!0,this.smokePool=new cc.NodePool,cc.director.on("destorysmoke",function(e){t.destroySmoke(e.detail.coinNode)}),this.talentShield=this.getComponent(_.default),this.talentShield.init(),this.talentShield.loadList(h.default.talentList),this.talentDash=this.getComponent(E.default),this.talentDash.init(),this.talentDash.loadList(h.default.talentList),this.talentMagic=this.getComponent(b.default),this.talentMagic.init(),this.talentMagic.loadList(h.default.talentList),this.anim&&(this.resetFoot(),this.playerAnim(o.STATE_WALK)),h.default.isCheatMode&&this.scheduleOnce(function(){t.data.currentHealth=1,t.data.Common.maxHealth=1,t.data.Common.damageMin=99,t.data.Common.remoteCritRate=50},.2)},e.prototype.actorName=function(){return"Player"},e.prototype.turnStone=function(t,e){},e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,o=0,i=t;o<i.length;o++){var a=i[o];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.dizzCharacter=function(t){var e=this;t>0&&(this.isDizz=!0,this.resetFoot(),this.rigidbody.linearVelocity=cc.Vec2.ZERO,this.playerAnim(o.STATE_IDLE),this.scheduleOnce(function(){e.isDizz=!1},t))},e.prototype.statusUpdate=function(){this.inventoryManager&&(this.data.EquipmentTotalData.valueCopy(this.inventoryManager.getTotalEquipmentData()),cc.director.emit(c.EventConstant.HUD_UPDATE_PLAYER_INFODIALOG,{detail:{data:this.data}}))},e.prototype.getWalkSmoke=function(t,e){var o=null;this.smokePool.size()>0&&(o=this.smokePool.get()),o&&!o.active||(o=cc.instantiate(this.walksmoke)),o.parent=t,o.position=e,o.zIndex=4e3,o.opacity=255,o.active=!0},e.prototype.destroySmoke=function(t){t&&(t.active=!1,this.smokePool&&this.smokePool.put(t))},e.prototype.changeEquipment=function(t,e){switch(t.equipmetType){case"weapon":this.meleeWeapon.isStab=1==t.stab,this.meleeWeapon.isFar=1==t.far,this.meleeWeapon.isReflect=1==t.isReflect,this.meleeWeapon.isFist=!1,this.meleeWeapon.setHands(),1==t.stab?(this.weaponSprite.spriteFrame=null,this.weaponStabSprite.spriteFrame=e,this.weaponStabLightSprite.spriteFrame=this.meleeWeapon.isFar?h.default.spriteFrames.stablight:h.default.spriteFrames.stablight1):(this.weaponSprite.spriteFrame=e,this.weaponStabSprite.spriteFrame=null);var o=cc.color(255,255,255).fromHEX(this.inventoryManager.weapon.color),i=cc.color(255,255,255).fromHEX(this.inventoryManager.weapon.lightcolor);this.weaponSprite.node.color=o,this.weaponLightSprite.node.color=i,this.weaponStabSprite.node.color=i,this.weaponStabLightSprite.node.color=i;break;case"remote":this.shooter.data=t.clone(),this.shooter.changeRes(this.shooter.data.img);var a=cc.color(255,255,255).fromHEX(this.shooter.data.color);this.shooter.changeResColor(a);break;case"helmet":this.hairSprite.node.opacity=1==this.inventoryManager.helmet.hideHair?0:255,this.updateEquipMent(this.helmetSprite,this.inventoryManager.helmet.color,e);break;case"clothes":this.updateEquipMent(this.clothesSprite,this.inventoryManager.clothes.color,e);break;case"trousers":var n=1==this.inventoryManager.trousers.trouserslong;this.updateEquipMent(this.trousersSprite,n?this.inventoryManager.trousers.color:"#ffffff",h.default.spriteFrames.playerlegs),this.updateEquipMent(this.pantsSprite,this.inventoryManager.trousers.color,e);break;case"gloves":this.updateEquipMent(this.glovesLeftSprite,this.inventoryManager.gloves.color,e),this.updateEquipMent(this.meleeWeapon.glovesStabSprite,this.inventoryManager.gloves.color,e),this.updateEquipMent(this.meleeWeapon.glovesWaveSprite,this.inventoryManager.gloves.color,e);break;case"shoes":this.updateEquipMent(this.shoesLeftSprite,this.inventoryManager.shoes.color,e),this.updateEquipMent(this.shoesRightSprite,this.inventoryManager.shoes.color,e);break;case"cloak":this.updateEquipMent(this.cloakSprite,this.inventoryManager.cloak.color,e)}this.data.EquipmentTotalData.valueCopy(this.inventoryManager.getTotalEquipmentData()),cc.director.emit(c.EventConstant.HUD_UPDATE_PLAYER_INFODIALOG,{detail:{data:this.data}});var s=this.data.getHealth();cc.director.emit(c.EventConstant.HUD_UPDATE_PLAYER_HEALTHBAR,{detail:{x:s.x,y:s.y}})},e.prototype.updateEquipMent=function(t,e,o){t.spriteFrame=o;var i=cc.color(255,255,255).fromHEX(e);t.node.color=i},e.prototype.getCenterPosition=function(){return this.node.position.clone().addSelf(cc.v2(0,32*this.node.scaleY))},e.prototype.updatePlayerPos=function(){this.node.position=u.default.getPosInMap(this.pos)},e.prototype.transportPlayer=function(t){this.sprite&&(this.sprite.angle=0,this.sprite.scale=5,this.sprite.opacity=255,this.sprite.x=0,this.sprite.y=0,this.pos=t,this.changeZIndex(this.pos),this.updatePlayerPos())},e.prototype.changeZIndex=function(t){this.node.zIndex=3e3+10*(u.default.HEIGHT_SIZE-t.y)+2},e.prototype.addStatus=function(t,e){this.node&&(this.talentShield.IsExcuting?this.talentShield.canAddStatus(t)&&this.statusManager.addStatus(t,e):this.statusManager.addStatus(t,e))},e.prototype.meleeAttack=function(){var t=this;if(!(!this.meleeWeapon||this.isAttacking||this.isDizz||this.isDied||this.isFall||this.meleeWeapon.isAttacking)){this.isAttacking=!0;var e=this.meleeWeapon.getHv().clone();e.equals(cc.Vec2.ZERO)&&(e=cc.v2(1,0)),(e=e.normalizeSelf().mul(15)).x=this.isFaceRight?e.x:-e.x;var i=y.default.DefAULT_SPEED-this.data.getAttackSpeed();i<1&&(this.meleeWeapon.isStab&&!this.meleeWeapon.isFar&&(i=0+i),this.meleeWeapon.isStab||this.meleeWeapon.isFar||(i=100+i),this.meleeWeapon.isStab&&this.meleeWeapon.isFar&&(i=150+i),!this.meleeWeapon.isStab&&this.meleeWeapon.isFar&&(i=300+i)),i<0&&(i=0);var a=this.sprite.position.clone(),n=cc.sequence(cc.moveBy(.1,-e.x,-e.y),cc.moveBy(.1,e.x,e.y),cc.callFunc(function(){t.scheduleOnce(function(){t.sprite.position=a.clone(),t.isAttacking=!1},i/1e3)},this));this.sprite.runAction(n);var s=h.default.getRandomNum(0,100)<this.data.StatusTotalData.missRate;s&&this.showFloatFont(this.node.parent,0,!1,!0,!1),this.playerAnim(o.STATE_ATTACK),this.meleeWeapon.attack(this.data,s),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:T.default.MELEE}})}},e.prototype.remoteAttack=function(){var t=this,e=!1;if(this.data&&!this.isDizz&&!this.isDied&&!this.isFall){var o=y.default.DefAULT_SPEED-this.data.getRemoteSpeed();o<10&&(o=10),o>10*l.default.DefAULT_SPEED&&(o=10*l.default.DefAULT_SPEED);var i=Date.now();i-this.remoteRate>o&&(this.remoteRate=i,e=!0),e&&(this.isHeavyRemotoAttacking=this.isHeavyRemoteShooter(),this.scheduleOnce(function(){t.isHeavyRemotoAttacking=!1},.2),this.shooter&&(this.shooter.remoteDamagePlayer=this.data.getFinalRemoteDamage(),this.shooter.fireBullet(0)))}},e.prototype.remoteExAttack=function(t){for(var e=0,o=this.inventoryManager.list;e<o.length;e++){var i=o[e],a=!1;t==d.default.COMBO1&&i.exBulletCombo1>0&&(a=!0),t==d.default.COMBO2&&i.exBulletCombo2>0&&(a=!0),t==d.default.COMBO3&&i.exBulletCombo3>0&&(a=!0),a&&i.exBulletTypeAttack.length>0&&C.default.getRandomNum(0,100)<i.exBulletRate&&(this.shooterEx.data.bulletType=i.exBulletTypeAttack,this.shooterEx.data.bulletArcExNum=i.bulletArcExNum,this.shooterEx.data.bulletLineExNum=i.bulletLineExNum,this.shooterEx.data.bulletSize=i.bulletSize,this.shooterEx.fireBullet(0,cc.v2(i.exBulletOffsetX,24)))}},e.prototype.remoteExHurt=function(){for(var t=0,e=this.inventoryManager.list;t<e.length;t++){var o=e[t];o.exBulletTypeHurt.length>0&&C.default.getRandomNum(0,100)<o.exBulletRate&&(this.shooterEx.data.bulletType=o.exBulletTypeHurt,this.shooterEx.data.bulletArcExNum=o.bulletArcExNum,this.shooterEx.data.bulletLineExNum=o.bulletLineExNum,this.shooterEx.data.bulletSize=o.bulletSize,this.shooterEx.fireBullet(0))}},e.prototype.isHeavyRemoteShooter=function(){return 1==this.shooter.data.isHeavy},e.prototype.move=function(t,e,i){if(!(this.isDied||this.isFall||this.isDizz)){this.isAttacking&&!e.equals(cc.Vec2.ZERO)&&(e=!this.meleeWeapon.isFar&&this.meleeWeapon.isStab?e.mul(.6):this.meleeWeapon.isFar&&this.meleeWeapon.isStab?e.mul(.3):this.meleeWeapon.isFar||this.meleeWeapon.isStab?e.mul(.1):e.mul(.3)),this.isHeavyRemotoAttacking&&!e.equals(cc.Vec2.ZERO)&&(e=e.mul(.1)),this.talentMagic&&this.talentMagic.magiccircle.isShow&&!this.talentMagic.hashTalent(S.default.MAGIC_05)&&(e=e.mul(.5)),this.talentShield&&this.talentShield.IsExcuting&&!this.talentMagic.hashTalent(S.default.SHIELD_12)&&(e=e.mul(.5)),this.shooter&&!e.equals(cc.Vec2.ZERO)&&(this.shooter.setHv(cc.v2(e.x,e.y)),this.pos=u.default.getIndexInMap(this.node.position),h.default.profileManager.data.playerData.pos=this.pos.clone()),this.shooterEx&&!e.equals(cc.Vec2.ZERO)&&this.shooterEx.setHv(cc.v2(e.x,e.y)),this.talentShield&&!e.equals(cc.Vec2.ZERO)&&this.talentShield.flyWheel.setHv(cc.v2(e.x,e.y));var a=e.x,n=e.y,s=Math.abs(a),r=Math.abs(n),c=s>r?s:r;c=0==c?1:c;var l=cc.v2(a,n),p=this.data.getMoveSpeed();p<0&&(p=0),l=l.mul(p),this.rigidbody.linearVelocity=l,this.isMoving=0!=a||0!=n,!this.isMoving||this.isAttacking||this.meleeWeapon.isAttacking||(this.isFaceRight=this.meleeWeapon.getHv().x>0),!this.meleeWeapon||e.equals(cc.Vec2.ZERO)||this.meleeWeapon.isAttacking||this.meleeWeapon.setHv(cc.v2(e.x,e.y)),this.isMoving&&!this.isStone?this.playerAnim(o.STATE_WALK):this.playerAnim(o.STATE_IDLE),(1==t||0==t)&&this.changeZIndex(this.pos)}},e.prototype.resetFoot=function(){this.trousersSprite.spriteFrame=h.default.spriteFrames.playerlegs,this.shoesLeftSprite.node.parent.setPosition(2,-1),this.shoesLeftSprite.node.parent.angle=0,this.shoesRightSprite.node.parent.setPosition(-2,-1),this.shoesRightSprite.node.parent.angle=0},e.prototype.playerAnim=function(t,e){switch(t){case o.STATE_IDLE:this.anim.getAnimationState("PlayerWalk").isPlaying&&(this.anim.play("PlayerIdle"),this.shooter.playWalk(!1));break;case o.STATE_WALK:this.anim.getAnimationState("PlayerWalk").isPlaying||this.anim.getAnimationState("PlayerFist").isPlaying||this.anim.getAnimationState("PlayerAttack").isPlaying||(this.anim.play("PlayerWalk"),this.shooter.playWalk(!0));break;case o.STATE_ATTACK:!this.meleeWeapon.isFar&&this.meleeWeapon.isStab||this.meleeWeapon.isFar&&!this.meleeWeapon.isStab?(this.anim.play("PlayerFist"),this.meleeWeapon.isFar&&!this.meleeWeapon.isStab?this.anim.getAnimationState("PlayerFist").speed=1:this.anim.getAnimationState("PlayerFist").speed=2):this.anim.play("PlayerAttack"),this.shooter.playWalk(!0);break;case o.STATE_FALL:case o.STATE_DIE:}},e.prototype.start=function(){if(this.node){this.changeZIndex(this.pos);var t=this.data.getHealth();cc.director.emit(c.EventConstant.HUD_UPDATE_PLAYER_HEALTHBAR,{detail:{x:t.x,y:t.y}})}},e.prototype.fall=function(){var t=this;this.isFall||(this.isFall=!0,this.anim.play("PlayerFall"),this.isAttacking=!1,this.scheduleOnce(function(){t.transportPlayer(t.defaultPos),t.playerAnim(o.STATE_IDLE),t.resetFoot();var e=new g.default;e.realDamage=1,t.takeDamage(e,O.default.getClone("\u8dcc\u843d","")),t.isFall=!1},2))},e.prototype.takeDamage=function(t,e,o){if(!this.data)return!1;this.talentShield.takeDamage(t,o);var i=this.data.getDamage(t),a=this.data.getDodge(),n=C.default.rand()<=a&&i.getTotalDamage()>0;this.talentDash.hashTalent(S.default.DASH_12)&&this.talentDash.IsExcuting&&i.getTotalDamage()>0&&(n=!0);var s=!1;i.getTotalDamage()>0&&(s=this.talentMagic.takeIce()),s&&(n=!0),i=n?new g.default:i;var r=this.data.getHealth();r.x-=i.getTotalDamage(),r.x>r.y&&(r.x=r.y),cc.director.emit(c.EventConstant.HUD_UPDATE_PLAYER_HEALTHBAR,{detail:{x:r.x,y:r.y}}),h.default.playerData.currentHealth=r.x,this.showFloatFont(this.node.parent,i.getTotalDamage(),n,!1,!1),h.default.playerData.currentHealth<=0&&this.killed(e);var l=!n&&i.getTotalDamage()>0;return l&&(cc.director.emit(c.EventConstant.CAMERA_SHAKE,{detail:{isHeavyShaking:!1}}),cc.director.emit(c.EventConstant.HUD_DAMAGE_CORNER_SHOW),this.remoteExHurt(),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:T.default.PLAYER_HIT}})),l},e.prototype.showFloatFont=function(t,e,o,i,a){if(this.floatinglabelManager){var n=this.floatinglabelManager.getFloaingLabel(t);o?n.showDoge():i?n.showMiss():0!=e?n.showDamage(-e,a):n.hideLabel()}},e.prototype.killed=function(t){this.isDied||(this.isDied=!0,this.anim.play("PlayerDie"),cc.director.emit(c.EventConstant.HUD_STOP_COUNTTIME),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:T.default.DIE}}),A.default.addPlayerDiedLifesAchievement(),this.scheduleOnce(function(){h.default.profileManager.clearData(),h.default.dieFrom.valueCopy(t),cc.audioEngine.stopMusic(),cc.director.loadScene("gameover")},1.5))},e.prototype.playerAction=function(t,e,o,i){this.meleeWeapon&&!this.meleeWeapon.dungeon&&(this.meleeWeapon.dungeon=i),this.shooter&&!this.shooter.dungeon&&(this.shooter.dungeon=i),this.shooterEx&&!this.shooterEx.dungeon&&(this.shooterEx.dungeon=i),this.talentDash&&!this.talentDash.IsExcuting&&this.move(t,e,o)},e.prototype.isRecoveryTimeDelay=function(t){return this.recoveryTimeDelay+=t,this.recoveryTimeDelay>30&&(this.recoveryTimeDelay=0,!0)},e.prototype.isSmokeTimeDelay=function(t){return this.smokeTimeDelay+=t,this.smokeTimeDelay>.3&&(this.smokeTimeDelay=0,!0)},e.prototype.update=function(t){if(this.isRecoveryTimeDelay(t)){var e=this.data.getLifeRecovery();if(e>0){var o=new g.default;o.realDamage=-e,this.takeDamage(o)}}this.isSmokeTimeDelay(t)&&this.isMoving&&this.getWalkSmoke(this.node.parent,this.node.position),this.isStone=this.statusManager.hasStatus(m.default.STONE),this.turnStone(this.isStone),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.useSkill=function(){h.default.hashTalent(S.default.SHIELD_01)?this.talentShield&&this.talentShield.useShield():h.default.hashTalent(S.default.DASH_01)?this.talentDash&&this.talentDash.useDash():h.default.hashTalent(S.default.MAGIC_01)&&this.talentMagic&&this.talentMagic.useMagic()},e.prototype.triggerThings=function(){this.touchedEquipment&&!this.touchedEquipment.isTaken&&(this.touchedEquipment.shopTable?h.default.coins>=this.touchedEquipment.shopTable.data.price&&(cc.director.emit(c.EventConstant.HUD_ADD_COIN,{detail:{count:-this.touchedEquipment.shopTable.data.price}}),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:T.default.COIN}}),this.touchedEquipment.taken(),this.touchedEquipment.shopTable.data.isSaled=!0,this.touchedEquipment=null):(this.touchedEquipment.taken(),this.touchedEquipment=null)),this.touchedItem&&!this.touchedItem.data.isTaken&&this.touchedItem.data.canSave&&(this.touchedItem.shopTable?h.default.coins>=this.touchedItem.shopTable.data.price&&(cc.director.emit(c.EventConstant.HUD_ADD_COIN,{detail:{count:-this.touchedItem.shopTable.data.price}}),cc.director.emit(c.EventConstant.PLAY_AUDIO,{detail:{name:T.default.COIN}}),this.touchedItem.taken(this),this.touchedItem.shopTable.data.isSaled=!0,this.touchedItem=null):(this.touchedItem.taken(this),this.touchedItem=null)),this.touchedTips&&this.touchedTips.next()},e.prototype.AttackFinish=function(){this.isAttacking=!1},e.prototype.onPreSolve=function(t,e,o){10==o.tag&&(t.disabledOnce=!0)},e.prototype.onCollisionEnter=function(t,e){this.touchedEquipment=null,this.touchedItem=null,this.touchedTips=null},e.prototype.onCollisionExit=function(t,e){this.touchedEquipment=null,this.touchedItem=null,this.touchedTips=null},e.prototype.onCollisionStay=function(t,e){var o=t.node.getComponent(p.default);o&&(this.touchedEquipment=o);var i=t.node.getComponent(M.default);i&&(this.touchedItem=i);var a=t.node.getComponent(D.default);a&&(this.touchedTips=a)},e.prototype.useItem=function(t){M.default.userIt(t,this)},e.STATE_IDLE=0,e.STATE_WALK=1,e.STATE_ATTACK=2,e.STATE_FALL=3,e.STATE_DIE=4,a([r(cc.Vec2)],e.prototype,"pos",void 0),a([r(v.default)],e.prototype,"floatinglabelManager",void 0),a([r(cc.Prefab)],e.prototype,"walksmoke",void 0),a([r(cc.Node)],e.prototype,"meleeWeaponNode",void 0),a([r(l.default)],e.prototype,"shooter",void 0),a([r(l.default)],e.prototype,"shooterEx",void 0),a([r(m.default)],e.prototype,"statusManager",void 0),e=o=a([s],e)}(R.default);o.default=P,cc._RF.pop()},{"./Achievement":"Achievement","./Base/Actor":"Actor","./Data/DamageData":"DamageData","./Data/FromData":"FromData","./Data/PlayerData":"PlayerData","./Dungeon":"Dungeon","./Equipment/Equipment":"Equipment","./EventConstant":"EventConstant","./Item/Item":"Item","./Logic":"Logic","./Manager/FloatingLabelManager":"FloatingLabelManager","./Manager/StatusManager":"StatusManager","./MeleeWeapon":"MeleeWeapon","./Rect/RectDungeon":"RectDungeon","./Shooter":"Shooter","./Talent/Talent":"Talent","./Talent/TalentDash":"TalentDash","./Talent/TalentMagic":"TalentMagic","./Talent/TalentShield":"TalentShield","./UI/Tips":"Tips","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random"}],Portal:[function(t,e,o){"use strict";cc._RF.push(e,"deb90P3hX5AB5svKZmVAO6Q","Portal");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../EventConstant"),r=t("../Player"),c=t("./Building"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=!1,e.pos=cc.v2(4,4),e}return i(e,t),e.prototype.start=function(){this.anim=this.getComponent(cc.Animation),this.anim.play("PortalCloseIdle")},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=1e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.AnimGateClose=function(){this.anim.play("PortalCloseIdle")},e.prototype.AnimGateOpen=function(){this.anim.play("PortalOpenIdle")},e.prototype.openGate=function(){this.isOpen||(this.isOpen=!0,this.anim.play("PortalOpen"))},e.prototype.closeGate=function(){this.isOpen&&(this.isOpen=!1,this.anim.play("PortalClose"))},e.prototype.transportPlayer=function(t){t.x==this.pos.x&&t.y==this.pos.y&&this.isOpen},e.prototype.onBeginContact=function(t,e,o){o.body.node.getComponent(r.default)&&this.isOpen&&(this.closeGate(),cc.director.emit(s.EventConstant.LOADINGNEXTLEVEL))},e=a([h],e)}(c.default));o.default=u,cc._RF.pop()},{"../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Player":"Player","./Building":"Building"}],ProfileData:[function(t,e,o){"use strict";cc._RF.push(e,"6ba48LTPitPa5dUl/wXJcJ0","ProfileData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./PlayerData"),a=t("../Rect/RectDungeon"),n=function(){function t(){this.rectDungeon=new a.default(0),this.currentPos=cc.v2(1,1),this.boxes={},this.shopTables={},this.chests={},this.equipments={},this.items={},this.chapterName=0,this.playerData=new i.default,this.playerEquipList=new Array,this.playerItemList=new Array,this.talentList=new Array,this.ammo=30,this.level=0}return t.prototype.clearData=function(){cc.sys.localStorage.setItem("profileData",""),this.chapterName=0,this.playerData=new i.default,this.talentList=new Array,this.playerEquipList=new Array,this.playerItemList=new Array,this.rectDungeon=new a.default(0),this.currentPos=cc.v2(1,1),this.boxes={},this.shopTables={},this.chests={},this.equipments={},this.items={},this.ammo=30,this.level=0,console.log("clear data")},t}();o.default=n,cc._RF.pop()},{"../Rect/RectDungeon":"RectDungeon","./PlayerData":"PlayerData"}],ProfileManager:[function(t,e,o){"use strict";cc._RF.push(e,"5915dTUdVpDi5LG7x2qxIEk","ProfileManager");var i=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Data/BoxData"),n=t("../Data/ShopTableData"),s=t("../Data/ChestData"),r=t("../Data/EquipmentData"),c=t("../Data/ItemData"),l=t("../Data/ProfileData"),h=t("../Data/TalentData"),u=cc._decorator,p=u.ccclass,d=(u.property,function(){function t(){this.data=new l.default,this.hasSaveData=!1,this.loadData()}return t.prototype.loadData=function(){this.data=new l.default,this.loadProfile()},t.prototype.getSaveData=function(){var t=cc.sys.localStorage.getItem("data");return t?JSON.parse(t):null},t.prototype.saveData=function(){cc.sys.localStorage.setItem("data",JSON.stringify(this.data)),console.log("save data")},t.prototype.clearData=function(){cc.sys.localStorage.setItem("data",""),this.hasSaveData=!1,this.data.clearData(),console.log("clear data")},t.prototype.loadProfile=function(){var t=this.getSaveData();if(t)if(t.playerData&&t.playerEquipList&&t.playerItemList&&t.rectDungeon&&t.currentPos&&t.shopTables&&t.boxes&&t.chests&&t.equipments&&t.items&&t.talentList){this.hasSaveData=!0,this.data.playerData.valueCopy(t.playerData),this.data.chapterName=t.chapterName,this.data.level=t.level;for(var e=0;e<t.playerEquipList.length;e++)this.data.playerEquipList[e]=t.playerEquipList[e];if(t.playerItemList)for(e=0;e<t.playerItemList.length;e++)this.data.playerItemList[e]=t.playerItemList[e];for(e=0;e<t.talentList.length;e++){var o=new h.default;o.valueCopy(t.talentList[e]),this.data.talentList.push(o)}for(var i in this.data.rectDungeon=this.data.rectDungeon.buildMapFromSave(t.rectDungeon),this.data.currentPos=t.currentPos?cc.v2(t.currentPos.x,t.currentPos.y):cc.v2(0,0),t.boxes){var l=t.boxes[i];this.data.boxes[i]=new Array;for(e=0;e<l.length;e++){var u=new a.default;u.valueCopy(l[e]),this.data.boxes[i][e]=u}}for(var i in t.shopTables){l=t.shopTables[i];this.data.shopTables[i]=new Array;for(e=0;e<l.length;e++){var p=new n.default;p.valueCopy(l[e]),this.data.shopTables[i][e]=p}}for(var i in t.chests){l=t.chests[i];this.data.chests[i]=new Array;for(e=0;e<l.length;e++){var d=new s.default;d.valueCopy(l[e]),this.data.chests[i][e]=d}}for(var i in t.equipments){l=t.equipments[i];this.data.equipments[i]=new Array;for(e=0;e<l.length;e++){var f=new r.default;f.valueCopy(l[e]),this.data.equipments[i][e]=f}}for(var i in t.items){l=t.items[i];this.data.items[i]=new Array;for(e=0;e<l.length;e++){var m=new c.default;m.valueCopy(l[e]),this.data.items[i][e]=m}}console.log("data",this)}else this.hasSaveData=!1;else this.hasSaveData=!1},t=i([p],t)}());o.default=d,cc._RF.pop()},{"../Data/BoxData":"BoxData","../Data/ChestData":"ChestData","../Data/EquipmentData":"EquipmentData","../Data/ItemData":"ItemData","../Data/ProfileData":"ProfileData","../Data/ShopTableData":"ShopTableData","../Data/TalentData":"TalentData"}],Rah:[function(t,e,o){"use strict";cc._RF.push(e,"d367aUD8qtMnYoMv/zpvvi2","Rah");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Data/DamageData"),r=t("../Shooter"),c=t("../Dungeon"),l=t("../Logic"),h=t("../Player"),u=t("../Manager/StatusManager"),p=t("../Utils/Skill"),d=t("../EventConstant"),f=t("../Utils/AudioPlayer"),m=t("../Data/FromData"),g=t("../Achievement"),y=cc._decorator,v=y.ccclass,D=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isFaceRight=!0,e.isMoving=!1,e.darkSkill=new p.default,e.blinkSkill=new p.default,e.snakeSkill=new p.default,e.bugsSkill=new p.default,e.meleeSkill=new p.default,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter=this.node.getChildByName("Shooter").getComponent(r.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(u.default),this.shooter.from.valueCopy(m.default.getClone(this.actorName(),"bossrahhead"))},e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow||this.blinkSkill.IsExcuting)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:f.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(g.default.addMonsterKillAchievement(this.data.resName),this.node.runAction(cc.fadeOut(3)),this.isDied=!0,this.dungeon.fog.runAction(cc.scaleTo(1,1.5)),this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.isDied&&this.isShow&&this.dungeon){this.node.position=c.default.fixOuterMap(this.node.position),this.pos=c.default.getIndexInMap(this.node.position),this.changeZIndex();var t=this.dungeon.player.pos.clone(),e=c.default.getPosInMap(t).sub(this.node.position),o=this.getNearPlayerDistance(this.dungeon.player.node),i=e.x,a=e.y;Math.abs(i),Math.abs(a);this.isFaceRight=i>0;var n=this.data.currentHealth<this.data.Common.maxHealth/2;o<100&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),l.default.getChance(20)&&n&&this.dark(),l.default.getChance(80)&&this.blink(),o<600&&!this.blinkSkill.IsExcuting&&this.fireSnake(),l.default.getChance(90)&&!this.blinkSkill.IsExcuting&&this.fireBugs(n),o<100&&!this.blinkSkill.IsExcuting&&this.attack(),!e.equals(cc.Vec2.ZERO)&&!this.meleeSkill.IsExcuting&&!this.blinkSkill.IsExcuting&&o>100&&(e=e.normalizeSelf(),this.move(e,100))}},e.prototype.blink=function(){var t=this;this.blinkSkill.next(function(){cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:f.default.BLINK}}),t.blinkSkill.IsExcuting=!0,t.rigidbody.linearVelocity=cc.Vec2.ZERO;var e=cc.sequence(cc.callFunc(function(){}),cc.fadeOut(1),cc.callFunc(function(){var e=t.dungeon.player.pos.clone();e.y>c.default.HEIGHT_SIZE-1?e.y-=1:e.y+=1,t.transportBoss(e.x,e.y)}),cc.fadeIn(1),cc.callFunc(function(){t.attack()}));t.node.runAction(e),t.scheduleOnce(function(){t.blinkSkill.IsExcuting=!1},5)},10)},e.prototype.attack=function(){var t=this;this.meleeSkill.next(function(){cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:f.default.MELEE}}),t.meleeSkill.IsExcuting=!0,t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahAttack001")},2,!0)},e.prototype.dark=function(){var t=this;this.darkSkill.next(function(){var e=cc.sequence(cc.scaleTo(2,1.5,1.5),cc.rotateTo(6,0),cc.scaleTo(2,.5,.5));t.dungeon.fog.runAction(e),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahSpellDark")},20)},e.prototype.fireSnake=function(){var t=this;this.snakeSkill.next(function(){t.shooter.setHv(cc.v2(0,-1));var e=t.node.position.clone().add(t.shooter.node.position),o=t.dungeon.player.getCenterPosition().sub(e);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),t.shooter.setHv(o),t.fireShooter(t.shooter,"bullet014",1,0)),t.anim||(t.anim=t.getComponent(cc.Animation)),t.anim.playAdditive("RahSpellSnake")},6)},e.prototype.fireBugs=function(t){var e=this;this.bugsSkill.next(function(){e.shooter.data.bulletLineInterval=.5;var t=e.node.position.clone().add(e.shooter.node.position),o=e.dungeon.player.getCenterPosition().sub(t);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),e.shooter.setHv(o)),e.fireShooter(e.shooter,"bullet017",99,0),e.anim||(e.anim=e.getComponent(cc.Animation)),e.anim.playAdditive("RahSpellBugs")},4)},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a)},e.prototype.showBoss=function(){this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied,this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.node.scaleX=this.isFaceRight?1:-1},e.prototype.move=function(t,e){if(!this.isDied){t.equals(cc.Vec2.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(h.default);if(o&&this.meleeSkill.IsExcuting&&!this.isDied){var i=new s.default;i.physicalDamage=3,o.takeDamage(i,m.default.getClone(this.actorName(),"bossrahhead"))}},e.prototype.actorName=function(){return"\u673a\u68b0\u62c9\u795e"},e=a([v],e)}(n.default));o.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss"}],Random4Save:[function(t,e,o){"use strict";cc._RF.push(e,"74f98/L5YNOk7ZP1QlogXyD","Random4Save"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t){this.seed=(new Date).getTime(),this.seed=t}return t.prototype.rand=function(){return this.seed=(9301*this.seed+49297)%233280,this.seed/233280},t.prototype.getRandomNum=function(t,e){return t+Math.round(this.rand()*(e-t))},t.prototype.getHalfChance=function(){return this.rand()>.5},t}();o.default=i,cc._RF.pop()},{}],Random:[function(t,e,o){"use strict";cc._RF.push(e,"b33a81ZfJ9HoIP2sjcUTtfA","Random"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.setSeed=function(e){t.seed=e},t.rand=function(){return t.seed=(9301*t.seed+49297)%233280,t.seed/233280},t.getRandomNum=function(e,o){return e+Math.round(t.rand()*(o-e))},t.getHalfChance=function(){return t.rand()>.5},t.seed=(new Date).getTime(),t}();o.default=i,cc._RF.pop()},{}],RectDoor:[function(t,e,o){"use strict";cc._RF.push(e,"d41e5HipSBBVLDWw2G1WR/C","RectDoor"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(t,e,o){this.isLocked=!1,this.isDoor=!1,this.dir=t,this.isLocked=e,this.isDoor=o}}();o.default=i,cc._RF.pop()},{}],RectDungeon:[function(t,e,o){"use strict";cc._RF.push(e,"3b710jO571KQpPd9DCAmaJb","RectDungeon"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./RectRoom"),a=t("../Utils/Random"),n=function(){function t(t){this.level=1,this.isLevelZero=!1,this.isLevelFinal=!1,this.isLevelZero=0==t,this.isLevelFinal=6==t,this.isLevelZero||this.isLevelFinal?this.level=1:this.level=t,this.size=this.level+2,this.primaryRooms=new Array,this.secondaryRooms=new Array,this.buildMap()}return t.prototype.buildMapFromSave=function(e){this.isLevelZero=e.isLevelZero,this.isLevelFinal=e.isLevelFinal,this.level=e.level,this.size=e.size,this.map=new Array;for(var o=0;o<this.size;o++){this.map[o]=new Array;for(var a=0;a<this.size;a++)this.map[o][a]=new i.default(!0,0,o,a,t.EMPTY_ROOM).initFromSave(e.map[o][a])}for(o=0;o<e.primaryRooms.length;o++)this.primaryRooms[o]=e.primaryRooms[o];for(o=0;o<e.secondaryRooms.length;o++)this.secondaryRooms[o]=e.secondaryRooms[o];return this.startRoom=new i.default(!1,0,0,0,t.EMPTY_ROOM).initFromSave(e.startRoom),this.endRoom=new i.default(!1,0,0,0,t.EMPTY_ROOM).initFromSave(e.endRoom),this.merChantRoom=new i.default(!1,0,0,0,t.EMPTY_ROOM).initFromSave(e.merChantRoom),this.puzzleRoom=new i.default(!1,0,0,0,t.EMPTY_ROOM).initFromSave(e.puzzleRoom),this},t.prototype.buildMap=function(){this.map=new Array;for(var e=0;e<this.size;e++){this.map[e]=new Array;for(var o=0;o<this.size;o++)this.map[e][o]=null,(1==e||e==this.level)&&o>=1&&o<=this.level||(1==o||o==this.level)&&e>=1&&e<=this.level?this.map[e][o]=new i.default(!0,0,e,o,t.EMPTY_ROOM):this.map[e][o]=new i.default(!1,0,e,o,t.EMPTY_ROOM)}this.addPrimaryRooms(),this.addSecondaryRooms(),this.buildPrimaryRoomsType(),this.buildSecondaryRoomsType(),this.buildZeroRoomsType(),this.buildFinalRoomType(),this.addLootKeys(),this.addDoors()},t.prototype.addPrimaryRooms=function(){for(var t=1,e=1;e<=this.level;e++){var o=1;this.map[e][o].isPrimary&&(this.map[e][o].index=t,this.primaryRooms.push(this.map[e][o]),t++)}for(o=2;o<=this.level;o++){e=this.level;this.map[e][o].isPrimary&&(this.map[e][o].index=t,this.primaryRooms.push(this.map[e][o]),t++)}for(e=this.level-1;e>0;e--){o=this.level;this.map[e][o].isPrimary&&(this.map[e][o].index=t,this.primaryRooms.push(this.map[e][o]),t++)}for(o=this.level-1;o>1;o--){e=1;this.map[e][o].isPrimary&&(this.map[e][o].index=t,this.primaryRooms.push(this.map[e][o]),t++)}},t.prototype.addSecondaryRooms=function(){for(var t=1,e=0;e<this.size;e++)for(var o=0;o<this.size;o++)this.isSecondaryRoom(e,o)&&(this.map[e][o].index=t++,this.secondaryRooms.push(this.map[e][o]))},t.prototype.isSecondaryRoom=function(t,e){return!this.isPrimaryRoom(t,e)&&!!(this.isPrimaryRoom(t+1,e)||this.isPrimaryRoom(t,e+1)||this.isPrimaryRoom(t-1,e)||this.isPrimaryRoom(t,e-1))},t.prototype.isPrimaryRoom=function(t,e){return!!(t<this.size-1&&t>0&&e<this.size-1&&e>0&&this.map[t][e].isPrimary)},t.prototype.isPrimaryVertical=function(t,e){return!!((t==this.size-2||1==t)&&e<this.size-1&&e>0&&this.map[t][e].isPrimary)},t.prototype.isPrimaryHorizontal=function(t,e){return!(!(t<this.size-1&&t>0)||e!=this.size-2&&1!=e||!this.map[t][e].isPrimary)},t.prototype.isPrimaryRoomCorner=function(t,e){return t==this.size-2&&1==e||(t==this.size-2&&e==this.size-2||(1==t&&e==this.size-2||1==t&&1==e))},t.prototype.buildPrimaryRoomsType=function(){for(var e=0,o=this.primaryRooms;e<o.length;e++){o[e].roomType=t.PRIMARY_ROOM}var i=this.getRandomNum(0,this.primaryRooms.length-1),a=i-1;a<0&&(a=this.primaryRooms.length-1),this.primaryRooms[a].roomType=t.END_ROOM,this.endRoom=this.primaryRooms[a],this.endRoom.lockAllDoors(!0),this.primaryRooms[i].roomType=t.START_ROOM,this.startRoom=this.primaryRooms[i],this.startRoom.lockAllDoors(!1),this.startRoom.isFound=!0},t.prototype.buildSecondaryRoomsType=function(){for(var e=[t.TRAP_ROOM,t.DANGER_ROOM],o=0,i=this.secondaryRooms;o<i.length;o++){var a=i[o],n=e[this.getRandomNum(0,e.length-1)];this.level==t.LEVEL_1&&(a.roomType=n),this.level==t.LEVEL_6?a.roomType=t.EMPTY_ROOM:this.getRandomRoomChance()?a.roomType=n:a.roomType=t.EMPTY_ROOM}var s=this.getRandomNum(0,this.secondaryRooms.length-1);this.level==t.LEVEL_1&&(this.secondaryRooms[s].roomType=t.END_ROOM,this.endRoom=this.secondaryRooms[s],this.endRoom.lockAllDoors(!1)),this.level==t.LEVEL_3&&(this.map[2][2].roomType=t.PUZZLE_ROOM),this.level==t.LEVEL_5&&(this.map[3][3].roomType=t.BOSS_ROOM,this.map[3][4].roomType==t.EMPTY_ROOM&&this.map[3][2].roomType==t.EMPTY_ROOM&&this.map[2][3].roomType==t.EMPTY_ROOM&&this.map[4][3].roomType==t.EMPTY_ROOM&&(this.map[3][4].roomType=this.getHalfChance()?t.DANGER_ROOM:t.TRAP_ROOM),this.addLootRoom()),this.addMerchantRoom(),this.addLootRoom(),this.addLootRoom()},t.prototype.buildZeroRoomsType=function(){this.isLevelZero&&(this.secondaryRooms[0].roomType=t.POKER_ROOM,this.secondaryRooms[1].roomType=t.EMPTY_ROOM,this.secondaryRooms[2].roomType=t.TAROT_ROOM,this.secondaryRooms[3].roomType=t.TEST_ROOM,this.endRoom=this.secondaryRooms[2])},t.prototype.buildFinalRoomType=function(){this.isLevelFinal&&(this.secondaryRooms[0].roomType=t.EMPTY_ROOM,this.secondaryRooms[1].roomType=t.EMPTY_ROOM,this.secondaryRooms[2].roomType=t.FINAL_ROOM,this.secondaryRooms[3].roomType=t.EMPTY_ROOM)},t.prototype.addMerchantRoom=function(){var e=this.getRandomNum(0,this.secondaryRooms.length-1);this.secondaryRooms[e].roomType==t.TRAP_ROOM||this.secondaryRooms[e].roomType==t.DANGER_ROOM||this.secondaryRooms[e].roomType==t.EMPTY_ROOM?this.secondaryRooms[e].roomType=t.MERCHANT_ROOM:this.addMerchantRoom()},t.prototype.addLootRoom=function(){for(var e=0,o=new Array,i=0,a=this.secondaryRooms;i<a.length;i++){var n=a[i];n.roomType!=t.DANGER_ROOM&&n.roomType!=t.TRAP_ROOM&&n.roomType!=t.EMPTY_ROOM||o.push(n),n.roomType==t.LOOT_ROOM&&e++}if(o.length>1&&e<o.length+1){var s=this.getRandomNum(0,o.length-1);o[s].roomType=t.LOOT_ROOM,o[s].lockAllDoors(!0)}},t.prototype.addLootKeys=function(){for(var e=0,o=new Array,i=0,a=this.secondaryRooms;i<a.length;i++){var n=a[i];n.enemyCount!=t.DANGER_ROOM&&n.roomType!=t.TRAP_ROOM||o.push(n),n.roomType==t.LOOT_ROOM&&e++,n.roomType==t.MERCHANT_ROOM&&(n.hasKey=!0)}for(var s=0;s<e;s++)if(o.length>0){var r=this.getRandomNum(0,o.length-1);o[r].hasKey=!0,o.splice(r,1)}},t.prototype.addDoors=function(){for(var e=0;e<this.size;e++)for(var o=0;o<this.size;o++)this.map[e][o].roomType!=t.EMPTY_ROOM&&(this.changeDoor(e,o,i.default.TOPDOOR,!0),this.changeDoor(e,o,i.default.BOTTOMDOOR,!0),this.changeDoor(e,o,i.default.LEFTDOOR,!0),this.changeDoor(e,o,i.default.RIGHTDOOR,!0));for(e=0;e<this.size;e++)for(o=0;o<this.size;o++)this.map[e][o].roomType==t.EMPTY_ROOM&&(this.changeDoor(e,o,i.default.TOPDOOR,!1),this.changeDoor(e,o,i.default.BOTTOMDOOR,!1),this.changeDoor(e,o,i.default.LEFTDOOR,!1),this.changeDoor(e,o,i.default.RIGHTDOOR,!1))},t.prototype.changeDoor=function(t,e,o,a){switch(o){case i.default.TOPDOOR:this.map[t][e].doors[0].isDoor=a,e+1<this.size?this.map[t][e+1].doors[1].isDoor=a:this.map[t][e].doors[0].isDoor=!1;break;case i.default.BOTTOMDOOR:this.map[t][e].doors[1].isDoor=a,e-1>=0?this.map[t][e-1].doors[0].isDoor=a:this.map[t][e].doors[1].isDoor=!1;break;case i.default.LEFTDOOR:this.map[t][e].doors[2].isDoor=a,t-1>=0?this.map[t-1][e].doors[3].isDoor=a:this.map[t][e].doors[2].isDoor=!1;break;case i.default.RIGHTDOOR:this.map[t][e].doors[3].isDoor=a,t+1<this.size?this.map[t+1][e].doors[2].isDoor=a:this.map[t][e].doors[3].isDoor=!1}},t.prototype.getDisPlay=function(){for(var t="",e=this.size-1;e>=0;e--){for(var o=0;o<this.size;o++)t+=this.getTypeStringLog(this.map[o][e].roomType);t+="\n"}return t},t.prototype.getNeighborRoomType=function(t,e,o){var i=t,a=e;return-1==o?this.map[i][a]:(0==o&&(a+=1),1==o&&(a-=1),2==o&&(i-=1),3==o&&(i+=1),i>=this.size||i<0||a>=this.size||a<0||o<0||o>4?null:this.map[i][a])},t.prototype.changeRoomIsFound=function(e,o){e>=this.size||e<0||o>=this.size||o<0||this.map[e][o].roomType!=t.EMPTY_ROOM&&(this.map[e][o].isFound=!0)},t.isRoomEqual=function(t,e){return t.x==e.x&&t.y==e.y},t.prototype.getTypeStringLog=function(e){switch(e){case t.EMPTY_ROOM:return"\uff2f";case t.START_ROOM:return"\uff33";case t.PRIMARY_ROOM:return"\uff38";case t.END_ROOM:return"\uff25";case t.TRAP_ROOM:return"\uff34";case t.LOOT_ROOM:return"\uff2c";case t.DANGER_ROOM:return"\uff24";case t.PUZZLE_ROOM:return"\uff30";case t.MERCHANT_ROOM:return"\uff2d";case t.BOSS_ROOM:return"\uff22";case t.POKER_ROOM:return"\uff23";case t.TAROT_ROOM:return"\uff22";case t.TEST_ROOM:return"\uff21";case t.FINAL_ROOM:return"\uff26"}return"\uff2f"},t.prototype.getRandomNum=function(t,e){return t+Math.round(a.default.rand()*(e-t))},t.prototype.getHalfChance=function(){return a.default.rand()>.5},t.prototype.getRandomRoomChance=function(){switch(this.level){case t.LEVEL_2:case t.LEVEL_3:case t.LEVEL_4:case t.LEVEL_5:a.default.rand()}return a.default.rand()>.7},t.LEVEL_1=1,t.LEVEL_2=2,t.LEVEL_3=3,t.LEVEL_4=4,t.LEVEL_5=5,t.LEVEL_6=6,t.PRIMARY=1e3,t.SECONDARY=2e3,t.EMPTY_ROOM=0,t.START_ROOM=1,t.END_ROOM=2,t.PRIMARY_ROOM=3,t.TRAP_ROOM=4,t.LOOT_ROOM=5,t.DANGER_ROOM=6,t.MERCHANT_ROOM=7,t.PUZZLE_ROOM=8,t.BOSS_ROOM=9,t.POKER_ROOM=10,t.TAROT_ROOM=11,t.TEST_ROOM=12,t.FINAL_ROOM=13,t}();o.default=n,cc._RF.pop()},{"../Utils/Random":"Random","./RectRoom":"RectRoom"}],RectRoom:[function(t,e,o){"use strict";cc._RF.push(e,"d55edjfV4pLuKPki2DqAONx","RectRoom"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./RectDoor"),a=t("../Dungeon"),n=function(){function t(e,o,i,a,n){this.isPrimary=!1,this.enemyCount=0,this.state=t.STATE_SLEEP,this.isFound=!1,this.isInit=!0,this.saveIndex=0,this.seed=(new Date).getTime(),this.x=i,this.y=a,this.isPrimary=e,this.index=o,this.roomType=n,this.init()}return t.prototype.initFromSave=function(t){if(t)return this.x=t.x,this.y=t.y,this.isPrimary=t.isPrimary,this.index=t.index,this.roomType=t.roomType,this.isFound=t.isFound,this.isInit=t.isInit,this.doors=t.doors,this.state=t.state,this.hasKey=t.hasKey,this.enemyCount=t.enemyCount,this.hasKey=t.hasKey,this.saveIndex=t.saveIndex,this.seed=t.seed?t.seed:(new Date).getTime(),this},t.prototype.init=function(){if(this.state=t.STATE_SLEEP,null==this.doors){this.doors=new Array(4);for(var e=0;e<4;e++)this.doors[e]=new i.default(e,!1,!1)}},t.prototype.lockAllDoors=function(t){for(var e=0;e<4;e++)this.doors[e].isLocked=t},Object.defineProperty(t.prototype,"positionStr",{get:function(){return""+this.x+this.y},enumerable:!0,configurable:!0}),t.STATE_SLEEP=0,t.STATE_ACTIVE=1,t.STATE_CLEAR=2,t.ROOM_WIDTH=a.default.WIDTH_SIZE,t.ROOM_HEIGHT=a.default.HEIGHT_SIZE,t.TOPDOOR=0,t.BOTTOMDOOR=1,t.LEFTDOOR=2,t.RIGHTDOOR=3,t}();o.default=n,cc._RF.pop()},{"../Dungeon":"Dungeon","./RectDoor":"RectDoor"}],Saw:[function(t,e,o){"use strict";cc._RF.push(e,"e4758hHN8ZNFpX/Yga2qrRo","Saw");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Player"),r=t("../Data/DamageData"),c=t("./Building"),l=t("../Manager/StatusManager"),h=t("../Utils/Random"),u=t("../Data/FromData"),p=cc._decorator,d=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalSpriteFrame=null,e.bloodSpriteFrame=null,e.pos=cc.v2(0,0),e}return i(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.sprite.spriteFrame=this.normalSpriteFrame},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t;var e=n.default.getPosInMap(t);this.node.position=cc.v2(e.x,e.y),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(s.default);if(o){var i=u.default.getClone(this.actorName(),"saw002");o.takeDamage(new r.default(1),i),h.default.rand()<.1&&o.addStatus(l.default.BLEEDING,i),this.sprite.spriteFrame=this.bloodSpriteFrame}},e.prototype.update=function(t){},e.prototype.actorName=function(){return"\u952f\u9f7f\u8f6e"},a([f(cc.SpriteFrame)],e.prototype,"normalSpriteFrame",void 0),a([f(cc.SpriteFrame)],e.prototype,"bloodSpriteFrame",void 0),e=a([d],e)}(c.default);o.default=m,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../Manager/StatusManager":"StatusManager","../Player":"Player","../Utils/Random":"Random","./Building":"Building"}],Shooter:[function(t,e,o){"use strict";cc._RF.push(e,"f9805u1Wn9OeouYmQSWcHcq","Shooter");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Player"),s=t("./Item/Bullet"),r=t("./Monster"),c=t("./Logic"),l=t("./Data/EquipmentData"),h=t("./Data/BulletData"),u=t("./Utils/Random"),p=t("./Boss/Boss"),d=t("./EventConstant"),f=t("./Utils/AudioPlayer"),m=t("./Data/FromData"),g=t("./Data/DamageData"),y=cc._decorator,v=y.ccclass,D=y.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bullet=null,e.isAI=!1,e.dungeon=null,e.player=null,e.isEx=!1,e.timeDelay=0,e.isAutoAim=!0,e.bulletName="",e.data=new l.default,e.hv=cc.v2(1,0),e.isAiming=!1,e.remoteDamagePlayer=new g.default,e.from=new m.default,e.skipTopwall=!1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.graphics=this.getComponent(cc.Graphics),this.bulletPool=new cc.NodePool(s.default),this.sprite=this.node.getChildByName("sprite"),cc.director.on("destorybullet",function(e){t.destroyBullet(e.detail.bulletNode)}),this.anim=this.getComponent(cc.Animation)},e.prototype.playWalk=function(t){this.anim&&(t?this.anim.play("ShooterWalk"):(this.anim.pause(),this.sprite.y=0))},e.prototype.changeRes=function(t,e){if(this.sprite||(this.sprite=this.node.getChildByName("sprite")),this.sprite){var o=this.getSpriteFrameByName(t,e);this.sprite.getComponent(cc.Sprite).spriteFrame=o,this.sprite.width=1.5*o.getRect().width,this.sprite.height=1.5*o.getRect().height,this.sprite.anchorX=.2,1==this.data.far&&(this.sprite.width=2*this.sprite.width,this.sprite.height=2*this.sprite.height,this.sprite.anchorX=.5)}},e.prototype.changeResColor=function(t){this.sprite.color=t},e.prototype.getSpriteFrameByName=function(t,e){var o=c.default.spriteFrames[t+e];return o||(o=c.default.spriteFrames[t]),o},e.prototype.setHv=function(t){var e=this.hasNearEnemy();e.equals(cc.Vec2.ZERO)?this.hv=t.normalizeSelf():(this.rotateColliderManager(cc.v2(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e)},e.prototype.fireBullet=function(t,e){1==this.data.isArcAim&&this.graphics?this.aimTargetArc(t,e):1==this.data.isLineAim&&this.graphics?this.aimTargetLine(t,e):this.fireBulletDo(t,e)},e.prototype.fireBulletDo=function(t,e){var o=this;if(this.sprite){this.sprite.stopAllActions(),this.sprite.position=cc.Vec2.ZERO;var i=cc.sequence(cc.moveBy(.1,10,0),cc.callFunc(function(){o.changeRes(o.data.img,"anim")},this),cc.moveBy(.05,-5,0),cc.moveBy(.05,0,0),cc.callFunc(function(){o.changeRes(o.data.img)},this));this.sprite.runAction(i)}if(t||(t=0),this.dungeon&&(this.isAI||!this.player||this.isEx||!(c.default.ammo<=0||"remote"!=this.player.inventoryManager.remote.equipmetType)))if(!this.isAI&&this.player&&c.default.ammo>0&&!this.isEx&&c.default.ammo--,cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:f.default.SHOOT}}),this.data.bulletNets>0){var a=this.data.bulletType;this.fireNetsBullet(3,a)}else this.fire(this.data.bulletType,this.bullet,this.bulletPool,t,this.hv.clone(),e),this.fireArcBullet(this.data.bulletType,e),this.fireLinecBullet(this.data.bulletType,t,e)},e.prototype.fireArcBullet=function(t,e){if(!(this.data.bulletArcExNum<=0)){var o=[10,-10,20,-20,30,-30,40,-40,50,-50,60,-60,-70,-70,80,-80,90,-90,100,-100,110,-110,120,-120,130,-130,140,-140,150,-150,160,-160,170,-170,180,-180];if(this.data.bulletArcExNum>o.length){var i=[0,20,45,65,90,110,135,155,180,200,225,245,270,290,315,335];80==this.data.bulletArcExNum&&(i=[0,45,90,135,180,225,270,315,335]);for(var a=0;a<i.length;a++)!this.isAI&&c.default.ammo>0&&c.default.ammo--,this.fire(t,this.bullet,this.bulletPool,i[a],this.hv.clone(),e)}else for(a=0;a<this.data.bulletArcExNum;a++)a<o.length&&(!this.isAI&&c.default.ammo>0&&c.default.ammo--,this.fire(t,this.bullet,this.bulletPool,o[a],this.hv.clone(),e))}},e.prototype.fireLinecBullet=function(t,e,o){var i=this;0!=this.data.bulletLineExNum&&this.schedule(function(){!i.isAI&&c.default.ammo>0&&c.default.ammo--,i.fire(t,i.bullet,i.bulletPool,e,i.hv.clone(),o),i.fireArcBullet(t,o)},this.data.bulletLineInterval>0?this.data.bulletLineInterval:.2,this.data.bulletLineExNum,0)},e.prototype.fireNetsBullet=function(t,e){switch(t){case 0:this.setHv(cc.v2(0,1));break;case 1:this.setHv(cc.v2(0,-1));break;case 2:this.setHv(cc.v2(-1,0));break;case 3:this.setHv(cc.v2(1,0))}for(var o=[0,128,-128,256,-256],i=0;i<o.length;i++)this.fire(e,this.bullet,this.bulletPool,0,this.hv.clone(),cc.v2(64,o[i]))},e.prototype.fire=function(t,e,o,i,a,n){var r=null;o.size()>0&&(r=o.get()),r&&!r.active||(r=cc.instantiate(e)),r.parent=this.node;var l=this.node.convertToWorldSpaceAR(n||cc.v2(30,0));l=this.dungeon.node.convertToNodeSpaceAR(l),r.parent=this.dungeon.node,r.position=l,r.scaleX=1,r.scaleY=1,r.active=!0;var u=r.getComponent(s.default);u.node.scaleY=this.node.scaleX>0?1:-1,u.node.zIndex=4e3,u.isFromPlayer=!this.isAI,u.dungeon=this.dungeon,u.skipTopwall=this.skipTopwall;var p=new h.default;p.valueCopy(c.default.bullets[t]),u.isFromPlayer&&this.player&&!this.isEx&&(p.damage.physicalDamage=this.remoteDamagePlayer.physicalDamage,p.damage.isCriticalStrike=this.remoteDamagePlayer.isCriticalStrike),p.size+=this.data.bulletSize,p.speed+=this.data.bulletExSpeed,p.speed+this.data.bulletExSpeed>50&&(p.speed+=this.data.bulletExSpeed),p.from.valueCopy(this.from),u.changeBullet(p),this.bulletName=u.name+p.resName,u.enabled=!0,u.showBullet(cc.v2(a).rotateSelf(i*Math.PI/180))},e.prototype.destroyBullet=function(t){t.active=!1;var e=t.getComponent(s.default);this.bulletPool&&e.name==this.bulletName&&this.bulletPool.put(t)},e.prototype.start=function(){},e.prototype.drawLine=function(t,e,o){this.graphics&&(this.graphics.clear(),this.graphics.fillColor=t,this.graphics.circle(0,0,o/2+1),this.graphics.circle(e,0,o/2+1),this.graphics.rect(0,-o/2,e,o),this.graphics.fill())},e.prototype.getRayCastPoint=function(t,e){var o=e||cc.v2(0,0),i=t||3e3,a=cc.v2(i,0),n=this.node.convertToWorldSpaceAR(o),s=this.node.convertToWorldSpaceAR(a),r=cc.director.getPhysicsManager().rayCast(n,s,cc.RayCastType.All),l=new Array;if(r.length>0)for(var h=0,u=r;h<u.length;h++){var p=u[h];this.isValidRayCastCollider(p.collider)&&(a=this.node.convertToNodeSpaceAR(p.point),l.push(a))}for(var d=i,f=0,m=l;f<m.length;f++){var g=m[f],y=c.default.getDistance(g,o);d>=y&&(d=y,a=g)}return a},e.prototype.isValidRayCastCollider=function(t){var e=!1;if(this.isAI){var o=t.node.getComponent(r.default),i=t.node.getComponent(p.default);(o||i)&&(e=!0)}else{t.node.getComponent(n.default)&&(e=!0)}return t.node.getComponent(s.default)&&(e=!0),t.sensor&&(e=!0),!e},e.prototype.aimTargetLine=function(t,e){var o=this;if(!this.isAiming&&(this.isAiming=!0,this.graphics)){var i=0,a=this.getRayCastPoint(),n=!1,s=function(){i<1&&n?(o.fireBulletDo(t,e),o.unschedule(s),o.graphics.clear(),o.isAiming=!1):o.drawLine(cc.color(255,0,0,200),a.x,i),i>10&&!n?n=!0:n?i-=1:i+=1};this.schedule(s,.02,30)}},e.prototype.drawArc=function(t){if(this.graphics&&(this.graphics.clear(),!(t<0))){var e=1e3,o=2*-t*Math.PI/360,i=2*t*Math.PI/360,a=cc.v2(e*Math.cos(o),e*Math.sin(o)),n=cc.v2(e*Math.cos(i),e*Math.sin(i));this.graphics.arc(0,0,e,2*Math.PI-o,2*Math.PI-i),this.graphics.fill(),this.graphics.moveTo(0,0),this.graphics.lineTo(a.x,a.y),this.graphics.lineTo(n.x,n.y),this.graphics.close(),this.graphics.fill()}},e.prototype.aimTargetArc=function(t,e){var o=this;if(!this.isAiming){this.isAiming=!0;var i=45,a=function(){o.drawArc(--i),i<0&&(o.fireBulletDo(t,e),o.unschedule(a),o.isAiming=!1)};this.schedule(a,.025,45)}},e.prototype.getRandomNum=function(t,e){return t+Math.round(u.default.rand()*(e-t))},e.prototype.update=function(t){var e=this.hasNearEnemy();if(e.equals(cc.Vec2.ZERO)){if(0!=this.hv.x||0!=this.hv.y){var o=cc.v2(this.node.position.x+this.hv.x,this.node.position.y+this.hv.y);this.rotateColliderManager(o)}}else this.rotateColliderManager(cc.v2(this.node.position.x+e.x,this.node.position.y+e.y)),this.hv=e},e.prototype.getParentNode=function(){return this.parentNode?this.parentNode:this.node.parent},e.prototype.hasNearEnemy=function(){if(!this.isAutoAim)return cc.Vec2.ZERO;var t=1e3,e=cc.v2(0,0);if(this.isAI);else if(this.dungeon){for(var o=0,i=this.dungeon.monsters;o<i.length;o++){var a=i[o];if((l=c.default.getDistance(this.getParentNode().position,a.node.position))<600&&l<t&&!a.isDied&&!a.isDisguising){t=l,(u=this.node.position.clone()).x=this.node.scaleX>0?u.x:-u.x;var n=a.node.position.clone();n.y+=32,e=n.sub(this.getParentNode().position.add(u))}}if(e.equals(cc.Vec2.ZERO))for(var s=0,r=this.dungeon.bosses;s<r.length;s++){var l,h=r[s];if((l=c.default.getDistance(this.getParentNode().position,h.node.position))<600&&l<t&&!h.isDied){var u;t=l,(u=this.node.position.clone()).x=this.node.scaleX>0?u.x:-u.x;var p=h.node.position.clone();p.y+=32,e=p.sub(this.getParentNode().position.add(u))}}1e3!=t&&(e=e.normalizeSelf())}return e},e.prototype.rotateColliderManager=function(t){var e=t.sub(this.node.position),o=360/(2*Math.PI),i=360-Math.atan2(e.x,e.y)*o;this.node.scaleX=this.getParentNode().scaleX>0?1:-1,this.node.scaleY=this.getParentNode().scaleX>0?1:-1,i+=90,this.node.angle=-1==this.node.scaleX?-i:i},e.DefAULT_SPEED=300,a([D(cc.Prefab)],e.prototype,"bullet",void 0),a([D],e.prototype,"isAI",void 0),e=a([v],e)}(cc.Component);o.default=C,cc._RF.pop()},{"./Boss/Boss":"Boss","./Data/BulletData":"BulletData","./Data/DamageData":"DamageData","./Data/EquipmentData":"EquipmentData","./Data/FromData":"FromData","./EventConstant":"EventConstant","./Item/Bullet":"Bullet","./Logic":"Logic","./Monster":"Monster","./Player":"Player","./Utils/AudioPlayer":"AudioPlayer","./Utils/Random":"Random"}],ShopTableData:[function(t,e,o){"use strict";cc._RF.push(e,"1f67aUHn09Nvaj7spLXjq++","ShopTableData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./EquipmentData"),a=t("./ItemData"),n=function(){function t(){this.price=60,this.shopType=0,this.isSaled=!1}return t.prototype.valueCopy=function(t){this.pos=t.pos?cc.v2(t.pos.x,t.pos.y):cc.v2(0,0),this.equipdata||(this.equipdata=new i.default),this.itemdata||(this.itemdata=new a.default),t.equipdata&&this.equipdata.valueCopy(t.equipdata),t.itemdata&&this.itemdata.valueCopy(t.itemdata),this.price=t.price,this.isSaled=t.isSaled,this.shopType=t.shopType},t}();o.default=n,cc._RF.pop()},{"./EquipmentData":"EquipmentData","./ItemData":"ItemData"}],ShopTable:[function(t,e,o){"use strict";cc._RF.push(e,"feb404aValPAJxRKh4uvHLm","ShopTable");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Player"),s=t("../Dungeon"),r=t("../Logic"),c=t("../Data/ShopTableData"),l=t("./Building"),h=cc._decorator,u=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new c.default,e.timeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.info=this.node.getChildByName("info"),this.label=this.info.getComponentInChildren(cc.Label)},e.prototype.start=function(){},e.prototype.showItem=function(){if(this.node.parent&&!this.data.isSaled){var t=this.node.parent.getComponent(s.default);t&&(this.data.shopType==o.EQUIPMENT?t.addEquipment(r.default.getRandomEquipType(),this.data.pos,this.data.equipdata,3,this):this.data.shopType==o.ITEM&&t.addItem(s.default.getPosInMap(this.data.pos),r.default.getRandomItemType(),this))}},e.prototype.setPos=function(t){this.data.pos=t,this.node.position=s.default.getPosInMap(t),this.node.zIndex=3e3+10*(s.default.HEIGHT_SIZE-t.y)+1},e.prototype.update=function(t){if(this.timeDelay+=t,this.timeDelay>.2){this.label.string=""+this.data.price,this.info.opacity=this.data.isSaled?0:255;var e=r.default.mapManager.getCurrentMapShopTables();if(e)for(var o=0,i=e;o<i.length;o++){var a=i[o];a.pos.equals(this.data.pos)&&(a.isSaled=this.data.isSaled,a.price=this.data.price)}}},e.prototype.onCollisionStay=function(t,e){t.node.getComponent(n.default)},e.prototype.onCollisionEnter=function(t,e){t.node.getComponent(n.default)},e.prototype.onCollisionExit=function(t,e){t.node.getComponent(n.default)},e.EQUIPMENT=0,e.ITEM=1,e=o=a([u],e)}(l.default));o.default=p,cc._RF.pop()},{"../Data/ShopTableData":"ShopTableData","../Dungeon":"Dungeon","../Logic":"Logic","../Player":"Player","./Building":"Building"}],Skill:[function(t,e,o){"use strict";cc._RF.push(e,"73312uU+rJIbovZ9lZbVJ9J","Skill");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,n=(a.ccclass,a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isExcuting=!1,e.isInCooling=!1,e}return i(e,t),e.prototype.next=function(t,e,o){var i=this;this.isInCooling||(t&&t(),this.isInCooling=!0,this.scheduleOnce(function(){i.isInCooling=!1,o&&(i.isExcuting=!1)},e))},e.prototype.refreshCoolDown=function(){this.isInCooling=!1},Object.defineProperty(e.prototype,"IsExcuting",{get:function(){return this.isExcuting},set:function(t){this.isExcuting=t},enumerable:!0,configurable:!0}),e}(cc.Component));o.default=n,cc._RF.pop()},{}],SlimeVenom:[function(t,e,o){"use strict";cc._RF.push(e,"a7fa4vRR+xDO6TrjB6jQViO","SlimeVenom");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../Data/DamageData"),r=t("../EventConstant"),c=t("../Base/Actor"),l=t("../Data/FromData"),h=cc._decorator,u=h.ccclass,p=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHide=!1,e.isForever=!1,e.from=l.default.getClone("\u53f2\u83b1\u59c6\u6bd2\u6db2","venom"),e.checkTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.venom1=this.node.getChildByName("sprite").getChildByName("venom1"),this.venom2=this.node.getChildByName("sprite").getChildByName("venom2"),this.venom3=this.node.getChildByName("sprite").getChildByName("venom2"),this.anim=this.getComponent(cc.Animation),this.sprite=this.node.getChildByName("sprite")},e.prototype.onEnable=function(){var t=this;this.isHide=!1,this.sprite.opacity=255,this.venom1.angle=n.default.getRandomNum(0,180),this.venom2.angle=n.default.getRandomNum(0,180),this.venom2.angle=n.default.getRandomNum(0,180),this.anim.play(),this.isForever||this.scheduleOnce(function(){t.anim&&(t.isHide=!0,t.anim.play("VenomHide"),t.scheduleOnce(function(){cc.director.emit("destoryvenom",{detail:{coinNode:t.node}})},1.5))},3),this.damagePlayer(this.from)},e.prototype.start=function(){},e.prototype.getNearPlayerDistance=function(t){return n.default.getDistance(this.node.position,t.position)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.damagePlayer(this.from)},e.prototype.damagePlayer=function(t){if(this.player&&this.getNearPlayerDistance(this.player.node)<60*this.node.scale&&this.node.active&&!this.isHide){var e=new s.default;e.toxicDamage=1,cc.director.emit(r.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:e,from:t}})}},e.prototype.takeDamage=function(t){return!1},e.prototype.actorName=function(){return"\u53f2\u83b1\u59c6\u6bd2\u6db2"},e=a([u],e)}(c.default));o.default=p,cc._RF.pop()},{"../Base/Actor":"Actor","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Logic":"Logic"}],Slime:[function(t,e,o){"use strict";cc._RF.push(e,"263b6VIDCJP+LELMRjXCL3M","Slime");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Player"),r=t("../EventConstant"),c=t("../Logic"),l=t("../Dungeon"),h=t("./SlimeVenom"),u=t("../Manager/MonsterManager"),p=t("../Utils/Skill"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=t("../Achievement"),g=t("../Item/Item"),y=cc._decorator,v=y.ccclass,D=y.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.venom=null,e.healthBar=null,e.isFaceRight=!0,e.isMoving=!1,e.timeDelay=0,e.isHurt=!1,e.isCrownFall=!1,e.isDashing=!1,e.currentlinearVelocitySpeed=cc.Vec2.ZERO,e.scaleSize=1,e.slimeType=0,e.meleeSkill=new p.default,e.venomTimeDelay=0,e.childSlimeTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;this.meleeSkill.IsExcuting=!1,this.isDied=!1,this.anim=this.getComponent(cc.Animation),this.rigidbody=this.getComponent(cc.RigidBody),this.updatePlayerPos(),this.venomPool=new cc.NodePool,this.sprite=this.node.getChildByName("sprite"),this.crown=this.sprite.getChildByName("crown"),this.decorate=this.node.getChildByName("sprite").getChildByName("body").getChildByName("decorate"),this.dashlight=this.sprite.getChildByName("dashlight"),this.dashlight.opacity=0,cc.director.on("destoryvenom",function(e){t.destroyVenom(e.detail.coinNode)}),this.scheduleOnce(function(){t.isShow=!0},1)},e.prototype.start=function(){t.prototype.start.call(this),this.crown&&0!=this.slimeType&&(this.crown.opacity=0),this.decorate&&this.slimeType>2&&(this.decorate.opacity=0)},e.prototype.getVenom=function(t,e){if(!(this.scaleSize<1||this.isDied)){var o=null;this.venomPool.size()>0&&(o=this.venomPool.get()),o&&!o.active||(o=cc.instantiate(this.venom)),o.parent=t,o.position=e,o.scale=0==this.slimeType?1.5:1,o.getComponent(h.default).player=this.dungeon.player,o.zIndex=3e3,o.opacity=255,o.active=!0}},e.prototype.destroyVenom=function(t){t&&(t.active=!1,this.venomPool&&this.venomPool.put(t))},e.prototype.AnimAttacking=function(){this.meleeSkill.IsExcuting=!1;var t=64+50*this.scaleSize;this.getNearPlayerDistance(this.dungeon.player.node)<t&&this.dungeon.player.takeDamage(this.data.getAttackPoint(),f.default.getClone(this.actorName(),"bossslimehelmet"))},e.prototype.onCollisionEnter=function(t,e){t.getComponent(s.default)&&this.isDashing&&this.dungeon&&!this.isHurt&&!this.isDied&&(this.isDashing=!1,this.rigidbody.linearVelocity=cc.Vec2.ZERO,this.dungeon.player.takeDamage(this.data.getAttackPoint(),f.default.getClone(this.actorName(),"bossslimehelmet")))},e.prototype.isVenomTimeDelay=function(t){return this.venomTimeDelay+=t,this.venomTimeDelay>.2&&(this.venomTimeDelay=0,!0)},e.prototype.isChildSlimeTimeDelay=function(t){return this.childSlimeTimeDelay+=t,this.childSlimeTimeDelay>5&&(this.childSlimeTimeDelay=0,!0)},e.prototype.update=function(t){(this.healthBar.node.active=!this.isDied,this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,this.bossAction()),this.dashlight.opacity=0,this.dungeon&&this.isDashing&&(this.dashlight.opacity=128,this.rigidbody.linearVelocity=this.currentlinearVelocitySpeed.clone()),this.dungeon)&&(this.getNearPlayerDistance(this.dungeon.player.node)<64&&!this.isHurt&&(this.rigidbody.linearVelocity=cc.v2(0,0)));if(this.isDied&&(this.rigidbody.linearVelocity=cc.Vec2.ZERO),this.healthBar.node.active=!this.isDied,this.data.currentHealth<1&&this.killed(),this.node.scaleY=this.scaleSize,this.node.scaleX=this.isFaceRight?this.scaleSize:-this.scaleSize,this.isVenomTimeDelay(t)&&this.isMoving&&!this.meleeSkill.IsExcuting&&this.getVenom(this.node.parent,this.node.position),this.isChildSlimeTimeDelay(t)&&!this.isDied&&0==this.slimeType&&this.dungeon){for(var e=0,o=0,i=this.dungeon.monsters;o<i.length;o++){i[o].isDied||e++}if(e<10&&this.dungeon.monsters.length<50){var a=l.default.getIndexInMap(this.node.position.clone());this.dungeon.addMonsterFromData(u.default.MONSTER_SLIME,a.x,a.y)}}},e.prototype.takeDamage=function(t){var e=this;return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.isHurt=!0,this.isDashing=!1,this.scheduleOnce(function(){e.node&&(e.isHurt=!1)},.1),this.anim.play("SlimeHit"),this.meleeSkill.IsExcuting=!1,this.data.currentHealth<this.data.Common.maxHealth/2&&!this.isCrownFall&&0==this.slimeType&&(this.isCrownFall=!0,this.isShow=!1,this.scheduleOnce(function(){e.isShow=!0,e.crown.opacity=0},1),this.anim.play("SlimeCrownFall")),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(this.isDied=!0,this.isDashing=!1,this.anim.play("SlimeDie"),this.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.dungeon&&(0==this.slimeType&&(m.default.addMonsterKillAchievement(this.data.resName),cc.director.emit(r.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:g.default.HEART}}),cc.director.emit(r.EventConstant.DUNGEON_ADD_ITEM,{detail:{pos:this.node.position,res:g.default.AMMO}}),this.dungeon.addEquipment(c.default.getRandomEquipType(),this.pos,null,3)),this.slimeType<o.DIVIDE_COUNT&&(cc.director.emit(r.EventConstant.DUNGEON_ADD_COIN,{detail:{pos:this.node.position,count:5}}),cc.director.emit(r.EventConstant.BOSS_ADDSLIME,{detail:{posIndex:this.pos.clone(),slimeType:this.slimeType+1}}),cc.director.emit(r.EventConstant.BOSS_ADDSLIME,{detail:{posIndex:this.pos.clone(),slimeType:this.slimeType+1}}))))},e.prototype.bossAction=function(){var t=this;if(!this.isDied&&this.dungeon&&!this.isHurt){var e=cc.v2(0,0);e.x+=c.default.getRandomNum(0,2e3)-1e3,e.y+=c.default.getRandomNum(0,2e3)-1e3;var o=this.getNearPlayerDistance(this.dungeon.player.node);this.node.position=l.default.fixOuterMap(this.node.position),this.pos=l.default.getIndexInMap(this.node.position),this.changeZIndex();var i=e.clone();if(o<64+50*this.scaleSize&&!this.dungeon.player.isDied&&!this.isDashing&&this.isShow&&this.scaleSize>=1)(i=this.dungeon.player.getCenterPosition().sub(this.node.position)).equals(cc.Vec2.ZERO)||(i=i.normalizeSelf()),this.anim.getAnimationState("SlimeAttack").isPlaying||(this.meleeSkill.IsExcuting=!0,this.anim.play("SlimeAttack"));var a=300-50*this.scaleSize;o>128+35*this.scaleSize&&!this.dungeon.player.isDied&&!this.isDashing&&this.isShow&&c.default.getHalfChance()&&(cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}}),c.default.getHalfChance()&&(i=this.dungeon.player.getCenterPosition().sub(this.node.position)),this.move(i,1.5*a),this.isDashing=!0,this.scheduleOnce(function(){t.node&&(t.isDashing=!1)},2)),c.default.getRandomNum(1,10)<3&&this.move(i,a)}},e.prototype.move=function(t,e){if(!(this.isDied||this.isHurt||this.isDashing||!this.isShow||this.meleeSkill.IsExcuting||t.equals(cc.Vec2.ZERO))){t=t.normalizeSelf(),this.meleeSkill.IsExcuting&&!t.equals(cc.Vec2.ZERO)&&(t=t.mul(.5)),t.equals(cc.Vec2.ZERO)||(this.pos=l.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a.clone(),this.currentlinearVelocitySpeed=a.clone(),this.isMoving=0!=o||0!=i,this.isMoving&&(this.isFaceRight=o>0);var n=this.anim.getAnimationState("SlimeAttack").isPlaying;this.anim.getAnimationState("SlimeIdle").isPlaying||n||this.anim.play("SlimeIdle"),this.changeZIndex()}},e.prototype.actorName=function(){return"\u53f2\u83b1\u59c6\u4e4b\u738b"},e.DIVIDE_COUNT=4,a([D(cc.Prefab)],e.prototype,"venom",void 0),e=o=a([v],e)}(n.default);o.default=C,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Item/Item":"Item","../Logic":"Logic","../Manager/MonsterManager":"MonsterManager","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss","./SlimeVenom":"SlimeVenom"}],SpecialManager:[function(t,e,o){"use strict";cc._RF.push(e,"e58b4559dND3JlWZESKg4rV","SpecialManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Boss/SlimeVenom"),r=t("../Data/DamageData"),c=t("./StatusManager"),l=t("../Monster"),h=t("../Item/AreaAttack"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.venom=null,e.howl=null,e.claw=null,e.blade=null,e}var o;return i(e,t),o=e,e.prototype.addPlacement=function(t,e,i,a){if(this.dungeon){var n=this.node.convertToWorldSpaceAR(cc.v2(e,0));switch(n=this.dungeon.node.convertToNodeSpaceAR(n),t){case o.AFTER_VENOM:this.addVenom(n,i,a);break;case o.AFTER_CLAW:this.addClaw(n,i,a);break;case o.AFTER_BLADE:this.addBlade(n,i,a)}}},e.prototype.addEffect=function(t,e,i,a){if(this.dungeon){var n=this.node.convertToWorldSpaceAR(cc.v2(e,0));switch(n=this.dungeon.node.convertToNodeSpaceAR(n),t){case o.BEFORE_HOWL:this.addHowl(n,i,a)}}},e.prototype.addVenom=function(t,e,o){var i=cc.instantiate(this.venom);i.getComponent(s.default).player=this.dungeon.player,i.getComponent(s.default).isForever=!1,i.getComponent(s.default).from.valueCopy(o),i.parent=this.dungeon.node,i.position=t;var a=n.default.getIndexInMap(t);i.zIndex=3e3+10*(n.default.HEIGHT_SIZE-a.y),i.scale=0,i.runAction(cc.scaleTo(.5,2,2))},e.prototype.addHowl=function(t,e,o){var i=this,a=cc.instantiate(this.howl);a.parent=this.dungeon.node,a.position=t;var s=n.default.getIndexInMap(t);a.zIndex=3e3+10*(n.default.HEIGHT_SIZE-s.y),a.scale=2;var u=this.node.parent.getComponent(l.default);u&&u.addStatus(c.default.WEREWOLFDEFENCE,o);var p=a.getComponent(h.default);this.scheduleOnce(function(){p.damagePlayer(c.default.DIZZ,i.dungeon.player,new r.default(1),o)},1)},e.prototype.addClaw=function(t,e,o){var i=this,a=cc.instantiate(this.claw);a.parent=this.dungeon.node,t.y+=32,a.position=t;var s=n.default.getIndexInMap(t);a.zIndex=3e3+10*(n.default.HEIGHT_SIZE-s.y),a.scale=1;var l=a.getComponent(h.default);this.scheduleOnce(function(){l.damagePlayer(c.default.BLEEDING,i.dungeon.player,new r.default(2),o),i.scheduleOnce(function(){l.damagePlayer(c.default.BLEEDING,i.dungeon.player,new r.default(3),o)},.2)},.5)},e.prototype.addBlade=function(t,e,o){var i=this,a=cc.instantiate(this.blade);a.parent=this.dungeon.node,a.position=t,t.y+=64;var s=n.default.getIndexInMap(t);a.zIndex=3e3+10*(n.default.HEIGHT_SIZE-s.y),a.scaleX=e?1:-1;var c=a.getComponent(h.default);this.scheduleOnce(function(){c.damagePlayer("",i.dungeon.player,new r.default(3),o)},.5)},e.BEFORE_HOWL="special015",e.AFTER_VENOM="special019",e.AFTER_CLAW="special024",e.AFTER_BLADE="special008",a([d(cc.Prefab)],e.prototype,"venom",void 0),a([d(cc.Prefab)],e.prototype,"howl",void 0),a([d(cc.Prefab)],e.prototype,"claw",void 0),a([d(cc.Prefab)],e.prototype,"blade",void 0),e=o=a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Boss/SlimeVenom":"SlimeVenom","../Data/DamageData":"DamageData","../Dungeon":"Dungeon","../Item/AreaAttack":"AreaAttack","../Monster":"Monster","./StatusManager":"StatusManager"}],Sphinx:[function(t,e,o){"use strict";cc._RF.push(e,"613334RiSdNUKEp1LtYmQ1e","Sphinx");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Shooter"),r=t("../Dungeon"),c=t("../Manager/StatusManager"),l=t("../Utils/Skill"),h=t("../Manager/MonsterManager"),u=t("../Utils/AudioPlayer"),p=t("../EventConstant"),d=t("../Data/FromData"),f=t("../Achievement"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.isMoving=!1,e.stormSkill=new l.default,e.summonSkill=new l.default,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(s.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(c.default),this.shooter01.from.valueCopy(d.default.getClone(this.actorName(),"sphinxhead"))},e.prototype.start=function(){},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.playHit(this.node.getChildByName("sprite")),cc.director.emit(p.EventConstant.PLAY_AUDIO,{detail:{name:u.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(f.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){!this.isDied&&this.isShow&&this.dungeon&&(this.changeZIndex(),this.fireStorm(),this.summonMonster())},e.prototype.summonMonster=function(){var t=this;this.dungeon.getMonsterAliveNum()>1||this.summonSkill.next(function(){cc.director.emit(p.EventConstant.PLAY_AUDIO,{detail:{name:u.default.MELEE}}),t.summonSkill.IsExcuting=!0;var e=r.default.getIndexInMap(t.node.position.clone());t.dungeon.addMonsterFromData(h.default.MONSTER_SANDSTATUE,e.x,e.y-1),t.dungeon.addMonsterFromData(h.default.MONSTER_SANDSTATUE,e.x+1,e.y-1),t.dungeon.addMonsterFromData(h.default.MONSTER_SANDSTATUE,e.x-1,e.y-1),t.dungeon.addMonsterFromData(h.default.MONSTER_ANUBIS,e.x-1,e.y-2),t.dungeon.addMonsterFromData(h.default.MONSTER_ANUBIS,e.x+1,e.y-2)},15,!0)},e.prototype.fireStorm=function(){var t=this;this.stormSkill.next(function(){t.stormSkill.IsExcuting=!0,t.anim.play("SphinxStorm"),t.scheduleOnce(function(){var e=t.node.position.clone().add(t.shooter01.node.position),o=t.dungeon.player.getCenterPosition().sub(e);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),t.shooter01.setHv(o),t.fireShooter(t.shooter01,"bullet023",0,-20),t.fireShooter(t.shooter01,"bullet123",0,0,0),t.fireShooter(t.shooter01,"bullet223",0,0,20))},.3),t.scheduleOnce(function(){t.stormSkill.IsExcuting=!1,t.anim.play("SphinxIdle")},2)},8,!0)},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a,cc.Vec2.ZERO)},e.prototype.showBoss=function(){this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied,this.rigidbody.linearVelocity=cc.Vec2.ZERO},e.prototype.actorName=function(){return"\u65af\u82ac\u514b\u65af"},e=a([g],e)}(n.default));o.default=y,cc._RF.pop()},{"../Achievement":"Achievement","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Manager/MonsterManager":"MonsterManager","../Manager/StatusManager":"StatusManager","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Boss":"Boss"}],Start:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Start");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=t("./WxHelper"),r=t("./EventConstant"),c=t("./Utils/AudioPlayer"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.continueButton=null,e.wxhelper=null,e.cheatButton=null,e.debugButton=null,e.cheatClickCount=0,e.debugClickCount=0,e}return i(e,t),e.prototype.start=function(){cc.view.enableAntiAlias(!1),this.continueButton&&(this.continueButton.active=n.default.profileManager.hasSaveData)},e.prototype.startGame=function(){this.wxhelper&&this.wxhelper.CloseDialog(),n.default.profileManager.clearData(),n.default.resetData(),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("loading")},e.prototype.chooseChapter=function(){cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("chapter")},e.prototype.achievementScene=function(){cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("achievement")},e.prototype.continueGame=function(){this.wxhelper&&this.wxhelper.CloseDialog(),n.default.resetData(),cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:c.default.SELECT}}),cc.director.loadScene("loading")},e.prototype.cheatModeChange=function(){this.cheatButton&&(this.cheatClickCount++,this.cheatClickCount>2?(this.cheatClickCount=0,n.default.isCheatMode=!0,this.cheatButton.opacity=n.default.isCheatMode?255:0):(n.default.isCheatMode=!1,this.cheatButton.opacity=0))},e.prototype.debugModeChange=function(){this.debugButton&&(this.debugClickCount++,this.debugClickCount>2?(this.debugClickCount=0,n.default.isDebug=!0,this.debugButton.opacity=n.default.isDebug?255:0,cc.director.getCollisionManager().enabledDebugDraw=!0):(n.default.isDebug=!1,this.debugButton.opacity=0,cc.director.getCollisionManager().enabledDebugDraw=!1))},a([u(cc.Node)],e.prototype,"continueButton",void 0),a([u(s.default)],e.prototype,"wxhelper",void 0),a([u(cc.Node)],e.prototype,"cheatButton",void 0),a([u(cc.Node)],e.prototype,"debugButton",void 0),e=a([h],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./Utils/AudioPlayer":"AudioPlayer","./WxHelper":"WxHelper"}],StatusData:[function(t,e,o){"use strict";cc._RF.push(e,"e6cc1ffzwVEGqcTbp1oM4Mh","StatusData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./CommonData"),a=t("./FromData"),n=function(){function t(){this.statusType=0,this.nameCn="",this.nameEn="",this.duration=0,this.desc="",this.spriteFrameName="",this.physicalDamageDirect=0,this.physicalDamageOvertime=0,this.missRate=0,this.realDamageDirect=0,this.realDamageOvertime=0,this.iceDamageDirect=0,this.iceDamageOvertime=0,this.fireDamageDirect=0,this.fireDamageOvertime=0,this.lighteningDamageDirect=0,this.lighteningDamageOvertime=0,this.toxicDamageDirect=0,this.toxicDamageOvertime=0,this.curseDamageDirect=0,this.curseDamageOvertime=0,this.dizzDurationDirect=0,this.dizzDurationOvertime=0,this.common=new i.default,this.from=new a.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"From",{get:function(){return this.from},enumerable:!0,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.from.valueCopy(t.from),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn,this.statusType=t.statusType,this.duration=t.duration,this.spriteFrameName=t.spriteFrameName,this.desc=t.desc,this.physicalDamageDirect=t.physicalDamageDirect,this.physicalDamageOvertime=t.physicalDamageOvertime,this.missRate=t.missRate,this.realDamageDirect=t.realDamageDirect,this.realDamageOvertime=t.realDamageOvertime,this.iceDamageDirect=t.iceDamageDirect,this.iceDamageOvertime=t.iceDamageOvertime,this.fireDamageDirect=t.fireDamageDirect,this.fireDamageOvertime=t.fireDamageOvertime,this.lighteningDamageDirect=t.lighteningDamageDirect,this.lighteningDamageOvertime=t.lighteningDamageOvertime,this.toxicDamageDirect=t.toxicDamageDirect,this.toxicDamageOvertime=t.toxicDamageOvertime,this.curseDamageDirect=t.curseDamageDirect,this.curseDamageOvertime=t.curseDamageOvertime,this.dizzDurationDirect=t.dizzDurationDirect,this.dizzDurationOvertime=t.dizzDurationOvertime},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.from=this.from.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.statusType=this.statusType,e.duration=this.duration,e.desc=this.desc,e.physicalDamageDirect=this.physicalDamageDirect,e.physicalDamageOvertime=this.physicalDamageOvertime,e.missRate=this.missRate,e.realDamageDirect=this.realDamageDirect,e.realDamageOvertime=this.realDamageDirect,e.iceDamageDirect=this.iceDamageDirect,e.iceDamageOvertime=this.iceDamageOvertime,e.fireDamageDirect=this.fireDamageDirect,e.fireDamageOvertime=this.fireDamageOvertime,e.lighteningDamageDirect=this.lighteningDamageDirect,e.lighteningDamageOvertime=this.lighteningDamageOvertime,e.toxicDamageDirect=this.toxicDamageDirect,e.toxicDamageOvertime=this.toxicDamageOvertime,e.curseDamageDirect=this.curseDamageDirect,e.curseDamageOvertime=this.curseDamageOvertime,e.spriteFrameName=this.spriteFrameName,e.dizzDurationDirect=this.dizzDurationDirect,e.dizzDurationOvertime=this.dizzDurationOvertime,e},t}();o.default=n,cc._RF.pop()},{"./CommonData":"CommonData","./FromData":"FromData"}],StatusManager:[function(t,e,o){"use strict";cc._RF.push(e,"70cfczADURLkqYmvLLsshT9","StatusManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Status"),s=t("../Data/StatusData"),r=t("../Logic"),c=t("../EventConstant"),l=t("../Player"),h=t("../Monster"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.statusPrefab=null,e.timeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.statusList=new Array},e.prototype.start=function(){},e.prototype.addStatus=function(t,e){if(!(t.length<1)){var o=new s.default;o.valueCopy(r.default.debuffs[t]),o.From.valueCopy(e),this.showStatus(o)}},e.prototype.hasStatus=function(t){var e=!1,o=new s.default;o.valueCopy(r.default.debuffs[t]);for(var i=this.statusList.length-1;i>=0;i--){var a=this.statusList[i];if(a&&a.node&&a.isValid&&a.isStatusRunning()&&a.data.statusType==o.statusType){e=!0;break}}return e},e.prototype.showStatus=function(t){for(var e=this.statusList.length-1;e>=0;e--){(i=this.statusList[e])&&i.node&&i.isValid&&i.isStatusRunning()||this.statusList.splice(e,1)}var o=!1;for(e=this.statusList.length-1;e>=0;e--){var i;if((i=this.statusList[e])&&i.node&&i.isValid&&i.isStatusRunning()&&i.data.statusType==t.statusType){i.data.duration=t.duration,i.showStatus(this.node.parent,t),o=!0;break}}if(!o){var a=cc.instantiate(this.statusPrefab);a.parent=this.node,a.active=!0;var s=a.getComponent(n.default);this.statusList.push(s),s.showStatus(this.node.parent,t)}},e.prototype.update=function(t){if(this.node.parent&&(this.node.scaleX=this.node.parent.scaleX>0?1:-1),this.isTimeDelay(t)){var e=this.node.parent.getComponent(h.default);this.node.parent&&this.node.parent.getComponent(l.default)?(r.default.playerData.StatusTotalData.valueCopy(this.updateStatus()),cc.director.emit(c.EventConstant.PLAYER_STATUSUPDATE)):this.node.parent&&e&&e.data.StatusTotalData.valueCopy(this.updateStatus())}},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.2&&(this.timeDelay=0,!0)},e.prototype.updateStatus=function(){var t=new s.default;t.Common.lifeDrain=1,t.Common.criticalStrikeRate=1,t.Common.dodge=1;for(var e=this.statusList.length-1;e>=0;e--){var o=this.statusList[e];o&&o.node&&o.isValid&&o.isStatusRunning()&&(t.missRate+=o.data.missRate?o.data.missRate:0,t.Common.damageMin+=o.data.Common.damageMin?o.data.Common.damageMin:0,t.Common.damageMax+=o.data.Common.damageMax?o.data.Common.damageMax:0,t.Common.defence+=o.data.Common.defence?o.data.Common.defence:0,t.Common.criticalStrikeRate*=o.data.Common.criticalStrikeRate?1-o.data.Common.criticalStrikeRate/100:1,t.Common.lifeDrain*=o.data.Common.lifeDrain?1-o.data.Common.lifeDrain/100:1,t.Common.dodge*=o.data.Common.dodge?1-o.data.Common.dodge/100:1,t.Common.lifeRecovery+=o.data.Common.lifeRecovery?o.data.Common.lifeRecovery:0,t.Common.moveSpeed+=o.data.Common.moveSpeed?o.data.Common.moveSpeed:0,t.Common.attackSpeed+=o.data.Common.attackSpeed?o.data.Common.attackSpeed:0,t.Common.maxHealth+=o.data.Common.maxHealth?o.data.Common.maxHealth:0,t.Common.realDamage+=o.data.Common.realDamage?o.data.Common.realDamage:0,t.Common.realRate+=o.data.Common.realRate?o.data.Common.realRate:0,t.Common.iceDamage+=o.data.Common.iceDamage?o.data.Common.iceDamage:0,t.Common.iceDefence+=o.data.Common.iceDefence?o.data.Common.iceDefence:0,t.Common.iceRate+=o.data.Common.iceRate?o.data.Common.iceRate:0,t.Common.fireDamage+=o.data.Common.fireDamage?o.data.Common.fireDamage:0,t.Common.fireDefence+=o.data.Common.fireDefence?o.data.Common.fireDefence:0,t.Common.fireRate+=o.data.Common.fireRate?o.data.Common.fireRate:0,t.Common.lighteningDamage+=o.data.Common.lighteningDamage?o.data.Common.lighteningDamage:0,t.Common.lighteningDefence+=o.data.Common.lighteningDefence?o.data.Common.lighteningDefence:0,t.Common.lighteningRate+=o.data.Common.lighteningRate?o.data.Common.lighteningRate:0,t.Common.toxicDamage+=o.data.Common.toxicDamage?o.data.Common.toxicDamage:0,t.Common.toxicDefence+=o.data.Common.toxicDefence?o.data.Common.toxicDefence:0,t.Common.toxicRate+=o.data.Common.toxicRate?o.data.Common.toxicRate:0,t.Common.curseDamage+=o.data.Common.curseDamage?o.data.Common.curseDamage:0,t.Common.curseDefence+=o.data.Common.curseDefence?o.data.Common.curseDefence:0,t.Common.curseRate+=o.data.Common.curseRate?o.data.Common.curseRate:0)}return t.Common.criticalStrikeRate=100*(1-t.Common.criticalStrikeRate),t.Common.lifeDrain=100*(1-t.Common.lifeDrain),t.Common.dodge=100*(1-t.Common.dodge),t},e.FROZEN="status001",e.BURNING="status002",e.DIZZ="status003",e.TOXICOSIS="status004",e.CURSING="status005",e.BLEEDING="status006",e.ATTACKPLUS="status007",e.FASTMOVE="status008",e.FASTATTACK="status009",e.PERFECTDEFENCE="status010",e.HEALING="status011",e.RECOVERY="status012",e.STONE="status013",e.TWINE="status014",e.SHIELD_NORMAL="status015",e.SHIELD_LONG="status016",e.BOTTLE_HEALING="status017",e.WEREWOLFDEFENCE="status021",e.GOLDAPPLE="status022",e.MAGIC_WEAPON="status023",e.MAGIC_WEAPON_STRONG="status024",e.FROZEN_STRONG="status025",a([d(cc.Prefab)],e.prototype,"statusPrefab",void 0),e=a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Data/StatusData":"StatusData","../EventConstant":"EventConstant","../Logic":"Logic","../Monster":"Monster","../Player":"Player","../Status":"Status"}],Status:[function(t,e,o){"use strict";cc._RF.push(e,"71809qjadJJZIMwM9M2G6cL","Status");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Data/StatusData"),s=t("./Logic"),r=t("./Player"),c=t("./Data/DamageData"),l=t("./Monster"),h=t("./Boss/Boss"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateRunning=!1,e.sprite=null,e.data=new n.default,e.delayTime=0,e}return i(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.label=this.node.getChildByName("sprite").getChildByName("label").getComponent(cc.Label),this.anim=this.getComponent(cc.Animation)},e.prototype.start=function(){},e.prototype.showStatus=function(t,e){this.anim&&(this.target=t,this.data=e,this.sprite.spriteFrame=s.default.spriteFrames[e.spriteFrameName],this.anim.playAdditive("StatusShow"),this.doStatusDamage(!0),this.stateRunning=!0)},e.prototype.stopStatus=function(){this.data.duration=0,this.stateRunning&&this.node.destroy()},e.prototype.isStatusRunning=function(){return this.data.duration>0||-1==this.data.duration},e.prototype.isTimeDelay=function(t){return this.delayTime+=t,this.delayTime>1&&(this.delayTime=0,!0)},e.prototype.doStatusDamage=function(t){if(this.target&&this.data){var e=t?this.getDamageDirect():this.getDamageOverTime(),o=t?this.data.dizzDurationDirect:this.data.dizzDurationOvertime,i=this.target.getComponent(r.default),a=0!=e.getTotalDamage();if(i)return a&&i.takeDamage(e,this.data.From),void i.dizzCharacter(o);var n=this.target.getComponent(l.default);if(n)return a&&n.takeDamage(e),void n.dizzCharacter(o);var s=this.target.getComponent(h.default);s&&a&&s.takeDamage(e)}},e.prototype.update=function(t){var e=this;this.label.string=""+this.data.duration,this.label.node.opacity=this.data.duration<0||this.data.duration>500?0:255,this.isTimeDelay(t)&&(this.data.duration>0&&(-1!=this.data.duration&&this.data.duration--,this.doStatusDamage(!1)),0==this.data.duration&&this.stateRunning&&(this.stateRunning=!1,this.anim.play("StatusHide"),this.scheduleOnce(function(){e.node&&e.node.destroy()},.5)))},e.prototype.getDamageDirect=function(){var t=new c.default;return t.realDamage=this.data.realDamageDirect?this.data.realDamageDirect:0,t.physicalDamage=this.data.physicalDamageDirect?this.data.physicalDamageDirect:0,t.iceDamage=this.data.iceDamageDirect?this.data.iceDamageDirect:0,t.fireDamage=this.data.fireDamageDirect?this.data.fireDamageDirect:0,t.lighteningDamage=this.data.lighteningDamageDirect?this.data.lighteningDamageDirect:0,t.toxicDamage=this.data.toxicDamageDirect?this.data.toxicDamageDirect:0,t.curseDamage=this.data.curseDamageDirect?this.data.curseDamageDirect:0,t},e.prototype.getDamageOverTime=function(){var t=new c.default;return t.realDamage=this.data.realDamageOvertime?this.data.realDamageOvertime:0,t.physicalDamage=this.data.physicalDamageOvertime?this.data.physicalDamageOvertime:0,t.iceDamage=this.data.iceDamageOvertime?this.data.iceDamageOvertime:0,t.fireDamage=this.data.fireDamageOvertime?this.data.fireDamageOvertime:0,t.lighteningDamage=this.data.lighteningDamageOvertime?this.data.lighteningDamageOvertime:0,t.toxicDamage=this.data.toxicDamageOvertime?this.data.toxicDamageOvertime:0,t.curseDamage=this.data.curseDamageOvertime?this.data.curseDamageOvertime:0,t},e=a([p],e)}(cc.Component));o.default=d,cc._RF.pop()},{"./Boss/Boss":"Boss","./Data/DamageData":"DamageData","./Data/StatusData":"StatusData","./Logic":"Logic","./Monster":"Monster","./Player":"Player"}],TalentDash:[function(t,e,o){"use strict";cc._RF.push(e,"52ac4HK4rpMhYIJb8+wkG1J","TalentDash");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("./Talent"),r=t("../Item/DashShadow"),c=t("../Player"),l=t("../Data/DamageData"),h=t("../Monster"),u=t("../Boss/Boss"),p=t("../Manager/StatusManager"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dashShadow=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(){t.prototype.init.call(this),this.dashShadow.node.active=!1,this.node.parent=this.player.node.parent,this.dashShadow.init(this)},e.prototype.useSKill=function(){this.useDash()},e.prototype.useDash=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=3;this.hashTalent(s.default.DASH_13)&&(e=2);var o=1200;this.hashTalent(s.default.DASH_14)&&(o=2400),this.talentSkill.next(function(){t.talentSkill.IsExcuting=!0,cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:d.default.DASH}}),t.schedule(function(){t.player.getWalkSmoke(t.node.parent,t.node.position)},.05,4,0);var i=t.player.rigidbody.linearVelocity.clone();t.player.isMoving=!1,i=i.equals(cc.Vec2.ZERO)?t.player.isFaceRight?cc.v2(1,0):cc.v2(-1,0):i.normalizeSelf(),t.hashTalent(s.default.DASH_08)&&(o=100,t.showShadow(i)),t.hv=i.clone(),i=i.mul(o),t.player.rigidbody.linearVelocity=i,t.scheduleOnce(function(){t.player.rigidbody.linearVelocity=cc.Vec2.ZERO,t.player.playerAnim(c.default.STATE_IDLE),t.player.resetFoot(),t.IsExcuting=!1},.5),cc.director.emit(n.EventConstant.HUD_CONTROLLER_COOLDOWN,{detail:{cooldown:e,talentType:1}})},e,!0)}},e.prototype.showShadow=function(t){this.dashShadow&&(this.dashShadow.setHv(t.clone()),this.dashShadow.show())},e.prototype.changePerformance=function(){for(var t=0,e=this.talentList;t<e.length;t++){var o=e[t];o.id==s.default.DASH_01||o.id==s.default.DASH_02||o.id==s.default.DASH_03||o.id==s.default.DASH_04||o.id==s.default.DASH_05||o.id==s.default.DASH_06||o.id==s.default.DASH_07||o.id==s.default.DASH_08||o.id==s.default.DASH_09||o.id==s.default.DASH_10||o.id==s.default.DASH_11||o.id==s.default.DASH_12||o.id==s.default.DASH_13||(o.id,s.default.DASH_14)}},e.prototype.onBeginContact=function(t,e,o){this.hashTalent(s.default.DASH_02)&&!this.hashTalent(s.default.DASH_08)&&this.attacking(o,this.node)},e.prototype.attacking=function(t,e){if(t&&e.active){var o=new l.default(1);this.hashTalent(s.default.DASH_07)&&(o.realDamage=5);var i=t.node.getComponent(h.default);i&&!i.isDied&&i.takeDamage(o)&&(this.beatBack(i.node),this.addMonsterAllStatus(i));var a=t.node.getComponent(u.default);a&&!a.isDied&&a.takeDamage(o)&&this.addBossAllStatus(a)}},e.prototype.beatBack=function(t){if(this.hashTalent(s.default.DASH_04)){var e=t.getComponent(cc.RigidBody),o=this.hv.clone();o=o.normalizeSelf().mul(1e3),e.applyLinearImpulse(o,e.getLocalCenter(),!0)}},e.prototype.addMonsterAllStatus=function(t){this.addMonsterStatus(s.default.DASH_05,t,p.default.FROZEN),this.addMonsterStatus(s.default.DASH_06,t,p.default.DIZZ),this.addMonsterStatus(s.default.DASH_03,t,p.default.BLEEDING)},e.prototype.addBossAllStatus=function(t){this.addBossStatus(s.default.DASH_05,t,p.default.FROZEN),this.addBossStatus(s.default.DASH_06,t,p.default.DIZZ),this.addBossStatus(s.default.DASH_03,t,p.default.BLEEDING)},e.prototype.addMonsterStatus=function(t,e,o){this.hashTalent(t)&&e.addStatus(o,new f.default)},e.prototype.addBossStatus=function(t,e,o){this.hashTalent(t)&&e.addStatus(o,new f.default)},e.prototype.takeDamage=function(){},a([y(r.default)],e.prototype,"dashShadow",void 0),e=a([g],e)}(s.default);o.default=v,cc._RF.pop()},{"../Boss/Boss":"Boss","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../EventConstant":"EventConstant","../Item/DashShadow":"DashShadow","../Manager/StatusManager":"StatusManager","../Monster":"Monster","../Player":"Player","../Utils/AudioPlayer":"AudioPlayer","./Talent":"Talent"}],TalentData:[function(t,e,o){"use strict";cc._RF.push(e,"337bcbBGB9GS4DrPZ+ZKu25","TalentData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./CommonData"),a=function(){function t(){this.id=0,this.desc="",this.nameCn="",this.nameEn="",this.common=new i.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.desc=t.desc?t.desc:this.desc,this.id=t.id?t.id:0},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.desc=this.desc,e.id=this.id,e},t}();o.default=a,cc._RF.pop()},{"./CommonData":"CommonData"}],TalentIcon:[function(t,e,o){"use strict";cc._RF.push(e,"b9bc3XlhjZFx7WzURGahizt","TalentIcon");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Logic"),s=t("../EventConstant"),r=t("../Talent/Talent"),c=cc._decorator,l=c.ccclass,h=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parents=null,e.children=null,e.currentChild=null,e.currentParent=null,e.isOpen=!1,e.isRoot=!1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){this.node.color=cc.color(51,51,51)},e.prototype.onClick=function(){return this.isOpen||this.openTalent(),!1},e.prototype.openTalent=function(){return this.isOpen=this.checkCanOpen(),!!this.isOpen&&(this.node.color=cc.color(255,255,255),cc.director.emit(s.EventConstant.TALENT_TREE_UPDATE),n.default.addTalent(this.data.id))},e.prototype.needAndNot=function(t,e,o,i){var a=!1;if(this.data.id!=t+e)return!1;if(1==e)return!0;for(var n=0,s=o;n<s.length;n++){var r=s[n];this.hasTalent(t+parseInt(r))&&(a=!0)}if(i)for(var c=0,l=i;c<l.length;c++){r=l[c];this.hasTalent(t+parseInt(r))&&(a=!1)}return a},e.prototype.parseOpenMapAndCanOpen=function(t,e){var o=e.split(";"),i=[],a=[];return o[1]&&o[1].length>0&&(i=o[1].split(",")),o[1]&&o[2].length>0&&(a=o[2].split(",")),!!this.needAndNot(t,parseInt(o[0]),i,a)},e.prototype.checkCanOpen=function(){for(var t=0,e=r.default.DASH_CAN_OPEN_MAP;t<e.length;t++){var o=e[t];if(this.parseOpenMapAndCanOpen(r.default.DASH,o))return!0}for(var i=0,a=r.default.SHIELD_CAN_OPEN_MAP;i<a.length;i++){o=a[i];if(this.parseOpenMapAndCanOpen(r.default.SHIELD,o))return!0}for(var n=0,s=r.default.MAGIC_CAN_OPEN_MAP;n<s.length;n++){o=s[n];if(this.parseOpenMapAndCanOpen(r.default.MAGIC,o))return!0}return!1},e.prototype.hasTalent=function(t){return n.default.hashTalent(t)},e.prototype.disconnectNode=function(t){t.node.color=cc.color(51,51,51),t.currentParent&&null!=t.currentParent&&(t.currentParent.getComponent(o).currentChild=null),t.currentChild=null,t.currentParent=null},e.prototype.closeAllChildren=function(t){for(var e=0,i=t;e<i.length;e++){var a=i[e].getComponent(o);a.isOpen=!1,this.disconnectNode(a),this.closeAllChildren(a.children)}},e=o=a([l],e)}(cc.Component));o.default=h,cc._RF.pop()},{"../EventConstant":"EventConstant","../Logic":"Logic","../Talent/Talent":"Talent"}],TalentMagic:[function(t,e,o){"use strict";cc._RF.push(e,"d3909410aVM/oDLjAGklG7U","TalentMagic");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=t("./Talent"),r=t("../Manager/StatusManager"),c=t("../Data/FromData"),l=t("./MagicCircle"),h=t("./MagicIce"),u=t("./MagicBall"),p=t("./FireGhost"),d=t("../Logic"),f=cc._decorator,m=f.ccclass,g=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.magiccircle=null,e.magicice=null,e.magicball=null,e.fireGhost=null,e.magicLightening=null,e.fireGhostNum=0,e.checkTimeDelay=0,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;this.ghostPool=new cc.NodePool(p.default),cc.director.on("destoryfireghost",function(e){t.destroyGhost(e.detail.coinNode)})},e.prototype.destroyGhost=function(t){t&&(t.active=!1,this.ghostPool&&(this.ghostPool.put(t),this.fireGhostNum--,cc.log("destroyGhost")))},e.prototype.init=function(){var e=this;this.magicLightening.opacity=0,t.prototype.init.call(this),this.scheduleOnce(function(){e.hashTalent(s.default.MAGIC_07)&&e.player.addStatus(e.hashTalent(o.MAGIC_06)?r.default.MAGIC_WEAPON_STRONG:r.default.MAGIC_WEAPON,new c.default),e.hashTalent(s.default.MAGIC_13)&&!e.magicice.isShow&&e.magicice.showIce(),e.hashTalent(s.default.MAGIC_10)&&e.initFireGhosts(),e.hashTalent(o.MAGIC_16)&&e.showLightening()},.2)},e.prototype.useSKill=function(){this.useMagic()},e.prototype.useMagic=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=7;this.hashTalent(s.default.MAGIC_04)&&(e=3),this.talentSkill.next(function(){t.talentSkill.IsExcuting=!0,t.magiccircle.talentMaigc=t,t.magiccircle.playMagic(t.hashTalent(s.default.MAGIC_03)?2:1),cc.director.emit(n.EventConstant.HUD_CONTROLLER_COOLDOWN,{detail:{cooldown:e,talentType:3}})},e,!0)}},e.prototype.MagicFinish=function(){this.hashTalent(s.default.MAGIC_09)?this.showMagicBall(u.default.FIRE,!0):this.hashTalent(s.default.MAGIC_08)?this.showMagicBall(u.default.FIRE,!1):this.hashTalent(s.default.MAGIC_12)?this.shoot(this.player.shooterEx,this.hashTalent(s.default.MAGIC_06)?"bullet137":"bullet037"):this.hashTalent(s.default.MAGIC_11)?this.shoot(this.player.shooterEx,this.hashTalent(s.default.MAGIC_06)?"bullet136":"bullet036"):this.hashTalent(s.default.MAGIC_15)?this.showMagicBall(u.default.LIGHTENING,!0):this.hashTalent(s.default.MAGIC_14)?this.showMagicBall(u.default.LIGHTENING,!1):this.hashTalent(s.default.MAGIC_01)&&this.shoot(this.player.shooterEx,this.hashTalent(s.default.MAGIC_06)?"bullet135":"bullet035")},e.prototype.showMagicBall=function(t,e){cc.instantiate(this.magicball).getComponent(u.default).show(this.player,t,e,0),this.hashTalent(s.default.MAGIC_02)&&(cc.instantiate(this.magicball).getComponent(u.default).show(this.player,t,e,30),cc.instantiate(this.magicball).getComponent(u.default).show(this.player,t,e,-30))},e.prototype.shoot=function(t,e){t.data.bulletType=e,t.data.bulletArcExNum=0,this.hashTalent(s.default.MAGIC_02)&&(t.data.bulletArcExNum=2),t.data.bulletLineExNum=0,t.fireBullet(0)},e.prototype.changePerformance=function(){},e.prototype.takeIce=function(){return!(!this.hashTalent(s.default.MAGIC_13)||!this.magicice.isShow)&&(this.addStatus2NearEnemy(r.default.FROZEN,300),this.magicice.breakIce(),!0)},e.prototype.takeDamage=function(t,e){},e.prototype.showLightening=function(){var t=this;this.magicLightening.opacity=128,this.magicLightening.scale=1,this.magicLightening.runAction(cc.sequence(cc.scaleTo(1,10),cc.callFunc(function(){t.addStatus2NearEnemy(r.default.DIZZ,300),t.magicLightening.opacity=0,t.magicLightening.scale=1})))},e.prototype.initFireGhosts=function(){for(var t=this.fireGhostNum,e=0;e<5-t;e++){var o=null;this.ghostPool.size()>0&&(o=this.ghostPool.get()),o&&!o.active||(o=cc.instantiate(this.fireGhost)),this.fireGhostNum++,o.active=!0;var i=o.getComponent(p.default);this.player.node.parent.addChild(i.node),i.init(this.player,72*e)}},e.prototype.addStatus2NearEnemy=function(t,e){if(!this.player)return cc.Vec2.ZERO;for(var o=0,i=this.player.meleeWeapon.dungeon.monsters;o<i.length;o++){var a=i[o];d.default.getDistance(this.node.position,a.node.position)<e&&!a.isDied&&!a.isDisguising&&a.addStatus(t,new c.default)}for(var n=0,s=this.player.meleeWeapon.dungeon.bosses;n<s.length;n++){var r=s[n];d.default.getDistance(this.node.position,r.node.position)<e&&!r.isDied&&r.addStatus(t,new c.default)}},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>10&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isCheckTimeDelay(t)&&this.init()},a([g(l.default)],e.prototype,"magiccircle",void 0),a([g(h.default)],e.prototype,"magicice",void 0),a([g(cc.Prefab)],e.prototype,"magicball",void 0),a([g(cc.Prefab)],e.prototype,"fireGhost",void 0),a([g(cc.Node)],e.prototype,"magicLightening",void 0),e=o=a([m],e)}(s.default);o.default=y,cc._RF.pop()},{"../Data/FromData":"FromData","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","./FireGhost":"FireGhost","./MagicBall":"MagicBall","./MagicCircle":"MagicCircle","./MagicIce":"MagicIce","./Talent":"Talent"}],TalentShield:[function(t,e,o){"use strict";cc._RF.push(e,"9db0eWCt9hLa7XLpSo6xHBj","TalentShield");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Manager/StatusManager"),s=t("../EventConstant"),r=t("../Logic"),c=t("../Data/DamageData"),l=t("../Item/FlyWheel"),h=t("../Dungeon"),u=t("./Talent"),p=t("../Utils/Skill"),d=t("../Utils/AudioPlayer"),f=t("../Data/FromData"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shieldBackSprite=null,e.shieldFrontSprite=null,e.flyWheel=null,e.flyWhellSkill=new p.default,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.init=function(){t.prototype.init.call(this),this.shieldBackSprite=this.getSpriteChildSprite(["shieldback"]),this.shieldFrontSprite=this.getSpriteChildSprite(["shieldfront"]),this.shieldBackSprite.node.opacity=0,this.shieldFrontSprite.node.opacity=0,this.sprites=new Array;for(var e=[2,3,4,5,9,12,13,14],o=0;o<e.length;o++){var i=this.getSpriteChildSprite(["shieldfront","sprite"+e[o]]);i.node.opacity=0,this.sprites.push(i)}this.flyWheel.dungeon=this.player.node.parent.getComponent(h.default),this.flyWheel.node.active=!1,this.node.parent=this.flyWheel.dungeon.node,this.flyWheel.init()},e.prototype.changePerformance=function(){for(var t=0,e=this.sprites;t<e.length;t++){e[t].node.opacity=0}this.shieldFrontSprite.node.color=cc.color(255,255,255);for(var i=!1,a=0,n=this.talentList;a<n.length;a++){var s=n[a];s.id==o.SHIELD_01||(s.id==o.SHIELD_02?this.sprites[0].node.opacity=255:s.id==o.SHIELD_03?this.sprites[1].node.opacity=255:s.id==o.SHIELD_04?this.sprites[2].node.opacity=255:s.id==o.SHIELD_05?this.sprites[3].node.opacity=255:s.id==o.SHIELD_06?i=!0:s.id==o.SHIELD_07?this.shieldFrontSprite.node.color=cc.color(0,0,0):s.id==o.SHIELD_08?this.shieldFrontSprite.node.color=cc.color(0,0,0):s.id==o.SHIELD_09?this.sprites[4].node.opacity=255:s.id==o.SHIELD_10?this.shieldFrontSprite.node.color=cc.color(0,0,0):s.id==o.SHIELD_11?this.shieldFrontSprite.node.color=cc.color(0,0,0):s.id==o.SHIELD_12?this.sprites[5].node.opacity=255:s.id==o.SHIELD_13?this.sprites[6].node.opacity=255:s.id==o.SHIELD_14&&(this.sprites[7].node.opacity=255))}this.changeRes(i?"shield06":"shield01"),this.flyWheel.changeShieldPerformance(this.talentList)},e.prototype.changeRes=function(t){!t||t.length<1||(this.shieldBackSprite.spriteFrame=r.default.spriteFrames[t],this.shieldFrontSprite.spriteFrame=r.default.spriteFrames[t])},e.prototype.useSKill=function(){this.useShield()},e.prototype.useShield=function(){var t=this;if(this.talentSkill&&!this.talentSkill.IsExcuting){var e=7,i=1;this.hashTalent(o.SHIELD_13)&&(e=5),this.talentSkill.next(function(){var a=n.default.SHIELD_NORMAL,r=.1;t.talentSkill.IsExcuting=!0;var c=t.shieldFrontSprite.node.y;t.shieldBackSprite.node.scaleX=1,t.shieldFrontSprite.node.scaleX=0,t.shieldBackSprite.node.opacity=255,t.shieldFrontSprite.node.opacity=255,t.shieldFrontSprite.node.x=-8,t.hashTalent(o.SHIELD_14)&&(a=n.default.SHIELD_LONG,i=2),t.hashTalent(o.SHIELD_06)&&(i=0,r=0);var l=cc.sequence(cc.scaleTo(.1,0,1),cc.moveTo(.1,cc.v2(-16,c)),cc.delayTime(i),cc.moveTo(r,cc.v2(-8,c)),cc.scaleTo(r,1,1)),h=cc.sequence(cc.scaleTo(.1,1,1),cc.moveTo(.1,cc.v2(8,c)),cc.delayTime(i),cc.moveTo(r,cc.v2(-8,c)),cc.scaleTo(r,0,1));t.shieldBackSprite.node.runAction(l),t.shieldFrontSprite.node.runAction(h),t.player.addStatus(a,new f.default),t.scheduleOnce(function(){t.hashTalent(o.SHIELD_06)?t.throwShield():cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:d.default.MELEE}})},.2),t.scheduleOnce(function(){t.talentSkill.IsExcuting=!1},i+.2),t.scheduleOnce(function(){t.shieldBackSprite.node.opacity=255},1),cc.director.emit(s.EventConstant.HUD_CONTROLLER_COOLDOWN,{detail:{cooldown:e,talentType:2}})},e,!0)}},e.prototype.throwShield=function(){this.shieldBackSprite.node.opacity=0,this.flyWheel&&(cc.director.emit(s.EventConstant.PLAY_AUDIO,{detail:{name:d.default.SHOOT}}),this.flyWheel.show())},e.prototype.hashTalent=function(t){return this.hasTalentMap[t]&&1==this.hasTalentMap[t]},e.prototype.canAddStatus=function(t){return!this.hashTalent(o.SHIELD_04)||!(t==n.default.FROZEN||t==n.default.BURNING||t==n.default.DIZZ||t==n.default.TOXICOSIS||t==n.default.CURSING||t==n.default.BLEEDING)},e.prototype.takeDamage=function(t,e){e&&this.IsExcuting&&(this.hashTalent(o.SHIELD_05)?e.takeDamage(new c.default(5)):this.hashTalent(o.SHIELD_02)&&e.takeDamage(new c.default(1)))},a([y(l.default)],e.prototype,"flyWheel",void 0),e=o=a([g],e)}(u.default);o.default=v,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Item/FlyWheel":"FlyWheel","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Utils/AudioPlayer":"AudioPlayer","../Utils/Skill":"Skill","./Talent":"Talent"}],TalentTree:[function(t,e,o){"use strict";cc._RF.push(e,"ac005Erbq9OdKKtABUwKphw","TalentTree");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./TalentIcon"),s=t("../Talent/Talent"),r=t("../Data/TalentData"),c=t("../Logic"),l=t("../EventConstant"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labelDesc=null,e.labelTitle=null,e.treeType=0,e.talentShield=[],e.talentDash=[],e.talentMagic=[],e.hasPicked=!1,e}var o;return i(e,t),o=e,e.prototype.onLoad=function(){var t=this;this.labelDesc&&(this.labelDesc.string=o.TEXT_PICKSKILL),this.talentShield=new Array,this.talentDash=new Array,this.talentMagic=new Array,this.initTalentSprite("talentdash",this.talentDash),this.initTalentSprite("talentshield",this.talentShield),this.initTalentSprite("talentmagic",this.talentMagic),this.treeType==o.TREE_SIMPLE?(this.initTalentNode(s.default.SHIELD_01,this.talentShield,0,[],[]),this.initTalentNode(s.default.DASH_01,this.talentDash,0,[],[]),this.initTalentNode(s.default.MAGIC_01,this.talentMagic,0,[],[])):this.treeType==o.TREE_SHIELD?(this.initShieldNode(s.default.SHIELD_01,0,[],[1,5,11]),this.initShieldNode(s.default.SHIELD_02,1,[0],[2,3]),this.initShieldNode(s.default.SHIELD_03,2,[1],[4]),this.initShieldNode(s.default.SHIELD_04,3,[1],[4]),this.initShieldNode(s.default.SHIELD_05,4,[2,3],[]),this.initShieldNode(s.default.SHIELD_06,5,[0],[6,7,8,9]),this.initShieldNode(s.default.SHIELD_07,6,[5],[10]),this.initShieldNode(s.default.SHIELD_08,7,[5],[10]),this.initShieldNode(s.default.SHIELD_09,8,[5],[10]),this.initShieldNode(s.default.SHIELD_10,9,[5],[10]),this.initShieldNode(s.default.SHIELD_11,10,[6,7,8,9],[]),this.initShieldNode(s.default.SHIELD_12,11,[0],[12]),this.initShieldNode(s.default.SHIELD_13,12,[11],[13]),this.initShieldNode(s.default.SHIELD_14,13,[12],[])):this.treeType==o.TREE_DASH?(this.initDashNode(s.default.DASH_01,0,[],[1,7,12]),this.initDashNode(s.default.DASH_02,1,[0],[2,3,4,5]),this.initDashNode(s.default.DASH_03,2,[1],[6]),this.initDashNode(s.default.DASH_04,3,[1],[6]),this.initDashNode(s.default.DASH_05,4,[1],[6]),this.initDashNode(s.default.DASH_06,5,[1],[6]),this.initDashNode(s.default.DASH_07,6,[2,3,4,5],[]),this.initDashNode(s.default.DASH_08,7,[0],[8,9]),this.initDashNode(s.default.DASH_09,8,[7],[10]),this.initDashNode(s.default.DASH_10,9,[7],[10]),this.initDashNode(s.default.DASH_11,10,[8,9],[]),this.initDashNode(s.default.DASH_12,11,[0],[12]),this.initDashNode(s.default.DASH_13,12,[11],[13]),this.initDashNode(s.default.DASH_14,13,[12],[])):this.treeType==o.TREE_MAGIC&&(this.initMagicNode(s.default.MAGIC_01,0,[],[2,4,7,10,13]),this.initMagicNode(s.default.MAGIC_02,1,[9,12,15],[]),this.initMagicNode(s.default.MAGIC_03,2,[0],[3]),this.initMagicNode(s.default.MAGIC_04,3,[2],[]),this.initMagicNode(s.default.MAGIC_05,4,[0],[6]),this.initMagicNode(s.default.MAGIC_06,5,[6],[]),this.initMagicNode(s.default.MAGIC_07,6,[4],[5]),this.initMagicNode(s.default.MAGIC_08,7,[0],[8]),this.initMagicNode(s.default.MAGIC_09,8,[7],[9]),this.initMagicNode(s.default.MAGIC_10,9,[8],[1]),this.initMagicNode(s.default.MAGIC_11,10,[0],[11]),this.initMagicNode(s.default.MAGIC_12,11,[10],[12]),this.initMagicNode(s.default.MAGIC_13,12,[11],[1]),this.initMagicNode(s.default.MAGIC_14,13,[0],[14]),this.initMagicNode(s.default.MAGIC_15,14,[13],[15]),this.initMagicNode(s.default.MAGIC_16,15,[14],[1])),cc.director.on(l.EventConstant.TALENT_TREE_UPDATE,function(e){t.node&&t.node.active&&(t.hasPicked=!0)})},Object.defineProperty(e.prototype,"SelectIcon",{get:function(){return this.selectIcon},enumerable:!0,configurable:!0}),e.prototype.initTalentSprite=function(t,e){var i=this,a=14;this.treeType==o.TREE_MAGIC&&(a=16);for(var s=function(a){if(r.treeType==o.TREE_SIMPLE&&a>0)return"break";var s=a<9?"0"+(a+1):""+(a+1),c=r.node.getChildByName("layout").getChildByName("talentempty").getChildByName(""+t+s);if(!c)return cc.log("worng skill name"),"break";c.addComponent(n.default),c.color=cc.color(51,51,51),c.on(cc.Node.EventType.TOUCH_START,function(t){i.labelDesc&&(i.labelDesc.string=c.getComponent(n.default).data.desc),i.labelTitle&&(i.labelTitle.string=c.getComponent(n.default).data.nameCn)},r),c.on(cc.Node.EventType.TOUCH_CANCEL,function(t){},r),c.on(cc.Node.EventType.TOUCH_END,function(t){c.getComponent(n.default).isOpen||(i.selectIcon&&(i.selectIcon.node.color=cc.color(51,51,51)),i.selectIcon=c.getComponent(n.default),c.color=cc.color(255,255,255),cc.director.emit(l.EventConstant.TALENT_TREE_SELECT))},r),e.push(c)},r=this,c=0;c<a;c++){if("break"===s(c))break}},e.prototype.drawLines=function(t,e){this.graphics||(this.graphics=this.getComponent(cc.Graphics)),this.graphics&&(this.graphics.lineWidth=2,this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(e.x,e.y),this.graphics.close(),this.graphics.stroke())},e.prototype.talentClick=function(){this.selectIcon&&this.selectIcon.onClick()},e.prototype.initShieldNode=function(t,e,i,a){this.treeType==o.TREE_SHIELD&&this.initTalentNode(t,this.talentShield,e,i,a)},e.prototype.initDashNode=function(t,e,i,a){this.treeType==o.TREE_DASH&&this.initTalentNode(t,this.talentDash,e,i,a)},e.prototype.initMagicNode=function(t,e,i,a){this.treeType==o.TREE_MAGIC&&this.initTalentNode(t,this.talentMagic,e,i,a)},e.prototype.initTalentNode=function(t,e,o,i,a){if(!(o<0||o>e.length-1)){var l=e[o].getComponent(n.default);l.parents=new Array,l.data=new r.default,l.data.id=t,t<s.default.SHIELD?(l.data.nameCn=s.default.DASH_DESC[t%s.default.DASH-1].split(";")[0],l.data.desc=s.default.DASH_DESC[t%s.default.DASH-1].split(";")[1]):t<s.default.MAGIC?(l.data.nameCn=s.default.SHIELD_DESC[t%s.default.SHIELD-1].split(";")[0],l.data.desc=s.default.SHIELD_DESC[t%s.default.SHIELD-1].split(";")[1]):t<s.default.ARCHER&&(l.data.nameCn=s.default.MAGIC_DESC[t%s.default.MAGIC-1].split(";")[0],l.data.desc=s.default.MAGIC_DESC[t%s.default.MAGIC-1].split(";")[1]),l.isOpen=c.default.hashTalent(t),l.isOpen&&(l.node.color=cc.color(255,255,255));for(var h=0,u=i;h<u.length;h++){var p=u[h];l.parents.push(e[p])}l.children=new Array;for(var d=0,f=a;d<f.length;d++){p=f[d];l.children.push(e[p]);var m=l.node.convertToWorldSpaceAR(cc.Vec2.ZERO);m=this.node.convertToNodeSpaceAR(m);var g=e[p].convertToWorldSpaceAR(cc.Vec2.ZERO);g=this.node.convertToNodeSpaceAR(g),this.drawLines(m,g)}}},e.prototype.start=function(){},e.TREE_ALL=0,e.TREE_SHIELD=1,e.TREE_DASH=2,e.TREE_SIMPLE=3,e.TREE_MAGIC=4,e.TREE_ARCHER=5,e.TEXT_PICKSKILL="\u9009\u62e9\u5408\u9002\u7684\u6280\u80fd\uff08\u6309\u4f4f\u67e5\u770b\u6280\u80fd\uff09",a([p(cc.Label)],e.prototype,"labelDesc",void 0),a([p(cc.Label)],e.prototype,"labelTitle",void 0),a([p()],e.prototype,"treeType",void 0),e=o=a([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Data/TalentData":"TalentData","../EventConstant":"EventConstant","../Logic":"Logic","../Talent/Talent":"Talent","./TalentIcon":"TalentIcon"}],Talent:[function(t,e,o){"use strict";cc._RF.push(e,"11194HbWx5MlLwfYetzGt8W","Talent");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Utils/Skill"),s=t("../Player"),r=t("../Data/TalentData"),c=t("../Logic"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.talentSkill=new n.default,e.hasTalentMap={},e}var o;return i(e,t),o=e,Object.defineProperty(e.prototype,"IsExcuting",{get:function(){return this.talentSkill.IsExcuting},set:function(t){this.talentSkill.IsExcuting=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.init=function(){this.player=this.getComponent(s.default)},e.prototype.loadList=function(t){this.talentList=new Array,this.hasTalentMap={};for(var e=0,o=t;e<o.length;e++){var i=o[e],a=new r.default;a.valueCopy(i),this.talentList.push(a),this.hasTalentMap[a.id]=!0}this.changePerformance()},e.prototype.addTalent=function(t){var e=new r.default;e.id=t;for(var o=!1,i=0,a=this.talentList;i<a.length;i++){t==a[i].id&&(o=!0)}o||(this.talentList.push(e),this.hasTalentMap[e.id]=!0,this.changePerformance(),c.default.addTalent(e.id))},e.prototype.getSpriteChildSprite=function(t){for(var e=this.node,o=0,i=t;o<i.length;o++){var a=i[o];e=e.getChildByName(a)}return e.getComponent(cc.Sprite)},e.prototype.hashTalent=function(t){return this.hasTalentMap[t]&&1==this.hasTalentMap[t]},e.DASH=1e6,e.SHIELD=2e6,e.MAGIC=3e6,e.ARCHER=4e6,e.DASH_01=o.DASH+1,e.DASH_02=o.DASH+2,e.DASH_03=o.DASH+3,e.DASH_04=o.DASH+4,e.DASH_05=o.DASH+5,e.DASH_06=o.DASH+6,e.DASH_07=o.DASH+7,e.DASH_08=o.DASH+8,e.DASH_09=o.DASH+9,e.DASH_10=o.DASH+10,e.DASH_11=o.DASH+11,e.DASH_12=o.DASH+12,e.DASH_13=o.DASH+13,e.DASH_14=o.DASH+14,e.SHIELD_01=o.SHIELD+1,e.SHIELD_02=o.SHIELD+2,e.SHIELD_03=o.SHIELD+3,e.SHIELD_04=o.SHIELD+4,e.SHIELD_05=o.SHIELD+5,e.SHIELD_06=o.SHIELD+6,e.SHIELD_07=o.SHIELD+7,e.SHIELD_08=o.SHIELD+8,e.SHIELD_09=o.SHIELD+9,e.SHIELD_10=o.SHIELD+10,e.SHIELD_11=o.SHIELD+11,e.SHIELD_12=o.SHIELD+12,e.SHIELD_13=o.SHIELD+13,e.SHIELD_14=o.SHIELD+14,e.MAGIC_01=o.MAGIC+1,e.MAGIC_02=o.MAGIC+2,e.MAGIC_03=o.MAGIC+3,e.MAGIC_04=o.MAGIC+4,e.MAGIC_05=o.MAGIC+5,e.MAGIC_06=o.MAGIC+6,e.MAGIC_07=o.MAGIC+7,e.MAGIC_08=o.MAGIC+8,e.MAGIC_09=o.MAGIC+9,e.MAGIC_10=o.MAGIC+10,e.MAGIC_11=o.MAGIC+11,e.MAGIC_12=o.MAGIC+12,e.MAGIC_13=o.MAGIC+13,e.MAGIC_14=o.MAGIC+14,e.MAGIC_15=o.MAGIC+15,e.MAGIC_16=o.MAGIC+16,e.DASH_DESC=["\u51b2\u523a;\u5411\u524d\u51b2\u523a\u4e00\u6bb5\u8ddd\u79bb","\u7a81\u523a\u51b2\u649e;\u51b2\u523a\u5e76\u9020\u62101\u70b9\u4f24\u5bb3","\u9c7c\u80a0\u523a\u50da;\u51b2\u523a\u9020\u6210\u6d41\u8840\u6548\u679c","\u87b3\u81c2\u5f53\u8f66;\u51b2\u523a\u9020\u6210\u51fb\u9000\u6548\u679c","\u9189\u821e\u77db\u6208;\u51b2\u523a\u9020\u6210\u51cf\u901f\u6548\u679c","\u91ce\u86ee\u51b2\u649e;\u51b2\u523a\u9020\u6210\u7729\u6655\u6548\u679c","\u7a81\u523a\u9e70\u51fb;\u51b2\u523a\u5e76\u9020\u62105\u70b9\u4f24\u5bb3","\u79fb\u5f62\u6362\u5f71;\u672c\u4f53\u4e0d\u51b2\u523a\u800c\u662f\u5e7b\u5f71\u66ff\u4ee3\u968f\u540e\u77ac\u79fb\u5230\u5e7b\u5f71\u7684\u4f4d\u7f6e","\u706b\u7130\u821e\u8005;\u5212\u8fc7\u8def\u5f84\u7559\u4e0b\u4e00\u90533\u79d2\u7684\u706b\u7130","\u51b0\u971c\u4e4b\u57ce;\u5212\u8fc7\u8def\u5f84\u7559\u4e0b\u4e00\u90533\u79d2\u7684\u51b0\u5899","\u5143\u7d20\u6e4d\u6d41;\u6269\u5927\u8def\u5f84\u9762\u79ef","\u7075\u59ff\u9b3c\u6b65;\u51b2\u523a\u671f\u95f4\u65e0\u654c","\u575a\u97e7\u610f\u5fd7;\u7f29\u77ed\u51b2\u523a\u51b7\u5374","\u98de\u71d5\u5982\u68ad;\u51b2\u523a\u901f\u5ea6\u63d0\u9ad8\u8ddd\u79bb\u53d8\u8fdc"],e.SHIELD_DESC=["\u4e3e\u76fe;\u4e3e\u8d77\u76fe\u724c\u9632\u5fa1","\u8fc5\u6377\u53cd\u51fb;\u76fe\u724c\u53cd\u51fb1\u70b9\u4f24\u5bb3","\u955c\u9762\u504f\u8f6c;\u53cd\u5f39\u5b50\u5f39","\u5143\u7d20\u6676\u76fe;\u53d7\u5230\u7684\u5143\u7d20\u6548\u679c\u65e0\u6548","\u5f3a\u529b\u76fe\u53cd;\u76fe\u724c\u53cd\u51fb5\u70b9\u4f24\u5bb3","\u4e7e\u5764\u4e00\u63b7;\u76fe\u724c\u53ef\u4ee5\u98de\u63b7","\u4e5d\u8f6c\u56de\u65cb;\u76fe\u724c\u98de\u63b7\u9020\u6210\u51cf\u901f\u6548\u679c","\u5e73\u5730\u60ca\u96f7;\u76fe\u724c\u98de\u63b7\u9020\u6210\u7729\u6655\u6548\u679c","\u56db\u4e24\u5343\u65a4;\u76fe\u724c\u98de\u63b7\u9020\u6210\u51fb\u9000\u6548\u679c","\u89c1\u8840\u5c01\u5589;\u76fe\u724c\u98de\u63b7\u9020\u6210\u6d41\u8840\u6548\u679c","\u9634\u9633\u9041\u5f62;\u76fe\u724c\u98de\u63b7\u8ddd\u79bb\u53d8\u8fdc","\u654f\u6377\u8eab\u6cd5;\u79fb\u9664\u51cf\u901f\u635f\u8017","\u575a\u97e7\u4e0d\u5c48;\u7f29\u77ed\u4e3e\u76fe\u51b7\u5374","\u9f9f\u7532\u94dc\u5899;\u4e3e\u76fe\u65f6\u95f4\u53d8\u957f"],e.MAGIC_DESC=["\u5143\u7d20\u98de\u5f39;\u53d1\u5c04\u4e00\u679a\u666e\u901a\u7684\u5143\u7d20\u98de\u5f39","\u591a\u91cd\u65bd\u6cd5;\u706b\u7403\u53d8\u591a\uff0c\u6247\u5f62\u51b0\u9525\uff0c\u53cc\u91cd\u96f7\u66b4","\u5feb\u901f\u541f\u5531;\u65bd\u6cd5\u541f\u5531\u65f6\u95f4\u53d8\u77ed","\u51b7\u9759\u51a5\u60f3;\u7f29\u77ed\u65bd\u6cd5\u95f4\u9694","\u7075\u6d3b\u79fb\u52a8;\u79fb\u52a8\u901f\u5ea6\u63d0\u9ad8\uff0c\u65bd\u6cd5\u53ef\u4ee5\u79fb\u52a8","\u6cd5\u529b\u589e\u5f3a;\u63d0\u9ad8\u6cd5\u672f\u4f24\u5bb3","\u6b66\u5668\u9644\u9b54;\u7ed9\u6b66\u5668\u9644\u52a0\u5143\u7d20\u4f24\u5bb3","\u706b\u7403\u672f;\u65bd\u653e\u4e00\u4e2a\u706b\u7403","\u708e\u7206\u672f;\u65bd\u653e\u4e00\u4e2a\u5927\u706b\u7403","\u706b\u7130\u7cbe\u7075;\u4ea7\u751f\u706b\u7130\u7cbe\u7075\u6f02\u6d6e\u5728\u8eab\u8fb9\u5bf9\u654c\u4eba\u53d1\u8d77\u8fdb\u653b","\u51b0\u6676\u9525;\u53d1\u5c04\u4e00\u4e2a\u80fd\u51cf\u901f\u7684\u51b0\u9525","\u5927\u51b0\u6676\u67f1;\u53d1\u5c04\u4e00\u4e2a\u80fd\u51bb\u7ed3\u7684\u51b0\u67f1","\u51b0\u6676\u62a4\u76fe;\u751f\u6210\u4e00\u4e2a\u51b0\u7532\u62b5\u6d88\u4e00\u6b21\u4f24\u5bb3\u5e76\u51cf\u901f\u5468\u56f4","\u96f7\u7535\u7403;\u5728\u524d\u65b9\u751f\u6210\u4e00\u4e2a\u5ef6\u8fdf\u7206\u70b8\u7684\u7535\u7403\u5e76\u7729\u6655\u5468\u56f4\u654c\u4eba","\u9ad8\u538b\u96f7\u66b4;\u96f7\u7535\u7403\u8303\u56f4\u53d8\u5927\uff0c\u5ef6\u8fdf\u53d8\u4f4e","\u96f7\u66b4\u7ebf\u5708;\u5b9a\u65f6\u7206\u53d1\u51fa\u96f7\u73af\u7729\u6655\u5468\u56f4\u654c\u4eba"],e.SHIELD_CAN_OPEN_MAP=["1;;","2;1;","3;2;4","4;2;3","5;3,4;","6;1;","7;6;8,9,10","8;6;7,9,10","9;6;7,8,10","10;6;7,8,9","11;7,8,9,10;","12;1;","13;12;","14;13;"],e.DASH_CAN_OPEN_MAP=["1;;","2;1;","3;2;4,5,6","4;2;3,5,6","5;2;3,4,6;","6;2;3,4,5","7;3,4,5,6;","8;1;","9;8;10","10;8;9","11;9,10;","12;1;","13;12;","14;13;"],e.MAGIC_CAN_OPEN_MAP=["1;;","2;13,10,16;","3;1;","4;3;","5;1;","6;7;","7;5;","8;1;11,14","9;8;","10;9;","11;1;8,14;","12;11;","13;12;","14;1;8,11","15;14;","16;15;"],e=o=a([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Data/TalentData":"TalentData","../Logic":"Logic","../Player":"Player","../Utils/Skill":"Skill"}],TarotCard:[function(t,e,o){"use strict";cc._RF.push(e,"e4b2bYbHidG7bCWzE85sIMb","TarotCard");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Data/TarotData"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.indexLabel=null,e.anim=null,e.frontNode=null,e.backNode=null,e.data=new n.default,e}return i(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),this.frontNode=this.node.getChildByName("sprite").getChildByName("front"),this.backNode=this.node.getChildByName("sprite").getChildByName("back"),this.indexLabel=this.node.getChildByName("sprite").getChildByName("front").getChildByName("index").getComponent(cc.Label),this.frontNode.scaleX=0,this.backNode.scaleY=1},e.prototype.initFromGround=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotIdle")},e.prototype.showCard=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotFilpToFront")},e.prototype.coverCard=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play("TarotFilpToBack")},e.prototype.start=function(){},e=a([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{"../Data/TarotData":"TarotData"}],TarotData:[function(t,e,o){"use strict";cc._RF.push(e,"2921ee/FxFNuIPjZdXjGRw+","TarotData"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.nameCn="",this.nameEn="",this.desc="",this.resName="",this.index=0,this.word1="",this.word2="",this.word3="",this.word4="",this.word5="",this.word6=""}return t.prototype.valueCopy=function(t){this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.index=t.index?t.index:this.index,this.resName=t.resName?t.resName:this.resName,this.desc=t.desc},t.prototype.clone=function(){var e=new t;return e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.index=this.index,e.resName=this.resName,e.desc=this.desc,e},t}();o.default=i,cc._RF.pop()},{}],TarotManager:[function(t,e,o){"use strict";cc._RF.push(e,"b67c009qhlE0oYcKSjCxjFX","TarotManager");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Item/TarotCard"),s=t("../Dungeon"),r=cc._decorator,c=(r.ccclass,r.property),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.card=null,e}return i(e,t),e.prototype.getCard=function(t,e){var o=cc.instantiate(this.card);o.parent=this.node,o.position=s.default.getPosInMap(e),o.zIndex=3e3+10*(s.default.HEIGHT_SIZE-e.y)+3;var i=o.getComponent(n.default);return i.data.resName=t,i},e.THE_FOOL="tarot00",e.THE_MAGICIAN="tarot01",e.THE_HIGH_PRIESTESS="tarot02",e.THE_EMPRESS="tarot03",e.THE_EMPEROR="tarot04",e.THE_HIEROPHANT="tarot05",e.THE_LOVERS="tarot06",e.THE_CHARIOT="tarot07",e.STRENGTH="tarot08",e.THE_HERMIT="tarot09",e.THE_WHEEL_OF_FORTUNE="tarot10",e.JUSTICE="tarot11",e.THE_HANGEDMAN="tarot12",e.DEATH="tarot13",e.TEMPERANCE="tarot14",e.THE_DEVIL="tarot15",e.THE_TOWER="tarot16",e.THE_STAR="tarot17",e.THE_MOON="tarot18",e.THE_SUN="tarot19",e.JUDGEMENT="tarot20",e.THE_WORLD="tarot21",a([c(cc.Prefab)],e.prototype,"card",void 0),e}(cc.Component);o.default=l,cc._RF.pop()},{"../Dungeon":"Dungeon","../Item/TarotCard":"TarotCard"}],TarotTable:[function(t,e,o){"use strict";cc._RF.push(e,"f0e8dVSyEpP0bI6DNiqwoQc","TarotTable");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../EventConstant"),r=t("../UI/Tips"),c=t("./Building"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.tips=this.node.getChildByName("Tips").getComponent(r.default),this.tips.tipsType=r.default.TAROT_TABLE,cc.director.on(s.EventConstant.PLAYER_TAPTIPS,function(e){e.detail.tipsType==r.default.TAROT_TABLE&&t.showCards()})},e.prototype.start=function(){},e.prototype.showCards=function(){this.anim||(this.anim=this.getComponent(cc.Animation)),this.anim.play()},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.update=function(t){},e=a([h],e)}(c.default));o.default=u,cc._RF.pop()},{"../Dungeon":"Dungeon","../EventConstant":"EventConstant","../UI/Tips":"Tips","./Building":"Building"}],TileWaterPool:[function(t,e,o){"use strict";cc._RF.push(e,"b8456P22ihLep1eraHZrtsU","TileWaterPool"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Logic"),a=t("./Building"),n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resName="tilewater_1_1",e.islight=!1,e.sprite=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.sprite=this.getComponent(cc.Sprite)},e.prototype.changeRes=function(t){var e=this.getComponent(cc.Sprite);this.sprite.spriteFrame=i.default.spriteFrames[t],this.node.width=e.spriteFrame.getRect().width,this.node.height=e.spriteFrame.getRect().height},e.prototype.changeWaterLight=function(){this.sprite||(this.sprite=this.getComponentInChildren(cc.Sprite)),this.sprite=this.getComponentInChildren(cc.Sprite),this.islight=!this.islight,this.sprite.spriteFrame=i.default.spriteFrames[this.islight?this.resName:"light"+this.resName]},e.prototype.setTiles=function(t,e,o){var a="tilewater";this.resName=a+"_1_1";var n=this.isWater(o[t][e+1]),s=this.isWater(o[t][e-1]),r=this.isWater(o[t-1][e]),c=this.isWater(o[t+1][e]);!n&&s&&!r&&c?this.resName=a+"_0_0":!n&&s&&r&&c?this.resName=a+"_0_1":!n&&s&&r&&!c?this.resName=a+"_0_2":n&&s&&!r&&c?this.resName=a+"_1_0":n&&s&&r&&c?this.resName=a+"_1_1":n&&s&&r&&!c?this.resName=a+"_1_2":n&&!s&&!r&&c?this.resName=a+"_2_0":n&&!s&&r&&c?this.resName=a+"_2_1":n&&!s&&r&&!c&&(this.resName=a+"_2_2"),this.sprite||(this.sprite=this.getComponentInChildren(cc.Sprite)),this.sprite.spriteFrame=i.default.spriteFrames[this.resName]},e.prototype.isWater=function(t){return"~"==t},e=__decorate([s],e)}(a.default));o.default=r,cc._RF.pop()},{"../Logic":"Logic","./Building":"Building"}],Tile:[function(t,e,o){"use strict";cc._RF.push(e,"f8047r9sJ5IqqTgIdjYi6dc","Tile");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.isBroken=!1,e.isAutoShow=!0,e.timeDelay=0,e.isAnimPlaying=!1,e.isBreakingNow=!1,e.tileType="**",e}return i(e,t),e.prototype.onLoad=function(){this.isAutoShow=!0,this.anim=this.getComponent(cc.Animation),this.floor=this.node.getChildByName("sprite").getChildByName("floor").getComponent(cc.Sprite)},e.prototype.start=function(){switch(n.default.chapterName){case n.default.CHAPTER00:this.changeRes(this.getLabRes());break;case n.default.CHAPTER01:this.changeRes(this.getDeckRes());break;case n.default.CHAPTER02:this.changeRes(this.getDirtRes());break;case n.default.CHAPTER03:this.changeRes("tile003");break;case n.default.CHAPTER04:this.changeRes("tile004")}},e.prototype.getLabRes=function(){var t="tile_lab001";switch(this.tileType){case"**":t="tile_lab001";break;case"*0":t="tile_lab002";break;case"*1":case"*2":t="tile_lab003"}return t},e.prototype.getDirtRes=function(){var t="tile_dirt001";switch(this.tileType){case"**":t="tile_dirt001";break;case"*0":t="tile_dirt002";break;case"*1":t="tile_dirt003";break;case"*2":t="tile_dirt004"}return t},e.prototype.getDeckRes=function(){var t="tile_deck001";switch(this.tileType){case"**":t="tile_deck001";break;case"*0":t="tile_deck002";break;case"*1":t="tile_deck003";break;case"*2":t="tile_deck004"}return t},e.prototype.TileBreak=function(){},e.prototype.TileBreakFinish=function(){var t=this;this.isBroken=!0,this.isAnimPlaying=!1,this.isAutoShow&&this.scheduleOnce(function(){t.showTile()},2)},e.prototype.TileShow=function(){this.isAnimPlaying=!1},e.prototype.breakTile=function(){this.isAnimPlaying||(this.anim.play("TileBreak"),this.isBreakingNow=!0,this.isAnimPlaying=!0)},e.prototype.showTile=function(){!this.isAnimPlaying&&this.anim&&(this.anim.play("TileShow"),this.isBroken=!1,this.isBreakingNow=!1,this.isAnimPlaying=!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.label&&(this.label.string=""+this.node.zIndex)},e.prototype.changeRes=function(t){this.floor.spriteFrame=n.default.spriteFrames[t]},a([c(cc.Label)],e.prototype,"label",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Logic":"Logic"}],Tips:[function(t,e,o){"use strict";cc._RF.push(e,"36c4bnGdrlOy4Y1XkbF9xfT","Tips");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUse=!1,e.tipsType="",e}return i(e,t),e.prototype.start=function(){},e.prototype.next=function(){var t=this;this.isUse||(this.isUse=!0,cc.director.emit(n.EventConstant.PLAYER_TAPTIPS,{detail:{tipsType:this.tipsType}}),setTimeout(function(){t.isUse=!1},.1))},e.prototype.onDestroy=function(){this.isUse=!1},e.TAROT_TABLE="Tips.TAROT_TABLE",e=a([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{"../EventConstant":"EventConstant"}],Trap:[function(t,e,o){"use strict";cc._RF.push(e,"67e3dv84GNOwbSynhs23bOv","Trap");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../EventConstant"),r=t("../Player"),c=t("../Data/DamageData"),l=t("./Building"),h=t("../Data/FromData"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSpriteFrame=null,e.closeSpriteFrame=null,e.halfSpriteFrame=null,e.isOpen=!1,e.pos=cc.v2(0,0),e.timeDelay=0,e.isPlayerIn=!1,e}return i(e,t),e.prototype.onLoad=function(){this.sprite=this.node.getChildByName("sprite")},e.prototype.start=function(){},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t),this.node.zIndex=3e3+10*(n.default.HEIGHT_SIZE-t.y)+1},e.prototype.openTrap=function(){var t=this;this.isOpen||(this.isOpen=!0,this.sprite.getComponent(cc.Sprite).spriteFrame=this.openSpriteFrame,this.scheduleOnce(function(){t.isOpen=!1,t.halfSpriteFrame&&(t.sprite.getComponent(cc.Sprite).spriteFrame=t.halfSpriteFrame,t.scheduleOnce(function(){t.closeSpriteFrame&&(t.sprite.getComponent(cc.Sprite).spriteFrame=t.closeSpriteFrame)},.2))},.5))},e.prototype.onCollisionStay=function(t,e){3==t.tag&&this.isOpen&&this.isPlayerIn&&(this.isOpen=!1,cc.director.emit(s.EventConstant.PLAYER_TAKEDAMAGE,{detail:{damage:new c.default(1),from:h.default.getClone(this.actorName(),"trap001")}}))},e.prototype.onBeginContact=function(t,e,o){o.body.node.getComponent(r.default)&&(this.isPlayerIn=!0)},e.prototype.onEndContact=function(t,e,o){o.body.node.getComponent(r.default)&&(this.isPlayerIn=!1)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>3&&(this.openTrap(),this.timeDelay=0)},e.prototype.actorName=function(){return"\u5c16\u523a"},a([d(cc.SpriteFrame)],e.prototype,"openSpriteFrame",void 0),a([d(cc.SpriteFrame)],e.prototype,"closeSpriteFrame",void 0),a([d(cc.SpriteFrame)],e.prototype,"halfSpriteFrame",void 0),e=a([p],e)}(l.default);o.default=f,cc._RF.pop()},{"../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Player":"Player","./Building":"Building"}],WalkSmoke:[function(t,e,o){"use strict";cc._RF.push(e,"d3d56K96jBFs6t/GiwCmf8x","WalkSmoke");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,r=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){var t=this;this.scheduleOnce(function(){cc.director.emit("destorysmoke",{detail:{coinNode:t.node}})},.3)},e=a([s],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],Wall:[function(t,e,o){"use strict";cc._RF.push(e,"e7c06zRjp9J+piF+ZsFdjSH","Wall");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Dungeon"),s=t("../Logic"),r=t("./Building"),c=cc._decorator,l=c.ccclass,h=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.half=!1,e.mapStr="##",e}return i(e,t),e.prototype.onLoad=function(){this.wallsprite=this.node.getChildByName("sprite").getChildByName("wallsprite").getComponent(cc.Sprite)},e.prototype.changeRes=function(t){this.wallsprite.spriteFrame=s.default.spriteFrames[t]},e.prototype.setPos=function(t){this.pos=t,this.node.position=n.default.getPosInMap(t)},e.prototype.start=function(){switch(this.node.opacity=255,s.default.chapterName){case s.default.CHAPTER00:this.changeRes(this.getRes00());break;case s.default.CHAPTER01:this.changeRes(this.getRes01());break;case s.default.CHAPTER02:this.changeRes(this.getRes02());break;case s.default.CHAPTER03:this.changeRes(this.getRes03());break;case s.default.CHAPTER04:this.changeRes(this.getRes04())}},e.prototype.getRes00=function(){var t="wall000";switch(this.mapStr){case"##":case"#0":t="wall000";break;case"#1":t="wall001"}return t},e.prototype.getRes01=function(){var t="wall005";switch(this.mapStr){case"##":case"#0":t="wall005";break;case"#1":t="wall003"}return t},e.prototype.getRes02=function(){var t="wall002";switch(this.mapStr){case"##":t="wall002";break;case"#0":t="wall009";break;case"#1":t="wall002"}return t},e.prototype.getRes03=function(){var t="wall008";switch(this.mapStr){case"##":t="wall008";break;case"#0":t="wall007";break;case"#1":t="wall006"}return t},e.prototype.getRes04=function(){var t="wall004";switch(this.mapStr){case"##":case"#0":case"#1":t="wall004"}return t},e.prototype.onCollisionEnter=function(t,e){this.node.opacity=255},e.prototype.onCollisionStay=function(t,e){3!=t.tag&&4!=t.tag||(this.node.opacity=128)},e.prototype.onCollisionExit=function(t,e){this.node.opacity=255},e=a([l],e)}(r.default));o.default=h,cc._RF.pop()},{"../Dungeon":"Dungeon","../Logic":"Logic","./Building":"Building"}],WarMachine:[function(t,e,o){"use strict";cc._RF.push(e,"e27dcjzJmBGK54bflNR6COZ","WarMachine");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Boss"),s=t("../Data/DamageData"),r=t("../Shooter"),c=t("../Dungeon"),l=t("../Logic"),h=t("../Player"),u=t("../Manager/StatusManager"),p=t("../Utils/AudioPlayer"),d=t("../EventConstant"),f=t("../Data/FromData"),m=t("../Achievement"),g=cc._decorator,y=g.ccclass,v=g.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.timeDelay=0,e.isMoving=!1,e.isMissileCoolDown=!1,e.isGatlingCoolDown=!1,e.isMainGunCoolDown=!1,e.actionCount=0,e.actionTimeDelay=0,e}return i(e,t),e.prototype.onLoad=function(){this.isDied=!1,this.isShow=!1,this.anim=this.getComponent(cc.Animation),this.shooter01=this.node.getChildByName("Shooter01").getComponent(r.default),this.shooter02=this.node.getChildByName("Shooter02").getComponent(r.default),this.shooter03=this.node.getChildByName("Shooter03").getComponent(r.default),this.shooter04=this.node.getChildByName("Shooter04").getComponent(r.default),this.shooter05=this.node.getChildByName("Shooter05").getComponent(r.default),this.rigidbody=this.getComponent(cc.RigidBody),this.statusManager=this.node.getChildByName("StatusManager").getComponent(u.default);var t=f.default.getClone(this.actorName(),"bossmachinehead");this.shooter01.from.valueCopy(t),this.shooter02.from.valueCopy(t),this.shooter03.from.valueCopy(t),this.shooter04.from.valueCopy(t),this.shooter05.from.valueCopy(t)},e.prototype.start=function(){this.initGuns()},e.prototype.takeDamage=function(t){return!(this.isDied||!this.isShow)&&(this.data.currentHealth-=this.data.getDamage(t).getTotalDamage(),this.data.currentHealth>this.data.Common.maxHealth&&(this.data.currentHealth=this.data.Common.maxHealth),this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:p.default.MONSTER_HIT}}),!0)},e.prototype.killed=function(){var t=this;this.isDied||(this.anim&&this.anim.pause(),m.default.addMonsterKillAchievement(this.data.resName),this.isDied=!0,this.scheduleOnce(function(){t.node&&(t.node.active=!1)},5),this.getLoot())},e.prototype.bossAction=function(){if(!this.isDied&&this.isShow&&this.dungeon){this.changeZIndex(),this.dungeon&&l.default.getChance(90)&&this.fireMainGun(),this.getNearPlayerDistance(this.dungeon.player.node)<200?this.fireMissile():l.default.getChance(20)&&this.fireMissile();var t=this.data.currentHealth<this.data.Common.maxHealth/2;if(this.fireGatling(t),t){this.actionCount++;var e=cc.v2(1,0);this.actionCount>10&&(cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:p.default.MELEE}}),e=cc.v2(-1,0)),this.actionCount>20&&(cc.director.emit(d.EventConstant.PLAY_AUDIO,{detail:{name:p.default.MELEE}}),this.actionCount=0),e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf(),this.move(e,500))}}else this.actionCount=0},e.prototype.initGuns=function(){this.isMainGunCoolDown=!1,this.isGatlingCoolDown=!1,this.isMissileCoolDown=!1,this.shooter01.setHv(cc.v2(0,-1)),this.shooter02.setHv(cc.v2(0,-1)),this.shooter03.setHv(cc.v2(0,-1)),this.shooter04.setHv(cc.v2(0,-1)),this.shooter05.setHv(cc.v2(0,-1));var t=this.node.position.clone().add(this.shooter01.node.position),e=this.dungeon.player.getCenterPosition().sub(t);e.equals(cc.Vec2.ZERO)||(e=e.normalizeSelf(),this.shooter01.setHv(e))},e.prototype.fireMainGun=function(){var t=this;if(!this.isMainGunCoolDown){this.isMainGunCoolDown=!0,this.shooter01.setHv(cc.v2(0,-1));var e=this.node.position.clone().add(this.shooter01.node.position),o=this.dungeon.player.getCenterPosition().sub(e);o.equals(cc.Vec2.ZERO)||(o=o.normalizeSelf(),this.shooter01.setHv(o),this.fireShooter(this.shooter01,"bullet016",0,0)),this.scheduleOnce(function(){t.isMainGunCoolDown=!1},6)}},e.prototype.fireGatling=function(t){var e=this;if(!this.isGatlingCoolDown){this.isGatlingCoolDown=!0,this.shooter02.setHv(cc.v2(0,-1)),this.shooter03.setHv(cc.v2(0,-1)),this.shooter02.data.bulletLineInterval=.5,this.shooter03.data.bulletLineInterval=.5;var o=3,i=l.default.getRandomNum(0,15);i=l.default.getHalfChance()?i:-i,t?(this.fireShooter(this.shooter02,"bullet011",0,4),this.fireShooter(this.shooter03,"bullet011",0,4),o=1.5):(this.fireShooter(this.shooter02,"bullet011",2,2),this.fireShooter(this.shooter03,"bullet011",2,2)),this.scheduleOnce(function(){e.isGatlingCoolDown=!1},o)}},e.prototype.fireMissile=function(){var t=this;this.isMissileCoolDown||(this.isMissileCoolDown=!0,this.shooter04.setHv(cc.v2(0,-1)),this.shooter05.setHv(cc.v2(0,-1)),this.fireShooter(this.shooter04,"bullet015",0,0),this.fireShooter(this.shooter05,"bullet015",0,0),this.scheduleOnce(function(){t.isMissileCoolDown=!1},8))},e.prototype.fireShooter=function(t,e,o,i,a){t.dungeon=this.dungeon,t.data.bulletType=e,t.data.bulletArcExNum=o,t.data.bulletLineExNum=i,t.fireBullet(a)},e.prototype.showBoss=function(){this.initGuns(),this.isShow=!0,this.healthBar&&(this.healthBar.refreshHealth(this.data.currentHealth,this.data.Common.maxHealth),this.healthBar.node.active=!this.isDied)},e.prototype.isActionTimeDelay=function(t){return this.actionTimeDelay+=t,this.actionTimeDelay>.2&&(this.actionTimeDelay=0,!0)},e.prototype.update=function(t){this.timeDelay+=t,this.timeDelay>1&&(this.timeDelay=0),this.isActionTimeDelay(t)&&this.bossAction(),this.data.currentHealth<1&&this.killed(),this.healthBar.node.active=!this.isDied},e.prototype.move=function(t,e){if(!this.isDied){t.equals(cc.Vec2.ZERO)||(this.pos=c.default.getIndexInMap(this.node.position));var o=t.x,i=t.y,a=(Math.abs(o),Math.abs(i),cc.v2(o,i));a=a.mul(e),this.rigidbody.linearVelocity=a,this.isMoving=0!=o||0!=i,this.changeZIndex()}},e.prototype.onCollisionEnter=function(t,e){var o=t.node.getComponent(h.default);if(o&&!this.isDied){var i=new s.default;i.physicalDamage=2,o.takeDamage(i,f.default.getClone(this.actorName(),"bossmachinehead"))}},e.prototype.actorName=function(){return"\u6218\u4e89\u673a\u5668"},a([v(cc.Label)],e.prototype,"label",void 0),a([v],e.prototype,"text",void 0),e=a([y],e)}(n.default);o.default=D,cc._RF.pop()},{"../Achievement":"Achievement","../Data/DamageData":"DamageData","../Data/FromData":"FromData","../Dungeon":"Dungeon","../EventConstant":"EventConstant","../Logic":"Logic","../Manager/StatusManager":"StatusManager","../Player":"Player","../Shooter":"Shooter","../Utils/AudioPlayer":"AudioPlayer","./Boss":"Boss"}],WordData:[function(t,e,o){"use strict";cc._RF.push(e,"78b51+ej+hHW50Cw1oQcuRl","WordData"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./CommonData"),a=function(){function t(){this.nameCn="",this.nameEn="",this.desc="",this.spriteFrameName="",this.common=new i.default}return Object.defineProperty(t.prototype,"Common",{get:function(){return this.common},enumerable:!0,configurable:!0}),t.prototype.valueCopy=function(t){this.common.valueCopy(t.common),this.nameCn=t.nameCn?t.nameCn:this.nameCn,this.nameEn=t.nameEn?t.nameEn:this.nameEn,this.spriteFrameName=t.spriteFrameName,this.desc=t.desc},t.prototype.clone=function(){var e=new t;return e.common=this.common.clone(),e.nameCn=this.nameCn,e.nameEn=this.nameEn,e.spriteFrameName=this.spriteFrameName,e.desc=this.desc,e},t}();o.default=a,cc._RF.pop()},{"./CommonData":"CommonData"}],WordManager:[function(t,e,o){"use strict";cc._RF.push(e,"0c333CGNPJP0ov5KegA/Xzf","WordManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){return function(){}}();o.default=i,cc._RF.pop()},{}],WxHelper:[function(t,e,o){"use strict";cc._RF.push(e,"4e113prls5Op7r/tgtPErZz","WxHelper");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),a=this&&this.__decorate||function(t,e,o,i){var a,n=arguments.length,s=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(s=(n<3?a(s):n>3?a(e,o,s):a(e,o))||s);return n>3&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),s=cc._decorator,r=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wx=window.wx,e.user=null,e.startButtonNode=null,e.rankList=null,e.rankListOpen=!1,e}return i(e,t),e.prototype.start=function(){if(this.rankList&&(this.CloseDialog(),this.rankList.node.active=this.rankListOpen),this.wx)if(this.startButtonNode){var t=cc.size(this.startButtonNode.width+10,this.startButtonNode.height+10),e=cc.view.getFrameSize(),o=cc.director.getWinSize(),i=(.5*o.width+this.startButtonNode.x-.5*t.width)/o.width*e.width,a=(.5*o.height-this.startButtonNode.y-.5*t.height)/o.height*e.height,n=t.width/o.width*e.width,s=t.height/o.height*e.height,r=this.wx.createUserInfoButton({type:"text",text:"",style:{left:i,top:a,width:n,height:s,lineHeight:0,backgroundColor:"",color:"#000000",textAlign:"center",fontSize:10,borderRadius:3}}),c=this,l=null;r.onTap(function(t){if(l)r.hide();else switch(t.errMsg){case"getUserInfo:ok":r.hide(),cc.sys.localStorage.setItem("hasUserInfo","1");var e=(l=t.userInfo).nickName,o=l.avatarUrl;c.setUserConfig(e,o),c.wx.getOpenDataContext().postMessage({message:"User info get success."});default:console.error(t.errMsg)}}),"1"==cc.sys.localStorage.getItem("hasUserInfo")&&r.hide()}else this.saveRankData()},e.prototype.setUserConfig=function(t,e){if(this.user){var o=this.user.getChildByName("mask").getComponentInChildren(cc.Sprite);this.user.getChildByName("userName").getComponent(cc.Label).string=t,cc.loader.load({url:e,type:"png"},function(t,e){t&&console.error(t),o.spriteFrame=new cc.SpriteFrame(e)})}},e.prototype.CloseDialog=function(){this.wx&&this.node&&this.rankList&&this.rankList.node&&(this.rankList.node.active=!1,this.wx.getOpenDataContext().postMessage({message:"close"}))},e.prototype.OpenDialog=function(){this.wx&&this.rankList&&(this.rankList.node.active=!0,this.saveRankData())},e.prototype.saveRankData=function(){if(this.wx){var t=this;t.wx.setUserCloudStorage({KVDataList:[{key:"score",value:n.default.coins+""}],success:function(e){console.log("score"+n.default.coins),console.log(e),t.wx.getOpenDataContext().postMessage({message:"updateMaxScore"})},fail:function(t){console.log("failed"+n.default.coins),console.log(t)}})}else console.log("wx is empty")},a([c(cc.Node)],e.prototype,"user",void 0),a([c(cc.Node)],e.prototype,"startButtonNode",void 0),a([c(cc.WXSubContextView)],e.prototype,"rankList",void 0),a([c],e.prototype,"rankListOpen",void 0),e=a([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Logic":"Logic"}]},{},["Achievement","MonsterDangerBox","MonsterDetector","AmmoCount","Actor","Boss","BossAttackCollider","Captain","CaptainSword","Dragon","Dryad","DryadGrass","EvilEye","IceDemon","IceDemonThron","Kraken","KrakenSwingHand","Rah","Slime","SlimeVenom","Sphinx","WarMachine","Box","Building","Chest","Decorate","DecorateRoom","DecorationFloor","Door","Emplacement","ExitDoor","FallStone","FootBoard","Portal","Saw","ShopTable","TarotTable","TileWaterPool","Trap","Wall","CameraControl","Chapter","CoinCount","Controller","AchievementData","BaseData","BoxData","BulletData","ChestData","CommonData","DamageData","DungeonStyleData","EquipmentData","EquipmentDescData","EquipmentStringData","FromData","ItemData","MapData","MapManagerData","MonsterData","PlayerData","ProfileData","ShopTableData","StatusData","TalentData","TarotData","WordData","Dungeon","Equipment","EquipmentDialog","EventConstant","Game","GameFinish","GameOver","HealthBar","Inventory","AreaAttack","Boom","Bullet","Coin","DashShadow","FlyWheel","Item","ItemDialog","TarotCard","JoyController","Joystick","KeyboardController","Loading","Logic","CoinManager","DungeonStyleManager","EquipmentManager","FloatingLabelManager","InventoryManager","LevelManager","MapManager","MonsterManager","MonsterRandomAttr","ProfileManager","SpecialManager","StatusManager","TarotManager","WordManager","MeleeWeapon","MeleeWeaponChild","MiniMap","Monster","OilLake","PerlinNoise2D","Player","RectDoor","RectDungeon","RectRoom","Shooter","Start","Status","FireGhost","MagicBall","MagicCircle","MagicIce","Talent","TalentDash","TalentMagic","TalentShield","Tile","CutScene","FloatingLabel","GameHud","ParallaxBackground","PlayerInfoDialog","TalentIcon","TalentTree","Tips","AudioPlayer","Random","Random4Save","Skill","WalkSmoke","WxHelper"]);