window.__require=function t(e,o,a){function i(r,c){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+r+"'")}}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return i(e[r][1][t]||t)},p,p.exports,t,e,o,a)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<a.length;r++)i(a[r]);return i}({AudioPlayer:[function(t,e,o){"use strict";cc._RF.push(e,"e5bd2TM901Exod7A4hZNEcf","AudioPlayer");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),r=t("./Random"),c=cc._decorator,s=c.ccclass,l=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boom=null,e.fall=null,e.falldown=null,e.skill001=null,e.over=null,e.bg01=null,e.bg02=null,e.bg03=null,e}var o;return a(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(n.EventConstant.PLAY_AUDIO,function(e){t.play(e.detail.name)})},e.prototype.playbg=function(){var t=r.default.getHalfChance()?this.bg01:this.bg03;cc.audioEngine.playMusic(t,!0)},e.prototype.play=function(t){switch(t){case o.FALL_TILE:cc.audioEngine.playEffect(this.fall,!1);break;case o.GAME_OVER:cc.audioEngine.playEffect(this.over,!1);break;case o.BOOM_TILE:cc.audioEngine.playEffect(this.boom,!1);break;case o.FALL_DOWN:cc.audioEngine.playEffect(this.falldown,!1);break;case o.SKILL_001:cc.audioEngine.playEffect(this.skill001,!1);break;case o.STOP_BG:cc.audioEngine.stopMusic();break;case o.PLAY_BG:this.playbg()}},e.prototype.start=function(){},e.PLAYER_UPGRADE="PLAYER_UPGRADE",e.GAME_OVER="GAME_OVER",e.FALL_TILE="FALL_TILE",e.FALL_DOWN="FALL_DOWN",e.BOOM_TILE="BOOM_TILE",e.STOP_BG="STOP_BG",e.PLAY_BG="PLAY_BG",e.SKILL_001="SKILL_001",i([l({type:cc.AudioClip})],e.prototype,"boom",void 0),i([l({type:cc.AudioClip})],e.prototype,"fall",void 0),i([l({type:cc.AudioClip})],e.prototype,"falldown",void 0),i([l({type:cc.AudioClip})],e.prototype,"skill001",void 0),i([l({type:cc.AudioClip})],e.prototype,"over",void 0),i([l({type:cc.AudioClip})],e.prototype,"bg01",void 0),i([l({type:cc.AudioClip})],e.prototype,"bg02",void 0),i([l({type:cc.AudioClip})],e.prototype,"bg03",void 0),e=o=i([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../EventConstant":"EventConstant","./Random":"Random"}],BoomData:[function(t,e,o){"use strict";cc._RF.push(e,"811bds9q7RFeLHbGhrdC6X1","BoomData"),Object.defineProperty(o,"__esModule",{value:!0});var a=function(){return function(t,e,o,a){this.x=0,this.y=0,this.isCenter=!1,this.tileSpecial=0,this.x=t,this.y=e,this.isCenter=o,this.tileSpecial=a}}();o.default=a,cc._RF.pop()},{}],CameraControl:[function(t,e,o){"use strict";cc._RF.push(e,"58a49NAKelDNoXaL6hYhEEU","CameraControl");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./GameWorld"),r=t("./EventConstant"),c=t("./utils/Utils"),s=cc._decorator,l=s.ccclass,p=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e.isZoomUp=!1,e}return a(e,t),e.prototype.onLoad=function(){var t=this;this.camera=this.getComponent(cc.Camera),cc.director.on(r.EventConstant.ZOOM_UP,function(e){t.isZoomUp=e.detail.isUp})},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.start=function(){},e.prototype.lateUpdate=function(){},e.prototype.zoomUp=function(){this.camera.zoomRatio=c.default.lerpnum(this.camera.zoomRatio,.5,.05)},e.prototype.zoomDown=function(){this.camera.zoomRatio=c.default.lerpnum(this.camera.zoomRatio,1,.05)},i([p(n.default)],e.prototype,"world",void 0),e=i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./EventConstant":"EventConstant","./GameWorld":"GameWorld","./utils/Utils":"Utils"}],EventConstant:[function(t,e,o){"use strict";cc._RF.push(e,"a5d82jAzBRME7BOwO7evcoZ","EventConstant");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.PLAYER_MOVE="PLAYER_MOVE",e.TIME_CHANGE="TIME_CHANGE",e.ZOOM_UP="ZOOM_UP",e.PLAYER_LEVEL_UPDATE="PLAYER_LEVEL_UPDATE",e.GAME_FINISHED="GAME_FINISHED",e.GAME_OVER="GAME_OVER",e.GAME_START="GAME_START",e.PLAY_AUDIO="PLAY_AUDIO",e.INIT_MAP="INIT_MAP",e.TILE_SWITCH="TILE_SWITCH",e.RED_BOOM_TILE="RED_BOOM_TILE",e.eventHandler=new cc.Node,e=i([r],e)}(cc.Component));o.EventConstant=c,cc._RF.pop()},{}],FallRowData:[function(t,e,o){"use strict";cc._RF.push(e,"17253us4dtGPJEuEiquQxNH","FallRowData"),Object.defineProperty(o,"__esModule",{value:!0});var a=function(){return function(t,e){this.boomPos=t,this.boomRowLength=e}}();o.default=a,cc._RF.pop()},{}],GameHud:[function(t,e,o){"use strict";cc._RF.push(e,"45cdfJdh35JBrvRikv80DXP","GameHud");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),r=t("./EventConstant"),c=t("./utils/Utils"),s=t("./utils/AudioPlayer"),l=cc._decorator,p=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.steplabel=null,e.levellabel=null,e.coinlabel=null,e.againDialog=null,e.dialogPlayer=null,e.redbar=null,e.bluebar=null,e.purplebar=null,e.greenbar=null,e.oilbar=null,e.redlabel=null,e.bluelabel=null,e.purplelabel=null,e.greenlabel=null,e.oillabel=null,e.skill01=null,e.skill02=null,e.skill03=null,e.skill04=null,e}return a(e,t),e.prototype.onLoad=function(){var t=this;cc.director.on(r.EventConstant.GAME_OVER,function(e){t.gameOver(e.detail.over)}),this.redbar=this.node.getChildByName("bar").getChildByName("redbar").getComponent(cc.ProgressBar),this.bluebar=this.node.getChildByName("bar").getChildByName("bluebar").getComponent(cc.ProgressBar),this.purplebar=this.node.getChildByName("bar").getChildByName("purplebar").getComponent(cc.ProgressBar),this.greenbar=this.node.getChildByName("bar").getChildByName("greenbar").getComponent(cc.ProgressBar),this.oilbar=this.node.getChildByName("bar").getChildByName("oilbar").getComponent(cc.ProgressBar),this.redlabel=this.node.getChildByName("bar").getChildByName("redbar").getChildByName("label").getComponent(cc.Label),this.bluelabel=this.node.getChildByName("bar").getChildByName("bluebar").getChildByName("label").getComponent(cc.Label),this.purplelabel=this.node.getChildByName("bar").getChildByName("purplebar").getChildByName("label").getComponent(cc.Label),this.greenlabel=this.node.getChildByName("bar").getChildByName("greenbar").getChildByName("label").getComponent(cc.Label),this.oillabel=this.node.getChildByName("bar").getChildByName("oilbar").getChildByName("label").getComponent(cc.Label),this.skill01=this.node.getChildByName("skill").getChildByName("skill01"),this.skill02=this.node.getChildByName("skill").getChildByName("skill02"),this.skill03=this.node.getChildByName("skill").getChildByName("skill03"),this.skill04=this.node.getChildByName("skill").getChildByName("skill04")},e.prototype.playAgain=function(){this.againDialog.active=!1,n.default.isPaused=!1,cc.director.emit(r.EventConstant.INIT_MAP),n.default.target<=n.default.level?n.default.reset(n.default.target+100,n.default.maxstep+5):n.default.reset(n.default.target,n.default.maxstep)},e.prototype.gameOver=function(t){this.dialogPlayer.spriteFrame=n.default.spriteFrames[t?"player4":"player"],this.againDialog.active=!0,n.default.isPaused=!0},e.prototype.changeOil=function(){n.default.oil>=3&&(n.default.oil-=3,n.default.step+=2,cc.director.emit(r.EventConstant.PLAY_AUDIO,{detail:{name:s.default.SKILL_001}}))},e.prototype.boom=function(){n.default.redpower>=6&&(n.default.redpower-=6)},e.prototype.useSkill=function(t,e){if(!n.default.isProcessing)switch(e){case"0":this.changeOil()}},e.prototype.start=function(){},e.prototype.update=function(t){this.steplabel.string="\u6b65\u6570\uff1a"+n.default.step,this.levellabel.string="\u6df1\u5ea6\uff1a"+n.default.level,this.coinlabel.string="\u91d1\u5e01\uff1a"+n.default.coin,this.redlabel.string=n.default.redpower+"/"+n.default.maxredpower,this.bluelabel.string=n.default.bluepower+"/"+n.default.maxbluepower,this.purplelabel.string=n.default.purplepower+"/"+n.default.maxpurplepower,this.greenlabel.string=n.default.greenpower+"/"+n.default.maxgreenpower,this.oillabel.string=n.default.oil+"/"+n.default.maxoilpower,this.redbar.progress=c.default.lerpnum(this.redbar.progress,n.default.redpower/n.default.maxredpower,5*t),this.bluebar.progress=c.default.lerpnum(this.bluebar.progress,n.default.bluepower/n.default.maxbluepower,5*t),this.purplebar.progress=c.default.lerpnum(this.purplebar.progress,n.default.purplepower/n.default.maxpurplepower,5*t),this.greenbar.progress=c.default.lerpnum(this.greenbar.progress,n.default.greenpower/n.default.maxgreenpower,5*t),this.oilbar.progress=c.default.lerpnum(this.oilbar.progress,n.default.oil/n.default.maxoilpower,5*t),this.skill01.opacity=n.default.isProcessing?128:255,this.skill02.opacity=(n.default.isProcessing,128),this.skill03.opacity=(n.default.isProcessing,128),this.skill04.opacity=(n.default.isProcessing,128)},i([u(cc.Label)],e.prototype,"steplabel",void 0),i([u(cc.Label)],e.prototype,"levellabel",void 0),i([u(cc.Label)],e.prototype,"coinlabel",void 0),i([u(cc.Node)],e.prototype,"againDialog",void 0),i([u(cc.Sprite)],e.prototype,"dialogPlayer",void 0),e=i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./utils/AudioPlayer":"AudioPlayer","./utils/Utils":"Utils"}],GameStart:[function(t,e,o){"use strict";cc._RF.push(e,"88009wMttRCU4cxCCZ3+ApL","GameStart");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.startGame=function(){cc.director.loadScene("loading")},e=i([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],GameWorld:[function(t,e,o){"use strict";cc._RF.push(e,"2d559jfMsxI8alkcM6ZnD10","GameWorld");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),r=t("./Logic"),c=t("./data/TileData"),s=t("./Tile"),l=t("./utils/AudioPlayer"),p=t("./data/BoomData"),u=cc._decorator,d=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerPrefab=null,e.tilePrefab=null,e.timeDelay=0,e.checkTimeDelay=0,e.map=[],e.blockMap=[],e.canFall=!1,e.canFill=!1,e.isRandoming=!1,e.isTopDown=!1,e.boomList=[],e.speed=.1,e}var o;return a(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.log(o.MAPX),cc.director.on(n.EventConstant.TILE_SWITCH,function(e){t.tileSwitched(e.detail.tapPos,e.detail.targetPos,!1)}),cc.director.on(n.EventConstant.INIT_MAP,function(e){t.initMap()}),cc.director.on(n.EventConstant.RED_BOOM_TILE,function(t){}),this.actorLayer=this.node.getChildByName("actorlayer"),this.actorLayer.zIndex=2e3,this.initMap()},e.prototype.initMap=function(){this.boomList=[],this.actorLayer.removeAllChildren(),this.map=new Array;for(var t=0;t<o.WIDTH_SIZE;t++){this.map[t]=new Array;for(var e=0;e<o.HEIGHT_SIZE;e++){(a=cc.instantiate(this.tilePrefab).getComponent(s.default)).initTile(c.default.getRandomTileData(t,e)),e<o.BLOCK_HEIGHT&&a.initTile(c.default.getBlockTileData(t,e)),this.actorLayer.addChild(a.node),this.map[t][e]=a}}this.blockMap=new Array;for(t=0;t<o.WIDTH_SIZE;t++){this.blockMap[t]=new Array;for(e=0;e<o.BLOCK_HEIGHT;e++){var a;(a=cc.instantiate(this.tilePrefab).getComponent(s.default)).initTile(c.default.getBlockTileData(t,e-o.BLOCK_HEIGHT)),a.node.opacity=0,this.actorLayer.addChild(a.node),this.blockMap[t][e]=a}}this.checkMapValid(),cc.log(this.showMap())},e.prototype.checkMapValid=function(){for(var t=this.getBoomList(),e=0;e<t.length;e++){var o=t[e];this.map[o.x][o.y].initTile(c.default.getRandomTileData(o.x,o.y))}t.length>0?this.checkMapValid():this.checkMapCanBoom()||this.randomSortMap()},e.prototype.randomSortMap=function(t){var e=this;cc.log("randomSortMap"),this.isRandoming=!0;for(var o=new Array,a=new Array,i=0;i<this.map.length;i++)for(var n=0;n<this.map[0].length;n++)this.isBlockOrEmptyType(this.map[i][n].data.tileType)||(o.push(cc.v2(i,n)),a.push(cc.v2(i,n)));a.sort(function(){return Math.random()-.5});for(i=0;i<o.length;i++){var r=o[i].clone(),c=a[i].clone();this.map[r.x][r.y].data.posIndex=c,this.map[c.x][c.y].data.posIndex=r;var s=this.map[r.x][r.y];this.map[r.x][r.y]=this.map[c.x][c.y],this.map[c.x][c.y]=s}var l=this.getBoomList();if(!this.checkMapCanBoom()||l.length>0)return cc.log(this.showMap()),void this.randomSortMap(t);var p=0;for(i=0;i<o.length;i++){var u=o[i].clone();this.map[u.x][u.y].updateTilePosition(t,function(){++p==o.length&&(e.isRandoming=!1)})}},e.prototype.downMap=function(){var t=this;r.default.level+=3,r.default.step+=5;cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:l.default.FALL_DOWN}}),this.isTopDown=!0;for(var e=0;e<this.map.length;e++)for(var a=0;a<this.map[0].length;a++)this.map[e][a].data.posIndex=cc.v2(e,a+o.BLOCK_HEIGHT),a>=o.HEIGHT_SIZE-o.BLOCK_HEIGHT?this.map[e][a].node.runAction(cc.fadeOut(.2)):this.map[e][a].node.runAction(cc.moveTo(.4,o.getPosInMap(this.map[e][a].data.posIndex)));for(e=0;e<this.blockMap.length;e++)for(a=0;a<this.blockMap[0].length;a++)this.blockMap[e][a].data.posIndex=cc.v2(e,a),this.blockMap[e][a].node.opacity=255,this.blockMap[e][a].node.runAction(cc.moveTo(.4,o.getPosInMap(this.blockMap[e][a].data.posIndex)));this.scheduleOnce(function(){for(var e=0;e<t.map.length;e++)for(var a=t.map[0].length-1;a-o.BLOCK_HEIGHT>-1;a--){var i=t.map[e][a];t.map[e][a]=t.map[e][a-o.BLOCK_HEIGHT],t.map[e][a-o.BLOCK_HEIGHT]=i}for(e=0;e<t.blockMap.length;e++)for(a=0;a<t.blockMap[0].length;a++){i=t.blockMap[e][a];t.blockMap[e][a]=t.map[e][a],t.map[e][a]=i,t.blockMap[e][a].initTile(c.default.getBlockTileData(e,a-o.BLOCK_HEIGHT)),t.blockMap[e][a].node.opacity=0}t.isTopDown=!1},.4*1.5)},e.prototype.checkMapCanBoom=function(){for(var t=this.getMapDataClone(),e=0;e<t.length;e++)for(var o=0;o<t[0].length;o++)if(!t[e][o].isBlock){var a=t[e][o];if(o<t[0].length-1&&!t[e][o+1].isBlock){if(t[e][o]=t[e][o+1],t[e][o+1]=a,this.checkPosHasThree(cc.v2(e,o),t)||this.checkPosHasThree(cc.v2(e,o+1),t))return cc.log("CanBoom"),!0;a=t[e][o],t[e][o]=t[e][o+1],t[e][o+1]=a}if(e<t.length-1&&!t[e+1][o].isBlock){if(a=t[e][o],t[e][o]=t[e+1][o],t[e+1][o]=a,this.checkPosHasThree(cc.v2(e,o),t)||this.checkPosHasThree(cc.v2(e+1,o),t))return cc.log("CanBoom"),!0;a=t[e][o],t[e][o]=t[e+1][o],t[e+1][o]=a}}return cc.log("NoTileCanBoom"),!1},e.prototype.checkPosHasThree=function(t,e){var o=t.x,a=t.y;return!!(this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a+1),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a+2),e)||this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a-1),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a-2),e)||this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a-1),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o,a+1),e)||this.isDataTypeEqual(cc.v2(o,a),cc.v2(o+1,a),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o+2,a),e)||this.isDataTypeEqual(cc.v2(o,a),cc.v2(o-1,a),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o-2,a),e)||this.isDataTypeEqual(cc.v2(o,a),cc.v2(o+1,a),e)&&this.isDataTypeEqual(cc.v2(o,a),cc.v2(o-1,a),e))},e.prototype.checkMapHasTopBlock=function(){for(var t=0;t<this.map.length;t++)for(var e=2;e<this.map[0].length;e++)if(this.isTypeBlock(this.map[t][e].data.tileType))return!0;return!1},e.prototype.getMapDataClone=function(){for(var t=new Array,e=0;e<this.map.length;e++){t[e]=new Array;for(var o=0;o<this.map[0].length;o++){var a=this.map[e][o].data.clone();t[e][o]=a}}return t},e.prototype.showMap=function(){for(var t="",e=0;e<this.map[0].length;e++){for(var o="",a=0;a<this.map.length;a++)o+=this.getTileTypeString(this.map[a][e].data.tileType)+",";t=o+"\n"+t}return t},e.prototype.getTileTypeString=function(t){switch(t){case"01":return"1";case"02":return"2";case"03":return"3";case"04":return"4";case"05":return"5";case"06":return"6";case"b0":return"b";default:return"0"}},e.prototype.tileSwitched=function(t,e,a){if(!(e.x>this.map.length-1||e.x<0||e.y>this.map[0].length-1||e.y<0||this.map[e.x][e.y].data.isBlock||this.canFall||this.canFill||(r.default.isProcessing=!0,this.map[t.x][t.y].data.isEmpty||this.map[e.x][e.y].data.isEmpty))){this.switchTileData(t,e);var i=this.getBoomList([t,e]);this.boomList=i,i.length>0?(r.default.step--,this.map[t.x][t.y].node.runAction(cc.moveTo(this.speed,o.getPosInMap(cc.v2(t.x,t.y)))),this.map[e.x][e.y].node.runAction(cc.moveTo(this.speed,o.getPosInMap(cc.v2(e.x,e.y)))),this.boomTiles(i)):(this.switchTileData(t,e),this.map[t.x][t.y].node.runAction(cc.sequence(cc.moveTo(this.speed,o.getPosInMap(cc.v2(e.x,e.y))),cc.moveTo(this.speed,o.getPosInMap(cc.v2(t.x,t.y))))),this.map[e.x][e.y].node.runAction(cc.sequence(cc.moveTo(this.speed,o.getPosInMap(cc.v2(t.x,t.y))),cc.moveTo(this.speed,o.getPosInMap(cc.v2(e.x,e.y))))))}},e.prototype.boomTiles=function(t){var e=this,o=0;t.length>0&&cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:l.default.BOOM_TILE}});for(var a=function(a){var n=t[a],l=1;switch(i.map[n.x][n.y].data.tileSpecial){case s.default.SPECIAL_NORMAL:break;case s.default.SPECIAL_VERTICAL:case s.default.SPECIAL_HORIZONTAL:l=4;break;case s.default.SPECIAL_CROSS:l=6;break;case s.default.SPECIAL_FIVE:l=10}"05"==i.map[n.x][n.y].data.tileType?r.default.oil+=l:"06"==i.map[n.x][n.y].data.tileType?r.default.coin+=l:i.isTypeBlock(i.map[n.x][n.y].data.tileType)||("01"==i.map[n.x][n.y].data.tileType?(r.default.redpower+=l,r.default.redpower>r.default.maxredpower&&(r.default.redpower=r.default.maxredpower)):"02"==i.map[n.x][n.y].data.tileType?(r.default.bluepower+=l,r.default.bluepower>r.default.maxbluepower&&(r.default.bluepower=r.default.maxbluepower)):"03"==i.map[n.x][n.y].data.tileType?(r.default.purplepower+=l,r.default.purplepower>r.default.maxpurplepower&&(r.default.purplepower=r.default.maxpurplepower)):"04"==i.map[n.x][n.y].data.tileType&&(r.default.greenpower+=l,r.default.greenpower>r.default.maxgreenpower&&(r.default.greenpower=r.default.maxgreenpower))),i.map[n.x][n.y].node.runAction(cc.sequence(cc.moveBy(.05,0,10),cc.moveBy(.05,0,-10),cc.moveBy(.05,0,10),cc.moveBy(.05,0,-10),cc.moveBy(.025,10,0),cc.moveBy(.025,-10,0),cc.moveBy(.025,10,0),cc.moveBy(.025,-10,0),cc.fadeOut(i.speed),cc.callFunc(function(){n.tileSpecial>0&&n.isCenter?(e.map[n.x][n.y].data.tileSpecial=n.tileSpecial,e.map[n.x][n.y].node.opacity=255,e.map[n.x][n.y].updateTile(),cc.log(n)):(e.map[n.x][n.y].node.opacity=0,e.map[n.x][n.y].data=c.default.getEmptyTileData(n.x,n.y))}),cc.callFunc(function(){++o==t.length&&(e.canFall=!0)})))},i=this,p=0;p<t.length;p++)a(p)},e.prototype.fallTiles=function(){var t=this;this.canFall=!1;var e=this.getFallList();e.length>0&&cc.director.emit(n.EventConstant.PLAY_AUDIO,{detail:{name:l.default.FALL_TILE}});for(var a=0,i=0;i<e.length;i++){var r=e[i];this.switchTileData(cc.v2(r.x,r.y),cc.v2(r.x,r.y-r.z)),this.map[r.x][r.y-r.z].node.runAction(cc.sequence(cc.delayTime(this.speed),cc.moveTo(this.speed,o.getPosInMap(cc.v2(r.x,r.y-r.z))).easing(cc.easeBackIn()),cc.callFunc(function(){++a==e.length&&(t.canFill=!0)})))}e.length<1&&(this.canFill=!0)},e.prototype.fillTiles=function(){var t=this;this.canFill=!1;for(var e=this.getEmptyList(),a=0,i=0;i<e.length;i++){var s=e[i];this.map[s.x][s.y].node.runAction(cc.sequence(cc.moveTo(this.speed,o.getPosInMap(cc.v2(s.x,o.HEIGHT_SIZE+s.y))),cc.fadeIn(this.speed),cc.moveTo(2*this.speed,o.getPosInMap(cc.v2(s.x,s.y))).easing(cc.easeBackIn()),cc.callFunc(function(){if(++a==e.length){var o=t.getBoomList();t.boomList=o,t.boomTiles(o),o.length<1&&r.default.step<1?cc.director.emit(n.EventConstant.GAME_OVER,{detail:{over:!0}}):o.length<1&&!t.checkMapCanBoom()?t.scheduleOnce(function(){t.randomSortMap(!0)},1):o.length<1&&!t.checkMapHasTopBlock()&&t.downMap()}}))),this.map[s.x][s.y].initTile(c.default.getRandomTileData(s.x,s.y))}},e.prototype.switchTileData=function(t,e){var o=this.map[t.x][t.y],a=this.map[e.x][e.y],i=o.data.posIndex;o.data.posIndex=a.data.posIndex.clone(),a.data.posIndex=i.clone(),this.map[t.x][t.y]=a,this.map[e.x][e.y]=o},e.prototype.getBoomList=function(t){for(var e=new Array,o=new Array,a=new Array,i={},n=0;n<this.map.length;n++)for(var r=new Array,c=0,l=0;l<this.map[0].length;l++)this.isTypeEqual(cc.v2(n,l),cc.v2(n,c))||(o=this.getTempBoomList(o,r,!0,t),r=new Array,c=l),r.push(cc.v2(n,l)),l==this.map[0].length-1&&(o=this.getTempBoomList(o,r,!0,t));for(l=0;l<this.map[0].length;l++)for(r=new Array,c=0,n=0;n<this.map.length;n++)this.isTypeEqual(cc.v2(n,l),cc.v2(c,l))||(a=this.getTempBoomList(a,r,!1,t),r=new Array,c=n),r.push(cc.v2(n,l)),n==this.map.length-1&&(a=this.getTempBoomList(a,r,!1,t));for(var u=0,d=o.concat(a);u<d.length;u++){var h=i["x="+(C=d[u]).x+"y="+C.y];h?h.tileSpecial!=s.default.SPECIAL_FIVE&&h.tileSpecial!=s.default.SPECIAL_CROSS&&(i["x="+C.x+"y="+C.y].tileSpecial=s.default.SPECIAL_CROSS,i["x="+C.x+"y="+C.y].isCenter=!0):i["x="+C.x+"y="+C.y]=C}for(var f in i){var y=i[f];this.map[y.x][y.y].data.isBlock||e.push(y)}var m=new Array;for(n=0;n<e.length;n++){var v=cc.v2(e[n].x+1,e[n].y),g=cc.v2(e[n].x-1,e[n].y),_=cc.v2(e[n].x,e[n].y+1),E=cc.v2(e[n].x,e[n].y-1);this.isPosBlock(v)&&m.push(new p.default(v.x,v.y,!1,0)),this.isPosBlock(g)&&m.push(new p.default(g.x,g.y,!1,0)),this.isPosBlock(_)&&m.push(new p.default(_.x,_.y,!1,0)),this.isPosBlock(E)&&m.push(new p.default(_.x,E.y,!1,0))}for(var b={},T=0,P=m;T<P.length;T++){var C;b["x="+(C=P[T]).x+"y="+C.y]=C}for(var f in b){y=b[f];e.push(y)}return e},e.prototype.getTempBoomList=function(t,e,o,a){var i=s.default.SPECIAL_NORMAL,n=!1;if(e.length>3&&(i=o?s.default.SPECIAL_VERTICAL:s.default.SPECIAL_HORIZONTAL),e.length>4&&(i=s.default.SPECIAL_FIVE),e.length>2)for(var r=0;r<e.length;r++){var c=!1,l=cc.v2(e[r].x,e[r].y);if(a)for(var u=0,d=a;u<d.length;u++){if(d[u].equals(l)){c=!0;break}}c||(c=r==Math.floor(e.length/2)),t.push(new p.default(e[r].x,e[r].y,c&&!n&&e.length>3,i)),c&&(n=!0)}return t},e.prototype.setBoomMapData=function(t,e){return t["x="+e.x+"y="+e.y]?t["x="+e.x+"y="+e.y].z<=e.z&&(t["x="+e.x+"y="+e.x]=e.clone()):t["x="+e.x+"y="+e.y]=e.clone(),t},e.prototype.getFallList=function(){for(var t=new Array,e=0;e<this.map.length;e++)for(var o=0,a=!1,i=0;i<this.map[0].length;i++)this.map[e][i].data.isEmpty?(a&&(a=!1,o=0),o++):o>0&&(a=!0,t.push(cc.v3(e,i,o)));return t},e.prototype.getEmptyList=function(){for(var t=new Array,e=0;e<this.map.length;e++)for(var o=0;o<this.map[0].length;o++)this.map[e][o].data.isEmpty&&t.push(cc.v2(e,o));return t},e.prototype.findBoomTile=function(t,e,o,a){var i=e,n=o;switch(a){case 0:n=o+1;break;case 1:n=o-1;break;case 2:i=e-1;break;case 3:i=e+1}return this.isTypeEqual(cc.v2(e,o),cc.v2(i,n))?(t.push(cc.v3(i,n,0)),this.findBoomTile(t,i,n,a)):t},e.prototype.isTypeEqual=function(t,e){return!!o.isPosIndexValid(t)&&(!!o.isPosIndexValid(e)&&(!this.isBlockOrEmptyType(this.map[t.x][t.y].data.tileType)&&!this.isBlockOrEmptyType(this.map[e.x][e.y].data.tileType)&&this.map[t.x][t.y].data.tileType==this.map[e.x][e.y].data.tileType))},e.prototype.isDataTypeEqual=function(t,e,a){return!!o.isPosIndexValid(t)&&(!!o.isPosIndexValid(e)&&(!this.isBlockOrEmptyType(a[t.x][t.y].tileType)&&!this.isBlockOrEmptyType(a[e.x][e.y].tileType)&&a[t.x][t.y].tileType==a[e.x][e.y].tileType))},e.prototype.isBlockOrEmptyType=function(t){return"00"==t||"b0"==t},e.prototype.isPosBlock=function(t){return!(!o.isPosIndexValid(t)||!this.isTypeBlock(this.map[t.x][t.y].data.tileType))},e.prototype.isTypeBlock=function(t){return"b0"==t},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&(this.canFall&&this.fallTiles(),this.canFill&&this.fillTiles(),r.default.isProcessing=this.boomList.length>0||this.isRandoming||this.isTopDown)},e.isPosIndexValid=function(t){return t.x<o.WIDTH_SIZE&&t.x>-1&&t.y<o.HEIGHT_SIZE&&t.y>-1},e.getPosInMap=function(t){var e=o.MAPX+t.x*o.TILE_SIZE+o.TILE_SIZE/2,a=o.MAPY+t.y*o.TILE_SIZE-o.TILE_SIZE;return cc.v2(e,a)},e.getIndexInMap=function(t,e){var a=(t.x-o.MAPX)/o.TILE_SIZE,i=(t.y-o.MAPY)/o.TILE_SIZE;return a=Math.round(a),i=Math.round(i),e||(a<0&&(a=0),a>=o.WIDTH_SIZE&&(a=o.WIDTH_SIZE-1),i<0&&(i=0),i>=o.HEIGHT_SIZE&&(i=o.HEIGHT_SIZE-1)),cc.v2(a,i)},e.fixOuterMap=function(t){var e=(t.x-o.MAPX)/o.TILE_SIZE,a=(t.y-o.MAPY)/o.TILE_SIZE;e=Math.round(e),a=Math.round(a);var i=!1;return e<0&&(e=0,i=!0),e>=o.WIDTH_SIZE&&(e=o.WIDTH_SIZE-1,i=!0),a<0&&(a=0,i=!0),a>=o.HEIGHT_SIZE&&(a=o.HEIGHT_SIZE-1,i=!0),i?o.getPosInMap(cc.v2(e,a)):t},e.BOTTOM_LINE_INDEX=3,e.TILE_SIZE=80,e.WIDTH_SIZE=9,e.HEIGHT_SIZE=9,e.MAPX=-o.WIDTH_SIZE*o.TILE_SIZE/2,e.MAPY=128,e.BLOCK_HEIGHT=3,i([h(cc.Prefab)],e.prototype,"playerPrefab",void 0),i([h(cc.Prefab)],e.prototype,"tilePrefab",void 0),e=o=i([d],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./Tile":"Tile","./data/BoomData":"BoomData","./data/TileData":"TileData","./utils/AudioPlayer":"AudioPlayer"}],KeyboardController:[function(t,e,o){"use strict";cc._RF.push(e,"890117p2tpMNYXd5PtS5Hgr","KeyboardController");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),r=t("./Logic"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopCount=0,e.isUp=!1,e.isDown=!1,e.isLeft=!1,e.isRight=!1,e.isA=!1,e.isB=!1,e.isC=!1,e.isD=!1,e.timeDelay=0,e}return a(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!0;break;case cc.macro.KEY.s:this.isDown=!0;break;case cc.macro.KEY.a:this.isLeft=!0;break;case cc.macro.KEY.d:this.isRight=!0;break;case cc.macro.KEY.j:this.isA=!0;break;case cc.macro.KEY.k:this.isB=!0;break;case cc.macro.KEY.i:this.isC=!0;break;case cc.macro.KEY.l:this.isD=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!1;break;case cc.macro.KEY.s:this.isDown=!1;break;case cc.macro.KEY.a:this.isLeft=!1;break;case cc.macro.KEY.d:this.isRight=!1;break;case cc.macro.KEY.j:this.isA=!1;break;case cc.macro.KEY.k:this.isB=!1;break;case cc.macro.KEY.i:this.isC=!1;break;case cc.macro.KEY.l:this.isD=!1}},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},e.prototype.sendMoveMessageToPlayer=function(t){var e=cc.v2(0,0);this.isUp&&e.addSelf(cc.v2(0,.9)),this.isDown&&e.addSelf(cc.v2(0,-.9)),this.isLeft&&e.addSelf(cc.v2(-.9,0)),this.isRight&&e.addSelf(cc.v2(.9,0)),e.mag()>0&&e.normalizeSelf();var o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3)),e.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(n.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:e,dt:t}}),this.isA&&r.default.isPaused&&cc.director.emit(n.EventConstant.GAME_START),this.isB,this.isC,this.isD},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e=i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic"}],Loading:[function(t,e,o){"use strict";cc._RF.push(e,"d89e3RWyLhN2ZFfaJfQzqAs","Loading");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=null,e.timeDelay=0,e.isSpriteFramesLoaded=!1,e}return a(e,t),e.prototype.start=function(){this.loadSpriteFrames()},e.prototype.loadSpriteFrames=function(){var t=this;n.default.spriteFrames?this.isSpriteFramesLoaded=!0:cc.loader.loadResDir("Texture",cc.SpriteFrame,function(e,o){n.default.spriteFrames={};for(var a=0,i=o;a<i.length;a++){var r=i[a];n.default.spriteFrames[r.name]=r}t.isSpriteFramesLoaded=!0,cc.log("texture loaded")})},e.prototype.update=function(t){var e=this;this.timeDelay+=t,this.timeDelay>.16&&this.isSpriteFramesLoaded&&(this.timeDelay=0,this.isSpriteFramesLoaded=!1,cc.director.preloadScene("game",function(){},function(){e.ui.runAction(cc.fadeOut(.2)),e.scheduleOnce(function(){cc.director.loadScene("game")},.2)}))},i([s(cc.Node)],e.prototype,"ui",void 0),e=i([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Logic":"Logic"}],Logic:[function(t,e,o){"use strict";cc._RF.push(e,"e235fPmQT1Nh7nMh+UJ5Y2h","Logic");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return a(e,t),o=e,e.prototype.onLoad=function(){cc.game.setFrameRate(45),cc.game.addPersistRootNode(this.node),cc.view.enableAntiAlias(!1)},e.reset=function(t,e){o.isProcessing=!1,o.level=0,o.coin=0,o.oil=0,o.step=e,o.maxstep=e,o.target=t},e.prototype.start=function(){},e.isPaused=!1,e.isProcessing=!1,e.level=0,e.coin=0,e.oil=0,e.target=1e8,e.step=20,e.maxstep=20,e.spriteFrames=null,e.redpower=0,e.bluepower=0,e.purplepower=0,e.greenpower=0,e.maxredpower=20,e.maxbluepower=20,e.maxpurplepower=20,e.maxgreenpower=20,e.maxoilpower=50,e=o=i([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"7cda7BZOz1Dq7ikRhlO7P3X","Player");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,c=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){},e.prototype.update=function(t){},e=i([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],Random:[function(t,e,o){"use strict";cc._RF.push(e,"6884aZwgtJKhYfD6AFDvIcl","Random"),Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.prototype.setSeed=function(e){t.seed=e},t.rand=function(){return t.seed=(9301*t.seed+49297)%233280,t.seed/233280},t.getRandomNum=function(e,o){return e+Math.round(t.rand()*(o-e))},t.getHalfChance=function(){return t.rand()>.5},t.seed=(new Date).getTime(),t}();o.default=a,cc._RF.pop()},{}],TileData:[function(t,e,o){"use strict";cc._RF.push(e,"660b86IF55MpZYbQRZo4A/l","TileData"),Object.defineProperty(o,"__esModule",{value:!0});var a=t("../utils/Random"),i=function(){function t(t,e,o,a,i){this.tileType="00",this.resName="tile000",this.posIndex=cc.v2(0,0),this.tileSpecial=0,this.isEmpty=!1,this.isBlock=!1,this.tileType=t,this.posIndex=e,this.resName=o,this.isEmpty=a,this.isBlock=i}return t.prototype.valueCopy=function(t){this.tileType=t.tileType,this.resName=t.resName,this.posIndex=cc.v2(t.posIndex.x,t.posIndex.y),this.isEmpty=t.isEmpty,this.isBlock=t.isBlock},t.prototype.statusCopy=function(t){this.tileType=t.tileType,this.resName=t.resName,this.isEmpty=t.isEmpty,this.isBlock=t.isBlock},t.prototype.clone=function(){return new t(this.tileType,this.posIndex.clone(),this.resName,this.isEmpty,this.isBlock)},t.getEmptyTileData=function(e,o){return new t("00",cc.v2(e,o),"tile000",!0,!1)},t.getPlayerTileData=function(){return new t("a0",cc.v2(0,0),"player",!1,!1)},t.getRandomTileData=function(e,o){var i=a.default.getRandomNum(1,6);return new t("0"+i,cc.v2(e,o),"tile00"+i,!1,!1)},t.getBlockTileData=function(e,o){return new t("b0",cc.v2(e,o),"tile101",!1,!0)},t}();o.default=i,cc._RF.pop()},{"../utils/Random":"Random"}],Tile:[function(t,e,o){"use strict";cc._RF.push(e,"ffe19gYutBE3LyIrRIF5dD0","Tile");var a=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),i=this&&this.__decorate||function(t,e,o,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,a);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(n<3?i(r):n>3?i(e,o,r):i(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Logic"),r=t("./GameWorld"),c=t("./EventConstant"),s=t("./utils/Utils"),l=cc._decorator,p=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onLoad=function(){var t=this;this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.glow=this.node.getChildByName("glow"),this.glow.opacity=0,this.node.on(cc.Node.EventType.TOUCH_START,function(){n.default.isPaused||(t.glow.opacity=80)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.glow.opacity=0},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){if(n.default.isProcessing||n.default.isPaused)t.glow.opacity=0;else{var o=t.node.convertToNodeSpaceAR(e.getLocation()),a=t.data.posIndex.clone();s.default.getDistance(cc.v2(0,0),o)<32||(Math.abs(o.x)>Math.abs(o.y)?a.x=o.x>0?a.x+1:a.x-1:a.y=o.y>0?a.y+1:a.y-1,cc.director.emit(c.EventConstant.TILE_SWITCH,{detail:{tapPos:t.data.posIndex,targetPos:a}}),t.glow.opacity=0)}},this)},e.prototype.initTile=function(t){this.data=t,this.changeRes(),this.node.position=r.default.getPosInMap(t.posIndex)},e.prototype.updateTile=function(){this.changeRes(),this.node.position=r.default.getPosInMap(this.data.posIndex)},e.prototype.updateTilePosition=function(t,e){t?this.node.runAction(cc.sequence(cc.moveTo(.2,r.default.getPosInMap(this.data.posIndex)),cc.callFunc(e))):(this.node.position=r.default.getPosInMap(this.data.posIndex),e())},e.prototype.changeRes=function(){this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite));var t="";switch(this.data.tileSpecial){case 0:t="";break;case 1:t="four1";break;case 2:t="four2";break;case 3:t="cross";break;case 4:t="five"}this.sprite.spriteFrame=n.default.spriteFrames[this.data.resName+t]},e.prototype.start=function(){},e.prototype.changeTile=function(){},e.SPECIAL_NORMAL=0,e.SPECIAL_VERTICAL=1,e.SPECIAL_HORIZONTAL=2,e.SPECIAL_CROSS=3,e.SPECIAL_FIVE=4,e=i([p],e)}(cc.Component));o.default=u,cc._RF.pop()},{"./EventConstant":"EventConstant","./GameWorld":"GameWorld","./Logic":"Logic","./utils/Utils":"Utils"}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"b6c395Cn/hBcaIzEjpdihLD","Utils"),Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.lerpnum=function(t,e,o){return t+(e-t)*o},t.lerp=function(t,e,o){var a=cc.v2(0,0),i=t.x,n=t.y;return a.x=i+(e.x-i)*o,a.y=n+(e.y-n)*o,a},t.getDistance=function(t,e){var o=t.x-e.x,a=t.y-e.y;return Math.sqrt(o*o+a*a)},t}();o.default=a,cc._RF.pop()},{}]},{},["CameraControl","EventConstant","GameHud","GameStart","GameWorld","KeyboardController","Loading","Logic","Player","Tile","BoomData","FallRowData","TileData","AudioPlayer","Random","Utils"]);