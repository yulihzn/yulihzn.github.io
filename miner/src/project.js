window.__require=function t(e,o,n){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!a&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return i(e[c][1][t]||t)},u,u.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({AudioPlayer:[function(t,e,o){"use strict";cc._RF.push(e,"e5bd2TM901Exod7A4hZNEcf","AudioPlayer");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../EventConstant"),c=t("./Random"),a=cc._decorator,s=a.ccclass,p=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hit=null,e.upgrade=null,e.over=null,e.bg01=null,e.bg02=null,e.bg03=null,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(r.EventConstant.PLAY_AUDIO,function(e){t.play(e.detail.name)})},e.prototype.playbg=function(){var t=c.default.getHalfChance()?this.bg01:this.bg03;cc.audioEngine.playMusic(t,!0)},e.prototype.play=function(t){switch(t){case o.PLAYER_UPGRADE:cc.audioEngine.playEffect(this.upgrade,!1);break;case o.GAME_OVER:cc.audioEngine.playEffect(this.over,!1);break;case o.PLAYER_HIT:cc.audioEngine.playEffect(this.hit,!1);break;case o.STOP_BG:cc.audioEngine.stopMusic();break;case o.PLAY_BG:this.playbg()}},e.prototype.start=function(){},e.PLAYER_UPGRADE="PLAYER_UPGRADE",e.GAME_OVER="GAME_OVER",e.PLAYER_HIT="PLAYER_HIT",e.STOP_BG="STOP_BG",e.PLAY_BG="PLAY_BG",i([p({type:cc.AudioClip})],e.prototype,"hit",void 0),i([p({type:cc.AudioClip})],e.prototype,"upgrade",void 0),i([p({type:cc.AudioClip})],e.prototype,"over",void 0),i([p({type:cc.AudioClip})],e.prototype,"bg01",void 0),i([p({type:cc.AudioClip})],e.prototype,"bg02",void 0),i([p({type:cc.AudioClip})],e.prototype,"bg03",void 0),e=o=i([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../EventConstant":"EventConstant","./Random":"Random"}],BoomData:[function(t,e,o){"use strict";cc._RF.push(e,"811bds9q7RFeLHbGhrdC6X1","BoomData"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(){}}();o.default=n,cc._RF.pop()},{}],CameraControl:[function(t,e,o){"use strict";cc._RF.push(e,"58a49NAKelDNoXaL6hYhEEU","CameraControl");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./GameWorld"),c=t("./EventConstant"),a=t("./utils/Utils"),s=cc._decorator,p=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e.isZoomUp=!1,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.camera=this.getComponent(cc.Camera),cc.director.on(c.EventConstant.ZOOM_UP,function(e){t.isZoomUp=e.detail.isUp})},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.start=function(){},e.prototype.lateUpdate=function(){},e.prototype.zoomUp=function(){this.camera.zoomRatio=a.default.lerpnum(this.camera.zoomRatio,.5,.05)},e.prototype.zoomDown=function(){this.camera.zoomRatio=a.default.lerpnum(this.camera.zoomRatio,1,.05)},i([u(r.default)],e.prototype,"world",void 0),e=i([p],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant","./GameWorld":"GameWorld","./utils/Utils":"Utils"}],EventConstant:[function(t,e,o){"use strict";cc._RF.push(e,"a5d82jAzBRME7BOwO7evcoZ","EventConstant");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.PLAYER_MOVE="PLAYER_MOVE",e.TIME_CHANGE="TIME_CHANGE",e.ZOOM_UP="ZOOM_UP",e.PLAYER_LEVEL_UPDATE="PLAYER_LEVEL_UPDATE",e.GAME_FINISHED="GAME_FINISHED",e.GAME_OVER="GAME_OVER",e.GAME_START="GAME_START",e.PLAY_AUDIO="PLAY_AUDIO",e.TILE_CLICK="TILE_CLICK",e.TILE_SWITCH="TILE_SWITCH",e.eventHandler=new cc.Node,e=i([c],e)}(cc.Component));o.EventConstant=a,cc._RF.pop()},{}],FallRowData:[function(t,e,o){"use strict";cc._RF.push(e,"17253us4dtGPJEuEiquQxNH","FallRowData"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){return function(t,e){this.boomPos=t,this.boomRowLength=e}}();o.default=n,cc._RF.pop()},{}],GameStart:[function(t,e,o){"use strict";cc._RF.push(e,"88009wMttRCU4cxCCZ3+ApL","GameStart");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.startGame=function(){cc.director.loadScene("loading")},e=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],GameWorld:[function(t,e,o){"use strict";cc._RF.push(e,"2d559jfMsxI8alkcM6ZnD10","GameWorld");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./EventConstant"),c=t("./Logic"),a=t("./data/TileData"),s=t("./Tile"),p=t("./data/FallRowData"),u=cc._decorator,l=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerPrefab=null,e.tilePrefab=null,e.timeDelay=0,e.checkTimeDelay=0,e.map=[],e.boomList=[],e.fallMap={},e.canBoom=!1,e.canFall=!1,e.canCreate=!1,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.log(o.MAPX),cc.director.on(r.EventConstant.TILE_SWITCH,function(e){t.tileSwitched(e.detail.tapPos,e.detail.targetPos,!1)}),this.actorLayer=this.node.getChildByName("actorlayer"),this.actorLayer.zIndex=2e3,this.initMap()},e.prototype.initMap=function(){this.map=new Array;for(var t=0;t<o.WIDTH_SIZE;t++){this.map[t]=new Array;for(var e=0;e<o.HEIGHT_SIZE;e++){var n=cc.instantiate(this.tilePrefab).getComponent(s.default);n.initTile(a.default.getRandomTileData(t,e)),this.actorLayer.addChild(n.node),this.map[t][e]=n}}cc.log(this.showMap()),this.checkMapValid()},e.prototype.checkMapValid=function(){for(var t=this.getBoomList(),e=0;e<t.length;e++){var o=t[e];this.map[o.x][o.y].initTile(a.default.getRandomTileData(o.x,o.y))}t.length>0&&this.checkMapValid()},e.prototype.showMap=function(){for(var t="",e=0;e<this.map[0].length;e++){for(var o="",n=0;n<this.map.length;n++)o+=this.map[n][e].data.tileType+",";t=o+"\n"+t}return t},e.prototype.tileSwitched=function(t,e,n){if(!(e.x>this.map.length-1||e.x<0||e.y>this.map[0].length-1||e.y<0)){c.default.isProcessing=!0;var i=this.map[t.x][t.y],r=this.map[e.x][e.y];if(!i.data.isEmpty&&!r.data.isEmpty){this.switchTileData(t,e);this.getBoomList();this.boom()?(i.node.runAction(cc.moveTo(.1,o.getPosInMap(i.data.posIndex))),r.node.runAction(cc.moveTo(.1,o.getPosInMap(r.data.posIndex)))):(this.switchTileData(t,e),i.node.runAction(cc.sequence(cc.moveTo(.1,o.getPosInMap(r.data.posIndex)),cc.moveTo(.1,o.getPosInMap(i.data.posIndex)))),r.node.runAction(cc.sequence(cc.moveTo(.1,o.getPosInMap(i.data.posIndex)),cc.moveTo(.1,o.getPosInMap(r.data.posIndex)))))}}},e.prototype.boom=function(){var t=this,e=this.getBoomList();if(e.length>0){for(var n=0;n<e.length;n++){var i=e[n];this.map[i.x][i.y].node.runAction(cc.fadeOut(.1)),this.map[i.x][i.y].data=a.default.getEmptyTileData()}return this.scheduleOnce(function(){for(var n=t.getFallList(e),i=0;i<n.length;i++){var r=n[i];t.switchTileData(cc.v2(r.x,r.y),cc.v2(r.x,r.y-r.z)),t.map[r.x][r.y-r.z].node.runAction(cc.moveTo(.1,o.getPosInMap(cc.v2(r.x,r.y-r.z))))}t.scheduleOnce(function(){var e=t.getEmptyList();cc.log(e);for(var n=0;n<e.length;n++){var i=e[n];t.map[i.x][i.y].node.position=o.getPosInMap(cc.v2(i.x,o.HEIGHT_SIZE+1)),t.map[i.x][i.y].node.runAction(cc.sequence(cc.fadeIn(.1),cc.moveTo(.1,o.getPosInMap(cc.v2(i.x,i.y))))),t.map[i.x][i.y].initTile(a.default.getRandomTileData(i.x,i.y))}t.scheduleOnce(function(){t.boom()},.5)},.5)},.5),!0}return c.default.isProcessing=!1,!1},e.prototype.switchTileData=function(t,e){var o=this.map[t.x][t.y],n=this.map[e.x][e.y],i=o.data.posIndex;o.data.posIndex=n.data.posIndex.clone(),n.data.posIndex=i.clone(),this.map[t.x][t.y]=n,this.map[e.x][e.y]=o},e.prototype.boomTiles=function(t,e,n){for(var i=this,r=0;r<n.length;r++){var c=this.boomList[r],s=this.map[c.x][c.y];s.data.isEmpty=!0,s.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){})))}var p=function(t){for(var e=u.fallMap[t],n=function(t){u.scheduleOnce(function(){i.fallTile(cc.v2(e.boomPos.x,t),cc.v2(e.boomPos.x,t+e.boomRowLength))},1)},r=e.boomPos.y;r+e.boomRowLength<o.HEIGHT_SIZE;r++)n(r);u.scheduleOnce(function(){for(var t=e.boomRowLength;t>0;){var n=i.map[e.boomPos.x][o.HEIGHT_SIZE-1];n.node.opacity=255,n.initTile(a.default.getRandomTileData(e.boomPos.x,o.HEIGHT_SIZE-1)),i.switchTileData(n.data.posIndex,cc.v2(e.boomPos.x,o.HEIGHT_SIZE-t)),n.node.runAction(cc.moveTo(.1,o.getPosInMap(n.data.posIndex))),t--}},3)},u=this;for(var l in this.fallMap)p(l);cc.log(this.showMap())},e.prototype.fallTile=function(t,e){var n=this.map[t.x][t.y],i=this.map[e.x][e.y];this.switchTileData(t,e),n.node.runAction(cc.moveTo(.1,o.getPosInMap(n.data.posIndex))),i.node.runAction(cc.moveTo(.1,o.getPosInMap(i.data.posIndex)))},e.prototype.getBoomList=function(){for(var t={},e=0;e<this.map.length;e++)for(var o=0;o<this.map[0].length;o++){var n=new Array;n=this.findBoomTile(n,e,o,0),n=this.findBoomTile(n,e,o,1);var i=new Array;if(i=this.findBoomTile(i,e,o,2),i=this.findBoomTile(i,e,o,3),n.length>1)for(var r=0,c=n;r<c.length;r++){t["x="+(p=c[r]).x+"y="+p.y]=p}if(i.length>1)for(var a=0,s=i;a<s.length;a++){var p;t["x="+(p=s[a]).x+"y="+p.y]=p}}var u=new Array;for(var l in t){var f=t[l];u.push(f)}return u},e.prototype.getFallList=function(t){for(var e={},n=0;n<t.length;n++){for(var i=t[n],r=0,c=i.y;c<o.HEIGHT_SIZE;c++)this.map[i.x][c].data.isEmpty&&r++;for(c=i.y;c<o.HEIGHT_SIZE;c++){var a=e["x="+i.x+"y="+c];a?a.z<r&&(e["x="+i.x+"y="+c]=cc.v3(i.x,c,r)):e["x="+i.x+"y="+c]=cc.v3(i.x,c,1)}}var s=new Array;for(var p in e){var u=e[p];this.map[u.x][u.y].data.isEmpty||s.push(u)}return s},e.prototype.getEmptyList=function(){for(var t=new Array,e=0;e<this.map.length;e++)for(var o=0;o<this.map[0].length;o++)this.map[e][o].data.isEmpty&&t.push(cc.v2(e,o));return t},e.prototype.isValidSwitch=function(t,e){this.boomList=new Array;var n=new Array,i=new Array,r=new Array,c=new Array;n=this.findBoomTile(n,t.x,t.y,0),n=this.findBoomTile(n,t.x,t.y,1),i=this.findBoomTile(i,t.x,t.y,2),i=this.findBoomTile(i,t.x,t.y,3),r=this.findBoomTile(r,e.x,e.y,0),r=this.findBoomTile(r,e.x,e.y,1),c=this.findBoomTile(c,e.x,e.y,2),c=this.findBoomTile(c,e.x,e.y,3);var a=!1,s=!1;(n.length>1||i.length>1)&&(a=!0,this.boomList.push(t)),(r.length>1||c.length>1)&&(s=!0,this.boomList.push(e)),a&&(this.boomList=this.boomList.concat(n),this.boomList=this.boomList.concat(i)),s&&(this.boomList=this.boomList.concat(r),this.boomList=this.boomList.concat(c)),cc.log(this.boomList),this.fallMap={};for(var u=0;u<this.boomList.length;u++){var l=this.boomList[u];this.map[l.x][l.y].data.isEmpty=!0}for(u=0;u<this.boomList.length;u++){for(var f=0,h=(l=this.boomList[u]).y;h<o.HEIGHT_SIZE;h++)this.map[l.x][h].data.isEmpty&&f++;var d=this.fallMap["x="+l.x];d?d.boomRowLength<f&&(this.fallMap["x="+l.x].boomRowLength=f,this.fallMap["x="+l.x].boomPos=l):this.fallMap["x="+l.x]=new p.default(l,1)}return cc.log(this.fallMap),a||s},e.prototype.findBoomTile=function(t,e,o,n){var i=e,r=o;switch(n){case 0:r=o+1;break;case 1:r=o-1;break;case 2:i=e-1;break;case 3:i=e+1}return this.isTypeEqual(cc.v2(e,o),cc.v2(i,r))?(t.push(cc.v2(i,r)),this.findBoomTile(t,i,r,n)):t},e.prototype.isTypeEqual=function(t,e){return!(t.x>this.map.length-1||t.x<0||t.y>this.map[0].length-1||t.y<0)&&(!(e.x>this.map.length-1||e.x<0||e.y>this.map[0].length-1||e.y<0)&&("00"!=this.map[t.x][t.y].data.tileType&&"00"!=this.map[e.x][e.y].data.tileType&&this.map[t.x][t.y].data.tileType==this.map[e.x][e.y].data.tileType))},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)},e.getPosInMap=function(t){var e=o.MAPX+t.x*o.TILE_SIZE+o.TILE_SIZE/2,n=o.MAPY+t.y*o.TILE_SIZE;return cc.v2(e,n)},e.getIndexInMap=function(t,e){var n=(t.x-o.MAPX)/o.TILE_SIZE,i=(t.y-o.MAPY)/o.TILE_SIZE;return n=Math.round(n),i=Math.round(i),e||(n<0&&(n=0),n>=o.WIDTH_SIZE&&(n=o.WIDTH_SIZE-1),i<0&&(i=0),i>=o.HEIGHT_SIZE&&(i=o.HEIGHT_SIZE-1)),cc.v2(n,i)},e.fixOuterMap=function(t){var e=(t.x-o.MAPX)/o.TILE_SIZE,n=(t.y-o.MAPY)/o.TILE_SIZE;e=Math.round(e),n=Math.round(n);var i=!1;return e<0&&(e=0,i=!0),e>=o.WIDTH_SIZE&&(e=o.WIDTH_SIZE-1,i=!0),n<0&&(n=0,i=!0),n>=o.HEIGHT_SIZE&&(n=o.HEIGHT_SIZE-1,i=!0),i?o.getPosInMap(cc.v2(e,n)):t},e.BOTTOM_LINE_INDEX=5,e.TILE_SIZE=80,e.WIDTH_SIZE=9,e.HEIGHT_SIZE=11,e.MAPX=-o.WIDTH_SIZE*o.TILE_SIZE/2,e.MAPY=64,i([f(cc.Prefab)],e.prototype,"playerPrefab",void 0),i([f(cc.Prefab)],e.prototype,"tilePrefab",void 0),e=o=i([l],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic","./Tile":"Tile","./data/FallRowData":"FallRowData","./data/TileData":"TileData"}],KeyboardController:[function(t,e,o){"use strict";cc._RF.push(e,"890117p2tpMNYXd5PtS5Hgr","KeyboardController");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./EventConstant"),c=t("./Logic"),a=cc._decorator,s=a.ccclass,p=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopCount=0,e.isUp=!1,e.isDown=!1,e.isLeft=!1,e.isRight=!1,e.isA=!1,e.isB=!1,e.isC=!1,e.isD=!1,e.timeDelay=0,e}return n(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!0;break;case cc.macro.KEY.s:this.isDown=!0;break;case cc.macro.KEY.a:this.isLeft=!0;break;case cc.macro.KEY.d:this.isRight=!0;break;case cc.macro.KEY.j:this.isA=!0;break;case cc.macro.KEY.k:this.isB=!0;break;case cc.macro.KEY.i:this.isC=!0;break;case cc.macro.KEY.l:this.isD=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!1;break;case cc.macro.KEY.s:this.isDown=!1;break;case cc.macro.KEY.a:this.isLeft=!1;break;case cc.macro.KEY.d:this.isRight=!1;break;case cc.macro.KEY.j:this.isA=!1;break;case cc.macro.KEY.k:this.isB=!1;break;case cc.macro.KEY.i:this.isC=!1;break;case cc.macro.KEY.l:this.isD=!1}},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},e.prototype.sendMoveMessageToPlayer=function(t){var e=cc.v2(0,0);this.isUp&&e.addSelf(cc.v2(0,.9)),this.isDown&&e.addSelf(cc.v2(0,-.9)),this.isLeft&&e.addSelf(cc.v2(-.9,0)),this.isRight&&e.addSelf(cc.v2(.9,0)),e.mag()>0&&e.normalizeSelf();var o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3)),e.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(r.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:e,dt:t}}),this.isA&&c.default.isPaused&&cc.director.emit(r.EventConstant.GAME_START),this.isB,this.isC,this.isD},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e=i([s],e)}(cc.Component));o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./Logic":"Logic"}],Loading:[function(t,e,o){"use strict";cc._RF.push(e,"d89e3RWyLhN2ZFfaJfQzqAs","Loading");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./Logic"),c=cc._decorator,a=c.ccclass,s=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=null,e.timeDelay=0,e.isSpriteFramesLoaded=!1,e}return n(e,t),e.prototype.start=function(){this.loadSpriteFrames()},e.prototype.loadSpriteFrames=function(){var t=this;r.default.spriteFrames?this.isSpriteFramesLoaded=!0:cc.loader.loadResDir("Texture",cc.SpriteFrame,function(e,o){r.default.spriteFrames={};for(var n=0,i=o;n<i.length;n++){var c=i[n];r.default.spriteFrames[c.name]=c}t.isSpriteFramesLoaded=!0,cc.log("texture loaded")})},e.prototype.update=function(t){var e=this;this.timeDelay+=t,this.timeDelay>.16&&this.isSpriteFramesLoaded&&(this.timeDelay=0,this.isSpriteFramesLoaded=!1,cc.director.preloadScene("game",function(){},function(){e.ui.runAction(cc.fadeOut(.2)),e.scheduleOnce(function(){cc.director.loadScene("game")},.2)}))},i([s(cc.Node)],e.prototype,"ui",void 0),e=i([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Logic":"Logic"}],Logic:[function(t,e,o){"use strict";cc._RF.push(e,"e235fPmQT1Nh7nMh+UJ5Y2h","Logic");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){cc.game.setFrameRate(45),cc.game.addPersistRootNode(this.node),cc.view.enableAntiAlias(!1)},e.prototype.start=function(){},e.isPaused=!1,e.isProcessing=!1,e.spriteFrames=null,e=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"7cda7BZOz1Dq7ikRhlO7P3X","Player");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,a=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){},e.prototype.update=function(t){},e=i([c],e)}(cc.Component));o.default=a,cc._RF.pop()},{}],Random:[function(t,e,o){"use strict";cc._RF.push(e,"6884aZwgtJKhYfD6AFDvIcl","Random"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.setSeed=function(e){t.seed=e},t.rand=function(){return t.seed=(9301*t.seed+49297)%233280,t.seed/233280},t.getRandomNum=function(e,o){return e+Math.round(t.rand()*(o-e))},t.getHalfChance=function(){return t.rand()>.5},t.seed=(new Date).getTime(),t}();o.default=n,cc._RF.pop()},{}],TileData:[function(t,e,o){"use strict";cc._RF.push(e,"660b86IF55MpZYbQRZo4A/l","TileData"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../utils/Random"),i=function(){function t(t,e,o,n){this.tileType="00",this.resName="tile000",this.posIndex=cc.v2(0,0),this.isEmpty=!1,this.tileType=t,this.posIndex=e,this.resName=o,this.isEmpty=n}return t.prototype.valueCopy=function(t){this.tileType=t.tileType,this.resName=t.resName,this.posIndex=cc.v2(t.posIndex.x,t.posIndex.y),this.isEmpty=t.isEmpty},t.prototype.statusCopy=function(t){this.tileType=t.tileType,this.resName=t.resName,this.isEmpty=t.isEmpty},t.getEmptyTileData=function(){return new t("00",cc.v2(0,0),"tile000",!0)},t.getPlayerTileData=function(){return new t("a0",cc.v2(0,0),"player",!1)},t.getRandomTileData=function(e,o){var i=n.default.getRandomNum(1,6);return new t("0"+i,cc.v2(e,o),"tile00"+i,!1)},t}();o.default=i,cc._RF.pop()},{"../utils/Random":"Random"}],Tile:[function(t,e,o){"use strict";cc._RF.push(e,"ffe19gYutBE3LyIrRIF5dD0","Tile");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./Logic"),c=t("./GameWorld"),a=t("./EventConstant"),s=t("./utils/Utils"),p=cc._decorator,u=p.ccclass,l=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){var t=this;this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.glow=this.node.getChildByName("glow"),this.glow.opacity=0,this.node.on(cc.Node.EventType.TOUCH_START,function(){t.glow.opacity=80},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.glow.opacity=0},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){if(r.default.isProcessing)t.glow.opacity=0;else{var o=t.node.convertToNodeSpace(e.getLocation()),n=t.data.posIndex.clone();s.default.getDistance(cc.v2(0,0),o)<32||(Math.abs(o.x)>Math.abs(o.y)?n.x=o.x>0?n.x+1:n.x-1:n.y=o.y>0?n.y+1:n.y-1,cc.director.emit(a.EventConstant.TILE_SWITCH,{detail:{tapPos:t.data.posIndex,targetPos:n}}),t.glow.opacity=0)}},this)},e.prototype.initTile=function(t){this.data=t,this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite)),this.sprite.spriteFrame=r.default.spriteFrames[t.resName],this.node.position=c.default.getPosInMap(t.posIndex)},e.prototype.updateTile=function(){this.sprite||(this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite)),this.sprite.spriteFrame=r.default.spriteFrames[this.data.resName],this.node.position=c.default.getPosInMap(this.data.posIndex)},e.prototype.start=function(){},e.prototype.changeTile=function(){},e=i([u],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant","./GameWorld":"GameWorld","./Logic":"Logic","./utils/Utils":"Utils"}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"b6c395Cn/hBcaIzEjpdihLD","Utils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.lerpnum=function(t,e,o){return t+(e-t)*o},t.lerp=function(t,e,o){var n=cc.v2(0,0),i=t.x,r=t.y;return n.x=i+(e.x-i)*o,n.y=r+(e.y-r)*o,n},t.getDistance=function(t,e){var o=t.x-e.x,n=t.y-e.y;return Math.sqrt(o*o+n*n)},t}();o.default=n,cc._RF.pop()},{}]},{},["CameraControl","EventConstant","GameStart","GameWorld","KeyboardController","Loading","Logic","Player","Tile","BoomData","FallRowData","TileData","AudioPlayer","Random","Utils"]);