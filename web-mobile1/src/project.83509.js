window.__require=function t(e,o,r){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+c+"'")}}var p=o[c]={exports:{}};e[c][0].call(p.exports,function(t){return i(e[c][1][t]||t)},p,p.exports,t,e,o,r)}return o[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<r.length;c++)i(r[c]);return i}({AudioPlayer:[function(t,e,o){"use strict";cc._RF.push(e,"e5bd2TM901Exod7A4hZNEcf","AudioPlayer");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../EventConstant"),c=t("./Random"),a=cc._decorator,s=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hit=null,e.upgrade=null,e.over=null,e.bg01=null,e.bg02=null,e.bg03=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(n.EventConstant.PLAY_AUDIO,function(e){t.play(e.detail.name)})},e.prototype.playbg=function(){var t=c.default.getHalfChance()?this.bg01:this.bg03;cc.audioEngine.playMusic(t,!0)},e.prototype.play=function(t){switch(t){case o.PLAYER_UPGRADE:cc.audioEngine.playEffect(this.upgrade,!1);break;case o.GAME_OVER:cc.audioEngine.playEffect(this.over,!1);break;case o.PLAYER_HIT:cc.audioEngine.playEffect(this.hit,!1);break;case o.STOP_BG:cc.audioEngine.stopMusic();break;case o.PLAY_BG:this.playbg()}},e.prototype.start=function(){},e.PLAYER_UPGRADE="PLAYER_UPGRADE",e.GAME_OVER="GAME_OVER",e.PLAYER_HIT="PLAYER_HIT",e.STOP_BG="STOP_BG",e.PLAY_BG="PLAY_BG",i([l({type:cc.AudioClip})],e.prototype,"hit",void 0),i([l({type:cc.AudioClip})],e.prototype,"upgrade",void 0),i([l({type:cc.AudioClip})],e.prototype,"over",void 0),i([l({type:cc.AudioClip})],e.prototype,"bg02",void 0),i([l({type:cc.AudioClip})],e.prototype,"bg03",void 0),e=o=i([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../EventConstant":"EventConstant","./Random":"Random"}],Building:[function(t,e,o){"use strict";cc._RF.push(e,"b8557VgzS1PaZtvSMwX8vKI","Building");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../utils/Random"),c=t("../EventConstant"),a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shadowarr=[-1.1,-1,-.9,-.8,-.7,-.6,-.5,-.4,-.3,-.2,-.1,0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],e.shadowopacityarr=[20,40,60,80,100,120,140,160,180,200,220,240,220,200,180,160,140,120,100,80,60,40,20,0],e}return r(e,t),e.prototype.onLoad=function(){var t=this;cc.director.on(c.EventConstant.TIME_CHANGE,function(e){t.changeShadow(e.detail.time)}),this.sprite=this.node.getChildByName("sprite"),this.shadow=this.node.getChildByName("shadow"),this.collider=this.getComponent(cc.PhysicsCircleCollider);var e="#579725";this.collider.sensor=!0,this.node.opacity=128,n.default.getHalfChance()&&(e="#C71585",this.collider.sensor=!0,this.node.opacity=128),n.default.getHalfChance()&&(e="#333333",this.collider.sensor=!1,this.node.opacity=255),this.collider.apply(),this.sprite.color=cc.color(255,255,255).fromHEX(e),this.changeShadow(0)},e.prototype.changeShadow=function(t){this.shadow.scaleX=this.shadowarr[t],this.shadow.scaleX+=t<=12?-.5:.5,this.shadow.opacity=this.shadowopacityarr[t]},e.prototype.start=function(){},e=i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{"../EventConstant":"EventConstant","../utils/Random":"Random"}],CameraControl:[function(t,e,o){"use strict";cc._RF.push(e,"8b9a6eGtr5LjbYDTt157V5Q","CameraControl");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./GameWorld"),c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e}return r(e,t),e.prototype.onLoad=function(){this.camera=this.getComponent(cc.Camera)},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.start=function(){},e.prototype.lateUpdate=function(){if(this.world&&this.world.player){var t=this.world.player.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.node.position=this.lerp(this.node.position,this.node.parent.convertToNodeSpaceAR(t),.1)}},e.prototype.lerp=function(t,e,o){var r=cc.v2(0,0),i=t.x,n=t.y;return r.x=i+(e.x-i)*o,r.y=n+(e.y-n)*o,r},i([s(n.default)],e.prototype,"world",void 0),e=i([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./GameWorld":"GameWorld"}],Circle:[function(t,e,o){"use strict";cc._RF.push(e,"2f565vHKqRAUZ1o3eFQfEyC","Circle");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),c=t("./ui/GameStart"),a=cc._decorator,s=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMoving=!1,e.isDied=!1,e.speed=100,e.protectingTime=2,e.isProtecting=!1,e.level=0,e.circle000=null,e.circle001=null,e.circle002=null,e.circle003=null,e.circle004=null,e.circle005=null,e.circle006=null,e.circle007=null,e.star1=null,e.star2=null,e.star3=null,e.star4=null,e}var o;return r(e,t),o=e,e.prototype.init=function(t){this.upgrade(t)},e.prototype.move=function(t){if(c.default.isPaused)this.rigidbody.linearVelocity=cc.Vec2.ZERO;else{var e=t.x,o=t.y,r=Math.abs(e),i=Math.abs(o);this.isMoving=0!=e||0!=o;var n=r>i?r:i;n=0==n?1:n;var a=cc.v2(e,o),s=this.speed;s<0&&(s=0),a=a.mul(s),this.rigidbody.linearVelocity=a}},e.prototype.start=function(){},e.prototype.upgrade=function(t){this.level=t,this.node.scale=1+t/10,this.speed=8*(o.MAX_LEVEL-t)+40,this.changeRes(t)},e.prototype.changeRes=function(t){var e=[null,this.star1,this.star2,this.star3,this.star4];t<1?(this.sprite.spriteFrame=this.circle000,this.star.spriteFrame=null):t>0&&t<=5?(this.sprite.spriteFrame=this.circle001,this.star.spriteFrame=e[t-1]):t>5&&t<=10?(this.sprite.spriteFrame=this.circle002,this.star.spriteFrame=e[t-6]):t>10&&t<=15?(this.sprite.spriteFrame=this.circle003,this.star.spriteFrame=e[t-11]):t>15&&t<=20?(this.sprite.spriteFrame=this.circle004,this.star.spriteFrame=e[t-16]):t>20&&t<=25?(this.sprite.spriteFrame=this.circle005,this.star.spriteFrame=e[t-21]):t>25&&t<=30?(this.sprite.spriteFrame=this.circle006,this.star.spriteFrame=e[t-26]):t>30&&(this.sprite.spriteFrame=this.circle007,this.star.spriteFrame=null)},e.prototype.getCirleRank=function(t){return t<1?0:t>0&&t<=5?1:t>5&&t<=10?2:t>10&&t<=15?3:t>15&&t<=20?4:t>20&&t<=25?5:t>25&&t<=30?6:t>30?7:void 0},e.prototype.transfromScale=function(t,e){var o=this;if(!this.isProtecting){this.changeRes(t),this.node.runAction(cc.scaleTo(.2,1+t/8)),this.isProtecting=!0,this.anim||(this.anim=this.getComponent(cc.Animation));var r=this.node.getChildByName("sprite").getChildByName("rim");r&&(r.opacity=200),this.anim.playAdditive("PlayerChange"),this.scheduleOnce(function(){o.isProtecting=!1,o.upgrade(t),r&&(r.opacity=0),e&&cc.director.emit(n.EventConstant.PLAYER_LEVEL_UPDATE,{detail:{level:o.level}})},this.protectingTime),this.rigidbody.linearVelocity=cc.Vec2.ZERO}},e.MAX_LEVEL=30,i([l(cc.SpriteFrame)],e.prototype,"circle000",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle001",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle002",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle003",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle004",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle005",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle006",void 0),i([l(cc.SpriteFrame)],e.prototype,"circle007",void 0),i([l(cc.SpriteFrame)],e.prototype,"star1",void 0),i([l(cc.SpriteFrame)],e.prototype,"star2",void 0),i([l(cc.SpriteFrame)],e.prototype,"star3",void 0),i([l(cc.SpriteFrame)],e.prototype,"star4",void 0),e=o=i([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./EventConstant":"EventConstant","./ui/GameStart":"GameStart"}],EventConstant:[function(t,e,o){"use strict";cc._RF.push(e,"4bc2cjsl3FOupuzjqA2r09w","EventConstant");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,c=n.ccclass,a=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.PLAYER_MOVE="PLAYER_MOVE",e.TIME_CHANGE="TIME_CHANGE",e.PLAYER_LEVEL_UPDATE="PLAYER_LEVEL_UPDATE",e.GAME_FINISHED="GAME_FINISHED",e.GAME_OVER="GAME_OVER",e.GAME_START="GAME_START",e.PLAY_AUDIO="PLAY_AUDIO",e.eventHandler=new cc.Node,e=i([c],e)}(cc.Component));o.EventConstant=a,cc._RF.pop()},{}],GameStart:[function(t,e,o){"use strict";cc._RF.push(e,"c28aaTc/RFFhru2M/2+g1fm","GameStart");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../GameWorld"),c=t("../EventConstant"),a=t("../Joystick"),s=cc._decorator,l=s.ccclass,p=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e.startDialog=null,e.finishDialog=null,e.overDialog=null,e.joystick=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){var t=this;cc.director.on(c.EventConstant.GAME_FINISHED,function(e){t.gameFinish()}),cc.director.on(c.EventConstant.GAME_START,function(e){t.gameStart()}),cc.director.on(c.EventConstant.GAME_OVER,function(e){t.gameOver()})},e.prototype.start=function(){},e.prototype.gameFinish=function(){o.isPaused=!0,this.startDialog.active=!1,this.finishDialog.active=!0,this.overDialog.active=!1;var t=this.joystick.getComponent(a.default);t&&t.init(),this.joystick.active=!1,this.world.init()},e.prototype.gameStart=function(){o.isPaused=!1,this.startDialog.active=!1,this.finishDialog.active=!1,this.overDialog.active=!1,this.joystick.active=!0;var t=this.joystick.getComponent(a.default);t&&t.init()},e.prototype.gameOver=function(){o.isPaused=!0,this.startDialog.active=!1,this.finishDialog.active=!1,this.overDialog.active=!0;var t=this.joystick.getComponent(a.default);t&&t.init(),this.joystick.active=!1},e.isPaused=!0,i([p(n.default)],e.prototype,"world",void 0),i([p(cc.Node)],e.prototype,"startDialog",void 0),i([p(cc.Node)],e.prototype,"finishDialog",void 0),i([p(cc.Node)],e.prototype,"overDialog",void 0),i([p(cc.Node)],e.prototype,"joystick",void 0),e=o=i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../EventConstant":"EventConstant","../GameWorld":"GameWorld","../Joystick":"Joystick"}],GameTimer:[function(t,e,o){"use strict";cc._RF.push(e,"bdcf8gUFppHVrWtV5s7RIwz","GameTimer");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.seconds=0,e.timeDelay=0,e}return r(e,t),e.prototype.start=function(){},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>60&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&(this.seconds++,this.seconds>23&&(this.seconds=0),cc.director.emit(n.EventConstant.TIME_CHANGE,{detail:{time:this.seconds}}))},e=i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./EventConstant":"EventConstant"}],GameWorld:[function(t,e,o){"use strict";cc._RF.push(e,"17d53HrJp5K4ZGbscfaLtYF","GameWorld");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Player"),c=t("./EventConstant"),a=t("./Npc"),s=t("./utils/Random"),l=t("./building/Building"),p=t("./Circle"),u=cc._decorator,h=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerPrefab=null,e.npcPrefab=null,e.buildingPrefab=null,e.timeDelay=0,e.checkTimeDelay=0,e.player=null,e.npcList=[],e.shadowarr=[110,100,90,80,70,60,50,40,30,20,10,0,10,20,30,40,50,60,70,80,90,100,110,120],e.colorarr=[233,235,237,239,241,243,245,247,249,251,253,255,253,251,249,247,245,243,241,239,237,235,233,231],e}return r(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getPhysicsManager().enabled=!0,cc.director.on(c.EventConstant.TIME_CHANGE,function(e){t.changeShadow(e.detail.time)}),this.spritebasebg=this.node.getChildByName("basebg"),this.spritebg=this.node.getChildByName("background"),this.spritewalltop=this.node.getChildByName("background").getChildByName("airwalltop").getChildByName("sprite"),this.spritewallbottom=this.node.getChildByName("background").getChildByName("airwallbottom").getChildByName("sprite"),this.spritewallleft=this.node.getChildByName("background").getChildByName("airwallleft").getChildByName("sprite"),this.spritewallright=this.node.getChildByName("background").getChildByName("airwallright").getChildByName("sprite"),this.shadow=this.node.getChildByName("shadow"),this.actorLayer=this.node.getChildByName("actorlayer"),this.actorLayer.zIndex=2e3,this.shadow.zIndex=8e3,this.player=cc.instantiate(this.playerPrefab).getComponent(n.default),this.player.node.parent=this.node,this.player.node.zIndex=3e3,this.init()},e.prototype.init=function(){var t=this;this.actorLayer.removeAllChildren(),this.scheduleOnce(function(){t.player.node.setPosition(cc.v2(0,0))},.1),this.player.init(0);for(var e=0;e<100;e++)this.addBuilding(cc.v2(s.default.getRandomNum(-1600,1600),s.default.getRandomNum(-1600,1600)),s.default.getRandomNum(1,5)+s.default.rand());this.scheduleOnce(function(){t.delayAddNpcs()},.2)},e.prototype.delayAddNpcs=function(){for(var t=0;t<300;t++)this.addNpc(cc.v2(s.default.getRandomNum(-1500,1500),s.default.getRandomNum(-1500,1500)),s.default.getRandomNum(0,p.default.MAX_LEVEL))},e.prototype.changeShadow=function(t){this.shadow.opacity=0,this.spritebasebg.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t]),this.spritebg.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t]),this.spritewalltop.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t]),this.spritewallbottom.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t]),this.spritewallleft.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t]),this.spritewallright.color=cc.color(this.colorarr[t],this.colorarr[t],this.colorarr[t])},e.prototype.addNpc=function(t,e){var o=cc.instantiate(this.npcPrefab).getComponent(a.default);o.node.parent=this.actorLayer,o.node.position=t,o.node.zIndex=1e3,o.init(e),this.npcList.push(o)},e.prototype.addBuilding=function(t,e){var o=cc.instantiate(this.buildingPrefab).getComponent(l.default);o.node.parent=this.node,o.node.position=t,o.node.zIndex=3e3,o.node.scale=e},e.prototype.start=function(){},e.prototype.lerp=function(t,e,o){var r=cc.v2(0,0),i=t.x,n=t.y;return r.x=i+(e.x-i)*o,r.y=n+(e.y-n)*o,r},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.isCheckTimeDelay=function(t){return this.checkTimeDelay+=t,this.checkTimeDelay>1&&(this.checkTimeDelay=0,!0)},e.prototype.update=function(t){},i([d(cc.Prefab)],e.prototype,"playerPrefab",void 0),i([d(cc.Prefab)],e.prototype,"npcPrefab",void 0),i([d(cc.Prefab)],e.prototype,"buildingPrefab",void 0),e=i([h],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./Circle":"Circle","./EventConstant":"EventConstant","./Npc":"Npc","./Player":"Player","./building/Building":"Building","./utils/Random":"Random"}],Joystick:[function(t,e,o){"use strict";cc._RF.push(e,"b3041FXU3BBlLVXLnuJUnIm","Joystick");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anglePreDirQuadrant=23,e.fixedPoint=null,e.movePoint=null,e.movePointMoveRadius=100,e.stopCount=0,e.timeDelay=0,e}return r(e,t),e.prototype.onLoad=function(){var t=this.node.getContentSize();this.touchArea=new cc.Vec2(t.width,t.height),this.fixedPointMoveCenterPos=this.touchArea.div(0,this.touchArea),this.fixedPointMoveRadius=this.touchArea.x/2-this.movePointMoveRadius,this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(-1==this.touchID){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var r=this.clampPos(o,this.fixedPointMoveCenterPos,this.fixedPointMoveRadius);this.movePointMoveCenterPos=r,this.setFixedPointPos(r),this.setMovePointPos(r),this.touchID=t.getID()}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.touchID==t.getID()){var e=t.getLocation(),o=new cc.Vec2(e.x,e.y);o.subSelf(this.node.position);var r=this.clampPos(o,this.movePointMoveCenterPos,this.movePointMoveRadius);this.setMovePointPos(r)}},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){this.init()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){this.init()},this),this.init()},e.prototype.init=function(){this.touchID=-1,this.joystickInputDir=new cc.Vec2,this.setFixedPointPos(this.fixedPointMoveCenterPos),this.setMovePointPos(this.fixedPointMoveCenterPos)},e.prototype.setFixedPointPos=function(t){this.fixedPoint.setPosition(t)},e.prototype.getFixedPointPos=function(){return this.fixedPoint.getPosition()},e.prototype.setMovePointPos=function(t){this.movePoint.setPosition(t)},e.prototype.getMovePointPos=function(){return this.movePoint.getPosition()},e.prototype.clampPos=function(t,e,o){var r=t.sub(e);return r.mag()>o?r.normalize().mul(o).add(e):t},e.prototype.getInputDir=function(){var t=this.movePoint.getPosition().sub(this.fixedPoint.getPosition());return(isNaN(t.x)||isNaN(t.y))&&(t=cc.v2(0,0)),t.mag()>0&&t.normalizeSelf(),t},e.prototype.getInputQuadrantDir=function(){return this.getVec2ByQuadrant(this.getDirQuadrant(this.getInputDir()))},e.prototype.getDirQuadrant=function(t){var e=null;return t.mag()>0&&(e=Math.floor(this.getAngleByVec2(t)/this.anglePreDirQuadrant)),e},e.prototype.getAngleByVec2=function(t){return 180*-Math.atan2(t.y,t.x)/Math.PI+this.anglePreDirQuadrant/2},e.prototype.getVec2ByAngle=function(t){var e=new cc.Vec2,o=(this.anglePreDirQuadrant/2-t)*(Math.PI/180);return e.x=Math.cos(o),e.y=Math.sin(o),e.normalizeSelf()},e.prototype.getVec2ByQuadrant=function(t){if(null!=t){var e=t*this.anglePreDirQuadrant;return e+=this.anglePreDirQuadrant/2,this.getVec2ByAngle(e)}return cc.Vec2.ZERO},e.prototype.sendMoveMessageToPlayer=function(t){var e=this.getInputQuadrantDir(),o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3));var r=this.getInputDir();r.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(n.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:r,dt:t}})},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},i([s(cc.Integer)],e.prototype,"anglePreDirQuadrant",void 0),i([s(cc.Node)],e.prototype,"fixedPoint",void 0),i([s(cc.Node)],e.prototype,"movePoint",void 0),i([s],e.prototype,"movePointMoveRadius",void 0),e=i([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant"}],KeyboardController:[function(t,e,o){"use strict";cc._RF.push(e,"4d2c9CLNu1I0JRJ/zYWvgTz","KeyboardController");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EventConstant"),c=t("./ui/GameStart"),a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stopCount=0,e.isUp=!1,e.isDown=!1,e.isLeft=!1,e.isRight=!1,e.isA=!1,e.isB=!1,e.isC=!1,e.isD=!1,e.timeDelay=0,e}return r(e,t),e.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.start=function(){},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!0;break;case cc.macro.KEY.s:this.isDown=!0;break;case cc.macro.KEY.a:this.isLeft=!0;break;case cc.macro.KEY.d:this.isRight=!0;break;case cc.macro.KEY.j:this.isA=!0;break;case cc.macro.KEY.k:this.isB=!0;break;case cc.macro.KEY.i:this.isC=!0;break;case cc.macro.KEY.l:this.isD=!0}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.w:this.isUp=!1;break;case cc.macro.KEY.s:this.isDown=!1;break;case cc.macro.KEY.a:this.isLeft=!1;break;case cc.macro.KEY.d:this.isRight=!1;break;case cc.macro.KEY.j:this.isA=!1;break;case cc.macro.KEY.k:this.isB=!1;break;case cc.macro.KEY.i:this.isC=!1;break;case cc.macro.KEY.l:this.isD=!1}},e.prototype.update=function(t){this.isTimeDelay(t)&&this.sendMoveMessageToPlayer(t)},e.prototype.sendMoveMessageToPlayer=function(t){var e=cc.v2(0,0);this.isUp&&e.addSelf(cc.v2(0,.9)),this.isDown&&e.addSelf(cc.v2(0,-.9)),this.isLeft&&e.addSelf(cc.v2(-.9,0)),this.isRight&&e.addSelf(cc.v2(.9,0)),e.mag()>0&&e.normalizeSelf();var o=4;Math.abs(e.x)<Math.abs(e.y)&&(e.y>.3&&(o=0),e.y<-.3&&(o=1)),Math.abs(e.x)>Math.abs(e.y)&&(e.x<-.3&&(o=2),e.x>.3&&(o=3)),e.equals(cc.Vec2.ZERO)?this.stopCount++:this.stopCount=0,this.stopCount<2&&cc.director.emit(n.EventConstant.PLAYER_MOVE,{detail:{dir:o,pos:e,dt:t}}),this.isA&&c.default.isPaused&&cc.director.emit(n.EventConstant.GAME_START),this.isB,this.isC,this.isD},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>.016&&(this.timeDelay=0,!0)},e=i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./EventConstant":"EventConstant","./ui/GameStart":"GameStart"}],Npc:[function(t,e,o){"use strict";cc._RF.push(e,"d1a1eIJ+ItH3KWe/hPfwvFH","Npc");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("./utils/Random"),c=t("./Circle"),a=t("./EventConstant"),s=cc._decorator,l=s.ccclass,p=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeDelay=0,e.rate=3,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.isDied=!1,this.rigidbody=this.getComponent(cc.RigidBody),this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.star=this.node.getChildByName("sprite").getChildByName("star").getComponent(cc.Sprite),this.move(cc.v2(n.default.getHalfChance()?n.default.rand():-n.default.rand(),n.default.getHalfChance()?n.default.rand():-n.default.rand())),cc.director.on(a.EventConstant.PLAYER_LEVEL_UPDATE,function(e){t.changeColor(e.detail.level)}),this.scheduleOnce(function(){t.changeColor(0)},1)},e.prototype.isTimeDelay=function(t){return this.timeDelay+=t,this.timeDelay>this.rate&&(this.rate=n.default.getRandomNum(1,6),this.timeDelay=0,!0)},e.prototype.changeColor=function(t){var e=this.getCirleRank(this.level),o=this.getCirleRank(t);Math.abs(o-e)>3?this.sprite.node.color=cc.color(40,40,40):this.sprite.node.color=cc.color(255,255,255)},e.prototype.update=function(t){this.isTimeDelay(t)&&this.move(cc.v2(n.default.getHalfChance()?n.default.rand():-n.default.rand(),n.default.getHalfChance()?n.default.rand():-n.default.rand()))},e=i([l],e)}(c.default));o.default=p,cc._RF.pop()},{"./Circle":"Circle","./EventConstant":"EventConstant","./utils/Random":"Random"}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"98cabdCDgxC64xZj196b1xq","Player");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,c=n.ccclass,a=(n.property,t("./EventConstant")),s=t("./Npc"),l=t("./Circle"),p=t("./ui/GameStart"),u=t("./utils/AudioPlayer"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUpgraded=!1,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.isDied=!1,this.rigidbody=this.getComponent(cc.RigidBody),this.anim=this.getComponent(cc.Animation),this.sprite=this.node.getChildByName("sprite").getComponent(cc.Sprite),this.star=this.node.getChildByName("sprite").getChildByName("star").getComponent(cc.Sprite),cc.director.on(a.EventConstant.PLAYER_MOVE,function(e){t.move(e.detail.pos)})},e.prototype.update=function(t){},e.prototype.getNextTargetSpriteframe=function(){var t=[null,this.star1,this.star2,this.star3,this.star4],e=this.level+1,o=null,r=null;return e<1?(o=this.circle000,r=null):e>0&&e<=5?(o=this.circle001,r=t[e-1]):e>5&&e<=10?(o=this.circle002,r=t[e-6]):e>10&&e<=15?(o=this.circle003,r=t[e-11]):e>15&&e<=20?(o=this.circle004,r=t[e-16]):e>20&&e<=25?(o=this.circle005,r=t[e-21]):e>25&&e<=30?(o=this.circle006,r=t[e-26]):e>30&&(o=this.circle007,r=null),[o,r]},e.prototype.checkBadLevelValid=function(t){var e=t-this.level,o=this.getCirleRank(this.level),r=this.getCirleRank(t);return!(Math.abs(r-o)>3)&&(e>1||e<0)},e.prototype.checkGoodLevelValid=function(t){return t-this.level==1},e.prototype.onBeginContact=function(t,e,o){if(!p.default.isPaused&&this.level!=l.default.MAX_LEVEL){var r=o.node.getComponent(s.default);!r||this.isProtecting||r.isProtecting||(this.checkGoodLevelValid(r.level)?(this.transfromScale(r.level,!0),cc.director.emit(a.EventConstant.PLAY_AUDIO,{detail:{name:u.default.PLAYER_UPGRADE}}),1==r.level&&(this.isUpgraded=!0),r.level==l.default.MAX_LEVEL&&cc.director.emit(a.EventConstant.GAME_FINISHED)):this.checkBadLevelValid(r.level)&&this.level>0&&(this.transfromScale(this.level-1,!0),cc.director.emit(a.EventConstant.PLAY_AUDIO,{detail:{name:u.default.PLAYER_HIT}}),this.isUpgraded&&this.level-1==0&&(this.isUpgraded=!1,this.init(0),cc.director.emit(a.EventConstant.GAME_OVER),cc.director.emit(a.EventConstant.PLAY_AUDIO,{detail:{name:u.default.GAME_OVER}}))))}},e=i([c],e)}(l.default);o.default=h,cc._RF.pop()},{"./Circle":"Circle","./EventConstant":"EventConstant","./Npc":"Npc","./ui/GameStart":"GameStart","./utils/AudioPlayer":"AudioPlayer"}],Random:[function(t,e,o){"use strict";cc._RF.push(e,"6884aZwgtJKhYfD6AFDvIcl","Random"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.setSeed=function(e){t.seed=e},t.rand=function(){return t.seed=(9301*t.seed+49297)%233280,t.seed/233280},t.getRandomNum=function(e,o){return e+Math.round(t.rand()*(o-e))},t.getHalfChance=function(){return t.rand()>.5},t.seed=(new Date).getTime(),t}();o.default=r,cc._RF.pop()},{}],TargetUI:[function(t,e,o){"use strict";cc._RF.push(e,"e6099Xh7JxLBZyOKXJ02zQi","TargetUI");var r=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),i=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,c=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(n<3?i(c):n>3?i(e,o,c):i(e,o))||c);return n>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../GameWorld"),c=t("../EventConstant"),a=cc._decorator,s=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.sprite=this.node.getChildByName("next").getChildByName("sprite").getComponent(cc.Sprite),this.star=this.node.getChildByName("next").getChildByName("sprite").getChildByName("star").getComponent(cc.Sprite),cc.director.on(c.EventConstant.PLAYER_LEVEL_UPDATE,function(e){t.changeRes()})},e.prototype.changeRes=function(){if(this.world&&this.world.player){var t=this.world.player.getNextTargetSpriteframe();this.sprite.spriteFrame=t[0],this.star.spriteFrame=t[1]}},e.prototype.start=function(){},i([l(n.default)],e.prototype,"world",void 0),e=i([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../EventConstant":"EventConstant","../GameWorld":"GameWorld"}]},{},["CameraControl","Circle","EventConstant","GameTimer","GameWorld","Joystick","KeyboardController","Npc","Player","Building","GameStart","TargetUI","AudioPlayer","Random"]);